# üìä –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í RLS –ê–£–î–ò–¢–ê

## üéØ –ö–†–ò–¢–ò–ß–ù–´–ï –¢–ê–ë–õ–ò–¶–´ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. **ai_agent_settings** - –ö–†–ò–¢–ò–ß–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞**: RLS –æ—Ç–∫–ª—é—á–µ–Ω, –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–õ–æ–≥–∏–∫–∞**: 1 –ø—Ä–æ–µ–∫—Ç = 1 AI –∞–≥–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 2. **autoswitch_settings** - –ö–†–ò–¢–ò–ß–ù–û  
- **–ü—Ä–æ–±–ª–µ–º–∞**: RLS –æ—Ç–∫–ª—é—á–µ–Ω, –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–õ–æ–≥–∏–∫–∞**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 3. **dialogs** - –ö–†–ò–¢–ò–ß–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞**: RLS –æ—Ç–∫–ª—é—á–µ–Ω, –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–õ–æ–≥–∏–∫–∞**: –î–∏–∞–ª–æ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 4. **conversations** - –ö–†–ò–¢–ò–ß–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞**: RLS –æ—Ç–∫–ª—é—á–µ–Ω, –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–õ–æ–≥–∏–∫–∞**: –†–∞–∑–≥–æ–≤–æ—Ä—ã –≤ –¥–∏–∞–ª–æ–≥–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 5. **chat_messages** - –ö–†–ò–¢–ò–ß–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞**: RLS –æ—Ç–∫–ª—é—á–µ–Ω, –ø–æ–ª–∏—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–õ–æ–≥–∏–∫–∞**: –°–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

## üîß –¢–ê–ë–õ–ò–¶–´ –° –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ú–ò –ü–û–õ–ò–¢–ò–ö–ê–ú–ò

### 6. **widget_development_settings** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `widget_development_settings_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 7. **telegram_settings** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `telegram_settings_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –±–æ—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 8. **bot_corrections** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `bot_corrections_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –±–æ—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

## üìö –¢–ê–ë–õ–ò–¶–´ –ë–ê–ó–´ –ó–ù–ê–ù–ò–ô

### 9. **knowledge_sources** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `knowledge_sources_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–Ω–∞–Ω–∏–π –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 10. **knowledge_chunks** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `knowledge_chunks_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ß–∞–Ω–∫–∏ –∑–Ω–∞–Ω–∏–π –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

## üè∑Ô∏è –¢–ê–ë–õ–ò–¶–´ –ù–ò–®

### 11. **niches** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `niches_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –ù–∏—à–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 12. **niche_synonyms** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `niche_synonyms_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –°–∏–Ω–æ–Ω–∏–º—ã –Ω–∏—à –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

### 13. **user_niches** - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–∏—Ç–∏–∫–∞ `user_niches_project_access` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ–æ–≥–∏–∫–∞**: –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –Ω–∏—à–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **–¢—Ä–µ–±—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞**: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`

## üéØ –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –§–ê–ó–ê 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (1-5)
1. ai_agent_settings
2. autoswitch_settings  
3. dialogs
4. conversations
5. chat_messages

### –§–ê–ó–ê 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (6-8)
6. widget_development_settings
7. telegram_settings
8. bot_corrections

### –§–ê–ó–ê 3: –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (9-10)
9. knowledge_sources
10. knowledge_chunks

### –§–ê–ó–ê 4: –ù–∏—à–∏ (11-13)
11. niches
12. niche_synonyms
13. user_niches

## ‚úÖ –ü–†–ò–ù–¶–ò–ü–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. **–í–∫–ª—é—á–∏—Ç—å RLS** –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
2. **–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏** —Å –ø–æ–º–æ—â—å—é `DROP POLICY IF EXISTS`
3. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏** –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É: `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`
4. **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞** –¥–ª—è authenticated –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å** –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üö® –í–ê–ñ–ù–û

- –ö–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
- –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
- –ü—Ä–∏–Ω—Ü–∏–ø: 1 –ø—Ä–æ–µ–∫—Ç = 1 –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (–∞–≥–µ–Ω—Ç, RAG, –Ω–∏—à–∞, CRM, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
