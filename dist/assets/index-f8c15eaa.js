!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var s=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(s,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),s}var n={exports:{}},r={},a={exports:{}},i={},l=Symbol.for("react.element"),o=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),x=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),b=Symbol.iterator;var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function j(e,t,s){this.props=e,this.context=t,this.refs=w,this.updater=s||v}function N(){}function k(e,t,s){this.props=e,this.context=t,this.refs=w,this.updater=s||v}j.prototype.isReactComponent={},j.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},j.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},N.prototype=j.prototype;var F=k.prototype=new N;F.constructor=k,y(F,j.prototype),F.isPureReactComponent=!0;var _=Array.isArray,E=Object.prototype.hasOwnProperty,C={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,s){var n,r={},a=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(a=""+t.key),t)E.call(t,n)&&!S.hasOwnProperty(n)&&(r[n]=t[n]);var o=arguments.length-2;if(1===o)r.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===r[n]&&(r[n]=o[n]);return{$$typeof:l,type:e,key:a,ref:i,props:r,_owner:C.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===l}var D=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(e,t,s,n,r){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var i=!1;if(null===e)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case l:case o:i=!0}}if(i)return r=r(i=e),e=""===n?"."+I(i,0):n,_(r)?(s="",null!=e&&(s=e.replace(D,"$&/")+"/"),M(r,t,s,"",function(e){return e})):null!=r&&(T(r)&&(r=function(e,t){return{$$typeof:l,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,s+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(D,"$&/")+"/")+e)),t.push(r)),1;if(i=0,n=""===n?".":n+":",_(e))for(var c=0;c<e.length;c++){var d=n+I(a=e[c],c);i+=M(a,t,s,d,r)}else if(d=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=b&&e[b]||e["@@iterator"])?e:null}(e),"function"==typeof d)for(e=d.call(e),c=0;!(a=e.next()).done;)i+=M(a=a.value,t,s,d=n+I(a,c++),r);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function L(e,t,s){if(null==e)return e;var n=[],r=0;return M(e,n,"","",function(e){return t.call(s,e,r++)}),n}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},P={transition:null},$={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:P,ReactCurrentOwner:C};function B(){throw Error("act(...) is not supported in production builds of React.")}i.Children={map:L,forEach:function(e,t,s){L(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return L(e,function(){t++}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},i.Component=j,i.Fragment=c,i.Profiler=u,i.PureComponent=k,i.StrictMode=d,i.Suspense=m,i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,i.act=B,i.cloneElement=function(e,t,s){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=y({},e.props),r=e.key,a=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,i=C.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)E.call(t,c)&&!S.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:l,type:e.type,key:r,ref:a,props:n,_owner:i}},i.createContext=function(e){return(e={$$typeof:x,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:h,_context:e},e.Consumer=e},i.createElement=A,i.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},i.createRef=function(){return{current:null}},i.forwardRef=function(e){return{$$typeof:p,render:e}},i.isValidElement=T,i.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:R}},i.memo=function(e,t){return{$$typeof:g,type:e,compare:void 0===t?null:t}},i.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},i.unstable_act=B,i.useCallback=function(e,t){return O.current.useCallback(e,t)},i.useContext=function(e){return O.current.useContext(e)},i.useDebugValue=function(){},i.useDeferredValue=function(e){return O.current.useDeferredValue(e)},i.useEffect=function(e,t){return O.current.useEffect(e,t)},i.useId=function(){return O.current.useId()},i.useImperativeHandle=function(e,t,s){return O.current.useImperativeHandle(e,t,s)},i.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},i.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},i.useMemo=function(e,t){return O.current.useMemo(e,t)},i.useReducer=function(e,t,s){return O.current.useReducer(e,t,s)},i.useRef=function(e){return O.current.useRef(e)},i.useState=function(e){return O.current.useState(e)},i.useSyncExternalStore=function(e,t,s){return O.current.useSyncExternalStore(e,t,s)},i.useTransition=function(){return O.current.useTransition()},i.version="18.3.1",a.exports=i;var z=a.exports;const U=t(z);
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q=z,W=Symbol.for("react.element"),H=Symbol.for("react.fragment"),Q=Object.prototype.hasOwnProperty,V=q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K={key:!0,ref:!0,__self:!0,__source:!0};function G(e,t,s){var n,r={},a=null,i=null;for(n in void 0!==s&&(a=""+s),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(i=t.ref),t)Q.call(t,n)&&!K.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:W,type:e,key:a,ref:i,props:r,_owner:V.current}}r.Fragment=H,r.jsx=G,r.jsxs=G,n.exports=r;var J=n.exports,Y={},X={exports:{}},Z={},ee={exports:{}},te={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e){function t(e,t){var s=e.length;e.push(t);e:for(;0<s;){var n=s-1>>>1,a=e[n];if(!(0<r(a,t)))break e;e[n]=t,e[s]=a,s=n}}function s(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var l=2*(n+1)-1,o=e[l],c=l+1,d=e[c];if(0>r(o,s))c<a&&0>r(d,o)?(e[n]=d,e[c]=s,n=c):(e[n]=o,e[l]=s,n=l);else{if(!(c<a&&0>r(d,s)))break e;e[n]=d,e[c]=s,n=c}}}return t}function r(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var o=[],c=[],d=1,u=null,h=3,x=!1,p=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,f="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var r=s(c);null!==r;){if(null===r.callback)n(c);else{if(!(r.startTime<=e))break;n(c),r.sortIndex=r.expirationTime,t(o,r)}r=s(c)}}function y(e){if(m=!1,v(e),!p)if(null!==s(o))p=!0,D(w);else{var t=s(c);null!==t&&I(y,t.startTime-e)}}function w(t,r){p=!1,m&&(m=!1,f(F),F=-1),x=!0;var a=h;try{for(v(r),u=s(o);null!==u&&(!(u.expirationTime>r)||t&&!C());){var i=u.callback;if("function"==typeof i){u.callback=null,h=u.priorityLevel;var l=i(u.expirationTime<=r);r=e.unstable_now(),"function"==typeof l?u.callback=l:u===s(o)&&n(o),v(r)}else n(o);u=s(o)}if(null!==u)var d=!0;else{var g=s(c);null!==g&&I(y,g.startTime-r),d=!1}return d}finally{u=null,h=a,x=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,N=!1,k=null,F=-1,_=5,E=-1;function C(){return!(e.unstable_now()-E<_)}function S(){if(null!==k){var t=e.unstable_now();E=t;var s=!0;try{s=k(!0,t)}finally{s?j():(N=!1,k=null)}}else N=!1}if("function"==typeof b)j=function(){b(S)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,T=A.port2;A.port1.onmessage=S,j=function(){T.postMessage(null)}}else j=function(){g(S,0)};function D(e){k=e,N||(N=!0,j())}function I(t,s){F=g(function(){t(e.unstable_now())},s)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||x||(p=!0,D(w))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return s(o)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var s=h;h=t;try{return e()}finally{h=s}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=h;h=e;try{return t()}finally{h=s}},e.unstable_scheduleCallback=function(n,r,a){var i=e.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?i+a:i:a=i,n){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return n={id:d++,callback:r,priorityLevel:n,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>i?(n.sortIndex=a,t(c,n),null===s(o)&&n===s(c)&&(m?(f(F),F=-1):m=!0,I(y,a-i))):(n.sortIndex=l,t(o,n),p||x||(p=!0,D(w))),n},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=h;return function(){var s=h;h=t;try{return e.apply(this,arguments)}finally{h=s}}}}(te),ee.exports=te;var se=ee.exports,ne=z,re=se;
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ie=new Set,le={};function oe(e,t){ce(e,t),ce(e+"Capture",t)}function ce(e,t){for(le[e]=t,e=0;e<t.length;e++)ie.add(t[e])}var de=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),ue=Object.prototype.hasOwnProperty,he=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xe={},pe={};function me(e,t,s,n,r,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var ge={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ge[e]=new me(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ge[t]=new me(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){ge[e]=new me(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ge[e]=new me(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ge[e]=new me(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){ge[e]=new me(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){ge[e]=new me(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){ge[e]=new me(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){ge[e]=new me(e,5,!1,e.toLowerCase(),null,!1,!1)});var fe=/[\-:]([a-z])/g;function be(e){return e[1].toUpperCase()}function ve(e,t,s,n){var r=ge.hasOwnProperty(t)?ge[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,n){if(null==t||function(e,t,s,n){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,n))return!0;if(n)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,r,n)&&(s=null),n||null===r?function(e){return!!ue.call(pe,e)||!ue.call(xe,e)&&(he.test(e)?pe[e]=!0:(xe[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=null===s?3!==r.type&&"":s:(t=r.attributeName,n=r.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(r=r.type)||4===r&&!0===s?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fe,be);ge[t]=new me(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fe,be);ge[t]=new me(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fe,be);ge[t]=new me(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){ge[e]=new me(e,1,!1,e.toLowerCase(),null,!1,!1)}),ge.xlinkHref=new me("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){ge[e]=new me(e,1,!1,e.toLowerCase(),null,!0,!0)});var ye=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,we=Symbol.for("react.element"),je=Symbol.for("react.portal"),Ne=Symbol.for("react.fragment"),ke=Symbol.for("react.strict_mode"),Fe=Symbol.for("react.profiler"),_e=Symbol.for("react.provider"),Ee=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),Se=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),Te=Symbol.for("react.memo"),De=Symbol.for("react.lazy"),Ie=Symbol.for("react.offscreen"),Me=Symbol.iterator;function Le(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Me&&e[Me]||e["@@iterator"])?e:null}var Re,Oe=Object.assign;function Pe(e){if(void 0===Re)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Re=t&&t[1]||""}return"\n"+Re+e}var $e=!1;function Be(e,t){if(!e||$e)return"";$e=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"==typeof c.stack){for(var r=c.stack.split("\n"),a=n.stack.split("\n"),i=r.length-1,l=a.length-1;1<=i&&0<=l&&r[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(r[i]!==a[l]){if(1!==i||1!==l)do{if(i--,0>--l||r[i]!==a[l]){var o="\n"+r[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{$e=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Pe(e):""}function ze(e){switch(e.tag){case 5:return Pe(e.type);case 16:return Pe("Lazy");case 13:return Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 2:case 15:return e=Be(e.type,!1);case 11:return e=Be(e.type.render,!1);case 1:return e=Be(e.type,!0);default:return""}}function Ue(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Ne:return"Fragment";case je:return"Portal";case Fe:return"Profiler";case ke:return"StrictMode";case Se:return"Suspense";case Ae:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ee:return(e.displayName||"Context")+".Consumer";case _e:return(e._context.displayName||"Context")+".Provider";case Ce:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Te:return null!==(t=e.displayName||null)?t:Ue(e.type)||"Memo";case De:t=e._payload,e=e._init;try{return Ue(e(t))}catch(s){}}return null}function qe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ue(t);case 8:return t===ke?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function We(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function He(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Qe(e){e._valueTracker||(e._valueTracker=function(e){var t=He(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==s&&"function"==typeof s.get&&"function"==typeof s.set){var r=s.get,a=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ve(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=He(e)?e.checked?"true":"false":e.value),(e=n)!==s&&(t.setValue(e),!0)}function Ke(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Ge(e,t){var s=t.checked;return Oe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Je(e,t){var s=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;s=We(null!=t.value?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Ye(e,t){null!=(t=t.checked)&&ve(e,"checked",t,!1)}function Xe(e,t){Ye(e,t);var s=We(t.value),n=t.type;if(null!=s)"number"===n?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?et(e,t.type,s):t.hasOwnProperty("defaultValue")&&et(e,t.type,We(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ze(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function et(e,t,s){"number"===t&&Ke(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var tt=Array.isArray;function st(e,t,s,n){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&n&&(e[s].defaultSelected=!0)}else{for(s=""+We(s),t=null,r=0;r<e.length;r++){if(e[r].value===s)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function nt(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(ae(91));return Oe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rt(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(ae(92));if(tt(s)){if(1<s.length)throw Error(ae(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:We(s)}}function at(e,t){var s=We(t.value),n=We(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=n&&(e.defaultValue=""+n)}function it(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function lt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ot(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?lt(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ct,dt,ut=(dt=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ct.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,n){MSApp.execUnsafeLocalFunction(function(){return dt(e,t)})}:dt);function ht(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function mt(e,t,s){return null==t||"boolean"==typeof t||""===t?"":s||"number"!=typeof t||0===t||xt.hasOwnProperty(e)&&xt[e]?(""+t).trim():t+"px"}function gt(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var n=0===s.indexOf("--"),r=mt(s,t[s],n);"float"===s&&(s="cssFloat"),n?e.setProperty(s,r):e[s]=r}}Object.keys(xt).forEach(function(e){pt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xt[t]=xt[e]})});var ft=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bt(e,t){if(t){if(ft[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(ae(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(ae(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(ae(62))}}function vt(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yt=null;function wt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var jt=null,Nt=null,kt=null;function Ft(e){if(e=va(e)){if("function"!=typeof jt)throw Error(ae(280));var t=e.stateNode;t&&(t=wa(t),jt(e.stateNode,e.type,t))}}function _t(e){Nt?kt?kt.push(e):kt=[e]:Nt=e}function Et(){if(Nt){var e=Nt,t=kt;if(kt=Nt=null,Ft(e),t)for(e=0;e<t.length;e++)Ft(t[e])}}function Ct(e,t){return e(t)}function St(){}var At=!1;function Tt(e,t,s){if(At)return e(t,s);At=!0;try{return Ct(e,t,s)}finally{At=!1,(null!==Nt||null!==kt)&&(St(),Et())}}function Dt(e,t){var s=e.stateNode;if(null===s)return null;var n=wa(s);if(null===n)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(s&&"function"!=typeof s)throw Error(ae(231,t,typeof s));return s}var It=!1;if(de)try{var Mt={};Object.defineProperty(Mt,"passive",{get:function(){It=!0}}),window.addEventListener("test",Mt,Mt),window.removeEventListener("test",Mt,Mt)}catch(dt){It=!1}function Lt(e,t,s,n,r,a,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var Rt=!1,Ot=null,Pt=!1,$t=null,Bt={onError:function(e){Rt=!0,Ot=e}};function zt(e,t,s,n,r,a,i,l,o){Rt=!1,Ot=null,Lt.apply(Bt,arguments)}function Ut(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function qt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Wt(e){if(Ut(e)!==e)throw Error(ae(188))}function Ht(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ut(e)))throw Error(ae(188));return t!==e?null:e}for(var s=e,n=t;;){var r=s.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(n=r.return)){s=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===s)return Wt(r),e;if(a===n)return Wt(r),t;a=a.sibling}throw Error(ae(188))}if(s.return!==n.return)s=r,n=a;else{for(var i=!1,l=r.child;l;){if(l===s){i=!0,s=r,n=a;break}if(l===n){i=!0,n=r,s=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===s){i=!0,s=a,n=r;break}if(l===n){i=!0,n=a,s=r;break}l=l.sibling}if(!i)throw Error(ae(189))}}if(s.alternate!==n)throw Error(ae(190))}if(3!==s.tag)throw Error(ae(188));return s.stateNode.current===s?e:t}(e))?Qt(e):null}function Qt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Qt(e);if(null!==t)return t;e=e.sibling}return null}var Vt=re.unstable_scheduleCallback,Kt=re.unstable_cancelCallback,Gt=re.unstable_shouldYield,Jt=re.unstable_requestPaint,Yt=re.unstable_now,Xt=re.unstable_getCurrentPriorityLevel,Zt=re.unstable_ImmediatePriority,es=re.unstable_UserBlockingPriority,ts=re.unstable_NormalPriority,ss=re.unstable_LowPriority,ns=re.unstable_IdlePriority,rs=null,as=null;var is=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ls(e)/os|0)|0},ls=Math.log,os=Math.LN2;var cs=64,ds=4194304;function us(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function hs(e,t){var s=e.pendingLanes;if(0===s)return 0;var n=0,r=e.suspendedLanes,a=e.pingedLanes,i=268435455&s;if(0!==i){var l=i&~r;0!==l?n=us(l):0!==(a&=i)&&(n=us(a))}else 0!==(i=s&~r)?n=us(i):0!==a&&(n=us(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(a=t&-t)||16===r&&4194240&a))return t;if(4&n&&(n|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(s=31-is(t)),n|=e[s],t&=~r;return n}function xs(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ps(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ms(){var e=cs;return!(4194240&(cs<<=1))&&(cs=64),e}function gs(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function fs(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-is(t)]=s}function bs(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-is(s),r=1<<n;r&t|e[n]&t&&(e[n]|=t),s&=~r}}var vs=0;function ys(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var ws,js,Ns,ks,Fs,_s=!1,Es=[],Cs=null,Ss=null,As=null,Ts=new Map,Ds=new Map,Is=[],Ms="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ls(e,t){switch(e){case"focusin":case"focusout":Cs=null;break;case"dragenter":case"dragleave":Ss=null;break;case"mouseover":case"mouseout":As=null;break;case"pointerover":case"pointerout":Ts.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ds.delete(t.pointerId)}}function Rs(e,t,s,n,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=va(t))&&js(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Os(e){var t=ba(e.target);if(null!==t){var s=Ut(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=qt(s)))return e.blockedOn=t,void Fs(e.priority,function(){Ns(s)})}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ps(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Gs(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=va(s))&&js(t),e.blockedOn=s,!1;var n=new(s=e.nativeEvent).constructor(s.type,s);yt=n,s.target.dispatchEvent(n),yt=null,t.shift()}return!0}function $s(e,t,s){Ps(e)&&s.delete(t)}function Bs(){_s=!1,null!==Cs&&Ps(Cs)&&(Cs=null),null!==Ss&&Ps(Ss)&&(Ss=null),null!==As&&Ps(As)&&(As=null),Ts.forEach($s),Ds.forEach($s)}function zs(e,t){e.blockedOn===t&&(e.blockedOn=null,_s||(_s=!0,re.unstable_scheduleCallback(re.unstable_NormalPriority,Bs)))}function Us(e){function t(t){return zs(t,e)}if(0<Es.length){zs(Es[0],e);for(var s=1;s<Es.length;s++){var n=Es[s];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Cs&&zs(Cs,e),null!==Ss&&zs(Ss,e),null!==As&&zs(As,e),Ts.forEach(t),Ds.forEach(t),s=0;s<Is.length;s++)(n=Is[s]).blockedOn===e&&(n.blockedOn=null);for(;0<Is.length&&null===(s=Is[0]).blockedOn;)Os(s),null===s.blockedOn&&Is.shift()}var qs=ye.ReactCurrentBatchConfig,Ws=!0;function Hs(e,t,s,n){var r=vs,a=qs.transition;qs.transition=null;try{vs=1,Vs(e,t,s,n)}finally{vs=r,qs.transition=a}}function Qs(e,t,s,n){var r=vs,a=qs.transition;qs.transition=null;try{vs=4,Vs(e,t,s,n)}finally{vs=r,qs.transition=a}}function Vs(e,t,s,n){if(Ws){var r=Gs(e,t,s,n);if(null===r)Wr(e,t,n,Ks,s),Ls(e,n);else if(function(e,t,s,n,r){switch(t){case"focusin":return Cs=Rs(Cs,e,t,s,n,r),!0;case"dragenter":return Ss=Rs(Ss,e,t,s,n,r),!0;case"mouseover":return As=Rs(As,e,t,s,n,r),!0;case"pointerover":var a=r.pointerId;return Ts.set(a,Rs(Ts.get(a)||null,e,t,s,n,r)),!0;case"gotpointercapture":return a=r.pointerId,Ds.set(a,Rs(Ds.get(a)||null,e,t,s,n,r)),!0}return!1}(r,e,t,s,n))n.stopPropagation();else if(Ls(e,n),4&t&&-1<Ms.indexOf(e)){for(;null!==r;){var a=va(r);if(null!==a&&ws(a),null===(a=Gs(e,t,s,n))&&Wr(e,t,n,Ks,s),a===r)break;r=a}null!==r&&n.stopPropagation()}else Wr(e,t,n,null,s)}}var Ks=null;function Gs(e,t,s,n){if(Ks=null,null!==(e=ba(e=wt(n))))if(null===(t=Ut(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=qt(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ks=e,null}function Js(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xt()){case Zt:return 1;case es:return 4;case ts:case ss:return 16;case ns:return 536870912;default:return 16}default:return 16}}var Ys=null,Xs=null,Zs=null;function en(){if(Zs)return Zs;var e,t,s=Xs,n=s.length,r="value"in Ys?Ys.value:Ys.textContent,a=r.length;for(e=0;e<n&&s[e]===r[e];e++);var i=n-e;for(t=1;t<=i&&s[n-t]===r[a-t];t++);return Zs=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function sn(){return!0}function nn(){return!1}function rn(e){function t(t,s,n,r,a){for(var i in this._reactName=t,this._targetInst=n,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?sn:nn,this.isPropagationStopped=nn,this}return Oe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=sn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=sn)},persist:function(){},isPersistent:sn}),t}var an,ln,on,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=Oe({},cn,{view:0,detail:0}),hn=rn(un),xn=Oe({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(an=e.screenX-on.screenX,ln=e.screenY-on.screenY):ln=an=0,on=e),an)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),pn=rn(xn),mn=rn(Oe({},xn,{dataTransfer:0})),gn=rn(Oe({},un,{relatedTarget:0})),fn=rn(Oe({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=Oe({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=rn(bn),yn=rn(Oe({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Fn(){return kn}var _n=Oe({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=rn(_n),Cn=rn(Oe({},xn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Sn=rn(Oe({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fn})),An=rn(Oe({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=Oe({},xn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=rn(Tn),In=[9,13,27,32],Mn=de&&"CompositionEvent"in window,Ln=null;de&&"documentMode"in document&&(Ln=document.documentMode);var Rn=de&&"TextEvent"in window&&!Ln,On=de&&(!Mn||Ln&&8<Ln&&11>=Ln),Pn=String.fromCharCode(32),$n=!1;function Bn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Hn(e,t,s,n){_t(n),0<(t=Qr(t,"onChange")).length&&(s=new dn("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var Qn=null,Vn=null;function Kn(e){Pr(e,0)}function Gn(e){if(Ve(ya(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(de){var Xn;if(de){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"==typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Qn&&(Qn.detachEvent("onpropertychange",sr),Vn=Qn=null)}function sr(e){if("value"===e.propertyName&&Gn(Vn)){var t=[];Hn(t,Vn,e,wt(e)),Tt(Kn,t)}}function nr(e,t,s){"focusin"===e?(tr(),Vn=s,(Qn=t).attachEvent("onpropertychange",sr)):"focusout"===e&&tr()}function rr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn(Vn)}function ar(e,t){if("click"===e)return Gn(t)}function ir(e,t){if("input"===e||"change"===e)return Gn(t)}var lr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function or(e,t){if(lr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var r=s[n];if(!ue.call(t,r)||!lr(e[r],t[r]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var s,n=cr(e);for(e=0;n;){if(3===n.nodeType){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cr(n)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Ke();t instanceof e.HTMLIFrameElement;){try{var s="string"==typeof t.contentWindow.location.href}catch(n){s=!1}if(!s)break;t=Ke((e=t.contentWindow).document)}return t}function xr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&ur(s.ownerDocument.documentElement,s)){if(null!==n&&xr(s))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=s.textContent.length,a=Math.min(n.start,r);n=void 0===n.end?a:Math.min(n.end,r),!e.extend&&a>n&&(r=n,n=a,a=r),r=dr(s,a);var i=dr(s,n);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=de&&"documentMode"in document&&11>=document.documentMode,gr=null,fr=null,br=null,vr=!1;function yr(e,t,s){var n=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;vr||null==gr||gr!==Ke(n)||("selectionStart"in(n=gr)&&xr(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},br&&or(br,n)||(br=n,0<(n=Qr(fr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=gr)))}function wr(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var jr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Nr={},kr={};function Fr(e){if(Nr[e])return Nr[e];if(!jr[e])return e;var t,s=jr[e];for(t in s)if(s.hasOwnProperty(t)&&t in kr)return Nr[e]=s[t];return e}de&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);var _r=Fr("animationend"),Er=Fr("animationiteration"),Cr=Fr("animationstart"),Sr=Fr("transitionend"),Ar=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),oe(t,[e])}for(var Ir=0;Ir<Tr.length;Ir++){var Mr=Tr[Ir];Dr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Dr(_r,"onAnimationEnd"),Dr(Er,"onAnimationIteration"),Dr(Cr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Sr,"onTransitionEnd"),ce("onMouseEnter",["mouseout","mouseover"]),ce("onMouseLeave",["mouseout","mouseover"]),ce("onPointerEnter",["pointerout","pointerover"]),ce("onPointerLeave",["pointerout","pointerover"]),oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Or(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,n,r,a,i,l,o){if(zt.apply(this,arguments),Rt){if(!Rt)throw Error(ae(198));var c=Ot;Rt=!1,Ot=null,Pt||(Pt=!0,$t=c)}}(n,t,void 0,e),e.currentTarget=null}function Pr(e,t){t=!!(4&t);for(var s=0;s<e.length;s++){var n=e[s],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==a&&r.isPropagationStopped())break e;Or(r,l,c),a=o}else for(i=0;i<n.length;i++){if(o=(l=n[i]).instance,c=l.currentTarget,l=l.listener,o!==a&&r.isPropagationStopped())break e;Or(r,l,c),a=o}}}if(Pt)throw e=$t,Pt=!1,$t=null,e}function $r(e,t){var s=t[ma];void 0===s&&(s=t[ma]=new Set);var n=e+"__bubble";s.has(n)||(qr(t,e,2,!1),s.add(n))}function Br(e,t,s){var n=0;t&&(n|=4),qr(s,e,n,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[zr]){e[zr]=!0,ie.forEach(function(t){"selectionchange"!==t&&(Rr.has(t)||Br(t,!1,e),Br(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Br("selectionchange",!1,t))}}function qr(e,t,s,n){switch(Js(t)){case 1:var r=Hs;break;case 4:r=Qs;break;default:r=Vs}s=r.bind(null,t,s,e),r=void 0,!It||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):void 0!==r?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function Wr(e,t,s,n,r){var a=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var l=n.stateNode.containerInfo;if(l===r||8===l.nodeType&&l.parentNode===r)break;if(4===i)for(i=n.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===r||8===o.nodeType&&o.parentNode===r))return;i=i.return}for(;null!==l;){if(null===(i=ba(l)))return;if(5===(o=i.tag)||6===o){n=a=i;continue e}l=l.parentNode}}n=n.return}Tt(function(){var n=a,r=wt(s),i=[];e:{var l=Ar.get(e);if(void 0!==l){var o=dn,c=e;switch(e){case"keypress":if(0===tn(s))break e;case"keydown":case"keyup":o=En;break;case"focusin":c="focus",o=gn;break;case"focusout":c="blur",o=gn;break;case"beforeblur":case"afterblur":o=gn;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Sn;break;case _r:case Er:case Cr:o=fn;break;case Sr:o=An;break;case"scroll":o=hn;break;case"wheel":o=Dn;break;case"copy":case"cut":case"paste":o=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Cn}var d=!!(4&t),u=!d&&"scroll"===e,h=d?null!==l?l+"Capture":null:l;d=[];for(var x,p=n;null!==p;){var m=(x=p).stateNode;if(5===x.tag&&null!==m&&(x=m,null!==h&&(null!=(m=Dt(p,h))&&d.push(Hr(p,m,x)))),u)break;p=p.return}0<d.length&&(l=new o(l,c,null,s,r),i.push({event:l,listeners:d}))}}if(!(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||s===yt||!(c=s.relatedTarget||s.fromElement)||!ba(c)&&!c[pa])&&(o||l)&&(l=r.window===r?r:(l=r.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=n,null!==(c=(c=s.relatedTarget||s.toElement)?ba(c):null)&&(c!==(u=Ut(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=n),o!==c)){if(d=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=Cn,m="onPointerLeave",h="onPointerEnter",p="pointer"),u=null==o?l:ya(o),x=null==c?l:ya(c),(l=new d(m,p+"leave",o,s,r)).target=u,l.relatedTarget=x,m=null,ba(r)===n&&((d=new d(h,p+"enter",c,s,r)).target=x,d.relatedTarget=u,m=d),u=m,o&&c)e:{for(h=c,p=0,x=d=o;x;x=Vr(x))p++;for(x=0,m=h;m;m=Vr(m))x++;for(;0<p-x;)d=Vr(d),p--;for(;0<x-p;)h=Vr(h),x--;for(;p--;){if(d===h||null!==h&&d===h.alternate)break e;d=Vr(d),h=Vr(h)}d=null}else d=null;null!==o&&Kr(i,l,o,d,!1),null!==c&&null!==u&&Kr(i,u,c,d,!0)}if("select"===(o=(l=n?ya(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var g=Jn;else if(Wn(l))if(Yn)g=ir;else{g=rr;var f=nr}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=ar);switch(g&&(g=g(e,n))?Hn(i,g,s,r):(f&&f(e,l,n),"focusout"===e&&(f=l._wrapperState)&&f.controlled&&"number"===l.type&&et(l,"number",l.value)),f=n?ya(n):window,e){case"focusin":(Wn(f)||"true"===f.contentEditable)&&(gr=f,fr=n,br=null);break;case"focusout":br=fr=gr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,yr(i,s,r);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":yr(i,s,r)}var b;if(Mn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Un?Bn(e,s)&&(v="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(v="onCompositionStart");v&&(On&&"ko"!==s.locale&&(Un||"onCompositionStart"!==v?"onCompositionEnd"===v&&Un&&(b=en()):(Xs="value"in(Ys=r)?Ys.value:Ys.textContent,Un=!0)),0<(f=Qr(n,v)).length&&(v=new yn(v,e,null,s,r),i.push({event:v,listeners:f}),b?v.data=b:null!==(b=zn(s))&&(v.data=b))),(b=Rn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:($n=!0,Pn);case"textInput":return(e=t.data)===Pn&&$n?null:e;default:return null}}(e,s):function(e,t){if(Un)return"compositionend"===e||!Mn&&Bn(e,t)?(e=en(),Zs=Xs=Ys=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(n=Qr(n,"onBeforeInput")).length&&(r=new yn("onBeforeInput","beforeinput",null,s,r),i.push({event:r,listeners:n}),r.data=b))}Pr(i,t)})}function Hr(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Qr(e,t){for(var s=t+"Capture",n=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=Dt(e,s))&&n.unshift(Hr(e,a,r)),null!=(a=Dt(e,t))&&n.push(Hr(e,a,r))),e=e.return}return n}function Vr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,s,n,r){for(var a=t._reactName,i=[];null!==s&&s!==n;){var l=s,o=l.alternate,c=l.stateNode;if(null!==o&&o===n)break;5===l.tag&&null!==c&&(l=c,r?null!=(o=Dt(s,a))&&i.unshift(Hr(s,o,l)):r||null!=(o=Dt(s,a))&&i.push(Hr(s,o,l))),s=s.return}0!==i.length&&e.push({event:t,listeners:i})}var Gr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Yr(e){return("string"==typeof e?e:""+e).replace(Gr,"\n").replace(Jr,"")}function Xr(e,t,s){if(t=Yr(t),Yr(e)!==t&&s)throw Error(ae(425))}function Zr(){}var ea=null,ta=null;function sa(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"==typeof setTimeout?setTimeout:void 0,ra="function"==typeof clearTimeout?clearTimeout:void 0,aa="function"==typeof Promise?Promise:void 0,ia="function"==typeof queueMicrotask?queueMicrotask:void 0!==aa?function(e){return aa.resolve(null).then(e).catch(la)}:na;function la(e){setTimeout(function(){throw e})}function oa(e,t){var s=t,n=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&8===r.nodeType)if("/$"===(s=r.data)){if(0===n)return e.removeChild(r),void Us(t);n--}else"$"!==s&&"$?"!==s&&"$!"!==s||n++;s=r}while(s);Us(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,xa="__reactProps$"+ua,pa="__reactContainer$"+ua,ma="__reactEvents$"+ua,ga="__reactListeners$"+ua,fa="__reactHandles$"+ua;function ba(e){var t=e[ha];if(t)return t;for(var s=e.parentNode;s;){if(t=s[pa]||s[ha]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=da(e);null!==e;){if(s=e[ha])return s;e=da(e)}return t}s=(e=s).parentNode}return null}function va(e){return!(e=e[ha]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ya(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(ae(33))}function wa(e){return e[xa]||null}var ja=[],Na=-1;function ka(e){return{current:e}}function Fa(e){0>Na||(e.current=ja[Na],ja[Na]=null,Na--)}function _a(e,t){Na++,ja[Na]=e.current,e.current=t}var Ea={},Ca=ka(Ea),Sa=ka(!1),Aa=Ea;function Ta(e,t){var s=e.type.contextTypes;if(!s)return Ea;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in s)a[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Da(e){return null!=(e=e.childContextTypes)}function Ia(){Fa(Sa),Fa(Ca)}function Ma(e,t,s){if(Ca.current!==Ea)throw Error(ae(168));_a(Ca,t),_a(Sa,s)}function La(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return s;for(var r in n=n.getChildContext())if(!(r in t))throw Error(ae(108,qe(e)||"Unknown",r));return Oe({},s,n)}function Ra(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Aa=Ca.current,_a(Ca,e),_a(Sa,Sa.current),!0}function Oa(e,t,s){var n=e.stateNode;if(!n)throw Error(ae(169));s?(e=La(e,t,Aa),n.__reactInternalMemoizedMergedChildContext=e,Fa(Sa),Fa(Ca),_a(Ca,e)):Fa(Sa),_a(Sa,s)}var Pa=null,$a=!1,Ba=!1;function za(e){null===Pa?Pa=[e]:Pa.push(e)}function Ua(){if(!Ba&&null!==Pa){Ba=!0;var e=0,t=vs;try{var s=Pa;for(vs=1;e<s.length;e++){var n=s[e];do{n=n(!0)}while(null!==n)}Pa=null,$a=!1}catch(r){throw null!==Pa&&(Pa=Pa.slice(e+1)),Vt(Zt,Ua),r}finally{vs=t,Ba=!1}}return null}var qa=[],Wa=0,Ha=null,Qa=0,Va=[],Ka=0,Ga=null,Ja=1,Ya="";function Xa(e,t){qa[Wa++]=Qa,qa[Wa++]=Ha,Ha=e,Qa=t}function Za(e,t,s){Va[Ka++]=Ja,Va[Ka++]=Ya,Va[Ka++]=Ga,Ga=e;var n=Ja;e=Ya;var r=32-is(n)-1;n&=~(1<<r),s+=1;var a=32-is(t)+r;if(30<a){var i=r-r%5;a=(n&(1<<i)-1).toString(32),n>>=i,r-=i,Ja=1<<32-is(t)+r|s<<r|n,Ya=a+e}else Ja=1<<a|s<<r|n,Ya=e}function ei(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function ti(e){for(;e===Ha;)Ha=qa[--Wa],qa[Wa]=null,Qa=qa[--Wa],qa[Wa]=null;for(;e===Ga;)Ga=Va[--Ka],Va[Ka]=null,Ya=Va[--Ka],Va[Ka]=null,Ja=Va[--Ka],Va[Ka]=null}var si=null,ni=null,ri=!1,ai=null;function ii(e,t){var s=Td(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function li(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,si=e,ni=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,si=e,ni=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Ga?{id:Ja,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Td(18,null,null,0)).stateNode=t,s.return=e,e.child=s,si=e,ni=null,!0);default:return!1}}function oi(e){return!(!(1&e.mode)||128&e.flags)}function ci(e){if(ri){var t=ni;if(t){var s=t;if(!li(e,t)){if(oi(e))throw Error(ae(418));t=ca(s.nextSibling);var n=si;t&&li(e,t)?ii(n,s):(e.flags=-4097&e.flags|2,ri=!1,si=e)}}else{if(oi(e))throw Error(ae(418));e.flags=-4097&e.flags|2,ri=!1,si=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;si=e}function ui(e){if(e!==si)return!1;if(!ri)return di(e),ri=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!sa(e.type,e.memoizedProps)),t&&(t=ni)){if(oi(e))throw hi(),Error(ae(418));for(;t;)ii(e,t),t=ca(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){ni=ca(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}ni=null}}else ni=si?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ni;e;)e=ca(e.nextSibling)}function xi(){ni=si=null,ri=!1}function pi(e){null===ai?ai=[e]:ai.push(e)}var mi=ye.ReactCurrentBatchConfig;function gi(e,t,s){if(null!==(e=s.ref)&&"function"!=typeof e&&"object"!=typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(ae(309));var n=s.stateNode}if(!n)throw Error(ae(147,e));var r=n,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!=typeof e)throw Error(ae(284));if(!s._owner)throw Error(ae(290,e))}return e}function fi(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function vi(e){function t(t,s){if(e){var n=t.deletions;null===n?(t.deletions=[s],t.flags|=16):n.push(s)}}function s(s,n){if(!e)return null;for(;null!==n;)t(s,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Id(e,t)).index=0,e.sibling=null,e}function a(t,s,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<s?(t.flags|=2,s):n:(t.flags|=2,s):(t.flags|=1048576,s)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,s,n){return null===t||6!==t.tag?((t=Od(s,e.mode,n)).return=e,t):((t=r(t,s)).return=e,t)}function o(e,t,s,n){var a=s.type;return a===Ne?d(e,t,s.props.children,n,s.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===De&&bi(a)===t.type)?((n=r(t,s.props)).ref=gi(e,t,s),n.return=e,n):((n=Md(s.type,s.key,s.props,null,e.mode,n)).ref=gi(e,t,s),n.return=e,n)}function c(e,t,s,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Pd(s,e.mode,n)).return=e,t):((t=r(t,s.children||[])).return=e,t)}function d(e,t,s,n,a){return null===t||7!==t.tag?((t=Ld(s,e.mode,n,a)).return=e,t):((t=r(t,s)).return=e,t)}function u(e,t,s){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Od(""+t,e.mode,s)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case we:return(s=Md(t.type,t.key,t.props,null,e.mode,s)).ref=gi(e,null,t),s.return=e,s;case je:return(t=Pd(t,e.mode,s)).return=e,t;case De:return u(e,(0,t._init)(t._payload),s)}if(tt(t)||Le(t))return(t=Ld(t,e.mode,s,null)).return=e,t;fi(e,t)}return null}function h(e,t,s,n){var r=null!==t?t.key:null;if("string"==typeof s&&""!==s||"number"==typeof s)return null!==r?null:l(e,t,""+s,n);if("object"==typeof s&&null!==s){switch(s.$$typeof){case we:return s.key===r?o(e,t,s,n):null;case je:return s.key===r?c(e,t,s,n):null;case De:return h(e,t,(r=s._init)(s._payload),n)}if(tt(s)||Le(s))return null!==r?null:d(e,t,s,n,null);fi(e,s)}return null}function x(e,t,s,n,r){if("string"==typeof n&&""!==n||"number"==typeof n)return l(t,e=e.get(s)||null,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case we:return o(t,e=e.get(null===n.key?s:n.key)||null,n,r);case je:return c(t,e=e.get(null===n.key?s:n.key)||null,n,r);case De:return x(e,t,s,(0,n._init)(n._payload),r)}if(tt(n)||Le(n))return d(t,e=e.get(s)||null,n,r,null);fi(t,n)}return null}return function l(o,c,d,p){if("object"==typeof d&&null!==d&&d.type===Ne&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case we:e:{for(var m=d.key,g=c;null!==g;){if(g.key===m){if((m=d.type)===Ne){if(7===g.tag){s(o,g.sibling),(c=r(g,d.props.children)).return=o,o=c;break e}}else if(g.elementType===m||"object"==typeof m&&null!==m&&m.$$typeof===De&&bi(m)===g.type){s(o,g.sibling),(c=r(g,d.props)).ref=gi(o,g,d),c.return=o,o=c;break e}s(o,g);break}t(o,g),g=g.sibling}d.type===Ne?((c=Ld(d.props.children,o.mode,p,d.key)).return=o,o=c):((p=Md(d.type,d.key,d.props,null,o.mode,p)).ref=gi(o,c,d),p.return=o,o=p)}return i(o);case je:e:{for(g=d.key;null!==c;){if(c.key===g){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){s(o,c.sibling),(c=r(c,d.children||[])).return=o,o=c;break e}s(o,c);break}t(o,c),c=c.sibling}(c=Pd(d,o.mode,p)).return=o,o=c}return i(o);case De:return l(o,c,(g=d._init)(d._payload),p)}if(tt(d))return function(r,i,l,o){for(var c=null,d=null,p=i,m=i=0,g=null;null!==p&&m<l.length;m++){p.index>m?(g=p,p=null):g=p.sibling;var f=h(r,p,l[m],o);if(null===f){null===p&&(p=g);break}e&&p&&null===f.alternate&&t(r,p),i=a(f,i,m),null===d?c=f:d.sibling=f,d=f,p=g}if(m===l.length)return s(r,p),ri&&Xa(r,m),c;if(null===p){for(;m<l.length;m++)null!==(p=u(r,l[m],o))&&(i=a(p,i,m),null===d?c=p:d.sibling=p,d=p);return ri&&Xa(r,m),c}for(p=n(r,p);m<l.length;m++)null!==(g=x(p,r,m,l[m],o))&&(e&&null!==g.alternate&&p.delete(null===g.key?m:g.key),i=a(g,i,m),null===d?c=g:d.sibling=g,d=g);return e&&p.forEach(function(e){return t(r,e)}),ri&&Xa(r,m),c}(o,c,d,p);if(Le(d))return function(r,i,l,o){var c=Le(l);if("function"!=typeof c)throw Error(ae(150));if(null==(l=c.call(l)))throw Error(ae(151));for(var d=c=null,p=i,m=i=0,g=null,f=l.next();null!==p&&!f.done;m++,f=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=h(r,p,f.value,o);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(r,p),i=a(b,i,m),null===d?c=b:d.sibling=b,d=b,p=g}if(f.done)return s(r,p),ri&&Xa(r,m),c;if(null===p){for(;!f.done;m++,f=l.next())null!==(f=u(r,f.value,o))&&(i=a(f,i,m),null===d?c=f:d.sibling=f,d=f);return ri&&Xa(r,m),c}for(p=n(r,p);!f.done;m++,f=l.next())null!==(f=x(p,r,m,f.value,o))&&(e&&null!==f.alternate&&p.delete(null===f.key?m:f.key),i=a(f,i,m),null===d?c=f:d.sibling=f,d=f);return e&&p.forEach(function(e){return t(r,e)}),ri&&Xa(r,m),c}(o,c,d,p);fi(o,d)}return"string"==typeof d&&""!==d||"number"==typeof d?(d=""+d,null!==c&&6===c.tag?(s(o,c.sibling),(c=r(c,d)).return=o,o=c):(s(o,c),(c=Od(d,o.mode,p)).return=o,o=c),i(o)):s(o,c)}}var yi=vi(!0),wi=vi(!1),ji=ka(null),Ni=null,ki=null,Fi=null;function _i(){Fi=ki=Ni=null}function Ei(e){var t=ji.current;Fa(ji),e._currentValue=t}function Ci(e,t,s){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function Si(e,t){Ni=e,Fi=ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vo=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(Fi!==e)if(e={context:e,memoizedValue:t,next:null},null===ki){if(null===Ni)throw Error(ae(308));ki=e,Ni.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var Ti=null;function Di(e){null===Ti?Ti=[e]:Ti.push(e)}function Ii(e,t,s,n){var r=t.interleaved;return null===r?(s.next=s,Di(t)):(s.next=r.next,r.next=s),t.interleaved=s,Mi(e,n)}function Mi(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Li=!1;function Ri(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $i(e,t,s){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&Cc){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Mi(e,s)}return null===(r=n.interleaved)?(t.next=t,Di(n)):(t.next=r.next,r.next=t),n.interleaved=t,Mi(e,s)}function Bi(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&s)){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,bs(e,s)}}function zi(e,t){var s=e.updateQueue,n=e.alternate;if(null!==n&&s===(n=n.updateQueue)){var r=null,a=null;if(null!==(s=s.firstBaseUpdate)){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===a?r=a=i:a=a.next=i,s=s.next}while(null!==s);null===a?r=a=t:a=a.next=t}else r=a=t;return s={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Ui(e,t,s,n){var r=e.updateQueue;Li=!1;var a=r.firstBaseUpdate,i=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?a=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==a){var u=r.baseState;for(i=0,d=c=o=null,l=a;;){var h=l.lane,x=l.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=e,m=l;switch(h=t,x=s,m.tag){case 1:if("function"==typeof(p=m.payload)){u=p.call(x,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=m.payload)?p.call(x,u,h):p))break e;u=Oe({},u,h);break e;case 2:Li=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[l]:h.push(l))}else x={eventTime:x,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=x,o=u):d=d.next=x,i|=h;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(h=l).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(o=u),r.baseState=o,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Rc|=i,e.lanes=i,e.memoizedState=u}}function qi(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=s,"function"!=typeof r)throw Error(ae(191,r));r.call(n)}}}var Wi={},Hi=ka(Wi),Qi=ka(Wi),Vi=ka(Wi);function Ki(e){if(e===Wi)throw Error(ae(174));return e}function Gi(e,t){switch(_a(Vi,t),_a(Qi,e),_a(Hi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ot(null,"");break;default:t=ot(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Fa(Hi),_a(Hi,t)}function Ji(){Fa(Hi),Fa(Qi),Fa(Vi)}function Yi(e){Ki(Vi.current);var t=Ki(Hi.current),s=ot(t,e.type);t!==s&&(_a(Qi,e),_a(Hi,s))}function Xi(e){Qi.current===e&&(Fa(Hi),Fa(Qi))}var Zi=ka(0);function el(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tl=[];function sl(){for(var e=0;e<tl.length;e++)tl[e]._workInProgressVersionPrimary=null;tl.length=0}var nl=ye.ReactCurrentDispatcher,rl=ye.ReactCurrentBatchConfig,al=0,il=null,ll=null,ol=null,cl=!1,dl=!1,ul=0,hl=0;function xl(){throw Error(ae(321))}function pl(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!lr(e[s],t[s]))return!1;return!0}function ml(e,t,s,n,r,a){if(al=a,il=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nl.current=null===e||null===e.memoizedState?Xl:Zl,e=s(n,r),dl){a=0;do{if(dl=!1,ul=0,25<=a)throw Error(ae(301));a+=1,ol=ll=null,t.updateQueue=null,nl.current=eo,e=s(n,r)}while(dl)}if(nl.current=Yl,t=null!==ll&&null!==ll.next,al=0,ol=ll=il=null,cl=!1,t)throw Error(ae(300));return e}function gl(){var e=0!==ul;return ul=0,e}function fl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ol?il.memoizedState=ol=e:ol=ol.next=e,ol}function bl(){if(null===ll){var e=il.alternate;e=null!==e?e.memoizedState:null}else e=ll.next;var t=null===ol?il.memoizedState:ol.next;if(null!==t)ol=t,ll=e;else{if(null===e)throw Error(ae(310));e={memoizedState:(ll=e).memoizedState,baseState:ll.baseState,baseQueue:ll.baseQueue,queue:ll.queue,next:null},null===ol?il.memoizedState=ol=e:ol=ol.next=e}return ol}function vl(e,t){return"function"==typeof t?t(e):t}function yl(e){var t=bl(),s=t.queue;if(null===s)throw Error(ae(311));s.lastRenderedReducer=e;var n=ll,r=n.baseQueue,a=s.pending;if(null!==a){if(null!==r){var i=r.next;r.next=a.next,a.next=i}n.baseQueue=r=a,s.pending=null}if(null!==r){a=r.next,n=n.baseState;var l=i=null,o=null,c=a;do{var d=c.lane;if((al&d)===d)null!==o&&(o=o.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===o?(l=o=u,i=n):o=o.next=u,il.lanes|=d,Rc|=d}c=c.next}while(null!==c&&c!==a);null===o?i=n:o.next=l,lr(n,t.memoizedState)||(vo=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=o,s.lastRenderedState=n}if(null!==(e=s.interleaved)){r=e;do{a=r.lane,il.lanes|=a,Rc|=a,r=r.next}while(r!==e)}else null===r&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function wl(e){var t=bl(),s=t.queue;if(null===s)throw Error(ae(311));s.lastRenderedReducer=e;var n=s.dispatch,r=s.pending,a=t.memoizedState;if(null!==r){s.pending=null;var i=r=r.next;do{a=e(a,i.action),i=i.next}while(i!==r);lr(a,t.memoizedState)||(vo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),s.lastRenderedState=a}return[a,n]}function jl(){}function Nl(e,t){var s=il,n=bl(),r=t(),a=!lr(n.memoizedState,r);if(a&&(n.memoizedState=r,vo=!0),n=n.queue,Ll(_l.bind(null,s,n,e),[e]),n.getSnapshot!==t||a||null!==ol&&1&ol.memoizedState.tag){if(s.flags|=2048,Al(9,Fl.bind(null,s,n,r,t),void 0,null),null===Sc)throw Error(ae(349));30&al||kl(s,t,r)}return r}function kl(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=il.updateQueue)?(t={lastEffect:null,stores:null},il.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function Fl(e,t,s,n){t.value=s,t.getSnapshot=n,El(t)&&Cl(e)}function _l(e,t,s){return s(function(){El(t)&&Cl(e)})}function El(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!lr(e,s)}catch(n){return!0}}function Cl(e){var t=Mi(e,1);null!==t&&sd(t,e,1,-1)}function Sl(e){var t=fl();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:e},t.queue=e,e=e.dispatch=Vl.bind(null,il,e),[t.memoizedState,e]}function Al(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},null===(t=il.updateQueue)?(t={lastEffect:null,stores:null},il.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e),e}function Tl(){return bl().memoizedState}function Dl(e,t,s,n){var r=fl();il.flags|=e,r.memoizedState=Al(1|t,s,void 0,void 0===n?null:n)}function Il(e,t,s,n){var r=bl();n=void 0===n?null:n;var a=void 0;if(null!==ll){var i=ll.memoizedState;if(a=i.destroy,null!==n&&pl(n,i.deps))return void(r.memoizedState=Al(t,s,a,n))}il.flags|=e,r.memoizedState=Al(1|t,s,a,n)}function Ml(e,t){return Dl(8390656,8,e,t)}function Ll(e,t){return Il(2048,8,e,t)}function Rl(e,t){return Il(4,2,e,t)}function Ol(e,t){return Il(4,4,e,t)}function Pl(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function $l(e,t,s){return s=null!=s?s.concat([e]):null,Il(4,4,Pl.bind(null,t,e),s)}function Bl(){}function zl(e,t){var s=bl();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&pl(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function Ul(e,t){var s=bl();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&pl(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function ql(e,t,s){return 21&al?(lr(s,t)||(s=ms(),il.lanes|=s,Rc|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,vo=!0),e.memoizedState=s)}function Wl(e,t){var s=vs;vs=0!==s&&4>s?s:4,e(!0);var n=rl.transition;rl.transition={};try{e(!1),t()}finally{vs=s,rl.transition=n}}function Hl(){return bl().memoizedState}function Ql(e,t,s){var n=td(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},Kl(e))Gl(t,s);else if(null!==(s=Ii(e,t,s,n))){sd(s,e,n,ed()),Jl(s,t,n)}}function Vl(e,t,s){var n=td(e),r={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(Kl(e))Gl(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=a(i,s);if(r.hasEagerState=!0,r.eagerState=l,lr(l,i)){var o=t.interleaved;return null===o?(r.next=r,Di(t)):(r.next=o.next,o.next=r),void(t.interleaved=r)}}catch(c){}null!==(s=Ii(e,t,r,n))&&(sd(s,e,n,r=ed()),Jl(s,t,n))}}function Kl(e){var t=e.alternate;return e===il||null!==t&&t===il}function Gl(e,t){dl=cl=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Jl(e,t,s){if(4194240&s){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,bs(e,s)}}var Yl={readContext:Ai,useCallback:xl,useContext:xl,useEffect:xl,useImperativeHandle:xl,useInsertionEffect:xl,useLayoutEffect:xl,useMemo:xl,useReducer:xl,useRef:xl,useState:xl,useDebugValue:xl,useDeferredValue:xl,useTransition:xl,useMutableSource:xl,useSyncExternalStore:xl,useId:xl,unstable_isNewReconciler:!1},Xl={readContext:Ai,useCallback:function(e,t){return fl().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:Ml,useImperativeHandle:function(e,t,s){return s=null!=s?s.concat([e]):null,Dl(4194308,4,Pl.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Dl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dl(4,2,e,t)},useMemo:function(e,t){var s=fl();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=fl();return t=void 0!==s?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ql.bind(null,il,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},fl().memoizedState=e},useState:Sl,useDebugValue:Bl,useDeferredValue:function(e){return fl().memoizedState=e},useTransition:function(){var e=Sl(!1),t=e[0];return e=Wl.bind(null,e[1]),fl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=il,r=fl();if(ri){if(void 0===s)throw Error(ae(407));s=s()}else{if(s=t(),null===Sc)throw Error(ae(349));30&al||kl(n,t,s)}r.memoizedState=s;var a={value:s,getSnapshot:t};return r.queue=a,Ml(_l.bind(null,n,a,e),[e]),n.flags|=2048,Al(9,Fl.bind(null,n,a,s,t),void 0,null),s},useId:function(){var e=fl(),t=Sc.identifierPrefix;if(ri){var s=Ya;t=":"+t+"R"+(s=(Ja&~(1<<32-is(Ja)-1)).toString(32)+s),0<(s=ul++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=hl++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zl={readContext:Ai,useCallback:zl,useContext:Ai,useEffect:Ll,useImperativeHandle:$l,useInsertionEffect:Rl,useLayoutEffect:Ol,useMemo:Ul,useReducer:yl,useRef:Tl,useState:function(){return yl(vl)},useDebugValue:Bl,useDeferredValue:function(e){return ql(bl(),ll.memoizedState,e)},useTransition:function(){return[yl(vl)[0],bl().memoizedState]},useMutableSource:jl,useSyncExternalStore:Nl,useId:Hl,unstable_isNewReconciler:!1},eo={readContext:Ai,useCallback:zl,useContext:Ai,useEffect:Ll,useImperativeHandle:$l,useInsertionEffect:Rl,useLayoutEffect:Ol,useMemo:Ul,useReducer:wl,useRef:Tl,useState:function(){return wl(vl)},useDebugValue:Bl,useDeferredValue:function(e){var t=bl();return null===ll?t.memoizedState=e:ql(t,ll.memoizedState,e)},useTransition:function(){return[wl(vl)[0],bl().memoizedState]},useMutableSource:jl,useSyncExternalStore:Nl,useId:Hl,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var s in t=Oe({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function so(e,t,s,n){s=null==(s=s(n,t=e.memoizedState))?t:Oe({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&Ut(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=ed(),r=td(e),a=Pi(n,r);a.payload=t,null!=s&&(a.callback=s),null!==(t=$i(e,a,r))&&(sd(t,e,r,n),Bi(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=ed(),r=td(e),a=Pi(n,r);a.tag=1,a.payload=t,null!=s&&(a.callback=s),null!==(t=$i(e,a,r))&&(sd(t,e,r,n),Bi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ed(),n=td(e),r=Pi(s,n);r.tag=2,null!=t&&(r.callback=t),null!==(t=$i(e,r,n))&&(sd(t,e,n,s),Bi(t,e,n))}};function ro(e,t,s,n,r,a,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!or(s,n)||!or(r,a))}function ao(e,t,s){var n=!1,r=Ea,a=t.contextType;return"object"==typeof a&&null!==a?a=Ai(a):(r=Da(t)?Aa:Ca.current,a=(n=null!=(n=t.contextTypes))?Ta(e,r):Ea),t=new t(s,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,s,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function lo(e,t,s,n){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Ri(e);var a=t.contextType;"object"==typeof a&&null!==a?r.context=Ai(a):(a=Da(t)?Aa:Ca.current,r.context=Ta(e,a)),r.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(so(e,t,a,s),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&no.enqueueReplaceState(r,r.state,null),Ui(e,s,r,n),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function oo(e,t){try{var s="",n=t;do{s+=ze(n),n=n.return}while(n);var r=s}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var ho="function"==typeof WeakMap?WeakMap:Map;function xo(e,t,s){(s=Pi(-1,s)).tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Wc||(Wc=!0,Hc=n),uo(0,t)},s}function po(e,t,s){(s=Pi(-1,s)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var r=t.value;s.payload=function(){return n(r)},s.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(s.callback=function(){uo(0,t),"function"!=typeof n&&(null===Qc?Qc=new Set([this]):Qc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function mo(e,t,s){var n=e.pingCache;if(null===n){n=e.pingCache=new ho;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(s)||(r.add(s),e=Fd.bind(null,e,t,s),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function fo(e,t,s,n,r){return 1&e.mode?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Pi(-1,1)).tag=2,$i(s,t,1))),s.lanes|=1),e)}var bo=ye.ReactCurrentOwner,vo=!1;function yo(e,t,s,n){t.child=null===e?wi(t,null,s,n):yi(t,e.child,s,n)}function wo(e,t,s,n,r){s=s.render;var a=t.ref;return Si(t,r),n=ml(e,t,s,n,a,r),s=gl(),null===e||vo?(ri&&s&&ei(t),t.flags|=1,yo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function jo(e,t,s,n,r){if(null===e){var a=s.type;return"function"!=typeof a||Dd(a)||void 0!==a.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Md(s.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,No(e,t,a,n,r))}if(a=e.child,0===(e.lanes&r)){var i=a.memoizedProps;if((s=null!==(s=s.compare)?s:or)(i,n)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=Id(a,n)).ref=t.ref,e.return=t,t.child=e}function No(e,t,s,n,r){if(null!==e){var a=e.memoizedProps;if(or(a,n)&&e.ref===t.ref){if(vo=!1,t.pendingProps=n=a,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);131072&e.flags&&(vo=!0)}}return _o(e,t,s,n,r)}function ko(e,t,s){var n=t.pendingProps,r=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(1&t.mode){if(!(1073741824&s))return e=null!==a?a.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_a(Ic,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:s,_a(Ic,Dc),Dc|=n}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_a(Ic,Dc),Dc|=s;else null!==a?(n=a.baseLanes|s,t.memoizedState=null):n=s,_a(Ic,Dc),Dc|=n;return yo(e,t,r,s),t.child}function Fo(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function _o(e,t,s,n,r){var a=Da(s)?Aa:Ca.current;return a=Ta(t,a),Si(t,r),s=ml(e,t,s,n,a,r),n=gl(),null===e||vo?(ri&&n&&ei(t),t.flags|=1,yo(e,t,s,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Eo(e,t,s,n,r){if(Da(s)){var a=!0;Ra(t)}else a=!1;if(Si(t,r),null===t.stateNode)qo(e,t),ao(t,s,n),lo(t,s,n,r),n=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=s.contextType;"object"==typeof c&&null!==c?c=Ai(c):c=Ta(t,c=Da(s)?Aa:Ca.current);var d=s.getDerivedStateFromProps,u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate;u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==n||o!==c)&&io(t,i,n,c),Li=!1;var h=t.memoizedState;i.state=h,Ui(t,n,i,r),o=t.memoizedState,l!==n||h!==o||Sa.current||Li?("function"==typeof d&&(so(t,s,d,n),o=t.memoizedState),(l=Li||ro(t,s,l,n,h,o,c))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),i.props=n,i.state=o,i.context=c,n=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Oi(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:to(t.type,l),i.props=c,u=t.pendingProps,h=i.context,"object"==typeof(o=s.contextType)&&null!==o?o=Ai(o):o=Ta(t,o=Da(s)?Aa:Ca.current);var x=s.getDerivedStateFromProps;(d="function"==typeof x||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==u||h!==o)&&io(t,i,n,o),Li=!1,h=t.memoizedState,i.state=h,Ui(t,n,i,r);var p=t.memoizedState;l!==u||h!==p||Sa.current||Li?("function"==typeof x&&(so(t,s,x,n),p=t.memoizedState),(c=Li||ro(t,s,c,n,h,p,o)||!1)?(d||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(n,p,o),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,p,o)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),i.props=n,i.state=p,i.context=o,n=c):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,s,n,a,r)}function Co(e,t,s,n,r,a){Fo(e,t);var i=!!(128&t.flags);if(!n&&!i)return r&&Oa(t,s,!1),Wo(e,t,a);n=t.stateNode,bo.current=t;var l=i&&"function"!=typeof s.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=yi(t,e.child,null,a),t.child=yi(t,null,l,a)):yo(e,t,l,a),t.memoizedState=n.state,r&&Oa(t,s,!0),t.child}function So(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Gi(e,t.containerInfo)}function Ao(e,t,s,n,r){return xi(),pi(r),t.flags|=256,yo(e,t,s,n),t.child}var To,Do,Io,Mo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Ro(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,s){var n,r=t.pendingProps,a=Zi.current,i=!1,l=!!(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&!!(2&a)),n?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),_a(Zi,1&a),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},1&r||null===i?i=Rd(l,r,0,null):(i.childLanes=0,i.pendingProps=l),e=Ld(e,r,s,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Ro(s),t.memoizedState=Lo,e):Po(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,s,n,r,a,i){if(s)return 256&t.flags?(t.flags&=-257,$o(e,t,i,n=co(Error(ae(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,r=t.mode,n=Rd({mode:"visible",children:n.children},r,0,null),(a=Ld(a,r,i,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,1&t.mode&&yi(t,e.child,null,i),t.child.memoizedState=Ro(i),t.memoizedState=Lo,a);if(!(1&t.mode))return $o(e,t,i,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,$o(e,t,i,n=co(a=Error(ae(419)),n,void 0))}if(l=0!==(i&e.childLanes),vo||l){if(null!==(n=Sc)){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|i))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Mi(e,r),sd(n,e,r,-1))}return md(),$o(e,t,i,n=co(Error(ae(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ed.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,ni=ca(r.nextSibling),si=t,ri=!0,ai=null,null!==e&&(Va[Ka++]=Ja,Va[Ka++]=Ya,Va[Ka++]=Ga,Ja=e.id,Ya=e.overflow,Ga=t),t=Po(t,n.children),t.flags|=4096,t)}(e,t,l,r,n,a,s);if(i){i=r.fallback,l=t.mode,n=(a=e.child).sibling;var o={mode:"hidden",children:r.children};return 1&l||t.child===a?(r=Id(a,o)).subtreeFlags=14680064&a.subtreeFlags:((r=t.child).childLanes=0,r.pendingProps=o,t.deletions=null),null!==n?i=Id(n,i):(i=Ld(i,l,s,null)).flags|=2,i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=null===(l=e.child.memoizedState)?Ro(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~s,t.memoizedState=Lo,r}return e=(i=e.child).sibling,r=Id(i,{mode:"visible",children:r.children}),!(1&t.mode)&&(r.lanes=s),r.return=t,r.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r}function Po(e,t){return(t=Rd({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function $o(e,t,s,n){return null!==n&&pi(n),yi(t,e.child,null,s),(e=Po(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,s){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ci(e.return,t,s)}function zo(e,t,s,n,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=s,a.tailMode=r)}function Uo(e,t,s){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(yo(e,t,n.children,s),2&(n=Zi.current))n=1&n|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,s,t);else if(19===e.tag)Bo(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(_a(Zi,n),1&t.mode)switch(r){case"forwards":for(s=t.child,r=null;null!==s;)null!==(e=s.alternate)&&null===el(e)&&(r=s),s=s.sibling;null===(s=r)?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),zo(t,!1,r,s,a);break;case"backwards":for(s=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===el(e)){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}zo(t,!0,s,null,a);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function qo(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Rc|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(ae(153));if(null!==t.child){for(s=Id(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=Id(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Ho(e,t){if(!ri)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;null!==s;)null!==s.alternate&&(n=s),s=s.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,n=0;if(t)for(var r=e.child;null!==r;)s|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)s|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function Vo(e,t,s){var n=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qo(t),null;case 1:case 17:return Da(t.type)&&Ia(),Qo(t),null;case 3:return n=t.stateNode,Ji(),Fa(Sa),Fa(Ca),sl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ui(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ai&&(id(ai),ai=null))),Do(e,t),Qo(t),null;case 5:Xi(t);var r=Ki(Vi.current);if(s=t.type,null!==e&&null!=t.stateNode)Io(e,t,s,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(ae(166));return Qo(t),null}if(e=Ki(Hi.current),ui(t)){n=t.stateNode,s=t.type;var a=t.memoizedProps;switch(n[ha]=t,n[xa]=a,e=!!(1&t.mode),s){case"dialog":$r("cancel",n),$r("close",n);break;case"iframe":case"object":case"embed":$r("load",n);break;case"video":case"audio":for(r=0;r<Lr.length;r++)$r(Lr[r],n);break;case"source":$r("error",n);break;case"img":case"image":case"link":$r("error",n),$r("load",n);break;case"details":$r("toggle",n);break;case"input":Je(n,a),$r("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},$r("invalid",n);break;case"textarea":rt(n,a),$r("invalid",n)}for(var i in bt(s,a),r=null,a)if(a.hasOwnProperty(i)){var l=a[i];"children"===i?"string"==typeof l?n.textContent!==l&&(!0!==a.suppressHydrationWarning&&Xr(n.textContent,l,e),r=["children",l]):"number"==typeof l&&n.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Xr(n.textContent,l,e),r=["children",""+l]):le.hasOwnProperty(i)&&null!=l&&"onScroll"===i&&$r("scroll",n)}switch(s){case"input":Qe(n),Ze(n,a,!0);break;case"textarea":Qe(n),it(n);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(n.onclick=Zr)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{i=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=lt(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=i.createElement(s,{is:n.is}):(e=i.createElement(s),"select"===s&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,s),e[ha]=t,e[xa]=n,To(e,t,!1,!1),t.stateNode=e;e:{switch(i=vt(s,n),s){case"dialog":$r("cancel",e),$r("close",e),r=n;break;case"iframe":case"object":case"embed":$r("load",e),r=n;break;case"video":case"audio":for(r=0;r<Lr.length;r++)$r(Lr[r],e);r=n;break;case"source":$r("error",e),r=n;break;case"img":case"image":case"link":$r("error",e),$r("load",e),r=n;break;case"details":$r("toggle",e),r=n;break;case"input":Je(e,n),r=Ge(e,n),$r("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=Oe({},n,{value:void 0}),$r("invalid",e);break;case"textarea":rt(e,n),r=nt(e,n),$r("invalid",e)}for(a in bt(s,r),l=r)if(l.hasOwnProperty(a)){var o=l[a];"style"===a?gt(e,o):"dangerouslySetInnerHTML"===a?null!=(o=o?o.__html:void 0)&&ut(e,o):"children"===a?"string"==typeof o?("textarea"!==s||""!==o)&&ht(e,o):"number"==typeof o&&ht(e,""+o):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(le.hasOwnProperty(a)?null!=o&&"onScroll"===a&&$r("scroll",e):null!=o&&ve(e,a,o,i))}switch(s){case"input":Qe(e),Ze(e,n,!1);break;case"textarea":Qe(e),it(e);break;case"option":null!=n.value&&e.setAttribute("value",""+We(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?st(e,!!n.multiple,a,!1):null!=n.defaultValue&&st(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=Zr)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Qo(t),null;case 6:if(e&&null!=t.stateNode)Mo(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(ae(166));if(s=Ki(Vi.current),Ki(Hi.current),ui(t)){if(n=t.stateNode,s=t.memoizedProps,n[ha]=t,(a=n.nodeValue!==s)&&null!==(e=si))switch(e.tag){case 3:Xr(n.nodeValue,s,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(n.nodeValue,s,!!(1&e.mode))}a&&(t.flags|=4)}else(n=(9===s.nodeType?s:s.ownerDocument).createTextNode(n))[ha]=t,t.stateNode=n}return Qo(t),null;case 13:if(Fa(Zi),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ri&&null!==ni&&1&t.mode&&!(128&t.flags))hi(),xi(),t.flags|=98560,a=!1;else if(a=ui(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(ae(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(ae(317));a[ha]=t}else xi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Qo(t),a=!1}else null!==ai&&(id(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=s,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,1&t.mode&&(null===e||1&Zi.current?0===Mc&&(Mc=3):md())),null!==t.updateQueue&&(t.flags|=4),Qo(t),null);case 4:return Ji(),Do(e,t),null===e&&Ur(t.stateNode.containerInfo),Qo(t),null;case 10:return Ei(t.type._context),Qo(t),null;case 19:if(Fa(Zi),null===(a=t.memoizedState))return Qo(t),null;if(n=!!(128&t.flags),null===(i=a.rendering))if(n)Ho(a,!1);else{if(0!==Mc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(i=el(e))){for(t.flags|=128,Ho(a,!1),null!==(n=i.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;null!==s;)e=n,(a=s).flags&=14680066,null===(i=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return _a(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==a.tail&&Yt()>Uc&&(t.flags|=128,n=!0,Ho(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=el(i))){if(t.flags|=128,n=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Ho(a,!0),null===a.tail&&"hidden"===a.tailMode&&!i.alternate&&!ri)return Qo(t),null}else 2*Yt()-a.renderingStartTime>Uc&&1073741824!==s&&(t.flags|=128,n=!0,Ho(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(null!==(s=a.last)?s.sibling=i:t.child=i,a.last=i)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Yt(),t.sibling=null,s=Zi.current,_a(Zi,n?1&s|2:1&s),t):(Qo(t),null);case 22:case 23:return ud(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&1&t.mode?!!(1073741824&Dc)&&(Qo(t),6&t.subtreeFlags&&(t.flags|=8192)):Qo(t),null;case 24:case 25:return null}throw Error(ae(156,t.tag))}function Ko(e,t){switch(ti(t),t.tag){case 1:return Da(t.type)&&Ia(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ji(),Fa(Sa),Fa(Ca),sl(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xi(t),null;case 13:if(Fa(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(ae(340));xi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Fa(Zi),null;case 4:return Ji(),null;case 10:return Ei(t.type._context),null;case 22:case 23:return ud(),null;default:return null}}To=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Do=function(){},Io=function(e,t,s,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Ki(Hi.current);var a,i=null;switch(s){case"input":r=Ge(e,r),n=Ge(e,n),i=[];break;case"select":r=Oe({},r,{value:void 0}),n=Oe({},n,{value:void 0}),i=[];break;case"textarea":r=nt(e,r),n=nt(e,n),i=[];break;default:"function"!=typeof r.onClick&&"function"==typeof n.onClick&&(e.onclick=Zr)}for(c in bt(s,n),s=null,r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(a in l)l.hasOwnProperty(a)&&(s||(s={}),s[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(le.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var o=n[c];if(l=null!=r?r[c]:void 0,n.hasOwnProperty(c)&&o!==l&&(null!=o||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||(s||(s={}),s[a]="");for(a in o)o.hasOwnProperty(a)&&l[a]!==o[a]&&(s||(s={}),s[a]=o[a])}else s||(i||(i=[]),i.push(c,s)),s=o;else"dangerouslySetInnerHTML"===c?(o=o?o.__html:void 0,l=l?l.__html:void 0,null!=o&&l!==o&&(i=i||[]).push(c,o)):"children"===c?"string"!=typeof o&&"number"!=typeof o||(i=i||[]).push(c,""+o):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(le.hasOwnProperty(c)?(null!=o&&"onScroll"===c&&$r("scroll",e),i||l===o||(i=[])):(i=i||[]).push(c,o))}s&&(i=i||[]).push("style",s);var c=i;(t.updateQueue=c)&&(t.flags|=4)}},Mo=function(e,t,s,n){s!==n&&(t.flags|=4)};var Go=!1,Jo=!1,Yo="function"==typeof WeakSet?WeakSet:Set,Xo=null;function Zo(e,t){var s=e.ref;if(null!==s)if("function"==typeof s)try{s(null)}catch(n){kd(e,t,n)}else s.current=null}function ec(e,t,s){try{s()}catch(n){kd(e,t,n)}}var tc=!1;function sc(e,t,s){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&ec(t,s,a)}r=r.next}while(r!==n)}}function nc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function rc(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"==typeof t?t(e):t.current=e}}function ac(e){var t=e.alternate;null!==t&&(e.alternate=null,ac(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[xa],delete t[ma],delete t[ga],delete t[fa])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ic(e){return 5===e.tag||3===e.tag||4===e.tag}function lc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ic(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function oc(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!=(s=s._reactRootContainer)||null!==t.onclick||(t.onclick=Zr));else if(4!==n&&null!==(e=e.child))for(oc(e,t,s),e=e.sibling;null!==e;)oc(e,t,s),e=e.sibling}function cc(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cc(e,t,s),e=e.sibling;null!==e;)cc(e,t,s),e=e.sibling}var dc=null,uc=!1;function hc(e,t,s){for(s=s.child;null!==s;)xc(e,t,s),s=s.sibling}function xc(e,t,s){if(as&&"function"==typeof as.onCommitFiberUnmount)try{as.onCommitFiberUnmount(rs,s)}catch(l){}switch(s.tag){case 5:Jo||Zo(s,t);case 6:var n=dc,r=uc;dc=null,hc(e,t,s),uc=r,null!==(dc=n)&&(uc?(e=dc,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):dc.removeChild(s.stateNode));break;case 18:null!==dc&&(uc?(e=dc,s=s.stateNode,8===e.nodeType?oa(e.parentNode,s):1===e.nodeType&&oa(e,s),Us(e)):oa(dc,s.stateNode));break;case 4:n=dc,r=uc,dc=s.stateNode.containerInfo,uc=!0,hc(e,t,s),dc=n,uc=r;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(n=s.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var a=r,i=a.destroy;a=a.tag,void 0!==i&&(2&a||4&a)&&ec(s,t,i),r=r.next}while(r!==n)}hc(e,t,s);break;case 1:if(!Jo&&(Zo(s,t),"function"==typeof(n=s.stateNode).componentWillUnmount))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(l){kd(s,t,l)}hc(e,t,s);break;case 21:hc(e,t,s);break;case 22:1&s.mode?(Jo=(n=Jo)||null!==s.memoizedState,hc(e,t,s),Jo=n):hc(e,t,s);break;default:hc(e,t,s)}}function pc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Yo),t.forEach(function(t){var n=Cd.bind(null,e,t);s.has(t)||(s.add(t),t.then(n,n))})}}function mc(e,t){var s=t.deletions;if(null!==s)for(var n=0;n<s.length;n++){var r=s[n];try{var a=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:dc=l.stateNode,uc=!1;break e;case 3:case 4:dc=l.stateNode.containerInfo,uc=!0;break e}l=l.return}if(null===dc)throw Error(ae(160));xc(a,i,r),dc=null,uc=!1;var o=r.alternate;null!==o&&(o.return=null),r.return=null}catch(c){kd(r,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),fc(e),4&n){try{sc(3,e,e.return),nc(3,e)}catch(m){kd(e,e.return,m)}try{sc(5,e,e.return)}catch(m){kd(e,e.return,m)}}break;case 1:mc(t,e),fc(e),512&n&&null!==s&&Zo(s,s.return);break;case 5:if(mc(t,e),fc(e),512&n&&null!==s&&Zo(s,s.return),32&e.flags){var r=e.stateNode;try{ht(r,"")}catch(m){kd(e,e.return,m)}}if(4&n&&null!=(r=e.stateNode)){var a=e.memoizedProps,i=null!==s?s.memoizedProps:a,l=e.type,o=e.updateQueue;if(e.updateQueue=null,null!==o)try{"input"===l&&"radio"===a.type&&null!=a.name&&Ye(r,a),vt(l,i);var c=vt(l,a);for(i=0;i<o.length;i+=2){var d=o[i],u=o[i+1];"style"===d?gt(r,u):"dangerouslySetInnerHTML"===d?ut(r,u):"children"===d?ht(r,u):ve(r,d,u,c)}switch(l){case"input":Xe(r,a);break;case"textarea":at(r,a);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var x=a.value;null!=x?st(r,!!a.multiple,x,!1):h!==!!a.multiple&&(null!=a.defaultValue?st(r,!!a.multiple,a.defaultValue,!0):st(r,!!a.multiple,a.multiple?[]:"",!1))}r[xa]=a}catch(m){kd(e,e.return,m)}}break;case 6:if(mc(t,e),fc(e),4&n){if(null===e.stateNode)throw Error(ae(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(m){kd(e,e.return,m)}}break;case 3:if(mc(t,e),fc(e),4&n&&null!==s&&s.memoizedState.isDehydrated)try{Us(t.containerInfo)}catch(m){kd(e,e.return,m)}break;case 4:default:mc(t,e),fc(e);break;case 13:mc(t,e),fc(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(zc=Yt())),4&n&&pc(e);break;case 22:if(d=null!==s&&null!==s.memoizedState,1&e.mode?(Jo=(c=Jo)||d,mc(t,e),Jo=c):mc(t,e),fc(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&1&e.mode)for(Xo=e,d=e.child;null!==d;){for(u=Xo=d;null!==Xo;){switch(x=(h=Xo).child,h.tag){case 0:case 11:case 14:case 15:sc(4,h,h.return);break;case 1:Zo(h,h.return);var p=h.stateNode;if("function"==typeof p.componentWillUnmount){n=h,s=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){kd(n,s,m)}}break;case 5:Zo(h,h.return);break;case 22:if(null!==h.memoizedState){wc(u);continue}}null!==x?(x.return=h,Xo=x):wc(u)}d=d.sibling}e:for(d=null,u=e;;){if(5===u.tag){if(null===d){d=u;try{r=u.stateNode,c?"function"==typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=u.stateNode,i=null!=(o=u.memoizedProps.style)&&o.hasOwnProperty("display")?o.display:null,l.style.display=mt("display",i))}catch(m){kd(e,e.return,m)}}}else if(6===u.tag){if(null===d)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){kd(e,e.return,m)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:mc(t,e),fc(e),4&n&&pc(e);case 21:}}function fc(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(ic(s)){var n=s;break e}s=s.return}throw Error(ae(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(ht(r,""),n.flags&=-33),cc(e,lc(e),r);break;case 3:case 4:var a=n.stateNode.containerInfo;oc(e,lc(e),a);break;default:throw Error(ae(161))}}catch(i){kd(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,s){Xo=e,vc(e)}function vc(e,t,s){for(var n=!!(1&e.mode);null!==Xo;){var r=Xo,a=r.child;if(22===r.tag&&n){var i=null!==r.memoizedState||Go;if(!i){var l=r.alternate,o=null!==l&&null!==l.memoizedState||Jo;l=Go;var c=Jo;if(Go=i,(Jo=o)&&!c)for(Xo=r;null!==Xo;)o=(i=Xo).child,22===i.tag&&null!==i.memoizedState?jc(r):null!==o?(o.return=i,Xo=o):jc(r);for(;null!==a;)Xo=a,vc(a),a=a.sibling;Xo=r,Go=l,Jo=c}yc(e)}else 8772&r.subtreeFlags&&null!==a?(a.return=r,Xo=a):yc(e)}}function yc(e){for(;null!==Xo;){var t=Xo;if(8772&t.flags){var s=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Jo||nc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Jo)if(null===s)n.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:to(t.type,s.memoizedProps);n.componentDidUpdate(r,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&qi(t,a,n);break;case 3:var i=t.updateQueue;if(null!==i){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}qi(t,i,s)}break;case 5:var l=t.stateNode;if(null===s&&4&t.flags){s=l;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&s.focus();break;case"img":o.src&&(s.src=o.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var u=d.dehydrated;null!==u&&Us(u)}}}break;default:throw Error(ae(163))}Jo||512&t.flags&&rc(t)}catch(h){kd(t,t.return,h)}}if(t===e){Xo=null;break}if(null!==(s=t.sibling)){s.return=t.return,Xo=s;break}Xo=t.return}}function wc(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xo=s;break}Xo=t.return}}function jc(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{nc(4,t)}catch(o){kd(t,s,o)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(o){kd(t,r,o)}}var a=t.return;try{rc(t)}catch(o){kd(t,a,o)}break;case 5:var i=t.return;try{rc(t)}catch(o){kd(t,i,o)}}}catch(o){kd(t,t.return,o)}if(t===e){Xo=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Xo=l;break}Xo=t.return}}var Nc,kc=Math.ceil,Fc=ye.ReactCurrentDispatcher,_c=ye.ReactCurrentOwner,Ec=ye.ReactCurrentBatchConfig,Cc=0,Sc=null,Ac=null,Tc=0,Dc=0,Ic=ka(0),Mc=0,Lc=null,Rc=0,Oc=0,Pc=0,$c=null,Bc=null,zc=0,Uc=1/0,qc=null,Wc=!1,Hc=null,Qc=null,Vc=!1,Kc=null,Gc=0,Jc=0,Yc=null,Xc=-1,Zc=0;function ed(){return 6&Cc?Yt():-1!==Xc?Xc:Xc=Yt()}function td(e){return 1&e.mode?2&Cc&&0!==Tc?Tc&-Tc:null!==mi.transition?(0===Zc&&(Zc=ms()),Zc):0!==(e=vs)?e:e=void 0===(e=window.event)?16:Js(e.type):1}function sd(e,t,s,n){if(50<Jc)throw Jc=0,Yc=null,Error(ae(185));fs(e,s,n),2&Cc&&e===Sc||(e===Sc&&(!(2&Cc)&&(Oc|=s),4===Mc&&ld(e,Tc)),nd(e,n),1===s&&0===Cc&&!(1&t.mode)&&(Uc=Yt()+500,$a&&Ua()))}function nd(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-is(a),l=1<<i,o=r[i];-1===o?0!==(l&s)&&0===(l&n)||(r[i]=xs(l,t)):o<=t&&(e.expiredLanes|=l),a&=~l}}(e,t);var n=hs(e,e===Sc?Tc:0);if(0===n)null!==s&&Kt(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=s&&Kt(s),1===t)0===e.tag?function(e){$a=!0,za(e)}(od.bind(null,e)):za(od.bind(null,e)),ia(function(){!(6&Cc)&&Ua()}),s=null;else{switch(ys(n)){case 1:s=Zt;break;case 4:s=es;break;case 16:default:s=ts;break;case 536870912:s=ns}s=Sd(s,rd.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function rd(e,t){if(Xc=-1,Zc=0,6&Cc)throw Error(ae(327));var s=e.callbackNode;if(jd()&&e.callbackNode!==s)return null;var n=hs(e,e===Sc?Tc:0);if(0===n)return null;if(30&n||0!==(n&e.expiredLanes)||t)t=gd(e,n);else{t=n;var r=Cc;Cc|=2;var a=pd();for(Sc===e&&Tc===t||(qc=null,Uc=Yt()+500,hd(e,t));;)try{bd();break}catch(l){xd(e,l)}_i(),Fc.current=a,Cc=r,null!==Ac?t=0:(Sc=null,Tc=0,t=Mc)}if(0!==t){if(2===t&&(0!==(r=ps(e))&&(n=r,t=ad(e,r))),1===t)throw s=Lc,hd(e,0),ld(e,n),nd(e,Yt()),s;if(6===t)ld(e,n);else{if(r=e.current.alternate,!(30&n||function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var n=0;n<s.length;n++){var r=s[n],a=r.getSnapshot;r=r.value;try{if(!lr(a(),r))return!1}catch(i){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)||(t=gd(e,n),2===t&&(a=ps(e),0!==a&&(n=a,t=ad(e,a))),1!==t)))throw s=Lc,hd(e,0),ld(e,n),nd(e,Yt()),s;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(ae(345));case 2:case 5:wd(e,Bc,qc);break;case 3:if(ld(e,n),(130023424&n)===n&&10<(t=zc+500-Yt())){if(0!==hs(e,0))break;if(((r=e.suspendedLanes)&n)!==n){ed(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=na(wd.bind(null,e,Bc,qc),t);break}wd(e,Bc,qc);break;case 4:if(ld(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var i=31-is(n);a=1<<i,(i=t[i])>r&&(r=i),n&=~a}if(n=r,10<(n=(120>(n=Yt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kc(n/1960))-n)){e.timeoutHandle=na(wd.bind(null,e,Bc,qc),n);break}wd(e,Bc,qc);break;default:throw Error(ae(329))}}}return nd(e,Yt()),e.callbackNode===s?rd.bind(null,e):null}function ad(e,t){var s=$c;return e.current.memoizedState.isDehydrated&&(hd(e,t).flags|=256),2!==(e=gd(e,t))&&(t=Bc,Bc=s,null!==t&&id(t)),e}function id(e){null===Bc?Bc=e:Bc.push.apply(Bc,e)}function ld(e,t){for(t&=~Pc,t&=~Oc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-is(t),n=1<<s;e[s]=-1,t&=~n}}function od(e){if(6&Cc)throw Error(ae(327));jd();var t=hs(e,0);if(!(1&t))return nd(e,Yt()),null;var s=gd(e,t);if(0!==e.tag&&2===s){var n=ps(e);0!==n&&(t=n,s=ad(e,n))}if(1===s)throw s=Lc,hd(e,0),ld(e,t),nd(e,Yt()),s;if(6===s)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wd(e,Bc,qc),nd(e,Yt()),null}function cd(e,t){var s=Cc;Cc|=1;try{return e(t)}finally{0===(Cc=s)&&(Uc=Yt()+500,$a&&Ua())}}function dd(e){null!==Kc&&0===Kc.tag&&!(6&Cc)&&jd();var t=Cc;Cc|=1;var s=Ec.transition,n=vs;try{if(Ec.transition=null,vs=1,e)return e()}finally{vs=n,Ec.transition=s,!(6&(Cc=t))&&Ua()}}function ud(){Dc=Ic.current,Fa(Ic)}function hd(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,ra(s)),null!==Ac)for(s=Ac.return;null!==s;){var n=s;switch(ti(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Ia();break;case 3:Ji(),Fa(Sa),Fa(Ca),sl();break;case 5:Xi(n);break;case 4:Ji();break;case 13:case 19:Fa(Zi);break;case 10:Ei(n.type._context);break;case 22:case 23:ud()}s=s.return}if(Sc=e,Ac=e=Id(e.current,null),Tc=Dc=t,Mc=0,Lc=null,Pc=Oc=Rc=0,Bc=$c=null,null!==Ti){for(t=0;t<Ti.length;t++)if(null!==(n=(s=Ti[t]).interleaved)){s.interleaved=null;var r=n.next,a=s.pending;if(null!==a){var i=a.next;a.next=r,n.next=i}s.pending=n}Ti=null}return e}function xd(e,t){for(;;){var s=Ac;try{if(_i(),nl.current=Yl,cl){for(var n=il.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}cl=!1}if(al=0,ol=ll=il=null,dl=!1,ul=0,_c.current=null,null===s||null===s.return){Mc=1,Lc=t,Ac=null;break}e:{var a=e,i=s.return,l=s,o=t;if(t=Tc,l.flags|=32768,null!==o&&"object"==typeof o&&"function"==typeof o.then){var c=o,d=l,u=d.tag;if(!(1&d.mode||0!==u&&11!==u&&15!==u)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=go(i);if(null!==x){x.flags&=-257,fo(x,i,l,0,t),1&x.mode&&mo(a,c,t),o=c;var p=(t=x).updateQueue;if(null===p){var m=new Set;m.add(o),t.updateQueue=m}else p.add(o);break e}if(!(1&t)){mo(a,c,t),md();break e}o=Error(ae(426))}else if(ri&&1&l.mode){var g=go(i);if(null!==g){!(65536&g.flags)&&(g.flags|=256),fo(g,i,l,0,t),pi(oo(o,l));break e}}a=o=oo(o,l),4!==Mc&&(Mc=2),null===$c?$c=[a]:$c.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zi(a,xo(0,o,t));break e;case 1:l=o;var f=a.type,b=a.stateNode;if(!(128&a.flags||"function"!=typeof f.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Qc&&Qc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,zi(a,po(a,l,t));break e}}a=a.return}while(null!==a)}yd(s)}catch(v){t=v,Ac===s&&null!==s&&(Ac=s=s.return);continue}break}}function pd(){var e=Fc.current;return Fc.current=Yl,null===e?Yl:e}function md(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Sc||!(268435455&Rc)&&!(268435455&Oc)||ld(Sc,Tc)}function gd(e,t){var s=Cc;Cc|=2;var n=pd();for(Sc===e&&Tc===t||(qc=null,hd(e,t));;)try{fd();break}catch(r){xd(e,r)}if(_i(),Cc=s,Fc.current=n,null!==Ac)throw Error(ae(261));return Sc=null,Tc=0,Mc}function fd(){for(;null!==Ac;)vd(Ac)}function bd(){for(;null!==Ac&&!Gt();)vd(Ac)}function vd(e){var t=Nc(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?yd(e):Ac=t,_c.current=null}function yd(e){var t=e;do{var s=t.alternate;if(e=t.return,32768&t.flags){if(null!==(s=Ko(s,t)))return s.flags&=32767,void(Ac=s);if(null===e)return Mc=6,void(Ac=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(s=Vo(s,t,Dc)))return void(Ac=s);if(null!==(t=t.sibling))return void(Ac=t);Ac=t=e}while(null!==t);0===Mc&&(Mc=5)}function wd(e,t,s){var n=vs,r=Ec.transition;try{Ec.transition=null,vs=1,function(e,t,s,n){do{jd()}while(null!==Kc);if(6&Cc)throw Error(ae(327));s=e.finishedWork;var r=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-is(s),a=1<<r;t[r]=0,n[r]=-1,e[r]=-1,s&=~a}}(e,a),e===Sc&&(Ac=Sc=null,Tc=0),!(2064&s.subtreeFlags)&&!(2064&s.flags)||Vc||(Vc=!0,Sd(ts,function(){return jd(),null})),a=!!(15990&s.flags),!!(15990&s.subtreeFlags)||a){a=Ec.transition,Ec.transition=null;var i=vs;vs=1;var l=Cc;Cc|=4,_c.current=null,function(e,t){if(ea=Ws,xr(e=hr())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(n&&0!==n.rangeCount){s=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{s.nodeType,a.nodeType}catch(y){s=null;break e}var i=0,l=-1,o=-1,c=0,d=0,u=e,h=null;t:for(;;){for(var x;u!==s||0!==r&&3!==u.nodeType||(l=i+r),u!==a||0!==n&&3!==u.nodeType||(o=i+n),3===u.nodeType&&(i+=u.nodeValue.length),null!==(x=u.firstChild);)h=u,u=x;for(;;){if(u===e)break t;if(h===s&&++c===r&&(l=i),h===a&&++d===n&&(o=i),null!==(x=u.nextSibling))break;h=(u=h).parentNode}u=x}s=-1===l||-1===o?null:{start:l,end:o}}else s=null}s=s||{start:0,end:0}}else s=null;for(ta={focusedElem:e,selectionRange:s},Ws=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,1028&t.subtreeFlags&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var p=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var m=p.memoizedProps,g=p.memoizedState,f=t.stateNode,b=f.getSnapshotBeforeUpdate(t.elementType===t.type?m:to(t.type,m),g);f.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(ae(163))}}catch(y){kd(t,t.return,y)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}p=tc,tc=!1}(e,s),gc(s,e),pr(ta),Ws=!!ea,ta=ea=null,e.current=s,bc(s),Jt(),Cc=l,vs=i,Ec.transition=a}else e.current=s;if(Vc&&(Vc=!1,Kc=e,Gc=r),a=e.pendingLanes,0===a&&(Qc=null),function(e){if(as&&"function"==typeof as.onCommitFiberRoot)try{as.onCommitFiberRoot(rs,e,void 0,!(128&~e.current.flags))}catch(t){}}(s.stateNode),nd(e,Yt()),null!==t)for(n=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],n(r.value,{componentStack:r.stack,digest:r.digest});if(Wc)throw Wc=!1,e=Hc,Hc=null,e;!!(1&Gc)&&0!==e.tag&&jd(),a=e.pendingLanes,1&a?e===Yc?Jc++:(Jc=0,Yc=e):Jc=0,Ua()}(e,t,s,n)}finally{Ec.transition=r,vs=n}return null}function jd(){if(null!==Kc){var e=ys(Gc),t=Ec.transition,s=vs;try{if(Ec.transition=null,vs=16>e?16:e,null===Kc)var n=!1;else{if(e=Kc,Kc=null,Gc=0,6&Cc)throw Error(ae(331));var r=Cc;for(Cc|=4,Xo=e.current;null!==Xo;){var a=Xo,i=a.child;if(16&Xo.flags){var l=a.deletions;if(null!==l){for(var o=0;o<l.length;o++){var c=l[o];for(Xo=c;null!==Xo;){var d=Xo;switch(d.tag){case 0:case 11:case 15:sc(8,d,a)}var u=d.child;if(null!==u)u.return=d,Xo=u;else for(;null!==Xo;){var h=(d=Xo).sibling,x=d.return;if(ac(d),d===c){Xo=null;break}if(null!==h){h.return=x,Xo=h;break}Xo=x}}}var p=a.alternate;if(null!==p){var m=p.child;if(null!==m){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Xo=a}}if(2064&a.subtreeFlags&&null!==i)i.return=a,Xo=i;else e:for(;null!==Xo;){if(2048&(a=Xo).flags)switch(a.tag){case 0:case 11:case 15:sc(9,a,a.return)}var f=a.sibling;if(null!==f){f.return=a.return,Xo=f;break e}Xo=a.return}}var b=e.current;for(Xo=b;null!==Xo;){var v=(i=Xo).child;if(2064&i.subtreeFlags&&null!==v)v.return=i,Xo=v;else e:for(i=b;null!==Xo;){if(2048&(l=Xo).flags)try{switch(l.tag){case 0:case 11:case 15:nc(9,l)}}catch(w){kd(l,l.return,w)}if(l===i){Xo=null;break e}var y=l.sibling;if(null!==y){y.return=l.return,Xo=y;break e}Xo=l.return}}if(Cc=r,Ua(),as&&"function"==typeof as.onPostCommitFiberRoot)try{as.onPostCommitFiberRoot(rs,e)}catch(w){}n=!0}return n}finally{vs=s,Ec.transition=t}}return!1}function Nd(e,t,s){e=$i(e,t=xo(0,t=oo(s,t),1),1),t=ed(),null!==e&&(fs(e,1,t),nd(e,t))}function kd(e,t,s){if(3===e.tag)Nd(e,e,s);else for(;null!==t;){if(3===t.tag){Nd(t,e,s);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Qc||!Qc.has(n))){t=$i(t,e=po(t,e=oo(s,e),1),1),e=ed(),null!==t&&(fs(t,1,e),nd(t,e));break}}t=t.return}}function Fd(e,t,s){var n=e.pingCache;null!==n&&n.delete(t),t=ed(),e.pingedLanes|=e.suspendedLanes&s,Sc===e&&(Tc&s)===s&&(4===Mc||3===Mc&&(130023424&Tc)===Tc&&500>Yt()-zc?hd(e,0):Pc|=s),nd(e,t)}function _d(e,t){0===t&&(1&e.mode?(t=ds,!(130023424&(ds<<=1))&&(ds=4194304)):t=1);var s=ed();null!==(e=Mi(e,t))&&(fs(e,t,s),nd(e,s))}function Ed(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),_d(e,s)}function Cd(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(s=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ae(314))}null!==n&&n.delete(t),_d(e,s)}function Sd(e,t){return Vt(e,t)}function Ad(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Td(e,t,s,n){return new Ad(e,t,s,n)}function Dd(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Id(e,t){var s=e.alternate;return null===s?((s=Td(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Md(e,t,s,n,r,a){var i=2;if(n=e,"function"==typeof e)Dd(e)&&(i=1);else if("string"==typeof e)i=5;else e:switch(e){case Ne:return Ld(s.children,r,a,t);case ke:i=8,r|=8;break;case Fe:return(e=Td(12,s,t,2|r)).elementType=Fe,e.lanes=a,e;case Se:return(e=Td(13,s,t,r)).elementType=Se,e.lanes=a,e;case Ae:return(e=Td(19,s,t,r)).elementType=Ae,e.lanes=a,e;case Ie:return Rd(s,r,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case _e:i=10;break e;case Ee:i=9;break e;case Ce:i=11;break e;case Te:i=14;break e;case De:i=16,n=null;break e}throw Error(ae(130,null==e?e:typeof e,""))}return(t=Td(i,s,t,r)).elementType=e,t.type=n,t.lanes=a,t}function Ld(e,t,s,n){return(e=Td(7,e,n,t)).lanes=s,e}function Rd(e,t,s,n){return(e=Td(22,e,n,t)).elementType=Ie,e.lanes=s,e.stateNode={isHidden:!1},e}function Od(e,t,s){return(e=Td(6,e,null,t)).lanes=s,e}function Pd(e,t,s){return(t=Td(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $d(e,t,s,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gs(0),this.expirationTimes=gs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gs(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bd(e,t,s,n,r,a,i,l,o){return e=new $d(e,t,s,l,o),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Td(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ri(a),e}function zd(e){if(!e)return Ea;e:{if(Ut(e=e._reactInternals)!==e||1!==e.tag)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(ae(171))}if(1===e.tag){var s=e.type;if(Da(s))return La(e,s,t)}return t}function Ud(e,t,s,n,r,a,i,l,o){return(e=Bd(s,n,!0,e,0,a,0,l,o)).context=zd(null),s=e.current,(a=Pi(n=ed(),r=td(s))).callback=null!=t?t:null,$i(s,a,r),e.current.lanes=r,fs(e,r,n),nd(e,n),e}function qd(e,t,s,n){var r=t.current,a=ed(),i=td(r);return s=zd(s),null===t.context?t.context=s:t.pendingContext=s,(t=Pi(a,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=$i(r,t,i))&&(sd(e,r,i,a),Bi(e,r,i)),i}function Wd(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function Qd(e,t){Hd(e,t),(e=e.alternate)&&Hd(e,t)}Nc=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Sa.current)vo=!0;else{if(0===(e.lanes&s)&&!(128&t.flags))return vo=!1,function(e,t,s){switch(t.tag){case 3:So(t),xi();break;case 5:Yi(t);break;case 1:Da(t.type)&&Ra(t);break;case 4:Gi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;_a(ji,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(_a(Zi,1&Zi.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Oo(e,t,s):(_a(Zi,1&Zi.current),null!==(e=Wo(e,t,s))?e.sibling:null);_a(Zi,1&Zi.current);break;case 19:if(n=0!==(s&t.childLanes),128&e.flags){if(n)return Uo(e,t,s);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),_a(Zi,Zi.current),n)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,s)}return Wo(e,t,s)}(e,t,s);vo=!!(131072&e.flags)}else vo=!1,ri&&1048576&t.flags&&Za(t,Qa,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;qo(e,t),e=t.pendingProps;var r=Ta(t,Ca.current);Si(t,s),r=ml(null,t,n,e,r,s);var a=gl();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(n)?(a=!0,Ra(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ri(t),r.updater=no,t.stateNode=r,r._reactInternals=t,lo(t,n,e,s),t=Co(null,t,n,!0,a,s)):(t.tag=0,ri&&a&&ei(t),yo(null,t,r,s),t=t.child),t;case 16:n=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"==typeof e)return Dd(e)?1:0;if(null!=e){if((e=e.$$typeof)===Ce)return 11;if(e===Te)return 14}return 2}(n),e=to(n,e),r){case 0:t=_o(null,t,n,e,s);break e;case 1:t=Eo(null,t,n,e,s);break e;case 11:t=wo(null,t,n,e,s);break e;case 14:t=jo(null,t,n,to(n.type,e),s);break e}throw Error(ae(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,_o(e,t,n,r=t.elementType===n?r:to(n,r),s);case 1:return n=t.type,r=t.pendingProps,Eo(e,t,n,r=t.elementType===n?r:to(n,r),s);case 3:e:{if(So(t),null===e)throw Error(ae(387));n=t.pendingProps,r=(a=t.memoizedState).element,Oi(e,t),Ui(t,n,null,s);var i=t.memoizedState;if(n=i.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ao(e,t,n,s,r=oo(Error(ae(423)),t));break e}if(n!==r){t=Ao(e,t,n,s,r=oo(Error(ae(424)),t));break e}for(ni=ca(t.stateNode.containerInfo.firstChild),si=t,ri=!0,ai=null,s=wi(t,null,n,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(xi(),n===r){t=Wo(e,t,s);break e}yo(e,t,n,s)}t=t.child}return t;case 5:return Yi(t),null===e&&ci(t),n=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,i=r.children,sa(n,r)?i=null:null!==a&&sa(n,a)&&(t.flags|=32),Fo(e,t),yo(e,t,i,s),t.child;case 6:return null===e&&ci(t),null;case 13:return Oo(e,t,s);case 4:return Gi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=yi(t,null,n,s):yo(e,t,n,s),t.child;case 11:return n=t.type,r=t.pendingProps,wo(e,t,n,r=t.elementType===n?r:to(n,r),s);case 7:return yo(e,t,t.pendingProps,s),t.child;case 8:case 12:return yo(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,a=t.memoizedProps,i=r.value,_a(ji,n._currentValue),n._currentValue=i,null!==a)if(lr(a.value,i)){if(a.children===r.children&&!Sa.current){t=Wo(e,t,s);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){i=a.child;for(var o=l.firstContext;null!==o;){if(o.context===n){if(1===a.tag){(o=Pi(-1,s&-s)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?o.next=o:(o.next=d.next,d.next=o),c.pending=o}}a.lanes|=s,null!==(o=a.alternate)&&(o.lanes|=s),Ci(a.return,s,t),l.lanes|=s;break}o=o.next}}else if(10===a.tag)i=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(i=a.return))throw Error(ae(341));i.lanes|=s,null!==(l=i.alternate)&&(l.lanes|=s),Ci(i,s,t),i=a.sibling}else i=a.child;if(null!==i)i.return=a;else for(i=a;null!==i;){if(i===t){i=null;break}if(null!==(a=i.sibling)){a.return=i.return,i=a;break}i=i.return}a=i}yo(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Si(t,s),n=n(r=Ai(r)),t.flags|=1,yo(e,t,n,s),t.child;case 14:return r=to(n=t.type,t.pendingProps),jo(e,t,n,r=to(n.type,r),s);case 15:return No(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:to(n,r),qo(e,t),t.tag=1,Da(n)?(e=!0,Ra(t)):e=!1,Si(t,s),ao(t,n,r),lo(t,n,r,s),Co(null,t,n,!0,e,s);case 19:return Uo(e,t,s);case 22:return ko(e,t,s)}throw Error(ae(156,t.tag))};var Vd="function"==typeof reportError?reportError:function(e){console.error(e)};function Kd(e){this._internalRoot=e}function Gd(e){this._internalRoot=e}function Jd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xd(){}function Zd(e,t,s,n,r){var a=s._reactRootContainer;if(a){var i=a;if("function"==typeof r){var l=r;r=function(){var e=Wd(i);l.call(e)}}qd(t,i,e,r)}else i=function(e,t,s,n,r){if(r){if("function"==typeof n){var a=n;n=function(){var e=Wd(i);a.call(e)}}var i=Ud(t,n,e,0,null,!1,0,"",Xd);return e._reactRootContainer=i,e[pa]=i.current,Ur(8===e.nodeType?e.parentNode:e),dd(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof n){var l=n;n=function(){var e=Wd(o);l.call(e)}}var o=Bd(e,0,!1,null,0,!1,0,"",Xd);return e._reactRootContainer=o,e[pa]=o.current,Ur(8===e.nodeType?e.parentNode:e),dd(function(){qd(t,o,s,n)}),o}(s,t,e,r,n);return Wd(i)}Gd.prototype.render=Kd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(ae(409));qd(e,t,null,null)},Gd.prototype.unmount=Kd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dd(function(){qd(null,e,null,null)}),t[pa]=null}},Gd.prototype.unstable_scheduleHydration=function(e){if(e){var t=ks();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Is.length&&0!==t&&t<Is[s].priority;s++);Is.splice(s,0,e),0===s&&Os(e)}},ws=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=us(t.pendingLanes);0!==s&&(bs(t,1|s),nd(t,Yt()),!(6&Cc)&&(Uc=Yt()+500,Ua()))}break;case 13:dd(function(){var t=Mi(e,1);if(null!==t){var s=ed();sd(t,e,1,s)}}),Qd(e,1)}},js=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)sd(t,e,134217728,ed());Qd(e,134217728)}},Ns=function(e){if(13===e.tag){var t=td(e),s=Mi(e,t);if(null!==s)sd(s,e,t,ed());Qd(e,t)}},ks=function(){return vs},Fs=function(e,t){var s=vs;try{return vs=e,t()}finally{vs=s}},jt=function(e,t,s){switch(t){case"input":if(Xe(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var r=wa(n);if(!r)throw Error(ae(90));Ve(n),Xe(n,r)}}}break;case"textarea":at(e,s);break;case"select":null!=(t=s.value)&&st(e,!!s.multiple,t,!1)}},Ct=cd,St=dd;var eu={usingClientEntryPoint:!1,Events:[va,ya,wa,_t,Et,cd]},tu={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},su={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ye.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ht(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{rs=nu.inject(su),as=nu}catch(dt){}}Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,Z.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jd(t))throw Error(ae(200));return function(e,t,s){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:je,key:null==n?null:""+n,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},Z.createRoot=function(e,t){if(!Jd(e))throw Error(ae(299));var s=!1,n="",r=Vd;return null!=t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Bd(e,1,!1,null,0,s,0,n,r),e[pa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Kd(t)},Z.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(ae(188));throw e=Object.keys(e).join(","),Error(ae(268,e))}return e=null===(e=Ht(t))?null:e.stateNode},Z.flushSync=function(e){return dd(e)},Z.hydrate=function(e,t,s){if(!Yd(t))throw Error(ae(200));return Zd(null,e,t,!0,s)},Z.hydrateRoot=function(e,t,s){if(!Jd(e))throw Error(ae(405));var n=null!=s&&s.hydratedSources||null,r=!1,a="",i=Vd;if(null!=s&&(!0===s.unstable_strictMode&&(r=!0),void 0!==s.identifierPrefix&&(a=s.identifierPrefix),void 0!==s.onRecoverableError&&(i=s.onRecoverableError)),t=Ud(t,null,e,1,null!=s?s:null,r,0,a,i),e[pa]=t.current,Ur(e),n)for(e=0;e<n.length;e++)r=(r=(s=n[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new Gd(t)},Z.render=function(e,t,s){if(!Yd(t))throw Error(ae(200));return Zd(null,e,t,!1,s)},Z.unmountComponentAtNode=function(e){if(!Yd(e))throw Error(ae(40));return!!e._reactRootContainer&&(dd(function(){Zd(null,null,e,!1,function(){e._reactRootContainer=null,e[pa]=null})}),!0)},Z.unstable_batchedUpdates=cd,Z.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!Yd(s))throw Error(ae(200));if(null==e||void 0===e._reactInternals)throw Error(ae(38));return Zd(e,t,s,!1,n)},Z.version="18.3.1-next-f1338f8080-20240426",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),X.exports=Z;var ru=X.exports;Y.createRoot=ru.createRoot,Y.hydrateRoot=ru.hydrateRoot;const au=[{id:1,title:"Возможности Adapto",description:"Узнайте о всех возможностях нашей платформы",image:"/Frame 126.png",type:"feature",order:1,isActive:!0,createdAt:(new Date).toISOString()},{id:2,title:"Обзор платформы",description:"Полный обзор функционала Adapto",image:"/Frame 127.png",type:"overview",order:2,isActive:!0,createdAt:(new Date).toISOString()},{id:3,title:"История Adapto",description:"Как мы создавали платформу",image:"/Frame 128.png",type:"story",order:3,isActive:!0,createdAt:(new Date).toISOString()},{id:4,title:"Техническая поддержка",description:"Как получить помощь",image:"/Frame 129.png",type:"support",order:4,isActive:!0,createdAt:(new Date).toISOString()},{id:5,title:"Наш тг-канал",description:"Подписывайтесь на новости",image:"/Frame 130.png",type:"social",order:5,isActive:!0,createdAt:(new Date).toISOString()}],iu={},lu={},ou=function(e,t,s){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in lu)return;lu[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(!!s)for(let s=n.length-1;s>=0;s--){const r=n[s];if(r.href===e&&(!t||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),t?new Promise((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};class cu extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class du extends cu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class uu extends cu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hu extends cu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xu,pu;(pu=xu||(xu={})).Any="any",pu.ApNortheast1="ap-northeast-1",pu.ApNortheast2="ap-northeast-2",pu.ApSouth1="ap-south-1",pu.ApSoutheast1="ap-southeast-1",pu.ApSoutheast2="ap-southeast-2",pu.CaCentral1="ca-central-1",pu.EuCentral1="eu-central-1",pu.EuWest1="eu-west-1",pu.EuWest2="eu-west-2",pu.EuWest3="eu-west-3",pu.SaEast1="sa-east-1",pu.UsEast1="us-east-1",pu.UsWest1="us-west-1",pu.UsWest2="us-west-2";var mu=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class gu{constructor(e,{headers:t={},customFetch:s,region:n=xu.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ou(()=>Promise.resolve().then(()=>Su),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return mu(this,void 0,void 0,function*(){try{const{headers:n,method:r,body:a}=t;let i={},{region:l}=t;l||(l=this.region);const o=new URL(`${this.url}/${e}`);let c;l&&"any"!==l&&(i["x-region"]=l,o.searchParams.set("forceFunctionRegion",l)),a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",c=a):"string"==typeof a?(i["Content-Type"]="text/plain",c=a):"undefined"!=typeof FormData&&a instanceof FormData?c=a:(i["Content-Type"]="application/json",c=JSON.stringify(a)));const d=yield this.fetch(o.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),n),body:c}).catch(e=>{throw new du(e)}),u=d.headers.get("x-relay-error");if(u&&"true"===u)throw new uu(d);if(!d.ok)throw new hu(d);let h,x=(null!==(s=d.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return h="application/json"===x?yield d.json():"application/octet-stream"===x?yield d.blob():"text/event-stream"===x?d:"multipart/form-data"===x?yield d.formData():yield d.text(),{data:h,error:null,response:d}}catch(n){return{data:null,error:n,response:n instanceof hu||n instanceof uu?n.context:void 0}}})}}var fu={},bu={},vu={},yu={},wu={},ju={},Nu=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const ku=Nu.fetch,Fu=Nu.fetch.bind(Nu),_u=Nu.Headers,Eu=Nu.Request,Cu=Nu.Response,Su=Object.freeze(Object.defineProperty({__proto__:null,Headers:_u,Request:Eu,Response:Cu,default:Fu,fetch:ku},Symbol.toStringTag,{value:"Module"})),Au=s(Su);var Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});let Du=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Tu.default=Du;var Iu=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ju,"__esModule",{value:!0});const Mu=Iu(Au),Lu=Iu(Tu);ju.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Mu.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,n;let r=null,a=null,i=null,l=e.status,o=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");n&&c&&c.length>1&&(i=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(r={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,i=null,l=406,o="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{r=JSON.parse(t),Array.isArray(r)&&404===e.status&&(a=[],r=null,l=200,o="OK")}catch(c){404===e.status&&""===t?(l=204,o="No Content"):r={message:t}}if(r&&this.isMaybeSingle&&(null===(n=null==r?void 0:r.details)||void 0===n?void 0:n.includes("0 rows"))&&(r=null,l=200,o="OK"),r&&this.shouldThrowOnError)throw new Lu.default(r)}return{error:r,data:a,count:i,status:l,statusText:o}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var Ru=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wu,"__esModule",{value:!0});const Ou=Ru(ju);let Pu=class extends Ou.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const r=void 0===n?"offset":`${n}.offset`,a=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(a,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:r=!1,format:a="text"}={}){var i;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,r?"wal":null].filter(Boolean).join("|"),o=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${o}"; options=${l};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};wu.default=Pu;var $u=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yu,"__esModule",{value:!0});const Bu=$u(wu);let zu=class extends Bu.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let r="";"plain"===n?r="pl":"phrase"===n?r="ph":"websearch"===n&&(r="w");const a=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};yu.default=zu;var Uu=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vu,"__esModule",{value:!0});const qu=Uu(yu);vu.default=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let r=!1;const a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!r?"":('"'===e&&(r=!r),e)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new qu.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new qu.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:r=!0}={}){const a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new qu.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new qu.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new qu.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Wu={},Hu={};Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.version=void 0,Hu.version="0.0.0-automated",Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.DEFAULT_HEADERS=void 0;const Qu=Hu;Wu.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Qu.version}`};var Vu=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bu,"__esModule",{value:!0});const Ku=Vu(vu),Gu=Vu(yu),Ju=Wu;bu.default=class e{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Ju.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new Ku.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:r}={}){let a;const i=new URL(`${this.url}/rpc/${e}`);let l;s||n?(a=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{i.searchParams.append(e,t)})):(a="POST",l=t);const o=Object.assign({},this.headers);return r&&(o.Prefer=`count=${r}`),new Gu.default({method:a,url:i,headers:o,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};var Yu=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fu,"__esModule",{value:!0}),fu.PostgrestError=fu.PostgrestBuilder=fu.PostgrestTransformBuilder=fu.PostgrestFilterBuilder=fu.PostgrestQueryBuilder=fu.PostgrestClient=void 0;const Xu=Yu(bu);fu.PostgrestClient=Xu.default;const Zu=Yu(vu);fu.PostgrestQueryBuilder=Zu.default;const eh=Yu(yu);fu.PostgrestFilterBuilder=eh.default;const th=Yu(wu);fu.PostgrestTransformBuilder=th.default;const sh=Yu(ju);fu.PostgrestBuilder=sh.default;const nh=Yu(Tu);fu.PostgrestError=nh.default;var rh=fu.default={PostgrestClient:Xu.default,PostgrestQueryBuilder:Zu.default,PostgrestFilterBuilder:eh.default,PostgrestTransformBuilder:th.default,PostgrestBuilder:sh.default,PostgrestError:nh.default};const{PostgrestClient:ah,PostgrestQueryBuilder:ih,PostgrestFilterBuilder:lh,PostgrestTransformBuilder:oh,PostgrestBuilder:ch,PostgrestError:dh}=rh;class uh{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);return e>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const hh=1e4;var xh,ph,mh,gh,fh,bh,vh,yh,wh,jh,Nh;(ph=xh||(xh={}))[ph.connecting=0]="connecting",ph[ph.open=1]="open",ph[ph.closing=2]="closing",ph[ph.closed=3]="closed",(gh=mh||(mh={})).closed="closed",gh.errored="errored",gh.joined="joined",gh.joining="joining",gh.leaving="leaving",(bh=fh||(fh={})).close="phx_close",bh.error="phx_error",bh.join="phx_join",bh.reply="phx_reply",bh.leave="phx_leave",bh.access_token="access_token",(vh||(vh={})).websocket="websocket",(wh=yh||(yh={})).Connecting="connecting",wh.Open="open",wh.Closing="closing",wh.Closed="closed";class kh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),r=t.getUint8(2);let a=this.HEADER_LENGTH+2;const i=s.decode(e.slice(a,a+n));a+=n;const l=s.decode(e.slice(a,a+r));a+=r;return{ref:null,topic:i,event:l,payload:JSON.parse(s.decode(e.slice(a,e.byteLength)))}}}class Fh{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Nh=jh||(jh={})).abstime="abstime",Nh.bool="bool",Nh.date="date",Nh.daterange="daterange",Nh.float4="float4",Nh.float8="float8",Nh.int2="int2",Nh.int4="int4",Nh.int4range="int4range",Nh.int8="int8",Nh.int8range="int8range",Nh.json="json",Nh.jsonb="jsonb",Nh.money="money",Nh.numeric="numeric",Nh.oid="oid",Nh.reltime="reltime",Nh.text="text",Nh.time="time",Nh.timestamp="timestamp",Nh.timestamptz="timestamptz",Nh.timetz="timetz",Nh.tsrange="tsrange",Nh.tstzrange="tstzrange";const _h=(e,t,s={})=>{var n;const r=null!==(n=s.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((s,n)=>(s[n]=Eh(n,e,t,r),s),{})},Eh=(e,t,s,n)=>{const r=t.find(t=>t.name===e),a=null==r?void 0:r.type,i=s[e];return a&&!n.includes(a)?Ch(a,i):Sh(i)},Ch=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return Ih(t,s)}switch(e){case jh.bool:return Ah(t);case jh.float4:case jh.float8:case jh.int2:case jh.int4:case jh.int8:case jh.numeric:case jh.oid:return Th(t);case jh.json:case jh.jsonb:return Dh(t);case jh.timestamp:return Mh(t);case jh.abstime:case jh.date:case jh.daterange:case jh.int4range:case jh.int8range:case jh.money:case jh.reltime:case jh.text:case jh.time:case jh.timestamptz:case jh.timetz:case jh.tsrange:case jh.tstzrange:default:return Sh(t)}},Sh=e=>e,Ah=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Th=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Dh=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Ih=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,n=e[s];if("{"===e[0]&&"}"===n){let n;const a=e.slice(1,s);try{n=JSON.parse("["+a+"]")}catch(r){n=a?a.split(","):[]}return n.map(e=>Ch(t,e))}return e},Mh=e=>"string"==typeof e?e.replace(" ","T"):e,Lh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Rh{constructor(e,t,s={},n=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Oh,Ph,$h,Bh,zh,Uh,qh,Wh;(Ph=Oh||(Oh={})).SYNC="sync",Ph.JOIN="join",Ph.LEAVE="leave";class Hh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Hh.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=Hh.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],n()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Hh.syncDiff(this.state,e,t,s),n())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const r=this.cloneDeep(e),a=this.transformState(t),i={},l={};return this.map(r,(e,t)=>{a[e]||(l[e]=t)}),this.map(a,(e,t)=>{const s=r[e];if(s){const n=t.map(e=>e.presence_ref),r=s.map(e=>e.presence_ref),a=t.filter(e=>r.indexOf(e.presence_ref)<0),o=s.filter(e=>n.indexOf(e.presence_ref)<0);a.length>0&&(i[e]=a),o.length>0&&(l[e]=o)}else i[e]=t}),this.syncDiff(r,{joins:i,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:r,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(r,(t,n)=>{var r;const a=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(n),a.length>0){const s=e[t].map(e=>e.presence_ref),n=a.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...n)}s(t,a,n)}),this.map(a,(t,s)=>{let r=e[t];if(!r)return;const a=s.map(e=>e.presence_ref);r=r.filter(e=>a.indexOf(e.presence_ref)<0),e[t]=r,n(t,r,s),0===r.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return t[s]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Bh=$h||($h={})).ALL="*",Bh.INSERT="INSERT",Bh.UPDATE="UPDATE",Bh.DELETE="DELETE",(Uh=zh||(zh={})).BROADCAST="broadcast",Uh.PRESENCE="presence",Uh.POSTGRES_CHANGES="postgres_changes",Uh.SYSTEM="system",(Wh=qh||(qh={})).SUBSCRIBED="SUBSCRIBED",Wh.TIMED_OUT="TIMED_OUT",Wh.CLOSED="CLOSED",Wh.CHANNEL_ERROR="CHANNEL_ERROR";class Qh{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=mh.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Rh(this,fh.join,this.params,this.timeout),this.rejoinTimer=new Fh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mh.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mh.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=mh.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mh.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=mh.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fh.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Hh(this),this.broadcastEndpointURL=Lh(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==mh.closed){const{config:{broadcast:r,presence:a,private:i}}=this.params,l=null!==(n=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==n?n:[],o=!!this.bindings[zh.PRESENCE]&&this.bindings[zh.PRESENCE].length>0,c={},d={broadcast:r,presence:Object.assign(Object.assign({},a),{enabled:o}),postgres_changes:l,private:i};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(qh.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(qh.CLOSED)),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const n=this.bindings.postgres_changes,r=null!==(s=null==n?void 0:n.length)&&void 0!==s?s:0,a=[];for(let s=0;s<r;s++){const r=n[s],{filter:{event:i,schema:l,table:o,filter:c}}=r,d=t&&t[s];if(!d||d.event!==i||d.schema!==l||d.table!==o||d.filter!==c)return this.unsubscribe(),this.state=mh.errored,void(null==e||e(qh.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));a.push(Object.assign(Object.assign({},r),{id:d.id}))}return this.bindings.postgres_changes=a,void(e&&e(qh.SUBSCRIBED))}null==e||e(qh.SUBSCRIBED)}).receive("error",t=>{this.state=mh.errored,null==e||e(qh.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(qh.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===mh.joined&&e===zh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var n,r,a;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(r=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===r?void 0:r.broadcast)||void 0===a?void 0:a.ack)||s("ok"),i.receive("ok",()=>s("ok")),i.receive("error",()=>s("error")),i.receive("timeout",()=>s("timed out"))});{const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=mh.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fh.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Rh(this,fh.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=mh.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,r=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(r),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Rh(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,r;const a=e.toLocaleLowerCase(),{close:i,error:l,leave:o,join:c}=fh;if(s&&[i,l,o,c].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,s,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===n?void 0:n.toLocaleLowerCase())===a}).map(e=>e.callback(d,s)):null===(r=this.bindings[a])||void 0===r||r.filter(e=>{var s,n,r,i,l,o;if(["broadcast","presence","postgres_changes"].includes(a)){if("id"in e){const a=e.id,i=null===(s=e.filter)||void 0===s?void 0:s.event;return a&&(null===(n=t.ids)||void 0===n?void 0:n.includes(a))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const s=null===(l=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===l?void 0:l.toLocaleLowerCase();return"*"===s||s===(null===(o=null==t?void 0:t.event)||void 0===o?void 0:o.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===a}).map(e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:n,type:r,errors:a}=e,i={schema:t,table:s,commit_timestamp:n,eventType:r,new:{},old:{},errors:a};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,s)})}_isClosed(){return this.state===mh.closed}_isJoined(){return this.state===mh.joined}_isJoining(){return this.state===mh.joining}_isLeaving(){return this.state===mh.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),r={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(r):this.bindings[n]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===s&&Qh.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fh.close,{},e)}_onError(e){this._on(fh.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mh.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=_h(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=_h(e.columns,e.old_record)),t}}const Vh=()=>{},Kh=25e3,Gh=10,Jh=100,Yh=[1e3,2e3,5e3,1e4];class Xh{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=hh,this.transport=null,this.heartbeatIntervalMs=Kh,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Vh,this.ref=0,this.reconnectTimer=null,this.logger=Vh,this.conn=null,this.sendBuffer=[],this.serializer=new kh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ou(()=>Promise.resolve().then(()=>Su),void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${vh.websocket}`,this.httpEndpoint=Lh(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=uh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case xh.connecting:return yh.Connecting;case xh.open:return yh.Open;case xh.closing:return yh.Closing;default:return yh.Closed}}isConnected(){return this.connectionState()===yh.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===s);if(n)return n;{const s=new Qh(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:n,ref:r}=e,a=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${r})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Jh);this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{"phoenix"===e.topic&&"phx_reply"===e.event&&this.heartbeatCallback("ok"===e.payload.status?"ok":"error"),e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:s,payload:n,ref:r}=e,a=r?`(${r})`:"",i=n.status||"";this.log("receive",`${i} ${t} ${s} ${a}`.trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,n,r)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fh.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const s={access_token:t,version:"realtime-js/2.15.1"};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(fh.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Fh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Gh)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,r,a,i,l,o;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null==e?void 0:e.timeout)&&void 0!==s?s:hh,this.heartbeatIntervalMs=null!==(n=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:Kh,this.worker=null!==(r=null==e?void 0:e.worker)&&void 0!==r&&r,this.accessToken=null!==(a=null==e?void 0:e.accessToken)&&void 0!==a?a:null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(i=null==e?void 0:e.reconnectAfterMs)&&void 0!==i?i:e=>Yh[e-1]||1e4,this.encode=null!==(l=null==e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(o=null==e?void 0:e.decode)&&void 0!==o?o:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class Zh extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ex(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class tx extends Zh{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sx extends Zh{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var nx=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const rx=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ou(()=>Promise.resolve().then(()=>Su),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ax=e=>{if(Array.isArray(e))return e.map(e=>ax(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,s])=>{const n=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[n]=ax(s)}),t};var ix=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const lx=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ox=(e,t,s)=>ix(void 0,void 0,void 0,function*(){const n=yield nx(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield ou(()=>Promise.resolve().then(()=>Su),void 0)).Response:Response});e instanceof n&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{const n=e.status||500,r=(null==s?void 0:s.statusCode)||n+"";t(new tx(lx(s),n,r))}).catch(e=>{t(new sx(lx(e),e))}):t(new sx(lx(e),e))}),cx=(e,t,s,n)=>{const r={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(n)?(r.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r.body=JSON.stringify(n)):r.body=n,(null==t?void 0:t.duplex)&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),s)):r};function dx(e,t,s,n,r,a){return ix(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(s,cx(t,n,r,a)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>ox(e,l,n))})})}function ux(e,t,s,n){return ix(this,void 0,void 0,function*(){return dx(e,"GET",t,s,n)})}function hx(e,t,s,n,r){return ix(this,void 0,void 0,function*(){return dx(e,"POST",t,n,r,s)})}function xx(e,t,s,n,r){return ix(this,void 0,void 0,function*(){return dx(e,"PUT",t,n,r,s)})}function px(e,t,s,n,r){return ix(this,void 0,void 0,function*(){return dx(e,"DELETE",t,n,r,s)})}var mx=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const gx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bx{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=rx(n)}uploadOrUpdate(e,t,s,n){return mx(this,void 0,void 0,function*(){try{let r;const a=Object.assign(Object.assign({},fx),n);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)});const l=a.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),l&&r.append("metadata",this.encodeMetadata(l)),r.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(r=s,r.append("cacheControl",a.cacheControl),l&&r.append("metadata",this.encodeMetadata(l))):(r=s,i["cache-control"]=`max-age=${a.cacheControl}`,i["content-type"]=a.contentType,l&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),(null==n?void 0:n.headers)&&(i=Object.assign(Object.assign({},i),n.headers));const o=this._removeEmptyFolders(t),c=this._getFinalPath(o),d=yield("PUT"==e?xx:hx)(this.fetch,`${this.url}/object/${c}`,r,Object.assign({headers:i},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{}));return{data:{path:o,id:d.Id,fullPath:d.Key},error:null}}catch(r){if(ex(r))return{data:null,error:r};throw r}})}upload(e,t,s){return mx(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return mx(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),a=this._getFinalPath(r),i=new URL(this.url+`/object/upload/sign/${a}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:fx.upsert},n),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);return{data:{path:r,fullPath:(yield xx(this.fetch,i.toString(),e,{headers:a})).Key},error:null}}catch(l){if(ex(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return mx(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");const r=yield hx(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+r.url),i=a.searchParams.get("token");if(!i)throw new Zh("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:i},error:null}}catch(s){if(ex(s))return{data:null,error:s};throw s}})}update(e,t,s){return mx(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return mx(this,void 0,void 0,function*(){try{return{data:yield hx(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(ex(n))return{data:null,error:n};throw n}})}copy(e,t,s){return mx(this,void 0,void 0,function*(){try{return{data:{path:(yield hx(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(ex(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return mx(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),r=yield hx(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const a=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(n){if(ex(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return mx(this,void 0,void 0,function*(){try{const n=yield hx(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${r}`):null})),error:null}}catch(n){if(ex(n))return{data:null,error:n};throw n}})}download(e,t){return mx(this,void 0,void 0,function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),r=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield ux(this.fetch,`${this.url}/${s}/${t}${r}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(a){if(ex(a))return{data:null,error:a};throw a}})}info(e){return mx(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield ux(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ax(e),error:null}}catch(s){if(ex(s))return{data:null,error:s};throw s}})}exists(e){return mx(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,n){return ix(this,void 0,void 0,function*(){return dx(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(ex(s)&&s instanceof sx){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],r=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==r&&n.push(r);const a=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&n.push(i);let l=n.join("&");return""!==l&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${l}`)}}}remove(e){return mx(this,void 0,void 0,function*(){try{return{data:yield px(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ex(t))return{data:null,error:t};throw t}})}list(e,t,s){return mx(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},gx),t),{prefix:e||""});return{data:yield hx(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(ex(n))return{data:null,error:n};throw n}})}listV2(e,t){return mx(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield hx(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(ex(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const vx={"X-Client-Info":"storage-js/2.11.0"};var yx=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class wx{constructor(e,t={},s,n){const r=new URL(e);if(null==n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."))}this.url=r.href,this.headers=Object.assign(Object.assign({},vx),t),this.fetch=rx(s)}listBuckets(){return yx(this,void 0,void 0,function*(){try{return{data:yield ux(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ex(e))return{data:null,error:e};throw e}})}getBucket(e){return yx(this,void 0,void 0,function*(){try{return{data:yield ux(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ex(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return yx(this,void 0,void 0,function*(){try{return{data:yield hx(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ex(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return yx(this,void 0,void 0,function*(){try{return{data:yield xx(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ex(s))return{data:null,error:s};throw s}})}emptyBucket(e){return yx(this,void 0,void 0,function*(){try{return{data:yield hx(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ex(t))return{data:null,error:t};throw t}})}deleteBucket(e){return yx(this,void 0,void 0,function*(){try{return{data:yield px(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ex(t))return{data:null,error:t};throw t}})}}class jx extends wx{constructor(e,t={},s,n){super(e,t,s,n)}from(e){return new bx(this.url,this.headers,e,this.fetch)}}let Nx="";Nx="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const kx={headers:{"X-Client-Info":`supabase-js-${Nx}/2.55.0`}},Fx={schema:"public"},_x={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ex={};var Cx=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const Sx=(e,t,s)=>{const n=(e=>{let t;return t=e||("undefined"==typeof fetch?Fu:fetch),(...e)=>t(...e)})(s),r="undefined"==typeof Headers?_u:Headers;return(s,a)=>Cx(void 0,void 0,void 0,function*(){var i;const l=null!==(i=yield t())&&void 0!==i?i:e;let o=new r(null==a?void 0:a.headers);return o.has("apikey")||o.set("apikey",e),o.has("Authorization")||o.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:o}))})};var Ax=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const Tx="2.71.1",Dx=3e4,Ix=9e4,Mx={"X-Client-Info":`gotrue-js/${Tx}`},Lx="X-Supabase-Api-Version",Rx={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ox=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Px extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function $x(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Bx extends Px{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class zx extends Px{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ux extends Px{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class qx extends Ux{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Wx extends Ux{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hx extends Ux{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qx extends Ux{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vx extends Ux{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kx extends Ux{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Gx(e){return $x(e)&&"AuthRetryableFetchError"===e.name}class Jx extends Ux{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Yx extends Ux{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zx=" \t\n\r=".split(""),ep=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Zx.length;t+=1)e[Zx[t].charCodeAt(0)]=-2;for(let t=0;t<Xx.length;t+=1)e[Xx[t].charCodeAt(0)]=t;return e})();function tp(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Xx[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Xx[e]),t.queuedBits-=6}}function sp(e,t,s){const n=ep[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function np(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,n,s)};for(let i=0;i<e.length;i+=1)sp(e.charCodeAt(i),r,a);return t.join("")}function rp(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function ap(e){const t=[],s={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let r=0;r<e.length;r+=1)sp(e.charCodeAt(r),s,n);return new Uint8Array(t)}function ip(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let n=e.charCodeAt(s);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}rp(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function lp(e){const t=[],s={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>tp(e,s,n)),tp(null,s,n),t.join("")}const op=()=>"undefined"!=typeof window&&"undefined"!=typeof document,cp={tested:!1,writable:!1},dp=()=>{if(!op())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(cp.tested)return cp.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),cp.tested=!0,cp.writable=!0}catch(t){cp.tested=!0,cp.writable=!1}return cp.writable};const up=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ou(()=>Promise.resolve().then(()=>Su),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},hp=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},xp=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(n){return s}},pp=async(e,t)=>{await e.removeItem(t)};class mp{constructor(){this.promise=new mp.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function gp(e){const t=e.split(".");if(3!==t.length)throw new Yx("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!Ox.test(t[s]))throw new Yx("JWT not in base64url format");return{header:JSON.parse(np(t[0])),payload:JSON.parse(np(t[1])),signature:ap(t[2]),raw:{header:t[0],payload:t[1]}}}function fp(e){return("0"+e.toString(16)).substr(-2)}async function bp(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vp(e,t,s=!1){const n=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let n=0;n<56;n++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,fp).join("")}();let r=n;s&&(r+="/PASSWORD_RECOVERY"),await hp(e,`${t}-code-verifier`,r);const a=await bp(n);return[a,n===a?"plain":"s256"]}mp.promiseConstructor=Promise;const yp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const wp=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jp(e){if(!wp.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Np(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kp(e){return JSON.parse(JSON.stringify(e))}var Fp=globalThis&&globalThis.__rest||function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(s[n[r]]=e[n[r]])}return s};const _p=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Ep=[502,503,504];async function Cp(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new Kx(_p(e),0);if(Ep.includes(e.status))throw new Kx(_p(e),e.status);let n,r;try{n=await e.json()}catch(i){throw new zx(_p(i),i)}const a=function(e){const t=e.headers.get(Lx);if(!t)return null;if(!t.match(yp))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(i){return null}}(e);if(a&&a.getTime()>=Rx.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?r=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(r=n.error_code),r){if("weak_password"===r)throw new Jx(_p(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new qx}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new Jx(_p(n),e.status,n.weak_password.reasons);throw new Bx(_p(n),e.status||500,r)}async function Sp(e,t,s,n){var r;const a=Object.assign({},null==n?void 0:n.headers);a[Lx]||(a[Lx]=Rx.name),(null==n?void 0:n.jwt)&&(a.Authorization=`Bearer ${n.jwt}`);const i=null!==(r=null==n?void 0:n.query)&&void 0!==r?r:{};(null==n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",o=await async function(e,t,s,n,r,a){const i=((e,t,s,n)=>{const r={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),r.body=JSON.stringify(n),Object.assign(Object.assign({},r),s))})(t,n,r,a);let l;try{l=await e(s,Object.assign({},i))}catch(o){throw console.error(o),new Kx(_p(o),0)}l.ok||await Cp(l);if(null==n?void 0:n.noResolveJson)return l;try{return await l.json()}catch(o){await Cp(o)}}(e,t,s+l,{headers:a,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(o):{data:Object.assign({},o),error:null}}function Ap(e){var t;let s=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Tp(e){const t=Ap(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Dp(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Ip(e){return{data:e,error:null}}function Mp(e){const{action_link:t,email_otp:s,hashed_token:n,redirect_to:r,verification_type:a}=e,i=Fp(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:n,redirect_to:r,verification_type:a},user:Object.assign({},i)},error:null}}function Lp(e){return e}const Rp=["global","local","others"];var Op=globalThis&&globalThis.__rest||function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(s[n[r]]=e[n[r]])}return s};class Pp{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=up(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Rp[0]){if(Rp.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Rp.join(", ")}`);try{return await Sp(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if($x(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Sp(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Dp})}catch(s){if($x(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Op(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=null==s?void 0:s.newEmail,delete n.newEmail),await Sp(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Mp,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if($x(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Sp(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Dp})}catch(t){if($x(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,r,a,i,l;try{const o={nextPage:null,lastPage:0,total:0},c=await Sp(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(r=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==r?r:""},xform:Lp});if(c.error)throw c.error;const d=await c.json(),u=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,h=null!==(l=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==l?l:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);o[`${s}Page`]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},d),o),error:null}}catch(o){if($x(o))return{data:{users:[]},error:o};throw o}}async getUserById(e){jp(e);try{return await Sp(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Dp})}catch(t){if($x(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){jp(e);try{return await Sp(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Dp})}catch(s){if($x(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){jp(e);try{return await Sp(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Dp})}catch(s){if($x(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){jp(e.userId);try{const{data:t,error:s}=await Sp(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if($x(t))return{data:null,error:t};throw t}}async _deleteFactor(e){jp(e.userId),jp(e.id);try{return{data:await Sp(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if($x(t))return{data:null,error:t};throw t}}}function $p(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const Bp=!!(globalThis&&dp()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class zp extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Up extends zp{}async function qp(e,t,s){Bp&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Bp&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw Bp&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Up(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Bp)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}Bp&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await s()}finally{Bp&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Wp={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Mx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Hp(e,t,s){return await s()}const Qp={};class Vp{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Vp.nextInstanceID,Vp.nextInstanceID+=1,this.instanceID>0&&op()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Wp),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Pp({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=up(n.fetch),this.lock=n.lock||Hp,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:op()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=qp:this.lock=Hp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:dp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$p(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=$p(this.memoryStorage)),op()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=Qp[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Qp[this.storageKey]=Object.assign(Object.assign({},Qp[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Qp[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qp[this.storageKey]=Object.assign(Object.assign({},Qp[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Tx}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(n){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),op()&&this.detectSessionInUrl&&"none"!==s){const{data:n,error:r}=await this._getSessionFromURL(t,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return $x(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return await this._removeSession(),{error:r}}const{session:a,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",i),await this._saveSession(a),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return $x(t)?{error:t}:{error:new zx("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const r=await Sp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:Ap}),{data:a,error:i}=r;if(i||!a)return{data:{user:null,session:null},error:i};const l=a.session,o=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(r){if($x(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,s,n;try{let r;if("email"in e){const{email:s,password:n,options:a}=e;let i=null,l=null;"pkce"===this.flowType&&([i,l]=await vp(this.storage,this.storageKey)),r=await Sp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:s,password:n,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:l},xform:Ap})}else{if(!("phone"in e))throw new Hx("You must provide either an email or phone number and a password");{const{phone:t,password:a,options:i}=e;r=await Sp(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(s=null==i?void 0:i.data)&&void 0!==s?s:{},channel:null!==(n=null==i?void 0:i.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Ap})}}const{data:a,error:i}=r;if(i||!a)return{data:{user:null,session:null},error:i};const l=a.session,o=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(r){if($x(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:n,options:r}=e;t=await Sp(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken}},xform:Tp})}else{if(!("phone"in e))throw new Hx("You must provide either an email or phone number and a password");{const{phone:s,password:n,options:r}=e;t=await Sp(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken}},xform:Tp})}}const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Wx}}catch(t){if($x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,r,a,i,l,o,c,d,u,h;let x,p;if("message"in e)x=e.message,p=e.signature;else{const{chain:u,wallet:h,statement:m,options:g}=e;let f;if(op())if("object"==typeof h)f=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");f=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");f=h}const b=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in f&&f.signIn){const e=await f.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),m?{statement:m}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");x="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in f&&"function"==typeof f.signMessage&&"publicKey"in f&&"object"==typeof f&&f.publicKey&&"toBase58"in f.publicKey&&"function"==typeof f.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${b.host} wants you to sign in with your Solana account:`,f.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${null!==(n=null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==n?n:(new Date).toISOString()}`,...(null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(d=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await f.signMessage((new TextEncoder).encode(x),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:s}=await Sp(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:lp(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Ap});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new Wx}}catch(m){if($x(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await xp(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(null!=t?t:"").split("/");try{const{data:t,error:r}=await Sp(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ap});if(await pp(this.storage,`${this.storageKey}-code-verifier`),r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:r}):{data:{user:null,session:null,redirectType:null},error:new Wx}}catch(r){if($x(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:r,nonce:a}=e,i=await Sp(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Ap}),{data:l,error:o}=i;return o?{data:{user:null,session:null},error:o}:l&&l.session&&l.user?(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:o}):{data:{user:null,session:null},error:new Wx}}catch(t){if($x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,r,a;try{if("email"in e){const{email:n,options:r}=e;let a=null,i=null;"pkce"===this.flowType&&([a,i]=await vp(this.storage,this.storageKey));const{error:l}=await Sp(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(s=null==r?void 0:r.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},code_challenge:a,code_challenge_method:i},redirectTo:null==r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:l}}if("phone"in e){const{phone:t,options:s}=e,{data:i,error:l}=await Sp(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==s?void 0:s.data)&&void 0!==n?n:{},create_user:null===(r=null==s?void 0:s.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(a=null==s?void 0:s.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:l}}throw new Hx("You must provide either an email or phone number.")}catch(i){if($x(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,s;try{let n,r;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:a,error:i}=await Sp(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:n,xform:Ap});if(i)throw i;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,o=a.user;return(null==l?void 0:l.access_token)&&(await this._saveSession(l),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(n){if($x(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let r=null,a=null;return"pkce"===this.flowType&&([r,a]=await vp(this.storage,this.storageKey)),await Sp(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:a}),headers:this.headers,xform:Ip})}catch(r){if($x(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new qx;const{error:n}=await Sp(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if($x(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:r}=e,{error:a}=await Sp(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken}},redirectTo:null==r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:s,type:n,options:r}=e,{data:a,error:i}=await Sp(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:i}}throw new Hx("You must provide either an email or phone number and a type")}catch(t){if($x(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await xp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<Ix;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const t=await xp(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Np()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,n)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,n))})}return{data:{session:e},error:null}}const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await Sp(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Dp}):await this._useSession(async e=>{var t,s,n;const{data:r,error:a}=e;if(a)throw a;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Sp(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(s=r.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0,xform:Dp}):{data:{user:null},error:new qx}})}catch(t){if($x(t))return function(e){return $x(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await pp(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:r}=s;if(r)throw r;if(!n.session)throw new qx;const a=n.session;let i=null,l=null;"pkce"===this.flowType&&null!=e.email&&([i,l]=await vp(this.storage,this.storageKey));const{data:o,error:c}=await Sp(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:l}),jwt:a.access_token,xform:Dp});if(c)throw c;return a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if($x(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new qx;const t=Date.now()/1e3;let s=t,n=!0,r=null;const{payload:a}=gp(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:n,error:a}=await this._getUser(e.access_token);if(a)throw a;r={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if($x(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:n,error:r}=t;if(r)throw r;e=null!==(s=n.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new qx;const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if($x(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!op())throw new Qx("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qx(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Vx("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Qx("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Vx("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:r,refresh_token:a,expires_in:i,expires_at:l,token_type:o}=e;if(!(r&&i&&a&&o))throw new Qx("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;l&&(u=parseInt(l));const h=u-c;1e3*h<=Dx&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const x=u-d;c-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,u,c):c-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,u,c);const{data:p,error:m}=await this._getUser(r);if(m)throw m;const g={provider_token:s,provider_refresh_token:n,access_token:r,expires_in:d,expires_at:u,refresh_token:a,token_type:o,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if($x(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await xp(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:r}=t;if(r)return{error:r};const a=null===(s=n.session)||void 0===s?void 0:s.access_token;if(a){const{error:t}=await this.admin.signOut(a,e);if(t&&(!function(e){return $x(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await pp(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:n},error:r}=t;if(r)throw r;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(r){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;"pkce"===this.flowType&&([s,n]=await vp(this.storage,this.storageKey,!0));try{return await Sp(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if($x(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if($x(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async t=>{var s,n,r,a,i;const{data:l,error:o}=t;if(o)throw o;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await Sp(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(a=l.session)||void 0===a?void 0:a.access_token)&&void 0!==i?i:void 0})});if(n)throw n;return op()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if($x(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:r,error:a}=t;if(a)throw a;return await Sp(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(s=r.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})})}catch(t){if($x(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Sp(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ap})),n=(e,t)=>{const s=200*Math.pow(2,e);return t&&Gx(t)&&Date.now()+s-r<Dx},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await s(a);if(!n(a,null,t))return void e(t)}catch(r){if(!n(a,r))return void t(r)}})()}))}catch(r){if(this._debug(t,"error",r),$x(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}var s,n}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),op()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await xp(this.storage,this.storageKey);if(r&&this.userStorage){let t=await xp(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await hp(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Np()}else if(r&&!r.user&&!r.user){const e=await xp(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(r.user=e.user,await pp(this.storage,this.storageKey+"-user"),await hp(this.storage,this.storageKey,r)):r.user=Np()}if(this._debug(s,"session from storage",r),!this._isValidSession(r))return this._debug(s,"session is not valid"),void(null!==r&&await this._removeSession());const a=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<Ix;if(this._debug(s,`session has${a?"":" not"} expired with margin of 90000s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),Gx(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null==e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(s,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(s,"error",r),void console.error(r)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new qx;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new mp;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new qx;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(r){if(this._debug(n,"error",r),$x(r)){const e={session:null,error:r};return Gx(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],r=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(r){n.push(r)}});if(await Promise.all(r),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await hp(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=kp(e);await hp(this.storage,this.storageKey,n)}else{const e=kp(t);await hp(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await pp(this.storage,this.storageKey),await pp(this.storage,this.storageKey+"-code-verifier"),await pp(this.storage,this.storageKey+"-user"),this.userStorage&&await pp(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&op()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Dx);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*s.expires_at-t)/Dx);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof zp))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!op()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await vp(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);n.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;return r?{data:null,error:r}:await Sp(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(t){if($x(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:r,error:a}=t;if(a)return{data:null,error:a};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:o}=await Sp(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:("totp"===e.factorType&&(null===(n=null==l?void 0:l.totp)||void 0===n?void 0:n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if($x(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;if(r)return{data:null,error:r};const{data:a,error:i}=await Sp(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:i})})}catch(t){if($x(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;return r?{data:null,error:r}:await Sp(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(t){if($x(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],n=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),r=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:n,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:r}=e;if(r)return{data:null,error:r};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=gp(n.access_token);let i=null;a.aal&&(i=a.aal);let l=i;(null!==(s=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(l="aal2");return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:a.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(t=>t.kid===e),s&&this.jwks_cached_at+6e5>n)return s;const{data:r,error:a}=await Sp(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return r.keys&&0!==r.keys.length?(this.jwks=r,this.jwks_cached_at=n,s=r.keys.find(t=>t.kid===e),s||null):null}async getClaims(e,t={}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:n,payload:r,signature:a,raw:{header:i,payload:l}}=gp(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(r.exp);const o=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!o){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:r,header:n,signature:a},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),d=await crypto.subtle.importKey("jwk",o,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,d,a,ip(`${i}.${l}`))))throw new Yx("Invalid JWT signature");return{data:{claims:r,header:n,signature:a},error:null}}catch(s){if($x(s))return{data:null,error:s};throw s}}}Vp.nextInstanceID=0;const Kp=Vp;class Gp extends Kp{constructor(e){super(e)}}var Jp=globalThis&&globalThis.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(r,a){function i(e){try{o(n.next(e))}catch(t){a(t)}}function l(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class Yp{constructor(e,t,s){var n,r,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=(l=e).endsWith("/")?l:l+"/";var l;const o=new URL(i);this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,d=function(e,t){var s,n;const{db:r,auth:a,realtime:i,global:l}=e,{db:o,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),l),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(n=null==l?void 0:l.headers)&&void 0!==n?n:{})}),accessToken:()=>Ax(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=s?s:{},{db:Fx,realtime:Ex,auth:Object.assign(Object.assign({},_x),{storageKey:c}),global:kx});this.storageKey=null!==(n=d.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(r=d.global.headers)&&void 0!==r?r:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=d.auth)&&void 0!==a?a:{},this.headers,d.global.fetch),this.fetch=Sx(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new ah(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new jx(this.storageUrl.href,this.headers,this.fetch,null==s?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new gu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Jp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:r,flowType:a,lock:i,debug:l},o,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Gp({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),o),storageKey:r,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:i,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Xh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const Xp=(e,t,s)=>new Yp(e,t,s);(function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Zp="https://jppujbttlrsobfwuzalw.supabase.co",em="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpwcHVqYnR0bHJzb2Jmd3V6YWx3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2Mjc3MDMsImV4cCI6MjA3MTIwMzcwM30.W-NgL1PIaAIUQfi5BtvFukSqLLG0ZPQDCKcs70sUaHY",tm=Xp(Zp,em),sm=Xp(Zp,em,{auth:{autoRefreshToken:!1,persistSession:!1}}),nm=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},rm=(...e)=>e.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),am=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var im={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=z.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:r="",children:a,iconNode:i,...l},o)=>z.createElement("svg",{ref:o,...im,width:t,height:t,stroke:e,strokeWidth:n?24*Number(s)/Number(t):s,className:rm("lucide",r),...!a&&!am(l)&&{"aria-hidden":"true"},...l},[...i.map(([e,t])=>z.createElement(e,t)),...Array.isArray(a)?a:[a]])),om=(e,t)=>{const s=z.forwardRef(({className:s,...n},r)=>{return z.createElement(lm,{ref:r,iconNode:t,className:rm(`lucide-${a=nm(e),a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...n});var a});return s.displayName=nm(e),s},cm=om("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),dm=om("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),um=om("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),hm=om("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),xm=om("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),pm=om("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),mm=om("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),gm=om("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),fm=om("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),bm=om("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),vm=om("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ym={color:"rgb(22 163 74 / var(--tw-text-opacity, 1))"},wm={filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"},jm={blueButton:{fontSize:"13px",fontWeight:"500",boxShadow:"rgba(95, 122, 143, 0.25) 0px 2px 3px, rgba(0, 0, 0, 0.11) -2px -2px 3px inset, rgba(255, 255, 255, 0.19) 2px 2px 3px inset"},whiteButton:{fontSize:"13px",fontWeight:"500",backgroundColor:"#F6F6F8",border:"none",boxShadow:"rgba(95, 122, 143, 0.25) 0px 1px 2px, rgb(255, 255, 255) 1px 1px 1px 0px inset"},disabledButton:{fontSize:"13px",fontWeight:"500",backgroundColor:"#F6F6F8",color:"#070F1A",border:"none",boxShadow:"rgba(95, 122, 143, 0.25) 0px 1px 2px, rgba(0, 0, 0, 0.03) -1px -1px 1px inset, rgb(255, 255, 255) 1px 1px 1px 0px inset"}},Nm={inputField:{fontSize:"13px",border:"none",boxShadow:"rgba(95, 122, 143, 0.25) 0px 1px 2px, rgba(0, 0, 0, 0.03) -1px -1px 1px inset, rgb(255, 255, 255) 1px 1px 1px 0px inset"}};
/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */if("undefined"!=typeof document){const e=document.createElement("style");e.textContent='\n  :root {\n    --accent-color: #0084FF;\n  }\n  \n  @keyframes blink {\n    0%, 50% { opacity: 1; }\n    51%, 100% { opacity: 0; }\n  }\n  \n  @keyframes pouring {\n    from {\n      background-position: 0 0;\n    }\n    to {\n      background-position: 100% 0;\n    }\n  }\n  \n  @keyframes flash {\n    0% {\n      background: linear-gradient(90deg, var(--accent-color, #0084FF) 0%, var(--accent-color, #0084FF) 40%, #ffffff 50%, var(--accent-color, #0084FF) 60%, var(--accent-color, #0084FF) 100%);\n      background-size: 200% 100%;\n      background-position: -200% 0;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n    }\n    100% {\n      background: linear-gradient(90deg, var(--accent-color, #0084FF) 0%, var(--accent-color, #0084FF) 40%, #ffffff 50%, var(--accent-color, #0084FF) 60%, var(--accent-color, #0084FF) 100%);\n      background-size: 200% 100%;\n      background-position: 200% 0;\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n    }\n  }\n  \n  .animate-flash {\n    color: var(--accent-color, #0084FF);\n    font-weight: 600;\n    animation: flash 4s linear infinite;\n  }\n\n  /* Анимации для кружков в плашке перехвата диалога */\n  @keyframes pulse-1 {\n    0%, 80%, 100% { opacity: 0.25; }\n    40% { opacity: 1; }\n  }\n  \n  @keyframes pulse-2 {\n    0%, 80%, 100% { opacity: 0.5; }\n    40% { opacity: 1; }\n  }\n  \n  @keyframes pulse-3 {\n    0%, 80%, 100% { opacity: 1; }\n    40% { opacity: 0.25; }\n  }\n\n  .animate-pulse-1 {\n    animation: pulse-1 2s linear infinite;\n  }\n  \n  .animate-pulse-2 {\n    animation: pulse-2 2s linear infinite 0.3s;\n  }\n  \n  .animate-pulse-3 {\n    animation: pulse-3 2s linear infinite 0.6s;\n  }\n  \n  /* Стили для поля поиска чата */\n  .chat-search-input {\n    border: 1px solid rgba(7, 15, 26, 0.1) !important;\n    background-color: white !important;\n    color: #8E8E93 !important;\n    transition: all 0.2s ease;\n  }\n  \n  .chat-search-input::placeholder {\n    color: #8E8E93 !important;\n  }\n  \n  .chat-search-input:focus {\n    outline: none !important;\n    border-color: transparent !important;\n    background-color: #F9FAFB !important;\n    color: #070F1A !important;\n    box-shadow: none !important;\n    ring: none !important;\n  }\n  \n  .chat-search-input:focus::placeholder {\n    color: #8E8E93 !important;\n  }\n  \n  /* Стили для иконок в выпадающем меню пользователя */\n  .user-dropdown button.group:hover img:not([style*="invert(27%)"]) {\n    filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%) !important;\n  }\n',document.head.appendChild(e)}const km=async()=>[],Fm=async()=>!1,_m=async()=>[],Em=async()=>!1,Cm=async()=>!1,Sm=async()=>null,Am={getChatHistory:async()=>[],saveMessage:async()=>null,clearChatHistory:async()=>!1},Tm=async()=>null,Dm=async()=>null,Im=async()=>null,Mm=async()=>null,Lm=()=>({selectedModel:"gigachat",temperature:.7,maxTokens:1e3,systemPrompt:"Вы - полезный AI-ассистент.",customInstructions:"",responseStyle:"balanced"}),Rm=async()=>null,Om={updateDialog:async(e,t)=>{try{const{data:s,error:n}=await tm.from("dialogs").update(t).eq("id",e).select().single();return n?(console.error("Error updating dialog:",n),null):s}catch(s){return console.error("Error updating dialog:",s),null}},getDialogs:async()=>{try{const{data:e,error:t}=await tm.from("dialogs").select("*").order("created_at",{ascending:!1});return t?(console.error("Error fetching dialogs:",t),[]):e||[]}catch(e){return console.error("Error fetching dialogs:",e),[]}},getDialogsByUser:async e=>{try{const{data:t,error:s}=await tm.from("dialogs").select("*").eq("user_id",e).order("created_at",{ascending:!1});return s?(console.error("Error fetching dialogs by user:",s),[]):t||[]}catch(t){return console.error("Error fetching dialogs by user:",t),[]}},createDialog:async e=>{try{const{data:t,error:s}=await tm.from("dialogs").insert(e).select().single();return s?(console.error("Error creating dialog:",s),null):t}catch(t){return console.error("Error creating dialog:",t),null}},createTestDialog:async(e,t)=>{try{const s={...t,user_id:e,is_test:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{data:n,error:r}=await tm.from("dialogs").insert(s).select().single();return r?(console.error("Error creating test dialog:",r),null):n}catch(s){return console.error("Error creating test dialog:",s),null}}},Pm={getStats:async()=>null,updateStats:async()=>null,getAggregates:async()=>null},$m="https://adaptoai.ru",Bm="/api/chat/message",zm="/api/widget/chat",Um=e=>{const t={id:e.id||`msg_${Date.now()}_${Math.random()}`,text:e.text||"",time:e.time||"Только что",timestamp:e.timestamp||Date.now(),isTyping:e.isTyping||!1};return e.type?(t.type=e.type,t.sender_role=e.sender_role||e.type):void 0!==e.isUser&&(t.type=e.isUser?"user":"assistant",t.sender_role=e.isUser?"user":"assistant"),(e.operatorId||e.operatorName)&&(t.operatorId=e.operatorId,t.operatorName=e.operatorName,t.sender=e.sender||"operator"),void 0!==e.isUser&&(t.isUser=e.isUser),t},qm=e=>"user"===e.type||!0===e.isUser,Wm=e=>"operator"===e.type||"operator"===e.sender_role,Hm=e=>"assistant"===e.type||!1===e.isUser&&"operator"!==e.type,Qm=e=>"system"===e.type||"system"===e.sender_role,Vm=e=>e.operatorName?e.operatorName:"user"===e.type?"Пользователь":"assistant"===e.type?"ИИ-ассистент":"operator"===e.type?"Оператор":"system"===e.type?"Система":"Неизвестно",Km=U.memo(({message:e,getMessageAlignment:t,getMessageOrder:s,getMessageStyle:n,getMessageFooter:r,aiAgentName:a})=>J.jsx("div",{className:`mb-4 ${t(e)}`,children:J.jsxs("div",{className:`max-w-[80%] ${s(e)}`,children:[J.jsx("div",{className:`flex ${t(e)} items-end`,children:J.jsx("div",{className:`max-w-[70%] p-3 text-[14px] ${n(e)}`,children:e.isTyping?J.jsx(ig,{}):e.text})}),r(e)]})})),Gm=U.memo(({messages:e,getMessageAlignment:t,getMessageOrder:s,getMessageStyle:n,getMessageFooter:r,aiAgentName:a,containerRef:i})=>{const[l,o]=U.useState({start:0,end:50}),[c,d]=U.useState(0),[u,h]=U.useState(80),x=U.useCallback(()=>{if(!i.current)return;const t=i.current.scrollTop,s=Math.floor(t/u),n=Math.min(s+Math.ceil(c/u)+10,e.length);o({start:s,end:n})},[c,u,e.length]);U.useEffect(()=>{if(!i.current)return;const e=()=>{const e=i.current.getBoundingClientRect();d(e.height)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),U.useEffect(()=>{if(i.current)return i.current.addEventListener("scroll",x),()=>{var e;return null==(e=i.current)?void 0:e.removeEventListener("scroll",x)}},[x]);const p=e.slice(l.start,l.end),m=l.start*u,g=e.length*u;return J.jsx("div",{style:{height:g,position:"relative"},children:J.jsx("div",{style:{transform:`translateY(${m}px)`},children:p.map((e,i)=>J.jsx(Km,{message:e,getMessageAlignment:t,getMessageOrder:s,getMessageStyle:n,getMessageFooter:r,aiAgentName:a},e.id))})})}),Jm={createLoadingMessage:(e="assistant",t=!1)=>Um({id:`loading_${Date.now()}_${Math.random()}`,type:e,text:"",time:"Только что",timestamp:Date.now(),isTyping:!0,isUser:t}),createErrorMessage:(e="Извините, произошла ошибка при обработке вашего запроса. Попробуйте еще раз.")=>Um({id:`error_${Date.now()}_${Math.random()}`,type:"assistant",text:e,time:"Только что",timestamp:Date.now()}),removeLoadingMessage:e=>e.filter(e=>!e.isTyping),addMessageAndRemoveLoading:(e,t)=>[...Jm.removeLoadingMessage(e),t],scrollToBottom:(e,t=100)=>{setTimeout(()=>{e&&e.current&&(e.current.scrollTop=e.current.scrollHeight)},t)},handleChatError:(e,t)=>{console.error("Chat error:",e);const s=e.message||"Произошла неизвестная ошибка";return t&&t(`❌ Ошибка: ${s}`),Jm.createErrorMessage()},saveMessageToDB:async(e,t,s,n,r)=>Jm.retryRequest(async()=>{await r.saveMessage(e,t,s,n)},{maxRetries:2,baseDelay:500,retryCondition:e=>!e.response||e.response.status>=500}).catch(e=>{console.warn("Failed to save message to DB after retries:",e)}),loadChatHistoryOptimized:async(e,t,s,n=1,r=50)=>{try{const a=await s.getHistory(e,t,n,r);return{messages:a||[],hasMore:(a||[]).length===r,page:n}}catch(a){return console.warn("Failed to load chat history:",a),{messages:[],hasMore:!1,page:1}}},debounce:(e,t)=>{let s;return function(...n){clearTimeout(s),s=setTimeout(()=>{clearTimeout(s),e(...n)},t)}},memoize:e=>{const t=new Map;return(...s)=>{const n=JSON.stringify(s);if(t.has(n))return t.get(n);const r=e(...s);return t.set(n,r),r}},retryRequest:async(e,t={})=>{const{maxRetries:s=3,baseDelay:n=1e3,maxDelay:r=1e4,backoffFactor:a=2,retryCondition:i=e=>!e.response||e.response.status>=500}=t;let l;for(let c=0;c<=s;c++)try{return await e()}catch(o){if(l=o,c===s||!i(o))throw o;const e=Math.min(n*Math.pow(a,c),r);console.warn(`Request failed (attempt ${c+1}/${s+1}), retrying in ${e}ms:`,o.message),await new Promise(t=>setTimeout(t,e))}throw l},retrySendMessage:async(e,t,s={})=>Jm.retryRequest(async()=>await e(t),{maxRetries:2,baseDelay:500,retryCondition:e=>!e.response||e.response.status>=500||"NETWORK_ERROR"===e.code||e.message.includes("timeout"),...s}),retryApiRequest:async(e,t={})=>Jm.retryRequest(e,{maxRetries:3,baseDelay:1e3,retryCondition:e=>!e.response||e.response.status>=500,...t}),retryWebSocketConnection:(e,t={})=>{const{maxRetries:s=5,baseDelay:n=2e3,onConnect:r=()=>{},onError:a=()=>{},onRetry:i=()=>{}}=t;let l=0;const o=()=>{try{const t=new WebSocket(e);return t.onopen=()=>{console.log("WebSocket connected successfully"),l=0,r(t)},t.onerror=e=>{if(console.error("WebSocket error:",e),a(e),l<s){l++;const e=n*Math.pow(2,l-1);console.log(`WebSocket retry ${l}/${s} in ${e}ms`),setTimeout(()=>{i(l),o()},e)}else console.error("WebSocket max retries exceeded")},t.onclose=e=>{if(!e.wasClean&&l<s){l++;const e=n*Math.pow(2,l-1);console.log(`WebSocket reconnecting ${l}/${s} in ${e}ms`),setTimeout(()=>{i(l),o()},e)}},t}catch(t){return console.error("WebSocket connection error:",t),a(t),null}};return o()}},Ym={isOnline:()=>navigator.onLine,KEYS:{OFFLINE_MESSAGES:"offline_messages",CHAT_HISTORY_CACHE:"chat_history_cache",NETWORK_STATUS:"network_status",LAST_SYNC:"last_sync"},saveOfflineMessage:(e,t="admin")=>{try{const s=Ym.getOfflineMessages(),n={...e,channel:t,timestamp:Date.now(),offline:!0,synced:!1};return s.push(n),localStorage.setItem(Ym.KEYS.OFFLINE_MESSAGES,JSON.stringify(s)),console.log("💾 Message saved offline:",n),n}catch(s){return console.error("Failed to save offline message:",s),null}},getOfflineMessages:()=>{try{const e=localStorage.getItem(Ym.KEYS.OFFLINE_MESSAGES);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to get offline messages:",e),[]}},clearOfflineMessages:()=>{try{localStorage.removeItem(Ym.KEYS.OFFLINE_MESSAGES),console.log("🧹 Offline messages cleared")}catch(e){console.error("Failed to clear offline messages:",e)}},syncOfflineMessages:async(e,t)=>{if(!Ym.isOnline())return void console.log("📴 Still offline, skipping sync");const s=Ym.getOfflineMessages();if(0===s.length)return void console.log("✅ No offline messages to sync");console.log(`🔄 Syncing ${s.length} offline messages...`);for(const a of s)try{if(a.synced)continue;await e(a),await t.saveMessage(a.userId||"offline_user",a.type||"user",a.text,a.channel||"admin"),a.synced=!0,a.syncedAt=Date.now(),console.log("✅ Message synced:",a.id)}catch(r){console.error("❌ Failed to sync message:",a.id,r)}localStorage.setItem(Ym.KEYS.OFFLINE_MESSAGES,JSON.stringify(s));const n=s.filter(e=>!e.synced);localStorage.setItem(Ym.KEYS.OFFLINE_MESSAGES,JSON.stringify(n)),console.log(`🎉 Sync completed. ${s.length-n.length} messages synced, ${n.length} remaining`)},cacheChatHistory:(e,t="admin")=>{try{const s={messages:e,channel:t,timestamp:Date.now(),version:"1.0"};localStorage.setItem(`${Ym.KEYS.CHAT_HISTORY_CACHE}_${t}`,JSON.stringify(s)),console.log(`💾 Chat history cached for ${t}:`,e.length,"messages")}catch(s){console.error("Failed to cache chat history:",s)}},getCachedChatHistory:(e="admin")=>{try{const t=localStorage.getItem(`${Ym.KEYS.CHAT_HISTORY_CACHE}_${e}`);if(!t)return null;const s=JSON.parse(t);return Date.now()-s.timestamp>864e5?(localStorage.removeItem(`${Ym.KEYS.CHAT_HISTORY_CACHE}_${e}`),null):(console.log(`📱 Using cached chat history for ${e}:`,s.messages.length,"messages"),s.messages)}catch(t){return console.error("Failed to get cached chat history:",t),null}},updateNetworkStatus:e=>{try{localStorage.setItem(Ym.KEYS.NETWORK_STATUS,JSON.stringify({isOnline:e,timestamp:Date.now()}))}catch(t){console.error("Failed to update network status:",t)}},getNetworkStatus:()=>{try{const e=localStorage.getItem(Ym.KEYS.NETWORK_STATUS);return e?JSON.parse(e):{isOnline:!0,timestamp:Date.now()}}catch(e){return console.error("Failed to get network status:",e),{isOnline:!0,timestamp:Date.now()}}}},Xm=4e3,Zm=1,eg=6e4,tg=10,sg=[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe/gi,/<object/gi,/<embed/gi],ng=new Map,rg=e=>{const t=[];if(!e||"string"!=typeof e)return t.push("Сообщение должно быть строкой"),{isValid:!1,errors:t};const s=e.trim();s.length<Zm&&t.push("Сообщение не может быть пустым"),s.length>Xm&&t.push(`Сообщение слишком длинное (максимум ${Xm} символов)`);for(const n of sg)if(n.test(s)){t.push("Сообщение содержит недопустимый контент");break}return{isValid:0===t.length,errors:t,sanitizedMessage:s}},ag=e=>{if(!e||"string"!=typeof e)return"";let t=e.replace(/<(?![\/]?(?:b|i|em|strong|br|p)(?:\s|>))/gi,"&lt;");return t=t.replace(new RegExp("(?<![\\/])(?:b|i|em|strong|br|p)(?=\\s|>)","gi"),e=>e.toLowerCase()),t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),t},ig=()=>J.jsx("div",{className:"flex items-center space-x-1",children:J.jsxs("div",{className:"flex space-x-1",children:[J.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),J.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),J.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),lg=e=>{const t=Date.now(),s=`user_${e}`;if(!ng.has(s))return ng.set(s,{count:1,resetTime:t+eg}),{allowed:!0,remaining:tg-1};const n=ng.get(s);return t>n.resetTime?(ng.set(s,{count:1,resetTime:t+eg}),{allowed:!0,remaining:tg-1}):n.count>=tg?{allowed:!1,remaining:0,resetTime:n.resetTime}:(n.count++,{allowed:!0,remaining:tg-n.count})};console.log("supabase:",tm),console.log("chatHistoryAPI:",Am),console.log("chatHistoryAPI.clearChatHistory:",Am.clearChatHistory);const og=({children:e,className:t="",onClick:s,disabled:n=!1,variant:r="default",size:a="default",type:i="button",...l})=>{const o={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},c={default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-[10px]",lg:"h-11 px-8 rounded-[10px]",icon:"h-10 w-10"},d=o[r]||o.default,u=c[a]||c.default;return J.jsx("button",{type:i,className:`inline-flex items-center justify-center rounded-[10px] font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background ${d} ${u} ${t}`,onClick:s,disabled:n,...l,children:e})},cg=({className:e="",type:t="text",style:s={},...n})=>J.jsx("input",{type:t,className:`flex h-[34px] w-full rounded-[10px] bg-transparent px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-[#070F1A]/60 focus:outline-none focus:ring-0 focus:placeholder:text-[#070F1A]/40 disabled:cursor-not-allowed disabled:opacity-50 ${e}`,style:{...Nm.inputField,...s},...n}),dg=({className:e="",style:t={},...s})=>J.jsx("textarea",{className:`flex min-h-[124px] w-full rounded-[10px] bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-[#070F1A]/60 focus:outline-none focus:ring-0 focus:placeholder:text-[#070F1A]/40 disabled:cursor-not-allowed disabled:opacity-50 ${e}`,style:{...Nm.inputField,...t},...s}),ug=({className:e="",...t})=>J.jsx("div",{className:`rounded-[15px] border bg-card text-card-foreground ${e}`,...t}),hg=({className:e="",...t})=>J.jsx("div",{className:`flex flex-col space-y-1.5 p-6 ${e}`,...t}),xg=({className:e="",...t})=>J.jsx("div",{className:`p-6 pt-0 ${e}`,...t});function pg(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function mg(){var e,t;U.useEffect(()=>{const e=document.createElement("style");return e.textContent="\n      @keyframes typing-bounce {\n        0%, 60%, 100% {\n          transform: translateY(0) scale(1);\n          opacity: 0.3;\n        }\n        30% {\n          transform: translateY(-12px) scale(1.1);\n          opacity: 1;\n        }\n      }\n      \n      input::placeholder {\n        opacity: 1;\n        transition: opacity 0.2s ease;\n      }\n      input:focus::placeholder {\n        opacity: 0.3;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const[s,n]=z.useState(!1),[r,a]=z.useState(null),[i,l]=z.useState(!0),[o,c]=z.useState(()=>localStorage.getItem("currentSection")||"main");z.useState(!1);const[d,u]=z.useState(null),[h,x]=z.useState(!1),p="operator"===(null==r?void 0:r.role),[m,g]=z.useState("login"),[f,b]=z.useState(0),[v,y]=z.useState(!1),[w,j]=z.useState(!1),[N,k]=z.useState(!1);z.useState(!1),z.useState(!1);const[F,_]=z.useState(!1),[E,C]=z.useState(""),[S,A]=z.useState(""),[T,D]=z.useState(!1),[I,M]=z.useState(!1),[L,R]=z.useState([]),[O,P]=z.useState(!1),$=z.useRef(null),[B,q]=z.useState(null),[W,H]=z.useState(""),[Q,V]=z.useState(""),[K,G]=z.useState(1);z.useState(0);const[Y,X]=z.useState([]),[Z,ee]=z.useState(null),[te,se]=z.useState(!0);z.useState(!1),z.useState(!1);const[ne,re]=z.useState(!1),[ae,ie]=z.useState(null),[le,oe]=z.useState(!1),[ce,de]=z.useState(!1);z.useState(!1);const[ue,he]=z.useState("personal"),[xe,pe]=z.useState(!1),[me,ge]=z.useState("light"),[fe,be]=z.useState(500),[ve,ye]=z.useState("monthly"),[we,je]=z.useState([]),[Ne,ke]=z.useState(null);z.useEffect(()=>{const e=e=>{Ne&&!e.target.closest(".relative")&&ke(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[Ne]),z.useEffect(()=>{(async()=>{var e;try{console.log("🔄 Проверка сессии Supabase...");const{data:{session:t},error:s}=await tm.auth.getSession();if(s)return console.error("❌ Ошибка получения сессии:",s),a(null),n(!1),void g("login");if(null==t?void 0:t.user){console.log("✅ Сессия активна, пользователь:",t.user);const{data:s,error:r}=await tm.from("users").select("*").eq("id",t.user.id).single();r?(console.warn("⚠️ Пользователь не найден в таблице users, используем данные из auth"),a({id:t.user.id,email:t.user.email,name:(null==(e=t.user.user_metadata)?void 0:e.name)||t.user.email,role:"user"})):a({...s,role:s.role||"user"}),n(!0),g("dashboard"),c("main")}else console.log("❌ Нет активной сессии"),a(null),n(!1),g("login")}catch(t){console.error("Ошибка инициализации авторизации:",t),a(null),n(!1),g("login")}finally{l(!1)}})()},[]),z.useEffect(()=>{const{data:{subscription:e}}=tm.auth.onAuthStateChange(async(e,t)=>{var r,i;if(console.log("🔄 Auth state changed:",e,(null==t?void 0:t.user)?"User: "+t.user.id:"No user"),"SIGNED_IN"===e&&(null==t?void 0:t.user)){console.log("✅ SIGNED_IN");try{console.log("🔍 Запрашиваем данные пользователя из таблицы users для ID:",t.user.id);const e=tm.from("users").select("*").eq("id",t.user.id).single(),s=new Promise((e,t)=>setTimeout(()=>t(new Error("Timeout")),3e3)),{data:i,error:l}=await Promise.race([e,s]);console.log("📊 Результат запроса к таблице users:",{userData:i,userError:l}),l?(console.warn("⚠️ Пользователь не найден в таблице users, используем данные из auth"),a({id:t.user.id,email:t.user.email,name:(null==(r=t.user.user_metadata)?void 0:r.name)||t.user.email,role:"user"})):(console.log("✅ Данные пользователя получены из таблицы users:",i),a({...i,role:i.role||"user"})),console.log("🔄 Устанавливаем isLoggedIn=true и переключаемся на dashboard"),n(!0),g("dashboard"),c("main")}catch(l){console.error("❌ Ошибка при получении данных пользователя:",l),console.log("🔄 Используем fallback на данные из auth"),a({id:t.user.id,email:t.user.email,name:(null==(i=t.user.user_metadata)?void 0:i.name)||t.user.email,role:"user"}),n(!0),g("dashboard"),c("main")}}else if("SIGNED_OUT"===e)a(null),n(!1),g("login");else if("USER_UPDATED"===e&&(null==t?void 0:t.user)&&(console.log("🔄 USER_UPDATED"),s)){const{data:e,error:s}=await tm.from("users").select("*").eq("id",t.user.id).single();!s&&e&&a({...e,role:e.role||"user"})}});return()=>{e.unsubscribe()}},[s]),z.useEffect(()=>{s&&r&&dr()},[s,r]),z.useEffect(()=>{const e=new URLSearchParams(window.location.search),t=e.get("token"),s=e.get("inviter");t&&s&&(wt(t),Nt(s),g("register-operator"))},[]),z.useEffect(()=>{if(s&&r&&"admin"===r.role&&"admin@adapto.ai"!==r.email){console.log("Исправляем роль пользователя с admin на user:",r.email);const e={...r,role:"user"};a(e),Oc('Роль пользователя исправлена на "user"')}},[s,r]);const Fe=(e,t,s="monthly")=>{t<500&&(t=500);const n={"Старт":2490,"Про":5490,"Бизнес":14990}[e]+3*((t-500)/5)*3;return"quarterly"===s?Math.round(.85*n):Math.round(n)},[_e,Ee]=z.useState("general"),[Ce,Se]=z.useState(!1),[Ae,Te]=z.useState(null),[De,Ie]=z.useState(!1),[Me,Le]=z.useState(null),[Re,Oe]=z.useState({x:0,y:0}),[Pe,$e]=z.useState(!1),[Be,ze]=z.useState(""),[Ue,qe]=z.useState(!1),[We,He]=z.useState(!1),[Qe,Ve]=z.useState(null),[Ke,Ge]=z.useState(null),[Je,Ye]=z.useState(null),[Xe,Ze]=z.useState("deals"),[et,tt]=z.useState("kanban"),[st,nt]=z.useState("newest"),[rt,at]=z.useState(null),[it,lt]=z.useState(!1),[ot,ct]=z.useState(null),[dt,ut]=z.useState({}),[ht,xt]=z.useState(!1),[pt,mt]=z.useState(null),[gt,ft]=z.useState(""),[bt,vt]=z.useState(""),[yt,wt]=z.useState(null),[jt,Nt]=z.useState(null),kt=(e,t="")=>{mt(e),ft(t||"")},Ft=()=>{if(!vi)return mt(null),void ft("");const e=(gt||"").trim();if(!e)return mt(null),void ft("");if("phone"===pt){if(!/^\+?[0-9\s()\-]{7,}$/.test(e))return mt(null),void ft("")}switch(pt){case"name":yi(t=>t?{...t,name:e}:t);break;case"phone":yi(t=>t?{...t,phone:e}:t);break;case"email":yi(t=>t?{...t,email:e}:t);break;case"address":yi(t=>t?{...t,address:e}:t);break;case"company":yi(t=>t?{...t,company:e}:t);break;case"notes":yi(t=>t?{...t,notes:e}:t)}mt(null),ft("")},_t=()=>{mt(null),ft("")},[Et,Ct]=z.useState(null),[St,At]=z.useState(!1),[Tt,Dt]=z.useState(!1),[It,Mt]=z.useState(!1);z.useState(!1),z.useState("");const[Lt,Rt]=z.useState({title:"",stage:"Новые",leadQuality:"warm",amount:"",client:{name:"",email:"",phone:"",company:"",address:""},notes:""}),[Ot,Pt]=z.useState({title:"",description:"",assignee:"ai",assigneeName:"ИИ-агент",priority:"medium",dueDate:"",dealId:"",notes:""});z.useState(null),z.useState(null);const[$t,Bt]=z.useState(null),[zt,Ut]=z.useState(null),[qt,Wt]=z.useState([]),[Ht,Qt]=z.useState("all"),[Vt,Kt]=z.useState([]),[Gt,Jt]=z.useState(!1),[Yt,Xt]=z.useState(""),[Zt,es]=z.useState(!1),[ts,ss]=z.useState(!1),[ns,rs]=z.useState(""),[as,is]=z.useState(!1),[ls,os]=z.useState(""),cs=(e,t)=>{ct(e),ut(s=>({...s,[e]:t}))},ds=e=>{if(rt){const t={...rt.client,[e]:dt[e]};at(e=>({...e,client:t})),tn(e=>e.map(e=>e.id===rt.id?{...e,client:t}:e)),rt.dialogId&&ps(t,rt.dialogId)}ct(null)},us=()=>{ct(null),ut({})},hs=e=>{rt&&(tn(t=>t.map(t=>t.id===rt.id?{...t,leadQuality:e}:t)),at(t=>({...t,leadQuality:e}))),xt(!1)},xs=async e=>{try{let n="cold";"taken"===e.status||"resolved_by_operator"===e.status?n="hot":"waiting"===e.status&&(n="warm");const a={title:`Лид из диалога: ${e.name||"Без имени"}`,description:`Автоматически создано из диалога. Источник: ${e.source}. Статус диалога: ${e.status}`,amount:0,currency:"RUB",stage:"Новые",probability:0,source:"chat_dialog",priority:"medium",lead_quality:n,has_contacts:!(!e.email&&!e.phone),is_resolved:!1,owner_type:e.assignedTo?"operator":"ai",owner_name:e.assignedTo?"Анна Петрова":"ИИ-агент",client_id:null,dialog_id:e.id};if(r)try{const s={id:Date.now().toString()};console.log("✅ Сделка создана в БД:",s);try{await Om.updateDialog(e.id,{is_added_to_crm:!0}),console.log("✅ Диалог помечен как добавленный в CRM")}catch(t){console.warn("⚠️ Не удалось пометить диалог как добавленный в CRM:",t)}const n={id:s.id,title:a.title,company:"",amount:a.amount,days:0,stage:a.stage,leadQuality:a.lead_quality,hasContacts:a.has_contacts,owner:a.owner_type,ownerName:a.owner_name,isResolved:a.is_resolved,client:{name:e.name||"",email:e.email||"",phone:e.phone||"",company:""},notes:a.description,createdDate:(new Date).toISOString().split("T")[0],lastContact:(new Date).toISOString().split("T")[0],dialogId:e.id};return tn(e=>[n,...e]),vc(t=>t.map(t=>t.id===e.id?{...t,isAddedToCRM:!0}:t)),yi(t=>t&&t.id===e.id?{...t,isAddedToCRM:!0}:t),C("Сделка создана из диалога"),_(!0),setTimeout(()=>_(!1),3e3),s}catch(s){console.error("❌ Ошибка создания сделки в БД:",s);const t={id:`local-${Date.now()}`,title:a.title,company:"",amount:a.amount,days:0,stage:a.stage,leadQuality:a.lead_quality,hasContacts:a.has_contacts,owner:a.owner_type,ownerName:a.owner_name,isResolved:a.is_resolved,client:{name:e.name||"",email:e.email||"",phone:e.phone||"",company:""},notes:a.description,createdDate:(new Date).toISOString().split("T")[0],lastContact:(new Date).toISOString().split("T")[0],dialogId:e.id};return console.log("⚠️ Создана локальная сделка:",t),tn(e=>[t,...e]),C("Сделка создана локально (ошибка БД)"),_(!0),setTimeout(()=>_(!1),3e3),t}}catch(s){console.error("Error creating deal from dialog:",s)}},ps=(e,t)=>{vc(s=>s.map(s=>s.id===t?{...s,name:e.name,email:e.email,phone:e.phone}:s)),tn(s=>s.map(s=>s.dialogId===t?{...s,client:{...s.client,name:e.name,email:e.email,phone:e.phone}}:s))},ms=async(e,t,s={})=>{var n;try{if(!(null==r?void 0:r.id))return;const i=bc.find(t=>t.id===e);if(!i)return;let l={};switch(t){case"created":l={dialogsTotal:pa.dialogsTotal+1,messagesTotal:pa.messagesTotal+((null==(n=i.messages)?void 0:n.length)||0)};break;case"taken":l={handoverTotal:pa.handoverTotal+1};break;case"resolved":l={resolvedTotal:pa.resolvedTotal+1};break;case"converted":l={convertedTotal:pa.convertedTotal+1};break;case"message_added":l={messagesTotal:pa.messagesTotal+1,avgMessagesPerDialog:Math.round((pa.messagesTotal+1)/Math.max(pa.dialogsTotal,1))}}ma(e=>({...e,...l}));try{await Pm.updateDialogMetrics(r.id,{dialogId:e,action:t,timestamp:(new Date).toISOString(),...s})}catch(a){console.warn("Failed to update dialog metrics in DB:",a)}}catch(i){console.error("Error updating dialog statistics:",i)}},[gs,fs]=z.useState(""),[bs,vs]=z.useState([]);z.useState(null);const[ys,ws]=z.useState(null),[js,Ns]=z.useState(!1),[ks,Fs]=z.useState(null),[_s,Es]=z.useState(null),[Cs,Ss]=z.useState(!1),[As,Ts]=z.useState({leadQuality:!1,contact:!1,owner:!1,sortOrder:!1,dealStage:!1,leadQualityDeal:!1}),[Ds,Is]=z.useState({deal:!1,task:!1}),Ms=e=>{Ts(t=>t[e]?{...t,[e]:!1}:{leadQuality:!1,contact:!1,owner:!1,sortOrder:!1,dealStage:!1,leadQualityDeal:!1,[e]:!0})},Ls=e=>{Is(t=>({...t,[e]:!t[e]}))};z.useEffect(()=>{const e=e=>{e.target.closest(".crm-dropdown")||Ts({leadQuality:!1,contact:!1,owner:!1,sortOrder:!1,dealStage:!1,leadQualityDeal:!1}),e.target.closest(".lead-quality-dropdown")||xt(!1),e.target.closest(".executor-dropdown")||Is({deal:!1,task:!1})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const Rs=()=>{rt&&(tn(e=>e.map(e=>e.id===rt.id?{...e,notes:Yt}:e)),at(e=>e?{...e,notes:Yt}:null),Jt(!1))},Os=()=>{Xt((null==rt?void 0:rt.notes)||""),Jt(!0)},Ps=()=>{Jt(!1),Xt("")},$s=(e,t)=>{vs(s=>s.map(s=>s.id===e?{...s,...t}:s))},Bs=e=>{ws(e),Ns(!0),fs(e.notes||""),es(!1)},zs=()=>{es(!0),fs(ys.notes||"")},Us=()=>{es(!1),fs(ys.notes||"")},qs=()=>{ys&&($s(ys.id,{notes:gs}),ws({...ys,notes:gs}),es(!1))},Ws=()=>{ss(!0),rs(ys.dueDate||"")},Hs=()=>{ss(!1),rs(ys.dueDate||"")},Qs=()=>{ys&&($s(ys.id,{dueDate:ns}),ws({...ys,dueDate:ns}),ss(!1))},Vs=()=>{is(!0),os(ys.description||"")},Ks=()=>{is(!1),os(ys.description||"")},Gs=()=>{ys&&($s(ys.id,{description:ls}),ws({...ys,description:ls}),is(!1))},Js=e=>bs.filter(t=>t.status===e),Ys=()=>{Es(null)},Xs=()=>{Fs(null),Es(null),Ss(!1)},Zs=()=>en.filter(e=>!(qt.length>0&&!qt.includes(e.leadQuality))&&(!("with_contacts"===Ht&&!e.hasContacts)&&(("without_contacts"!==Ht||!e.hasContacts)&&!(Vt.length>0&&!Vt.includes(e.owner))))),[en,tn]=z.useState([]),[sn,nn]=z.useState([]),[rn,an]=z.useState(!1),[ln,on]=z.useState(null),[cn,dn]=z.useState(""),[un,hn]=z.useState(!1),[xn,pn]=z.useState(!1),[mn,gn]=z.useState(null);z.useState("new_messages");const[fn,bn]=z.useState({name:"",email:"",company:"",phone:"",newPassword:"",confirmPassword:""}),[vn,yn]=z.useState({name:(null==r?void 0:r.name)||"",email:(null==r?void 0:r.email)||"",company:(null==r?void 0:r.company_name)||"",phone:(null==r?void 0:r.phone)||""});z.useEffect(()=>{r&&(bn({name:r.name||"",email:r.email||"",company:r.company_name||"",phone:r.phone||"",newPassword:"",confirmPassword:""}),yn({name:r.name||"",email:r.email||"",company:r.company_name||"",phone:r.phone||""}))},[r]);const[wn,jn]=z.useState({daysRemaining:7,tokensRemaining:1e3,tokensUsed:0,totalTokens:1e3,tierType:"free",isExpired:!1}),Nn=z.useRef(null),kn=z.useRef(null);let Fn=0;const _n=()=>{const e=Date.now();return e<=Fn?Fn+=1:Fn=e,Fn};z.useEffect(()=>{"my-adapto"===o&&Nn.current?Jm.scrollToBottom(Nn,500):"widget-dev"===o&&kn.current&&Jm.scrollToBottom(kn,500)},[o]),z.useEffect(()=>{("notifications"===ue||"notifications"===o)&&s&&r&&pr()},[ue,o,s,r]),z.useEffect(()=>{"messengers"===o&&s&&r&&cr()},[o,s,r]),z.useEffect(()=>{"model-extensions"===o&&s&&vr()},[o,s]);const[En,Cn]=z.useState({hasAccess:!0,isExpired:!1,reason:null}),[Sn,An]=z.useState(!1),[Tn,Dn]=z.useState(!1),[In,Mn]=z.useState(null),[Ln,Rn]=z.useState([{id:"widget",name:"Виджет на сайт",description:"Настройте виджет и вставьте скрипт на сайт",icon:"group-36.svg",installed:!1},{id:"whatsapp",name:"WhatsApp",description:"Подключите ИИ-бота к WhatsApp Business",icon:"group-37.svg",installed:!1},{id:"telegram",name:"Telegram",description:"Подключите ИИ-бота к Telegram",icon:"group-38.svg",installed:!1},{id:"vk",name:"Вконтакте",description:"Установите в своем сообществе ИИ-агента",icon:"group-39.svg",installed:!1},{id:"bitrix",name:"Битрикс24",description:"Подключите CRM для передачи лидов",icon:"group-41.svg",installed:!1},{id:"amo",name:"amoCRM",description:"Подключите CRM для передачи лидов",icon:"group-42.svg",installed:!1},{id:"instagram",name:"Instagram*",description:"Внедрите ИИ-бота прямиком в Директ",icon:"group-43.svg",installed:!1},{id:"yclients",name:"Yclients",description:"Интегрируйте Adapto в Yclients",icon:"group-40.svg",installed:!1}]),[On,Pn]=z.useState(!1),[$n,Bn]=z.useState(null),[zn,Un]=z.useState(!1),[qn,Wn]=z.useState(!1),[Hn,Qn]=z.useState(300),[Vn,Kn]=z.useState({email:"",password:"",name:"",company:"",phone:"",companyField:""}),[Gn,Jn]=z.useState({}),[Yn,Xn]=z.useState({}),Zn=e=>{"super_admin"===(null==r?void 0:r.role)||"admin"===(null==r?void 0:r.role)?"operator"===e?(d||u(r),a({...r,role:"operator"})):"admin"===e?d?(a(d),u(null)):a({...r,role:"admin"}):"user"===e&&a({...r,role:"user"}):Oc("У вас нет прав для переключения ролей")},er=async e=>{const t=bc.find(t=>t.id===e);if(t&&t.assignedTo&&t.assignedTo!==(null==r?void 0:r.id))return C("Диалог уже перехвачен другим оператором"),_(!0),void setTimeout(()=>_(!1),3e3);const s={id:`takeover_${e}_${Date.now()}`,type:"system",sender_role:"system",text:`Диалог перехвачен оператором ${(null==r?void 0:r.email)||"Оператор"}`,time:"только что",timestamp:Date.now(),isSystemMessage:!0};vc(t=>t.map(t=>t.id===e?{...t,status:"taken",assignedTo:(null==r?void 0:r.id)||"current_operator",canTakeover:!1,need_handover:!1,lastMessage:"Диалог взят в работу",messages:[...t.messages||[],s],isOperatorActive:!0,operatorId:(null==r?void 0:r.id)||"current_operator"}:t)),yi(t=>t&&t.id===e?{...t,status:"taken",assignedTo:(null==r?void 0:r.id)||"current_operator",canTakeover:!1,need_handover:!1,messages:[...t.messages||[],s],isOperatorActive:!0,operatorId:(null==r?void 0:r.id)||"current_operator"}:t);try{Om.updateDialog(e,{status:"taken",assigned_to:(null==r?void 0:r.id)||null,need_handover:!1,last_message_at:(new Date).toISOString()})}catch(n){console.warn("Failed to sync takeover to DB:",n)}if(t&&(t.email||t.phone))try{await xs(t),console.log("✅ Лид автоматически создан в CRM при перехвате диалога:",e)}catch(a){console.warn("⚠️ Не удалось автоматически создать лид в CRM при перехвате:",a)}if(await ms(e,"taken",{operatorId:null==r?void 0:r.id,channel:(null==t?void 0:t.channel)||(null==t?void 0:t.source)}),t){const s=`🤖 Диалог ID: ${e}\n👤 Клиент: ${t.user||"Неизвестно"}\n📞 ${t.phone||t.email||"Нет контактов"}\n⚡ Статус: Перехвачен оператором`;fr(s,"operator_takeover")}},tr=async(e,t,s=!1)=>{const n=e.includes("Виджет")?"widget":e.includes("Тестирование")?"admin":e;let a=bc.find(e=>e.isTest&&e.source===n&&"admin"===e.owner&&("active"===e.status||"waiting"===e.status));if(!a&&(null==r?void 0:r.id))try{const e=await Om.getDialogsByUser(r.id);a=e.find(e=>e.isTest&&e.source===n&&"admin"===e.owner&&("active"===e.status||"waiting"===e.status)),a&&!bc.find(e=>e.id===a.id)&&vc(e=>[a,...e])}catch(o){console.warn("Failed to check existing dialogs in DB:",o)}if(a){const e=a.messages||[],n=e.some(e=>e.text===t&&!0===e.isUser&&Date.now()-(e.id||0)<5e3),i={...a,lastMessage:t,time:"Только что",lastContact:(new Date).toISOString(),need_handover:s||a.need_handover,status:s?"waiting":a.status,priority:s?"high":a.priority,messages:n?e:[...e,{id:Date.now(),text:t,isUser:!0,time:"Только что"}],messageCount:n?a.messageCount:(a.messageCount||0)+1};if(vc(e=>e.map(e=>e.id===a.id?i:e)),yi(e=>e&&e.id===a.id?i:e),!n)try{await Am.saveMessage(r.id,"user",t,"widget")}catch(c){console.warn("Failed to save message to DB:",c)}return console.log("Существующий тестовый диалог обновлен:",a.id),i}const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),l={id:i,client:{name:"Тестовый пользователь",email:null,phone:null,company:"Тестовая компания"},title:`Тест: "${t.substring(0,30)}${t.length>30?"...":""}"`,stage:"Новый",leadQuality:"Горячий",amount:0,days:0,hasContacts:!0,owner:"admin",ownerName:"Администратор",isResolved:!1,notes:`Тестовый диалог из раздела "${e}". Первое сообщение: "${t}"`,createdDate:(new Date).toISOString(),lastContact:(new Date).toISOString(),dialogId:i,status:s?"waiting":"active",assignedTo:null,canTakeover:!0,need_handover:s,priority:s?"high":"low",isTest:!0,lastMessage:t,user:"Тестовый пользователь",email:null,phone:null,source:e.includes("Виджет")?"widget":e.includes("Тестирование")?"admin":e,time:"Только что",messages:[{id:1,text:t,isUser:!0,time:"Только что"}],messageCount:1};try{if(null==r?void 0:r.id){const e=await Om.createTestDialog(r.id,l);if(e&&e.id){l.id=e.id,l.dialogId=e.id;try{await Am.saveMessage(r.id,"user",t,"widget")}catch(c){console.warn("Failed to save message to DB:",c)}}}console.log("Новый тестовый диалог создан:",i)}catch(o){console.error("Ошибка при сохранении тестового диалога:",o)}if(vc(e=>[l,...e]),ki("all"),l.email||l.phone)try{await xs(l),console.log("✅ Лид автоматически создан в CRM для диалога:",l.id)}catch(o){console.warn("⚠️ Не удалось автоматически создать лид в CRM:",o)}return await ms(l.id,"created",{source:l.source,needHandover:s}),l},sr=Jm.debounce(e=>{Ci(e)},300),nr=Jm.memoize(()=>{let e=bc;if("active"===Ni?e=p?e.filter(e=>"taken"===e.status&&e.assignedTo===((null==r?void 0:r.id)||"current_operator")):e.filter(e=>"active"===e.status||"waiting"===e.status):"closed"===Ni&&(e=e.filter(e=>"closed"===e.status||"resolved"===e.status||"resolved_by_operator"===e.status)),"all"!==Fi&&(e=e.filter(e=>(e.channel||e.source)===Fi)),Ei.trim()){const t=Ei.toLowerCase().trim();e=e.filter(e=>!(!e.user||!e.user.toLowerCase().includes(t))||(!(!e.email||!e.email.toLowerCase().includes(t))||(!(!e.lastMessage||!e.lastMessage.toLowerCase().includes(t))||!(!e.messages||!e.messages.some(e=>e.text&&e.text.toLowerCase().includes(t))))))}return e}),rr=Jm.memoize(e=>qm(e)||Wm(e)?"flex justify-end":"flex justify-start"),ar=Jm.memoize(e=>qm(e)||Wm(e)?"order-2":"order-1"),ir=Jm.memoize(e=>qm(e)?"bg-blue-600 text-white rounded-[20px] rounded-br-[4px]":Wm(e)?"bg-green-600 text-white rounded-[20px] rounded-br-[4px]":Qm(e)?"bg-gray-400 text-white rounded-[20px] rounded-bl-[4px]":(Hm(e),"bg-[#EFEFEF] text-[#070F1A] rounded-[20px] rounded-bl-[4px]")),lr=Jm.memoize(e=>Hm(e)?J.jsx("div",{className:"mt-[5px] ml-11",children:J.jsxs("p",{className:"text-[9px] text-[#8E8E93]",children:[Vi," • ",e.time||"Только что"]})}):Wm(e)?J.jsx("div",{className:"mt-[5px] mr-11 text-right",children:J.jsxs("p",{className:"text-[9px] text-[#8E8E93]",children:[Vm(e)," • ",e.time||"Только что"]})}):Qm(e)?J.jsx("div",{className:"mt-[5px] ml-11",children:J.jsxs("p",{className:"text-[9px] text-[#8E8E93]",children:["Система • ",e.time||"Только что"]})}):null),or=async()=>{if(!(null==r?void 0:r.id)||!(null==vi?void 0:vi.id))return;const e=rg(wi);if(!e.isValid)return void Oc(`❌ Ошибка валидации: ${e.errors.join(", ")}`);const t=lg(r.id);if(!t.allowed){const e=new Date(t.resetTime).toLocaleTimeString();return void Oc(`❌ Слишком много сообщений. Попробуйте снова в ${e}`)}const s=ag(e.sanitizedMessage);try{const e=Um({id:`operator_${Date.now()}_${Math.random()}`,text:s,type:"operator",sender_role:"operator",isUser:!1,sender:"operator",time:"Только что",timestamp:_n(),operatorId:(null==r?void 0:r.id)||"current_operator",operatorName:(null==r?void 0:r.email)||"Оператор"});yi(t=>t?{...t,messages:[...t.messages||[],e],lastMessage:wi,time:"Только что"}:t),vc(t=>t.map(t=>t.id===vi.id?{...t,messages:[...t.messages||[],e],lastMessage:wi,time:"Только что"}:t)),await Am.saveMessage(r.id,"operator",wi,"dialog"),ji(""),await ms(vi.id,"message_added",{senderType:"operator",messageLength:wi.length}),Oc("Сообщение отправлено")}catch(n){console.error("Error sending dialog message:",n),Oc("Ошибка при отправке сообщения")}},cr=async()=>{if(null==r?void 0:r.id)try{const e=await fetch(`${$m}/api/messenger/telegram/status?userId=${r.id}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();He(t.connected),Ve(t.stats)}}catch(e){console.error("Error loading Telegram bot status:",e)}},dr=async()=>{try{const e=await(async()=>{try{return au}catch(e){return console.error("Error fetching stories:",e),au}})();R(e)}catch(e){console.error("Ошибка при загрузке сторис:",e),R([{id:"1",title:"Возможности Adapto",image_url:"/Frame 137.png",order_index:1},{id:"2",title:"Обзор платформы",image_url:"/Frame 137-1.png",order_index:2},{id:"3",title:"История Adapto",image_url:"/Frame 137-2.png",order_index:3},{id:"4",title:"Техническая поддержка",image_url:"/Frame 137-3.png",order_index:4},{id:"5",title:"Наш тг-канал",image_url:"/Frame 137-4.png",order_index:5}])}},ur=async(e,t)=>{try{await(async(e,t)=>{try{return console.log("Story updated:",e,t),{success:!0,data:t}}catch(s){return console.error("Error updating story:",s),{success:!1,error:s.message}}})(e,t),await dr(),q(null),Oc("Сторис обновлена успешно")}catch(s){console.error("Ошибка при обновлении сторис:",s),Oc("Ошибка при обновлении сторис")}},hr=async e=>{if(confirm("Вы уверены, что хотите удалить эту сторис?"))try{await(async e=>{try{return console.log("Story deleted:",e),{success:!0}}catch(t){return console.error("Error deleting story:",t),{success:!1,error:t.message}}})(e),await dr(),Oc("Сторис удалена успешно")}catch(t){console.error("Ошибка при удалении сторис:",t),Oc("Ошибка при удалении сторис")}},xr=async()=>{if(!cn.trim())return C("Введите API ключ"),_(!0),void setTimeout(()=>_(!1),3e3);if(!(null==r?void 0:r.id))return console.log("❌ Нет currentUser.id:",r),C("Ошибка аутентификации"),_(!0),void setTimeout(()=>_(!1),3e3);console.log("🔗 Подключаем Telegram с userId:",r.id),hn(!0);try{const t=await fetch(`${$m}/api/telegram/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:cn,userId:null==r?void 0:r.id})}),s=await t.json();if(s.success){pn(!0),await pr();try{(await fetch(`${$m}/api/telegram/link-user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:(null==mn?void 0:mn.chat_id)||"466811672",userId:null==r?void 0:r.id})})).ok&&(console.log("✅ User ID связан с Chat ID"),await pr())}catch(e){console.error("Ошибка связывания user_id с chat_id:",e)}C("Telegram бот успешно подключен!"),_(!0),setTimeout(()=>_(!1),3e3);const t="🎉 Telegram бот успешно подключен!\n\n✅ Настройки сохранены\n📱 Уведомления активированы\n🔔 Типы уведомлений: новые сообщения, перехваты оператором, критические уведомления, ежедневные отчеты\n\nСистема готова к работе!";await fr(t,"system_alerts")}else C(s.error||"Ошибка подключения"),_(!0),setTimeout(()=>_(!1),3e3)}catch(e){console.error("Ошибка подключения Telegram:",e),C("Ошибка подключения к серверу"),_(!0),setTimeout(()=>_(!1),3e3)}finally{hn(!1)}},pr=async()=>{try{const e=await fetch(`${$m}/api/telegram/settings?userId=${null==r?void 0:r.id}`),t=await e.json();t.success&&t.settings&&(gn(t.settings),pn(!0))}catch(e){console.error("Ошибка загрузки настроек Telegram:",e)}},mr=async(e,t)=>{try{const s=await fetch(`${$m}/api/telegram/settings`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==r?void 0:r.id,enabled:e,notificationTypes:t})}),n=await s.json();n.success&&(gn(n.settings),C("Настройки обновлены"),_(!0),setTimeout(()=>_(!1),3e3))}catch(s){console.error("Ошибка обновления настроек:",s)}},gr=async e=>{if(console.log("Toggle notification type:",e,"Current settings:",mn),!mn){console.log("No telegram settings found, creating default");const t=["new_messages","operator_takeover","system_alerts","daily_reports"],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];return void(await mr(!0,s))}const t=mn.notification_types||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];await mr(mn.enabled,s)},fr=async(e,t="operator_takeover")=>{try{console.log("📤 Отправляем Telegram уведомление:",{userId:null==r?void 0:r.id,type:t,message:e.substring(0,50)+"...",telegramSettings:mn}),mn&&mn.chat_id||(console.log("🔄 Перезагружаем настройки Telegram..."),await pr());const s=await fetch(`${$m}/api/telegram/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==r?void 0:r.id,message:e,type:t})}),n=await s.json();s.ok?console.log("✅ Telegram уведомление отправлено:",n):(console.error("❌ Ошибка отправки Telegram уведомления:",n),C(`Ошибка Telegram: ${n.error||s.statusText}`),_(!0),setTimeout(()=>_(!1),5e3))}catch(s){console.error("❌ Ошибка отправки Telegram уведомления:",s),C(`Ошибка Telegram: ${s.message}`),_(!0),setTimeout(()=>_(!1),5e3)}},br=async()=>{try{(await fetch(`${$m}/api/telegram/daily-report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==r?void 0:r.id})})).ok?Oc("Ежедневный отчет отправлен в Telegram"):Oc("Ошибка отправки отчета")}catch(e){console.error("Ошибка отправки ежедневного отчета:",e),Oc("Ошибка отправки отчета")}},vr=async()=>{try{const e=await fetch(`${$m}/api/autoswitch/settings`);if(e.ok){const t=await e.json();t.success&&Fc(t.settings)}}catch(e){console.error("Ошибка загрузки настроек автопереключения:",e)}},yr=()=>fn.name!==vn.name||fn.email!==vn.email||fn.company!==vn.company||fn.phone!==vn.phone||""!==fn.newPassword||""!==fn.confirmPassword,wr=async()=>{if(yr()){if(fn.newPassword&&fn.newPassword!==fn.confirmPassword)return C("Пароли не совпадают"),void _(!0);try{console.log("Сохранение личной информации:",fn),a(e=>({...e,name:fn.name,email:fn.email,company:fn.company,phone:fn.phone})),yn({name:fn.name,email:fn.email,company:fn.company,phone:fn.phone}),bn(e=>({...e,newPassword:"",confirmPassword:""})),C("Изменения сохранены"),_(!0)}catch(e){console.error("Ошибка сохранения:",e),C("Ошибка сохранения"),_(!0)}}},jr=e=>{const t=e.replace(/\D/g,"");return e?11!==t.length?"Номер телефона должен содержать 11 цифр":t.startsWith("7")?null:"Номер должен начинаться с 7":"Номер телефона обязателен"},Nr=e=>{if(!e)return{color:"#3B82F6",letter:"П"};const t=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16"],s=e.charAt(0).toUpperCase();return{color:t[e.charCodeAt(0)%t.length],letter:s}},[kr,Fr]=z.useState({task:"",mainGoal:"",mainGoalCustom:"",customGoal:"",dealCycle:"",targetAudience:"",addressing:"Вы",communicationStyle:"Профессиональный",restrictions:[],showCustomRestriction:!1,customRestriction:"",communicationSettings:[],showCustomCommunicationSetting:!1,customCommunicationSetting:"",dataCollection:[],showCustomData:!1,customData:"",clarificationQuestions:[],showCustomClarificationQuestion:!1,customClarificationQuestion:"",emojiUsage:"Никогда",editingStage:null,dialogStages:["🎯 УСТАНОВЛЕНИЕ КОНТАКТА: Поздоровайся тепло, представься как ИИ-помощник. Спроси имя клиента и как дела. Создай дружелюбную атмосферу.","🔍 ВЫЯСНЕНИЕ ПОТРЕБНОСТЕЙ: Задавай открытые вопросы о проблемах клиента, целях и ситуации. Уточни детали: бюджет, сроки, приоритеты.","💡 ПРЕЗЕНТАЦИЯ И ЗАКРЫТИЕ: Предложи решение на основе потребностей. Расскажи о преимуществах и выгодах. При возражениях - выясни причину и предложи альтернативы. Когда готов - подведи итоги и предложи оформить заказ."],dialogStagesModified:null,knowledgeItems:[],selectedKnowledgeType:null,knowledgeInput:"",modelProvider:"gigachat",modelName:"GigaChat:latest",systemPrompt:"",temperature:.7,maxTokens:1e3,customInstructions:"",enableRag:!0,enableValidation:!0,enableMonitoring:!0}),[_r,Er]=z.useState([{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?",time:"Только что",timestamp:Date.now()},{type:"user",text:"Привет! Расскажи о ваших услугах",time:"Только что",timestamp:Date.now()},{type:"assistant",text:"Конечно! Мы предоставляем широкий спектр услуг по разработке и поддержке IT-решений.",time:"1 мин назад",timestamp:Date.now()-6e4}]),[Cr,Sr]=z.useState(!1),[Ar,Tr]=z.useState(""),[Dr,Ir]=z.useState(""),[Mr,Lr]=z.useState([]);z.useState(new Set);const[Rr,Or]=z.useState(new Set),[Pr,$r]=z.useState(new Set),[Br,zr]=z.useState(!1),[Ur,qr]=z.useState(""),[Wr,Hr]=z.useState(!1),[Qr,Vr]=z.useState(!1),[Kr,Gr]=z.useState(!1),[Jr,Yr]=z.useState(!1),[Xr,Zr]=z.useState(!1),[ea,ta]=z.useState([]),[sa,na]=z.useState({type:"text",content:"",nicheId:""}),[ra,aa]=z.useState([]),[ia,la]=z.useState(""),[oa,ca]=z.useState([]),da=(e="")=>e||"Без ниши",ua=e=>{const t=ra.find(t=>t.id===e);return((e="")=>{const t=((e="")=>e.toLowerCase().trim())(e);return t.includes("детейлин")?"#56AAF7":t.includes("красот")||t.includes("уход")?"#FF6FAE":t.includes("образован")?"#FFA64D":t.includes("медицин")||t.includes("стоматолог")?"#0084FF":t.includes("ecom")||t.includes("e-comm")||t.includes("ecomm")||t.includes("интернет")&&t.includes("магаз")?"#8EE38A":t.includes("айти")||t.includes("it")||t.includes("дизайн")?"#8B5CF6":t.includes("маркетинг")||t.includes("реклам")?"#B19CD9":t.includes("детск")?"#FFD84D":t.includes("ресторан")?"#FF8A80":t.includes("отел")||t.includes("кемпинг")?"#34C759":t.includes("спорт")?"#FF3B30":"#E5E6E7"})((null==t?void 0:t.name)||"")};z.useEffect(()=>{(async()=>{try{const{data:e,error:t}=await tm.from("niches").select("id, name").order("name",{ascending:!0});t||aa(e||[])}catch(e){}})()},[]),z.useEffect(()=>{(async()=>{var e;try{if(!(null==r?void 0:r.id)||!(null==r?void 0:r.project_id))return;console.log("=== LOADING NICHE FROM USER_NICHES ==="),console.log("Current user ID:",r.id),console.log("Current project ID:",r.project_id);const{data:t,error:s}=await tm.from("user_niches").select("niche_id").eq("project_id",r.project_id).single();if(!s&&(null==t?void 0:t.niche_id))console.log("Niche loaded from user_niches:",t.niche_id),la(t.niche_id),na(e=>({...e,nicheId:t.niche_id}));else{console.log("Loading niche from agent settings as fallback");const t=await Tm(r.id),s=(null==t?void 0:t.niche_id)||(null==(e=null==t?void 0:t.settings)?void 0:e.nicheId)||"";s&&(console.log("Niche loaded from agent settings:",s),la(s),na(e=>({...e,nicheId:s})))}}catch(t){console.error("Error loading niche:",t)}})()},[null==r?void 0:r.id,null==r?void 0:r.project_id]),z.useEffect(()=>{ca([])},[ia]);const[ha,xa]=z.useState({}),[pa,ma]=z.useState({dialogsTotal:0,messagesTotal:0,resolvedTotal:0,handoverTotal:0,convertedTotal:0,avgMessagesPerDialog:0,conversionRate:0,widget_opens:0,bounce_rate:0,customer_engagement:0,resolved_questions:0,escalation_rate:0,avg_response_time:0,avg_resolution_time:0,ai_effectiveness_score:0,help_request_rate:0}),[ga,fa]=z.useState(null),[ba,va]=z.useState(!1),[ya,wa]=z.useState(!1),[ja,Na]=z.useState(!1),[ka,Fa]=z.useState(!1),[_a,Ea]=z.useState(!1),[Ca,Sa]=z.useState(null);z.useEffect(()=>{const e=e=>{ga&&!e.target.closest(".dropdown-menu")&&fa(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[ga]);const Aa=async()=>{if(console.log("=== LOAD DIALOGS DEBUG ==="),console.log("currentUser:",r),console.log("currentUser?.id:",null==r?void 0:r.id),console.log("currentUser?.email:",null==r?void 0:r.email),null==r?void 0:r.id)try{console.log("Загружаем диалоги для пользователя:",null==r?void 0:r.id);const t=(await Om.getDialogs(null==r?void 0:r.id,{limit:200})||[]).map(e=>({id:e.id,name:e.client_name||"Клиент",email:e.client_email||"",phone:e.client_phone||"",source:e.source||"admin",status:e.status||"active",assignedTo:e.assigned_to||null,need_handover:e.need_handover||!1,canTakeover:!1!==e.can_takeover,isTest:!!e.is_test,lastMessage:e.description||"",time:e.last_message_at?td(new Date(e.last_message_at).getTime()):"",messages:e.messages||[],channel:e.channel,assistant_id:e.assistant_id,session_persistent_id:e.session_persistent_id,user_id:e.user_id,is_operator_takeover:e.is_operator_takeover,operator_id:e.operator_id,takeover_at:e.takeover_at,uniqueKey:`${e.channel}_${e.user_id||e.assistant_id}_${e.session_persistent_id||e.id}`})),s=(e=>{const t=new Map;return e.forEach(e=>{const s=e.uniqueKey||`${e.channel}_${e.user_id}_${e.id}`;if(t.has(s)){const n=t.get(s),r=new Date(n.last_message_at||n.created_at||0).getTime();new Date(e.last_message_at||e.created_at||0).getTime()>r&&t.set(s,e)}else t.set(s,e)}),Array.from(t.values())})(t);console.log("Unique dialogs:",s.length,"from",t.length);const n=(e=>{const t={widget:[],telegram:[],whatsapp:[],vk:[],instagram:[],admin:[],other:[]};return e.forEach(e=>{const s=e.channel||e.source||"other";t[s]?t[s].push(e):t.other.push(e)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>{const s=new Date(e.last_message_at||e.created_at||0).getTime();return new Date(t.last_message_at||t.created_at||0).getTime()-s})}),t})(s);console.log("Grouped dialogs:",n),vc(s),wc(n);try{const e=await Pm.getAggregates(r.id,si.start,si.end);e&&ma(e)}catch(e){console.warn("Failed to load aggregates:",e)}const a=await Am.getChatHistory(null==r?void 0:r.id,"admin",50);console.log("Admin диалоги загружены:",a);const i=await Am.getChatHistory(null==r?void 0:r.id,"widget",50);console.log("Widget диалоги загружены:",i);const l=a.map(e=>({type:"user"===e.role?"user":"assistant",text:e.message_content,time:td(new Date(e.created_at).getTime()),timestamp:new Date(e.created_at).getTime(),id:`loaded_${e.id}_${Date.now()}`})).sort((e,t)=>(e.timestamp||0)-(t.timestamp||0)),o=i.map(e=>({id:e.id,text:e.message_content,isUser:"user"===e.role,time:td(new Date(e.created_at).getTime()),timestamp:new Date(e.created_at).getTime()})).sort((e,t)=>(e.timestamp||0)-(t.timestamp||0));console.log("Форматированные admin диалоги:",l),console.log("Форматированные widget диалоги:",o);const c=l.filter((e,t,s)=>s.findIndex(t=>t.text===e.text&&Math.abs(t.timestamp-e.timestamp)<1e3)===t),d=o.filter((e,t,s)=>s.findIndex(t=>t.text===e.text&&Math.abs(t.timestamp-e.timestamp)<1e3)===t);Er(c),il(d),Jm.scrollToBottom(Nn,200),Jm.scrollToBottom(kn,200),console.log("Диалоги успешно загружены и отформатированы")}catch(t){console.error("Ошибка при загрузке диалогов:",t)}else console.log("Нет currentUser?.id, выходим")};z.useEffect(()=>{const e=()=>{console.log("🌐 Network online - starting sync"),Ai(!0),Mi(!1),Ym.updateNetworkStatus(!0),Ym.syncOfflineMessages(async e=>"admin"===e.channel?await ed(e.text,e.userId,e.assistantId,[]):"widget"===e.channel?await fetch(`${$m}${zm}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:`adapto_${e.userId}_${Date.now()}`,message:e.text,conversationHistory:[]})}):void 0,Am)},t=()=>{console.log("📴 Network offline"),Ai(!1),Mi(!0),Ym.updateNetworkStatus(!1)},s=()=>{const e=Ym.getOfflineMessages();Di(e.filter(e=>!e.synced).length)};window.addEventListener("online",e),window.addEventListener("offline",t),s();const n=setInterval(s,5e3);return()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t),clearInterval(n)}},[null==r?void 0:r.id]),z.useEffect(()=>{if(!(null==r?void 0:r.id))return;let e=null,t=null,s=!1;const n=()=>{console.log("🔄 Запускаем HTTP polling как fallback для WebSocket"),t=setInterval(async()=>{try{const e=await fetch(`${$m}/api/dialogs?userId=${r.id}`);if(e.ok){const t=await e.json();t.dialogs&&t.dialogs.length>0&&setDialogs(e=>JSON.stringify(e)!==JSON.stringify(t.dialogs)?t.dialogs:e)}}catch(e){console.warn("⚠️ Ошибка HTTP polling:",e)}},5e3)},a=()=>{t&&(clearInterval(t),t=null,console.log("🛑 HTTP polling остановлен"))};return console.log("🔄 Пытаемся подключиться к WebSocket..."),(()=>{try{const t=`wss://adaptoai.ru/api/websocket?userId=${r.id}`;console.log(`🔌 Подключаемся к WebSocket: ${t}`),e=new WebSocket(t),e.onopen=()=>{console.log("✅ WebSocket подключен успешно"),s=!0,a(),e.send(JSON.stringify({type:"subscribe",channel:"dialogs"}))},e.onmessage=e=>{try{const t=JSON.parse(e.data);switch(console.log("📨 WebSocket сообщение:",t),t.type){case"connected":console.log("✅ WebSocket подтверждение подключения");break;case"subscribed":console.log("✅ Подписка на канал подтверждена");break;case"dialog_update":console.log("🔄 Обновление диалога через WebSocket"),Aa();break;case"new_message":console.log("💬 Новое сообщение через WebSocket"),Aa();break;case"pong":console.log("🏓 Pong получен");break;default:console.log("❓ Неизвестный тип сообщения:",t.type)}}catch(t){console.error("Ошибка парсинга WebSocket сообщения:",t)}},e.onclose=e=>{console.log("🔌 WebSocket соединение закрыто:",e.code,e.reason),s=!1,n()},e.onerror=e=>{console.error("❌ WebSocket ошибка:",e),s=!1,n()}}catch(t){console.error("❌ Ошибка создания WebSocket соединения:",t),n()}})(),setTimeout(()=>{s||(console.log("🔄 WebSocket не подключился, используем HTTP polling"),n())},3e3),()=>{e&&e.close(),a()}},[null==r?void 0:r.id]),z.useEffect(()=>{(null==r?void 0:r.id)&&(Aa(),Cn({hasAccess:!0,isExpired:!1,reason:null}))},[r]),z.useEffect(()=>{const e=e=>{xe&&!e.target.closest(".user-dropdown")&&pe(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[xe]),z.useEffect(()=>{s&&r&&"login"===m&&(console.log("✅ Пользователь уже вошел, переключаемся на dashboard"),g("dashboard"))},[s,r,m]);const Ta=["/Frame 126.png","/Frame 127.png","/Frame 128.png","/Frame 129.png","/Frame 130.png"];z.useEffect(()=>{if("login"===m||"register"===m){console.log("Слайдер активен, текущий слайд:",f,"URL:",Ta[f]);const e=setInterval(()=>{y(!0),setTimeout(()=>{b(e=>(e+1)%5),y(!1)},300)},4500);return()=>clearInterval(e)}},[m,f]);const[Da,Ia]=z.useState("full"),[Ma,La]=z.useState(""),[Ra,Oa]=z.useState([""]),[Pa,$a]=z.useState(""),[Ba,za]=z.useState([""]),[Ua,qa]=z.useState(""),[Wa,Ha]=z.useState(""),[Qa,Va]=z.useState([]),[Ka,Ga]=z.useState([]),[Ja,Ya]=z.useState(""),[Xa,Za]=z.useState(""),[ei,ti]=z.useState(!1);z.useState(!1);const[si,ni]=z.useState({start:null,end:null}),[ri,ai]=z.useState(new Date);z.useState([]);const[ii,li]=z.useState(null),[oi,ci]=z.useState(""),[di,ui]=z.useState(""),[hi,xi]=z.useState(!1),[pi,mi]=z.useState(!1),gi=e=>{const t=(e||"").replace(/\D/g,"").slice(0,8);let s=t;return t.length>4?s=`${t.slice(0,2)}.${t.slice(2,4)}.${t.slice(4)}`:t.length>2&&(s=`${t.slice(0,2)}.${t.slice(2)}`),s},fi=e=>{const t=/^([0-3]\d)\.([0-1]\d)\.(\d{4})$/.exec(e);if(!t)return!1;const s=parseInt(t[1],10),n=parseInt(t[2],10),r=parseInt(t[3],10);if(n<1||n>12)return!1;if(s<1||s>31)return!1;const a=new Date(r,n-1,s);return a.getFullYear()===r&&a.getMonth()===n-1&&a.getDate()===s},bi=e=>{if(!fi(e))return null;const[t,s,n]=e.split(".").map(e=>parseInt(e,10));return new Date(n,s-1,t)},[vi,yi]=z.useState(null),[wi,ji]=z.useState(""),[Ni,ki]=z.useState("all"),[Fi,_i]=z.useState("all"),[Ei,Ci]=z.useState("");z.useState("chats");const[Si,Ai]=z.useState(navigator.onLine),[Ti,Di]=z.useState(0),[Ii,Mi]=z.useState(!1),[Li,Ri]=z.useState({sections:!1,styling:!1,triggers:!1}),[Oi,Pi]=z.useState("main"),[$i,Bi]=z.useState(!0),[zi,Ui]=z.useState("default"),[qi,Wi]=z.useState(null),[Hi,Qi]=z.useState(""),[Vi,Ki]=z.useState("Адапто"),[Gi,Ji]=z.useState("none"),[Yi,Xi]=z.useState([]),[Zi,el]=z.useState("Отвечаем до 3-х минут"),[tl,sl]=z.useState(!0),[nl,rl]=z.useState("Доброго дня! Чем мы можем помочь?"),[al,il]=z.useState([{id:1,text:"Здравствуйте! Чем могу помочь?",isUser:!1,time:"Только что"}]);z.useEffect(()=>{"my-adapto"===o&&Nn.current&&Jm.scrollToBottom(Nn)},[_r,o]),z.useEffect(()=>{"widget-dev"===o&&kn.current&&Jm.scrollToBottom(kn)},[al,o]);const[ll,ol]=z.useState("before"),[cl,dl]=z.useState(!1),[ul,hl]=z.useState([]),[xl,pl]=z.useState([{id:1,type:"name",label:"Имя",placeholder:"Введите ваше имя",required:!0},{id:2,type:"email",label:"Эл. почта",placeholder:"Введите вашу почту",required:!0},{id:3,type:"phone",label:"Телефон",placeholder:"Введите ваш телефон",required:!1},{id:4,type:"company",label:"Название компании",placeholder:"Введите название компании",required:!1},{id:5,type:"position",label:"Должность",placeholder:"Введите вашу должность",required:!1},{id:6,type:"website",label:"Веб-сайт",placeholder:"Введите адрес сайта",required:!1},{id:7,type:"city",label:"Город",placeholder:"Введите ваш город",required:!1},{id:8,type:"age",label:"Возраст",placeholder:"Введите ваш возраст",required:!1}]),[ml,gl]=z.useState(""),[fl,bl]=z.useState("Пожалуйста заполните форму"),[vl,yl]=z.useState(30),[wl,jl]=z.useState(!1),[Nl,kl]=z.useState({}),[Fl,_l]=z.useState(null),[El,Cl]=z.useState(!1),[Sl,Al]=z.useState(!1),[Tl,Dl]=z.useState(!0),[Il,Ml]=z.useState("home"),[Ll,Rl]=z.useState(!1),[Ol,Pl]=z.useState(!1),[$l,Bl]=z.useState(!1),[zl,Ul]=z.useState(!1),[ql,Wl]=z.useState(null),[Hl,Ql]=z.useState(null),[Vl,Kl]=z.useState(!1),[Gl,Jl]=z.useState(!1),[Yl,Xl]=z.useState([{id:1,timeDelay:5,message:"У нас есть отличная акция",buttonText:"Расскажи подробнее"}]),[Zl,eo]=z.useState(!1),[to,so]=z.useState([{id:1,timeDelay:5,message:"Продолжим диалог?",buttonText:"Да"}]);z.useEffect(()=>{"before"!==ll||"chat"!==Il||wl||setTimeout(()=>{jl(!0)},100)},[ll,Il,wl]),z.useEffect(()=>{"timer"===ll&&Tl&&!Fl&&_l(Date.now())},[ll,Tl,Fl]),z.useEffect(()=>{if("timer"===ll&&Fl&&!wl){const e=setTimeout(()=>{"chat"===Il&&jl(!0)},1e3*vl);return()=>clearTimeout(e)}},[ll,Fl,wl,vl,Il]),z.useEffect(()=>{"home"===Il&&jl(!1)},[Il]),z.useEffect(()=>{"never"!==ll&&hl(e=>e.includes("phone")?e:[...e,"phone"])},[ll]),z.useEffect(()=>{if(Gl&&Yl.length>0&&!Tl&&!zl){const e=Yl[0],t=setTimeout(()=>{Ul(!0)},1e3*e.timeDelay);return()=>clearTimeout(t)}Tl&&zl&&Ul(!1)},[Gl,Yl,Tl,zl]),z.useEffect(()=>{if(Zl&&to.length>0&&ql&&!$l&&!Vl){const e=to[0],t=setTimeout(()=>{Bl(!0)},1e3*e.timeDelay);return()=>clearTimeout(t)}},[Zl,to,ql,$l,Vl]),z.useEffect(()=>{(async()=>{if(null==r?void 0:r.id)try{if(console.log("Загружаем настройки виджета для пользователя:",r.id),!Mc||"function"!=typeof Mc.getWidgetDevelopmentSettings)return void console.warn("widgetDevelopmentSettings не доступен, используем значения по умолчанию");const e=await Mc.getWidgetDevelopmentSettings(r.id);e?(console.log("Настройки виджета загружены из БД:",e),Lc(t=>({...t,accentColor:e.accent_color||t.accentColor,buttonColor:e.button_color||t.buttonColor,buttonText:e.button_text||t.buttonText,buttonSubtext:e.button_subtext||t.buttonSubtext,avatar:e.avatar||t.avatar,customButtonColor:e.custom_button_color||t.customButtonColor,widgetLocation:e.widget_location||t.widgetLocation,desktopBottomOffset:e.desktop_bottom_offset||t.desktopBottomOffset,desktopRightOffset:e.desktop_right_offset||t.desktopRightOffset,mobileBottomOffset:e.mobile_bottom_offset||t.mobileBottomOffset,mobileRightOffset:e.mobile_right_offset||t.mobileRightOffset,zIndex:e.z_index||t.zIndex,welcomeMessages:e.welcome_messages||t.welcomeMessages,triggerQuestion:e.trigger_question||t.triggerQuestion,triggerQuestionEnabled:e.trigger_question_enabled||t.triggerQuestionEnabled,triggerQuestionDelay:e.trigger_question_delay||t.triggerQuestionDelay,triggerQuestionText:e.trigger_question_text||t.triggerQuestionText,triggerQuickReply:e.trigger_quick_reply||t.triggerQuickReply,followUpMessage:e.follow_up_message||t.followUpMessage,followUpDelay:e.follow_up_delay||t.followUpDelay,followUpQuestion:e.follow_up_question||t.followUpQuestion,followUpQuickReply:e.follow_up_quick_reply||t.followUpQuickReply,quickReplies:e.quick_replies||t.quickReplies,privacyPolicyUrl:e.privacy_policy_url||t.privacyPolicyUrl,dataTags:e.data_tags||t.dataTags,excludedPages:e.excluded_pages||t.excludedPages,widgetMode:e.widget_mode||t.widgetMode,quickQuestions:e.quick_questions||t.quickQuestions,leadFormEnabled:e.lead_form_enabled||t.leadFormEnabled,leadFormTitle:e.lead_form_title||t.leadFormTitle,leadFormDescription:e.lead_form_description||t.leadFormDescription,leadFormFields:e.lead_form_fields||t.leadFormFields,widgetTheme:e.widget_theme||t.widgetTheme,widgetSize:e.widget_size||t.widgetSize,showAvatar:void 0!==e.show_avatar?e.show_avatar:t.showAvatar,showTypingIndicator:void 0!==e.show_typing_indicator?e.show_typing_indicator:t.showTypingIndicator,escalationEnabled:void 0!==e.escalation_enabled?e.escalation_enabled:t.escalationEnabled,escalationButtonText:e.escalation_button_text||t.escalationButtonText,escalationMessage:e.escalation_message||t.escalationMessage,escalationAutoAssign:void 0!==e.escalation_auto_assign?e.escalation_auto_assign:t.escalationAutoAssign,autoOpenOnScroll:void 0!==e.auto_open_on_scroll?e.auto_open_on_scroll:t.autoOpenOnScroll,autoOpenDelay:e.auto_open_delay||t.autoOpenDelay,showOnMobile:void 0!==e.show_on_mobile?e.show_on_mobile:t.showOnMobile,notificationSound:void 0!==e.notification_sound?e.notification_sound:t.notificationSound,notificationTitle:e.notification_title||t.notificationTitle,trackEvents:void 0!==e.track_events?e.track_events:t.trackEvents,trackConversions:void 0!==e.track_conversions?e.track_conversions:t.trackConversions,logoUrl:e.logo_url||t.logoUrl,logoName:e.logo_name||t.logoName,suggestions:e.suggestions||t.suggestions})),e.ai_agent_name&&Ki(e.ai_agent_name),void 0!==e.show_ai_label&&Bi(e.show_ai_label),e.logo_type&&Ui(e.logo_type),e.custom_logo&&Wi(e.custom_logo),e.custom_logo_name&&Qi(e.custom_logo_name),e.widget_title&&$o(e.widget_title),e.widget_description&&Go(e.widget_description),e.questions&&tc(e.questions),e.button_title&&Yo(e.button_title),e.button_description&&Zo(e.button_description),e.manager_photo_type&&Ji(e.manager_photo_type),e.manager_photos&&Xi(e.manager_photos),e.status_text&&el(e.status_text),void 0!==e.show_status&&sl(e.show_status),e.welcome_message&&rl(e.welcome_message),e.form_trigger&&ol(e.form_trigger),e.form_timer_seconds&&yl(e.form_timer_seconds),e.form_fields&&pl(e.form_fields),e.selected_form_fields&&hl(e.selected_form_fields),e.form_title&&bl(e.form_title),e.privacy_policy_link&&gl(e.privacy_policy_link),e.widget_theme&&ro(e.widget_theme),e.background_color&&io(e.background_color),void 0!==e.selected_gradient&&wo(e.selected_gradient),e.accent_color&&oo(e.accent_color),e.button_color&&uo(e.button_color),e.desktop_bottom_offset&&To(e.desktop_bottom_offset),e.desktop_right_offset&&Io(e.desktop_right_offset),e.mobile_bottom_offset&&Lo(e.mobile_bottom_offset),e.mobile_right_offset&&Oo(e.mobile_right_offset),void 0!==e.trigger_messages_enabled&&Jl(e.trigger_messages_enabled),e.trigger_messages&&Xl(e.trigger_messages),e.follow_up_messages&&so(e.follow_up_messages),e.quick_replies&&Lc(t=>({...t,quickReplies:e.quick_replies})),console.log("Настройки виджета обновлены")):console.log("Настройки виджета не найдены в БД, используем значения по умолчанию")}catch(e){console.error("Ошибка при загрузке настроек виджета:",e)}})()},[null==r?void 0:r.id]);const[no,ro]=z.useState("white"),[ao,io]=z.useState("linear-gradient(30deg, #52AEFF 0%, #096EFD 100%)"),[lo,oo]=z.useState("#0084FF"),[co,uo]=z.useState("#0084FF"),[ho,xo]=z.useState(!0),[po,mo]=z.useState("Поговорить с человеком"),[go,fo]=z.useState("Ваш запрос передан оператору. Ожидайте ответа."),[bo,vo]=z.useState(!0);z.useEffect(()=>{document.documentElement.style.setProperty("--accent-color",lo)},[lo]);const[yo,wo]=z.useState(1),[jo,No]=z.useState({background:!1,accent:!1,button:!1}),[ko,Fo]=z.useState(0),[_o,Eo]=z.useState(100),[Co,So]=z.useState(50),[Ao,To]=z.useState(20),[Do,Io]=z.useState(20),[Mo,Lo]=z.useState(20),[Ro,Oo]=z.useState(20),[Po,$o]=z.useState("Здравствуйте! 👋 Чем мы можем помочь?"),[Bo,zo]=z.useState("👍 Это помогло"),[Uo,qo]=z.useState("Получить доп. помощь"),Wo=()=>{const e=Math.max(...Yl.map(e=>e.id),0)+1;Xl([...Yl,{id:e,timeDelay:5,message:"У нас есть отличная акция",buttonText:"Расскажи подробнее"}])},Ho=(e,t,s)=>{if("message"===t&&"string"==typeof s){const e=s.trim().split(/\s+/);e.length>15&&(s=e.slice(0,15).join(" "))}Xl(Yl.map(n=>n.id===e?{...n,[t]:s}:n))},Qo=()=>{const e=Math.max(...to.map(e=>e.id),0)+1;so([...to,{id:e,timeDelay:5,message:"Продолжим диалог?",buttonText:"Давай"}])},Vo=(e,t,s)=>{if("message"===t&&"string"==typeof s){const e=s.trim().split(/\s+/);e.length>15&&(s=e.slice(0,15).join(" "))}so(to.map(n=>n.id===e?{...n,[t]:s}:n))},[Ko,Go]=z.useState("Выберите вопрос или задайте в чате свой"),[Jo,Yo]=z.useState("Отправить сообщение"),[Xo,Zo]=z.useState("Задавайте вопросы, мы всегда поможем"),[ec,tc]=z.useState([{id:1,text:"Какой у вас тариф?",enabled:!0},{id:2,text:"Как подключить интеграцию?",enabled:!0},{id:3,text:"Сколько стоит подписка?",enabled:!0}]),[sc,nc]=z.useState(null),[rc,ac]=z.useState(!1),[ic,lc]=z.useState(null);z.useEffect(()=>{(async()=>{try{if(!(null==r?void 0:r.id))return void nc(null);const e=await fetch(`${$m}/api/widget/key?userId=${r.id}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to get api key");const t=await e.json();(null==t?void 0:t.apiKey)&&nc(t.apiKey)}catch(e){console.warn("Failed to fetch widget api key",e)}})()},[null==r?void 0:r.id]);const oc=async()=>{try{const e=qc();await navigator.clipboard.writeText(e),Yr(!0)}catch(e){console.error("Ошибка при копировании:",e),Oc("Ошибка при копировании скрипта")}},cc=async()=>{if(console.log("=== НАЧАЛО СОХРАНЕНИЯ ВИДЖЕТА ==="),console.log("currentUser:",r),console.log("widgetApiKey:",sc),console.log("formTrigger:",ll),console.log("formTitle:",fl),console.log("selectedFormFields:",ul),!(null==r?void 0:r.id))return console.log("ОШИБКА: Нет пользователя"),void Oc("Необходимо войти в систему");try{console.log("Сохраняем настройки виджета в базу данных...");const t={ai_agent_name:Vi,show_ai_label:$i,logo_type:zi,custom_logo:qi,custom_logo_name:Hi,widget_title:Po,widget_description:Ko,questions:ec,button_title:Jo,button_description:Xo,manager_photo_type:Gi,manager_photos:Yi,status_text:Zi,show_status:tl,welcome_message:nl,form_trigger:ll,form_timer_seconds:vl,form_fields:xl,selected_form_fields:ul,form_title:fl,privacy_policy_link:ml,widget_theme:no,background_color:ao,selected_gradient:yo,accent_color:lo,escalation_enabled:ho,escalation_button_text:po,escalation_message:go,escalation_auto_assign:bo,button_color:co,desktop_bottom_offset:Ao,desktop_right_offset:Do,mobile_bottom_offset:Mo,mobile_right_offset:Ro,trigger_messages_enabled:Gl,trigger_messages:Yl,follow_up_messages:to,quick_replies:Mc.quickReplies};console.log("Данные для сохранения:",t),console.log("user_id:",r.id);const s=sc||((null==r?void 0:r.id)?`adapto_${r.id}`:"adapto_demo");console.log("Используем API ключ:",s);const n=await fetch(`${$m}/api/widget/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:s,settings:{accentColor:lo,buttonColor:co,widgetTheme:no,backgroundColor:ao,selectedGradient:yo,logoType:zi,customLogo:qi,customLogoName:Hi,aiAgentName:Vi,title:Po,description:Ko,buttonTitle:Jo,buttonDescription:Xo,managerPhotoType:Gi,managerPhotos:Yi,statusText:Zi,showStatus:tl,showAILabel:$i,questions:ec,showCompletionButton:Ol,selectedCompletionButton:Bo,showHumanButton:Ll,selectedHumanButton:Uo,formTrigger:ll,formTitle:fl,formTimerSeconds:vl,selectedFormFields:ul,formFields:xl,privacyPolicyLink:ml,desktopBottomOffset:Ao,desktopRightOffset:Do,mobileBottomOffset:Mo,mobileRightOffset:Ro,triggerMessagesEnabled:Gl,triggerMessages:Yl,followUpMessagesEnabled:Zl,followUpMessages:to,quickReplies:Mc.quickReplies,zIndex:Mc.zIndex}})});if(!n.ok){const e=await n.text();throw console.log("Ответ от API /api/widget/save:",n.status,e),new Error("Save failed: "+e)}const a=await n.text();console.log("Ответ от API /api/widget/save:",n.status,a);try{await Mc.saveWidgetDevelopmentSettings(r.id,{ai_agent_name:Vi,show_ai_label:$i,logo_type:zi,custom_logo:qi,custom_logo_name:Hi,widget_title:Po,widget_description:Ko,questions:ec,button_title:Jo,button_description:Xo,manager_photo_type:Gi,manager_photos:Yi,status_text:Zi,show_status:tl,welcome_message:nl,form_trigger:ll,form_timer_seconds:vl,form_fields:xl,selected_form_fields:ul,form_title:fl,privacy_policy_link:ml,widget_theme:no,background_color:ao,selected_gradient:yo,accent_color:lo,button_color:co,desktop_bottom_offset:Ao,desktop_right_offset:Do,mobile_bottom_offset:Mo,mobile_right_offset:Ro,trigger_messages_enabled:Gl,trigger_messages:Yl,follow_up_messages:to,quick_replies:Mc.quickReplies,z_index:Mc.zIndex,logo_url:Mc.logoUrl||"",logo_name:Mc.logoName||""})}catch(e){console.warn("Не удалось сохранить настройки в Supabase (UI раздел):",e)}Oc("✅ Настройки виджета сохранены!"),An(!1)}catch(t){console.error("Ошибка при сохранении:",t),Oc(`❌ Ошибка при сохранении: ${t.message}`)}console.log("=== КОНЕЦ СОХРАНЕНИЯ ВИДЖЕТА ===")},dc=()=>{if(ec.length>=4)return void Oc("Максимальное количество вопросов: 4");const e=Math.max(...ec.map(e=>e.id))+1;tc(t=>[...t,{id:e,text:"Новый вопрос",enabled:!0}])},uc=e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){const e=new FileReader;e.onload=e=>{var t;Wi(null==(t=e.target)?void 0:t.result),Qi(s.name)},e.readAsDataURL(s)}},hc=e=>{try{return new URL(e),!1}catch{return"Введите корректную ссылку"}},xc=e=>{No({background:!1,accent:!1,button:!1});let t="#0084FF";switch(e){case"background":t=ao.includes("gradient")?"#0084FF":ao;break;case"accent":t=lo;break;case"button":t=co}const s=t.replace("#",""),n=parseInt(s.substr(0,2),16)/255,r=parseInt(s.substr(2,2),16)/255,a=parseInt(s.substr(4,2),16)/255,i=Math.max(n,r,a),l=Math.min(n,r,a);let o=0,c=0,d=(i+l)/2;if(i!==l){const e=i-l;switch(c=d>.5?e/(2-i-l):e/(i+l),i){case n:o=(r-a)/e+(r<a?6:0);break;case r:o=(a-n)/e+2;break;case a:o=(n-r)/e+4}o/=6}Fo(Math.round(360*o)),Eo(Math.round(100*c)),So(Math.round(100*d)),No(t=>({...t,[e]:!0}))},pc=(e,t,s)=>{s/=100;const n=t*Math.min(s,1-s)/100,r=t=>{const r=(t+e/30)%12,a=s-n*Math.max(Math.min(r-3,9-r,1),-1);return Math.round(255*a).toString(16).padStart(2,"0")};return`#${r(0)}${r(8)}${r(4)}`},mc=(e,t,s,n)=>{Fo(e),Eo(t),So(s);((e,t)=>{switch(t){case"background":io(e),wo(0);break;case"accent":oo(e);break;case"button":uo(e)}})(pc(e,t,s),n)},gc=e=>{const t=e.replace("#",""),s=parseInt(t.substr(0,2),16)/255,n=parseInt(t.substr(2,2),16)/255,r=parseInt(t.substr(4,2),16)/255,a=Math.max(s,n,r),i=Math.min(s,n,r);let l=0;if(a!==i){const e=a-i;switch(a){case s:l=(n-r)/e+(n<r?6:0);break;case n:l=(r-s)/e+2;break;case r:l=(s-n)/e+4}l/=6}return Math.round(360*l)},fc=e=>jo[e]?J.jsxs("div",{className:"color-picker-container absolute left-0 right-0 bg-white border border-[#070F1A]/10 rounded-[10px] shadow-lg z-[9999] p-[10px] w-[200px] bottom-full mb-1",children:[J.jsx("div",{className:"absolute -top-2 w-6 h-6 cursor-pointer z-[10001] bg-white rounded-full flex items-center justify-center hover:bg-gray-100 transition-colors shadow-md border border-gray-200",style:{left:"190px"},onClick:e=>{e.preventDefault(),e.stopPropagation(),No({background:!1,accent:!1,button:!1})},children:J.jsx("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"none",children:J.jsx("path",{d:"M12 4L4 12M4 4L12 12",stroke:"#8E8E93",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),J.jsx("div",{className:"w-full pb-[75%] relative overflow-hidden mb-2",children:J.jsx("div",{className:"absolute inset-0 cursor-crosshair",style:{backgroundColor:`hsl(${ko}, 100%, 50%)`},onMouseDown:t=>{t.preventDefault(),t.stopPropagation();const s=t.currentTarget.getBoundingClientRect(),n=Math.max(0,Math.min(100,(t.clientX-s.left)/s.width*100)),r=Math.max(0,Math.min(100,(t.clientY-s.top)/s.height*100));mc(ko,n,100-r,e);const a=t=>{const n=Math.max(0,Math.min(100,(t.clientX-s.left)/s.width*100)),r=Math.max(0,Math.min(100,(t.clientY-s.top)/s.height*100));mc(ko,n,100-r,e)},i=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",i)},children:J.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to right, #fff, rgba(255,255,255,0))"},children:J.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, #000, rgba(0,0,0,0))"},children:J.jsx("div",{className:"absolute w-2 h-2 rounded-[90px] border-2 border-white shadow-lg pointer-events-none",style:{top:100-Co+"%",left:`${_o}%`,transform:"translate(-4px, -4px)"}})})})})}),J.jsx("div",{className:"relative h-[10px] overflow-hidden mb-2",children:J.jsx("div",{className:"absolute inset-0 cursor-crosshair",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMouseDown:t=>{t.preventDefault(),t.stopPropagation();const s=t.currentTarget.getBoundingClientRect(),n=Math.max(0,Math.min(100,(t.clientX-s.left)/s.width*100));mc(3.6*n,_o,Co,e);const r=t=>{const n=Math.max(0,Math.min(100,(t.clientX-s.left)/s.width*100));mc(3.6*n,_o,Co,e)},a=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",a)},children:J.jsx("div",{className:"absolute w-1 h-2 bg-white rounded-sm shadow-md pointer-events-none",style:{left:ko/360*100+"%",transform:"translateX(-2px)",marginTop:"1px"}})})}),J.jsxs("div",{className:"flex gap-1 mb-2",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("input",{type:"text",value:pc(ko,_o,Co).toUpperCase(),readOnly:!0,className:"w-full text-[11px] p-1 border border-gray-300 rounded text-center"}),J.jsx("label",{className:"block text-[11px] text-center text-gray-600 mt-1",children:"HEX"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("input",{type:"number",value:Math.round(ko),onChange:t=>mc(Number(t.target.value),_o,Co,e),className:"w-full text-[11px] p-1 border border-gray-300 rounded text-center"}),J.jsx("label",{className:"block text-[11px] text-center text-gray-600 mt-1",children:"H"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("input",{type:"number",value:Math.round(_o),onChange:t=>mc(ko,Number(t.target.value),Co,e),className:"w-full text-[11px] p-1 border border-gray-300 rounded text-center"}),J.jsx("label",{className:"block text-[11px] text-center text-gray-600 mt-1",children:"S"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("input",{type:"number",value:Math.round(Co),onChange:t=>mc(ko,_o,Number(t.target.value),e),className:"w-full text-[11px] p-1 border border-gray-300 rounded text-center"}),J.jsx("label",{className:"block text-[11px] text-center text-gray-600 mt-1",children:"L"})]})]}),J.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t border-gray-200",children:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"].map(t=>J.jsx("div",{className:"w-4 h-4 rounded cursor-pointer border border-gray-300",style:{backgroundColor:t},onClick:s=>{s.preventDefault(),s.stopPropagation();const n=t.replace("#",""),r=parseInt(n.substr(0,2),16)/255,a=parseInt(n.substr(2,2),16)/255,i=parseInt(n.substr(4,2),16)/255,l=Math.max(r,a,i),o=Math.min(r,a,i);let c=0,d=0,u=(l+o)/2;if(l!==o){const e=l-o;switch(d=u>.5?e/(2-l-o):e/(l+o),l){case r:c=(a-i)/e+(a<i?6:0);break;case a:c=(i-r)/e+2;break;case i:c=(r-a)/e+4}c/=6}mc(Math.round(360*c),Math.round(100*d),Math.round(100*u),e)}},t))})]}):null,[bc,vc]=z.useState([]),[yc,wc]=z.useState({widget:[],telegram:[],whatsapp:[],vk:[],instagram:[],admin:[],other:[]}),[jc,Nc]=z.useState(!1),[kc,Fc]=z.useState({disableOnHumanIntervention:!0,enableAfterOperatorSwitch:!1,switchDelayMinutes:5}),[_c,Ec]=z.useState(!1),[Cc,Sc]=z.useState(null),[Ac,Tc]=z.useState(!1),[Dc,Ic]=z.useState(null),[Mc,Lc]=z.useState({accentColor:"#0084FF",buttonColor:"custom",buttonText:"Написать нам",buttonSubtext:"Задать вопрос",avatar:"default",customButtonColor:"#0084FF",showCustomColorPicker:!1,widgetLocation:"default",desktopBottomOffset:20,desktopRightOffset:20,mobileBottomOffset:20,mobileRightOffset:20,zIndex:9999,welcomeMessages:["Привет! Меня зовут Adapto, я ИИ ассистент."],triggerQuestion:"Задать вопрос",triggerQuestionEnabled:"no",triggerQuestionDelay:5,triggerQuestionText:"Здравствуйте! Если появится вопрос, можете задать его в чате, я оперативно отвечу",triggerQuickReply:"Задать вопрос",followUpMessage:"no",followUpDelay:10,followUpQuestion:"Продолжим диалог?",followUpQuickReply:"Расскажи подробнее",quickReplies:["Расскажи подробнее"],privacyPolicyUrl:"https://",dataTags:["utm_source","utm_medium","utm_campaign","utm_term","utm_content","roistat_visit","gclid","fbclid"],excludedPages:[],widgetMode:"chat",quickQuestions:[{question:"Как работает ваш сервис?",answer:"Наш сервис использует ИИ для автоматизации общения с клиентами."},{question:"Сколько стоит?",answer:"У нас есть несколько тарифных планов. Базовый план стоит 2990₽ в месяц."},{question:"Есть ли демо?",answer:"Да, вы можете попробовать демо-версию бесплатно в течение 14 дней."}],leadFormEnabled:"yes",leadFormTitle:"Оставьте заявку",leadFormDescription:"Мы свяжемся с вами в ближайшее время",leadFormFields:[{name:"name",label:"Имя",type:"text",required:!0},{name:"phone",label:"Телефон",type:"tel",required:!0},{name:"email",label:"Email",type:"email",required:!1}],widgetTheme:"light",widgetSize:"medium",showAvatar:!0,showTypingIndicator:!0,escalationEnabled:!0,escalationButtonText:"Поговорить с человеком",escalationMessage:"Ваш запрос передан оператору. Ожидайте ответа.",escalationAutoAssign:!0,autoOpenOnScroll:!1,autoOpenDelay:0,showOnMobile:!0,notificationSound:!0,notificationTitle:"Новое сообщение",trackEvents:!0,trackConversions:!0,logoUrl:"",logoName:"",suggestions:[]}),Rc=(()=>{if(p)return[{id:"available-dialogs",label:"Доступные",icon:()=>J.jsx("img",{src:"/dialog.svg",alt:"Доступные",className:"w-5 h-5"})},{id:"dialogs",label:"Диалоги",icon:()=>J.jsx("img",{src:"/dialog.svg",alt:"Диалоги",className:"w-5 h-5"})},{id:"crm",label:"CRM",icon:()=>J.jsx("img",{src:"/crm.svg",alt:"CRM",className:"w-5 h-5"})},{id:"operator-statistics",label:"Моя статистика",icon:()=>J.jsx("img",{src:"/dashboard.svg",alt:"Статистика",className:"w-5 h-5"})},{id:"notifications",label:"Уведомления",icon:()=>J.jsx("img",{src:"/Icon inbox-1.svg",alt:"Уведомления",className:"w-5 h-5"})}];return"super_admin"===(null==r?void 0:r.role)||"admin"===(null==r?void 0:r.role)?[{id:"statistics",label:"Статистика",icon:()=>J.jsx("img",{src:"/stat.svg",alt:"Статистика",className:"w-5 h-5"})},{id:"dialogs",label:"Диалоги",icon:()=>J.jsx("img",{src:"/dialog.svg",alt:"Диалоги",className:"w-5 h-5"})},{id:"crm",label:"CRM",icon:()=>J.jsx("img",{src:"/crm.svg",alt:"CRM",className:"w-5 h-5"})},{id:"adapto-ai",label:"ИИ-агент",icon:()=>J.jsx("img",{src:"/ai.svg",alt:"ИИ-агент",className:"w-5 h-5"}),hasSubmenu:!0,submenu:[{id:"my-adapto",label:"Тестирование",icon:()=>J.jsx("img",{src:"/test.svg",alt:"Тестирование",className:"w-4 h-4"})},{id:"model-settings",label:"Настройка модели",icon:()=>J.jsx("img",{src:"/set.svg",alt:"Настройка модели",className:"w-4 h-4"})},{id:"model-extensions",label:"Расширения",icon:()=>J.jsx("img",{src:"/plugin.svg",alt:"Расширения",className:"w-4 h-4"})}]},{id:"knowledge",label:"База знаний",icon:()=>J.jsx("img",{src:"/baza.svg",alt:"База знаний",className:"w-5 h-5"})},{id:"integrations",label:"Интеграции",icon:()=>J.jsx("img",{src:"/inegra.svg",alt:"Интеграции",className:"w-5 h-5"}),hasSubmenu:!0,submenu:[{id:"widget-dev",label:"Виджет на сайт",icon:()=>J.jsx("img",{src:"/wiget.svg",alt:"Виджет на сайт",className:"w-4 h-4"})},{id:"messengers",label:"Мессенджеры",icon:()=>J.jsx("img",{src:"/mess.svg",alt:"Мессенджеры",className:"w-4 h-4"})},{id:"crm-systems",label:"CRM-системы",icon:()=>J.jsx("img",{src:"/crm2.svg",alt:"CRM-системы",className:"w-4 h-4"})},{id:"other-integrations",label:"Сервисы",icon:()=>J.jsx("img",{src:"/more.svg",alt:"Сервисы",className:"w-4 h-4"})}]},{id:"team",label:"Команда",icon:()=>J.jsx("img",{src:"/team.svg",alt:"Команда",className:"w-5 h-5"})},{id:"stories-management",label:"Управление сторис",icon:()=>J.jsx("img",{src:"/stories.svg",alt:"Сторисы",className:"w-5 h-5"})}]:[{id:"statistics",label:"Статистика",icon:()=>J.jsx("img",{src:"/stat.svg",alt:"Статистика",className:"w-5 h-5"})},{id:"dialogs",label:"Диалоги",icon:()=>J.jsx("img",{src:"/dialog.svg",alt:"Диалоги",className:"w-5 h-5"})},{id:"crm",label:"CRM",icon:()=>J.jsx("img",{src:"/crm.svg",alt:"CRM",className:"w-5 h-5"})},{id:"adapto-ai",label:"ИИ-агент",icon:()=>J.jsx("img",{src:"/ai.svg",alt:"ИИ-агент",className:"w-5 h-5"}),hasSubmenu:!0,submenu:[{id:"my-adapto",label:"Тестирование",icon:()=>J.jsx("img",{src:"/test.svg",alt:"Тестирование",className:"w-4 h-4"})},{id:"model-settings",label:"Настройка модели",icon:()=>J.jsx("img",{src:"/set.svg",alt:"Настройка модели",className:"w-4 h-4"})},{id:"model-extensions",label:"Расширения",icon:()=>J.jsx("img",{src:"/plugin.svg",alt:"Расширения",className:"w-4 h-4"})}]},{id:"knowledge",label:"База знаний",icon:()=>J.jsx("img",{src:"/baza.svg",alt:"База знаний",className:"w-5 h-5"})},{id:"integrations",label:"Интеграции",icon:()=>J.jsx("img",{src:"/inegra.svg",alt:"Интеграции",className:"w-5 h-5"}),hasSubmenu:!0,submenu:[{id:"widget-dev",label:"Виджет на сайт",icon:()=>J.jsx("img",{src:"/wiget.svg",alt:"Виджет на сайт",className:"w-4 h-4"})},{id:"messengers",label:"Мессенджеры",icon:()=>J.jsx("img",{src:"/mess.svg",alt:"Мессенджеры",className:"w-4 h-4"})},{id:"crm-systems",label:"CRM-системы",icon:()=>J.jsx("img",{src:"/crm2.svg",alt:"CRM-системы",className:"w-4 h-4"})},{id:"other-integrations",label:"Сервисы",icon:()=>J.jsx("img",{src:"/more.svg",alt:"Сервисы",className:"w-4 h-4"})}]},{id:"team",label:"Команда",icon:()=>J.jsx("img",{src:"/team.svg",alt:"Команда",className:"w-5 h-5"})},{id:"operator-stats",label:"Статистика",icon:()=>J.jsx("img",{src:"/stat.svg",alt:"Статистика",className:"w-5 h-5"})}]})(),Oc=e=>{C(e),_(!0),setTimeout(()=>_(!1),3e3)},Pc=e=>{A(e),D(!0),setTimeout(()=>D(!1),4e3)},$c={"widget-opens":{title:"Количество открытий виджета",description:"Общее количество раз, когда пользователи открывали виджет на сайте.",formula:"Сумма всех открытий виджета за период",explanation:"Эта метрика показывает, насколько активно пользователи взаимодействуют с вашим виджетом. Высокое количество открытий указывает на хорошую видимость и привлекательность виджета.\n\nРекомендации:\n• Размещайте виджет на видных местах сайта\n• Используйте привлекательные цвета и анимации\n• Добавьте призыв к действию рядом с виджетом"},"dialog-count":{title:"Количество диалогов",description:"Общее число разговоров между пользователями и ИИ-агентом.",formula:"Количество уникальных разговоров за период",explanation:"Эта метрика показывает общую активность пользователей с вашим ИИ-агентом. Каждый диалог представляет уникальное взаимодействие клиента с системой.\n\nРекомендации:\n• Анализируйте тренды роста диалогов\n• Сравнивайте с количеством открытий виджета\n• Оптимизируйте приветственные сообщения для увеличения конверсии"},"message-count":{title:"Количество сообщений",description:"Общее количество всех сообщений, отправленных в разговорах между пользователями и ИИ-агентом.",formula:"Сумма всех сообщений пользователей и ИИ-агента за период",explanation:"Эта метрика показывает общую активность общения в вашей системе. Высокое количество сообщений указывает на вовлеченность пользователей и качество диалогов.\n\nРекомендации:\n• Анализируйте соотношение сообщений пользователей и ИИ-агента\n• Оптимизируйте длину ответов ИИ-агента\n• Улучшайте качество вопросов для более глубокого взаимодействия"},"avg-messages-per-dialog":{title:"Среднее кол-во смс на диалог",description:"Среднее число сообщений в одном разговоре между пользователем и ИИ-агентом.",formula:"Общее количество сообщений / Количество диалогов",explanation:"Эта метрика показывает глубину взаимодействия пользователей с ИИ-агентом. Высокое значение указывает на качественные диалоги и заинтересованность клиентов.\\n\\nРекомендации:\\n• Целевое значение: 5-10 сообщений на диалог\\n• Слишком мало сообщений - упростите вопросы\\n• Слишком много - оптимизируйте ответы ИИ-агента"},"conversion-rate":{title:"Конверсия в основную цель",description:"Процент разговоров, которые успешно достигли вашей основной бизнес-цели.",formula:"0 (converted chats) / 0 (total analyzed chats) × 100% = 0%",explanation:"Эта метрика показывает эффективность ИИ-агента в достижении ваших бизнес-целей. Высокий процент конверсии означает, что агент успешно помогает клиентам.\\n\\nРекомендации:\\n• Целевое значение: 15-25% для большинства бизнесов\\n• Анализируйте неудачные диалоги для улучшения\\n• Настройте промпты под ваши конкретные цели"},"bounce-rate":{title:"Процент отказов",description:"Процент лидов, с которым ИИ пытался достичь основной цели, но клиент перестал отвечать.",formula:"0 (inconclusive leads) / 0 (total analyzed chats) × 100% = 0%",explanation:"Эта метрика показывает процент клиентов, которые прекратили общение до достижения цели. Низкий процент отказов указывает на качественное взаимодействие.\\n\\nРекомендации:\\n• Целевое значение: менее 20%\\n• Анализируйте причины отказов\\n• Улучшайте первые сообщения и подход"},"customer-engagement":{title:"Вовлечение клиента",description:"Среднее количество сообщений, отправляемых клиентами в каждом разговоре.",formula:"0 (total messages) / 0 (total chats) = 0",explanation:"Эта метрика показывает, насколько активно клиенты участвуют в диалоге. Высокое вовлечение указывает на интерес к продукту или услуге.\n\nРекомендации:\n• Целевое значение: 3-7 сообщений от клиента\n• Задавайте открытые вопросы\n• Показывайте заинтересованность в решении проблем клиента"},"resolved-questions":{title:"Количество решенных вопросов",description:"Количество разговоров, в которых ИИ-агент ответил, а клиент дал положительный отзыв или не запросил разговор с коллегой.",formula:"Количество успешно завершенных разговоров"},"rejection-rate":{title:"Коэффициент отклонений",description:"Процент разговоров, где клиенты никогда не отвечали на первоначальные сообщения ИИ.",formula:"0 (no response chats) / 0 (total chats) × 100% = 0%"},"avg-response-time":{title:"Средняя скорость ответа ИИ-агента",description:"Среднее время, которое нужно ИИ-агенту, чтобы ответить на сообщение клиента",formula:"0.0 sec (sum of response times) / 0 (total AI responses) = 0 сек",explanation:"Эта метрика показывает скорость работы ИИ-агента. Быстрые ответы улучшают пользовательский опыт и повышают конверсию.\\n\\nРекомендации:\\n• Целевое значение: менее 2 секунд\\n• Оптимизируйте промпты для более быстрых ответов\\n• Используйте кэширование для частых вопросов"},"avg-resolution-time":{title:"Средняя скорость разрешения вопроса",description:"Среднее время, которое необходимо ИИ-агенту для полного разрешения вопроса",formula:"Время от первого сообщения до завершения разговора",explanation:"Эта метрика показывает, насколько быстро ИИ-агент решает проблемы клиентов. Быстрое разрешение повышает удовлетворенность клиентов.\\n\\nРекомендации:\\n• Целевое значение: 2-5 минут\\n• Структурируйте ответы для быстрого решения\\n• Предоставляйте пошаговые инструкции"},"ai-effectiveness":{title:"Оценка эффективности ИИ-агента",description:"Общая оценка эффективности работы ИИ-агента на основе различных показателей качества.",formula:"(Точность ответов + Скорость работы + Удовлетворенность клиентов + Процент успешных разрешений) / 4",explanation:"Эта метрика дает общую оценку качества работы ИИ-агента. Высокая оценка означает эффективную работу системы.\\n\\nРекомендации:\\n• Целевое значение: 8+ из 10\\n• Регулярно обновляйте базу знаний\\n• Анализируйте отзывы клиентов для улучшений"},"help-request-rate":{title:"Процент чатов с запросом о помощи",description:"Процент разговоров, где клиенты запросили передачу разговора человеку из общего количества разговоров.",formula:"Количество чатов с запросом помощи / Общее количество чатов × 100%",explanation:"Эта метрика показывает, насколько часто клиенты просят помощи человека. Низкий процент указывает на качественную работу ИИ-агента.\\n\\nРекомендации:\\n• Целевое значение: менее 5%\\n• Улучшайте промпты для сложных вопросов\\n• Добавляйте эскалацию к человеку при необходимости"}},Bc=(e,t)=>{const s=t.target.getBoundingClientRect();Oe({x:s.left+s.width/2,y:s.top-10}),Le(e)},zc=()=>{Le(null)},Uc=(e,t,s=!1)=>{const n=s?"down"===e:"up"===e;return J.jsxs("div",{className:"flex items-end gap-1 ml-2",children:[J.jsx("svg",{className:"w-3 h-3 "+(n?"text-green-600":"text-red-600"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{paddingBottom:"0px",borderBottomWidth:"0px",height:"31px"},children:n?J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18",style:{paddingBottom:"0px"}}):J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3",style:{paddingBottom:"0px"}})}),J.jsx("div",{className:"text-[11px] font-[500] "+(n?"text-green-600":"text-red-600"),style:{height:"13px"},children:t})]})},qc=()=>{const e={accentColor:Mc.accentColor,buttonText:Mc.buttonText,buttonStyle:Mc.buttonColor||"rectangle",buttonColor:Mc.buttonColor||"light",customButtonColor:Mc.customButtonColor,widgetMode:Mc.widgetMode,quickQuestions:Mc.quickQuestions,leadFormEnabled:Mc.leadFormEnabled,leadFormTitle:Mc.leadFormTitle,leadFormDescription:Mc.leadFormDescription,leadFormFields:Mc.leadFormFields,welcomeMessages:Mc.welcomeMessages,quickReplies:Mc.quickReplies,logoUrl:Mc.logoUrl,logoName:Mc.logoName,suggestions:Mc.suggestions,triggerQuestionEnabled:Mc.triggerQuestionEnabled,triggerQuestionDelay:Mc.triggerQuestionDelay,triggerQuestionText:Mc.triggerQuestionText,followUpMessage:Mc.followUpMessage,followUpDelay:Mc.followUpDelay,followUpQuestion:Mc.followUpQuestion,followUpQuickReply:Mc.followUpQuickReply,privacyPolicyUrl:Mc.privacyPolicyUrl,dataTags:Mc.dataTags,widgetLocation:Mc.widgetLocation,desktopBottomOffset:Mc.desktopBottomOffset,desktopRightOffset:Mc.desktopRightOffset,mobileBottomOffset:Mc.mobileBottomOffset,mobileRightOffset:Mc.mobileRightOffset,zIndex:Mc.zIndex,avatar:Mc.avatar};encodeURIComponent(JSON.stringify(e));const t=sc||((null==r?void 0:r.id)?`adapto_${r.id}`:"adapto_demo");return`<script src="${{}.VITE_WIDGET_URL||"https://your-domain.com"}/adapto.js" data-key="${t}"><\/script>`},Wc=()=>{const e=sc||((null==r?void 0:r.id)?`adapto_${r.id}`:"adapto_demo"),t=`${$m}/widget-preview.html?key=${e}&noCache=1&ts=${Date.now()}`;window.open(t,"_blank","noopener,noreferrer")},Hc=()=>{const e=[["Название","Стадия","Качество лида","Сумма","Дни","Владелец","Статус","Дата создания","Клиент","Email","Телефон","Компания"]];en.forEach(t=>{e.push([t.title,t.stage,t.leadQuality,t.amount.toString(),t.days.toString(),t.ownerName,t.isResolved?"Завершена":"Активна",t.createdDate,t.client.name,t.client.email,t.client.phone,t.client.company])});const t=e.map(e=>e.join(",")).join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(s);n.setAttribute("href",r),n.setAttribute("download",`crm_deals_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},Qc=()=>{const e=en.map(e=>[e.title,e.stage,e.leadQuality,e.amount,e.days,e.ownerName,e.isResolved?"Завершена":"Активна",e.createdDate,e.client.name,e.client.email,e.client.phone,e.client.company]),t=`\n      <html>\n        <head>\n          <meta charset="utf-8">\n          <style>\n            table { border-collapse: collapse; width: 100%; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n          </style>\n        </head>\n        <body>\n          <table>\n            <thead>\n              <tr>\n                ${["Название","Стадия","Качество лида","Сумма","Дни","Владелец","Статус","Дата создания","Клиент","Email","Телефон","Компания"].map(e=>`<th>${e}</th>`).join("")}\n              </tr>\n            </thead>\n            <tbody>\n              ${e.map(e=>`<tr>${e.map(e=>`<td>${e}</td>`).join("")}</tr>`).join("")}\n            </tbody>\n          </table>\n        </body>\n      </html>\n    `,s=new Blob([t],{type:"application/vnd.ms-excel;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(s);n.setAttribute("href",r),n.setAttribute("download",`crm_deals_${(new Date).toISOString().split("T")[0]}.xls`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},Vc=()=>{const e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="image/*,.pdf,.doc,.docx,.txt",e.onchange=e=>{const t=Array.from(e.target.files||[]);console.log("Selected files:",t)},e.click()},Kc=async()=>{if(!(null==r?void 0:r.id))return;const e=rg(wi);if(!e.isValid)return void Oc(`❌ Ошибка валидации: ${e.errors.join(", ")}`);const t=lg(r.id);if(!t.allowed){const e=new Date(t.resetTime).toLocaleTimeString();return void Oc(`❌ Слишком много сообщений. Попробуйте снова в ${e}`)}const s=ag(e.sanitizedMessage);try{const e=`user_${Date.now()}_${Math.random()}`,t=Um({id:e,type:"user",text:s,time:"Только что",timestamp:_n()});if(Er(e=>[...e,t]),Jm.scrollToBottom(Nn),ji(""),!Ym.isOnline())return Ym.saveOfflineMessage({id:e,text:s,type:"user",userId:r.id,assistantId:r.id},"admin"),void Oc("📴 Сообщение сохранено в offline режиме. Будет отправлено при восстановлении связи.");await Am.saveMessage(r.id,"user",wi,"admin");const n=Jm.createLoadingMessage("assistant");Er(e=>[...e,n]);const a=r.id,i=await ed(s,r.id,a,_r);if(i.success){const e=Um({id:`ai_${Date.now()}_${Math.random()}`,type:"assistant",text:i.response||"Извините, произошла ошибка",time:"Только что",timestamp:_n()});Er(t=>Jm.addMessageAndRemoveLoading(t,e)),await Jm.saveMessageToDB(r.id,"assistant",i.response||"Извините, произошла ошибка","admin",Am),Jm.scrollToBottom(Nn)}else{const e=Jm.createErrorMessage("Извините, произошла ошибка при обработке сообщения");Er(t=>Jm.addMessageAndRemoveLoading(t,e)),Jm.scrollToBottom(Nn)}}catch(n){const e=Jm.handleChatError(n,Oc);Er(t=>Jm.addMessageAndRemoveLoading(t,e)),Jm.scrollToBottom(Nn)}},Gc=async()=>{if(Ar.trim()&&(null==r?void 0:r.id))try{const n=await _m(r.id),a={id:_n(),text:Ar,isUser:!0,time:"Только что",timestamp:_n()};il(e=>[...e,a]),Kl(!0),Pl(!1),Rl(!1),Jm.scrollToBottom(kn);try{const e=String(Ar||"").toLowerCase();[/заявк/,/записаться/,/консультац/,/остав(ить)?\s*(номер|телефон)/,/заполн(ить)?\s*форму/,/оформить\s*заявку/,/связаться/,/перезвонить/].some(t=>t.test(e))&&jl(!0)}catch(e){}await tr("Виджет на сайт",Ar),await Am.saveMessage(r.id,"user",Ar,"widget");const i=`💬 Новое сообщение от клиента\n\n👤 Клиент: Виджет\n💬 Сообщение: "${Ar}"\n🕒 Время: ${(new Date).toLocaleString("ru-RU")}`;fr(i,"new_messages"),Tr("");const l=Jm.createLoadingMessage("assistant",!1);il(e=>[...e,l]),Jm.scrollToBottom(kn);const o=n.filter((e,t)=>Pr.has(t)),c={message:Ar,conversationHistory:al,agentId:r.id,setupData:{...kr,knowledgeItems:[...kr.knowledgeItems||[],...o.map(e=>({type:"correction",content:e.correction||e}))]}};console.log("Sending widget request to API with corrections:",{loadedCorrections:n,activeCorrections:o,activeCorrectionsIndexes:Array.from(Pr),knowledgeItems:c.setupData.knowledgeItems});const d=`adapto_${r.id}_${Date.now()}`,u=await fetch(`${$m}${zm}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:d,message:Ar,conversationHistory:al.map(e=>({role:e.isUser?"user":"assistant",content:e.text}))})});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const h=await u.json(),x=h.answer||h.response||h.message||"Извините, произошла ошибка.";if(!0===h.showForm&&jl(!0),il(e=>[...e.filter(e=>!e.isTyping),{id:_n(),text:x,isUser:!1,time:"Только что",timestamp:_n()}]),Jm.scrollToBottom(kn),!0===h.handover)try{const e=await tr("Виджет: требуется оператор",Ar,!0);if(e&&e.id)try{await Om.updateDialog(e.id,{priority:"high"})}catch(t){console.warn("Failed to update dialog priority:",t)}}catch(t){console.error("Ошибка создания диалога/CRM-задачи для handover:",t)}await Am.saveMessage(r.id,"assistant",x,"widget");try{const e=await Rm(r.id);e&&(jn(e),console.log("User limits updated (widget):",e))}catch(s){console.log("Ошибка обновления лимитов (widget):",s.message)}Pl(!0),Rl(!0)}catch(n){console.error("Error sending widget message:",n),il(e=>[...e.filter(e=>!e.isTyping),{id:_n(),text:"Извините, произошла ошибка при обработке вашего запроса. Попробуйте еще раз.",isUser:!1,time:"Только что",timestamp:_n()}]),Oc("Ошибка при отправке сообщения")}},Jc=()=>{Dl(!0),Ql(Date.now()),Wl(null),Bl(!1),Kl(!1)},Yc=async e=>{if(!(null==r?void 0:r.id))return;const t=rg(e);if(!t.isValid)return void Oc(`❌ Ошибка валидации: ${t.errors.join(", ")}`);const s=lg(r.id);if(!s.allowed){const e=new Date(s.resetTime).toLocaleTimeString();return void Oc(`❌ Слишком много сообщений. Попробуйте снова в ${e}`)}const n=ag(t.sanitizedMessage);try{const t=Um({id:_n(),text:n,isUser:!0,time:"Только что",timestamp:_n()});il(e=>[...e,t]),Jm.scrollToBottom(kn);const s=`adapto_${r.id}_${Date.now()}`,i=await Jm.retryApiRequest(async()=>{const e=await fetch(`${$m}${zm}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:s,message:n,conversationHistory:al.map(e=>({role:e.isUser?"user":"assistant",content:e.text}))})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()},{maxRetries:2,baseDelay:1e3,retryCondition:e=>!e.response||e.response.status>=500||e.message.includes("timeout")||e.message.includes("NetworkError")});if(!0===i.showForm&&jl(!0),!0===i.handover||e.toLowerCase().includes("менеджер")||e.toLowerCase().includes("помощь"))try{const t=await tr("Виджет: запрос помощи",e,!0);if(t&&t.id)try{await Om.updateDialog(t.id,{priority:"high"})}catch(a){console.warn("Failed to update dialog priority:",a)}}catch(a){console.error("Ошибка создания диалога/CRM-задачи для запроса помощи:",a)}const l=i.answer||i.response||i.message||"Извините, произошла ошибка.",o=Um({id:_n(),text:l,isUser:!1,time:"Только что",timestamp:_n()});il(e=>Jm.addMessageAndRemoveLoading(e,o)),Jm.scrollToBottom(kn),await Jm.saveMessageToDB(r.id,"assistant",l,"widget",Am)}catch(a){const e=Jm.handleChatError(a,Oc);il(t=>Jm.addMessageAndRemoveLoading(t,e)),Jm.scrollToBottom(kn)}},Xc=()=>{Dl(!1),Wl(Date.now()),Ql(null),Ul(!1)};z.useEffect(()=>{if(s&&r){const e=localStorage.getItem("hasShownSetupWizard");"true"!==localStorage.getItem("isNewUser")||e||(Un(!0),localStorage.removeItem("isNewUser"))}},[s,r]),z.useEffect(()=>{let e;return qn&&Hn>0&&(e=setInterval(()=>{Qn(e=>e<=1?(Wn(!1),Qn(300),0):e-1)},1e3)),()=>clearInterval(e)},[qn,Hn]);const Zc=async()=>{if(!s||!r)return null;try{const e={email:r.email||`user${r.id}@example.com`,name:r.name||`User ${r.id}`,company_name:r.company_name||"",phone:r.phone||"",company_field:r.company_field||""};return await Sm(r.id,e)}catch(e){return console.error("Error getting/creating user:",e),null}},ed=async(e,t,s,n=[])=>Jm.retryApiRequest(async()=>{const a=n.filter(e=>"user"===e.type||"assistant"===e.type).map(e=>({role:"user"===e.type?"user":"assistant",content:e.text})),i=await fetch(`${$m}${Bm}`,{method:"POST",headers:{"x-user-id":t||(null==r?void 0:r.id)||"test-user-id","Content-Type":"application/json"},body:JSON.stringify({message:e,assistantId:s||t||(null==r?void 0:r.id)||"test-user-id",conversationId:`conv_${t||(null==r?void 0:r.id)||"test-user-id"}_${s||t||(null==r?void 0:r.id)||"test-user-id"}`,conversationHistory:a})});if(i.ok){return await i.json()}throw new Error(`HTTP error! status: ${i.status}`)},{maxRetries:2,baseDelay:1e3,retryCondition:e=>!e.response||e.response.status>=500||e.message.includes("timeout")||e.message.includes("NetworkError")}).catch(e=>(console.error("❌ Ошибка отправки сообщения после retry:",e),{success:!1,error:e.message}));z.useEffect(()=>{(async()=>{if(s&&r)try{const t=await(async()=>!1)();if(console.log("Supabase connection test result:",t),!t)throw console.warn("Supabase connection failed, using localStorage fallback"),new Error("Connection failed");if(!(await Zc()))throw console.warn("Failed to get/create user, using localStorage fallback"),new Error("User creation failed");console.log("Loading corrections for user:",r.id);const s=await _m(r.id);console.log("Loaded corrections from Supabase:",s),console.log("Number of corrections loaded:",s.length);const n=s.map(e=>({id:e.id,correction:e.correction,created_at:e.created_at}));console.log("Formatted corrections:",n),Lr(n),console.log("botCorrections state set to:",n);const a=await km(r.id);ta(a),Zr(a.length>0),a.length>0&&a[0].nicheId&&!ia&&(console.log("=== RESTORING NICHE FROM KNOWLEDGE ITEMS ==="),console.log("First knowledge item:",a[0]),console.log("Restoring nicheId:",a[0].nicheId),la(a[0].nicheId),na(e=>({...e,nicheId:a[0].nicheId}))),Fr(e=>({...e,knowledgeItems:a.map(e=>({type:e.source_type||e.type,content:e.processed_content||e.original_content||e.content,structured_data:e.structured_data}))}));try{console.log("Loading chat history for user:",r.id);const e=await Am.getChatHistory(r.id);if(console.log("Loaded chat history:",e),e&&e.length>0){const t=e.map((e,t)=>({type:"user"===e.role?"user":"assistant",text:e.message_content,time:td(e.created_at?new Date(e.created_at).getTime():Date.now()),timestamp:e.created_at?new Date(e.created_at).getTime():Date.now()+t,id:`loaded_${e.id||t}_${Date.now()}`}));console.log("Formatted chat history:",t),Er(t),Jm.scrollToBottom(Nn,300)}else console.log("No chat history found, using default welcome message"),Er([{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?",time:"Только что",timestamp:Date.now()}]),Jm.scrollToBottom(Nn,300)}catch(e){console.error("Error loading chat history:",e),Er([{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?"}]),Jm.scrollToBottom(Nn,300)}try{console.log("Loading CRM data for user:",r.id),console.log("Current user object:",r),console.log("Loaded clients from Supabase:",sn),console.log("Clients count:",sn.length),console.log("First client:",sn[0]),console.log("Loaded deals from Supabase:",en),console.log("Deals count:",en.length),console.log("First deal:",en[0]),console.log("Loaded tasks from Supabase:",bs);const e=en.map(e=>{var t,s,n,r,a,i,l;return{id:e.id,title:e.title,company:(null==(t=e.crm_clients)?void 0:t.company)||"",amount:e.amount||0,days:0,stage:e.stage||"Новые",leadQuality:e.lead_quality||"medium",hasContacts:!(!(null==(s=e.crm_clients)?void 0:s.email)&&!(null==(n=e.crm_clients)?void 0:n.phone)),owner:e.owner||"ai",ownerName:e.owner_name||"ИИ-агент",isResolved:e.is_resolved||!1,client:{name:(null==(r=e.crm_clients)?void 0:r.name)||"",email:(null==(a=e.crm_clients)?void 0:a.email)||"",phone:(null==(i=e.crm_clients)?void 0:i.phone)||"",company:(null==(l=e.crm_clients)?void 0:l.company)||""},notes:e.description||"",createdDate:e.created_at?e.created_at.split("T")[0]:(new Date).toISOString().split("T")[0],lastContact:e.created_at?e.created_at.split("T")[0]:(new Date).toISOString().split("T")[0],dialogId:e.dialog_id}}),t=bs.map(e=>({id:e.id,title:e.title,description:e.description||"",assignee:e.assignee||"operator-1",assigneeName:e.assignee_name||"Анна Петрова",priority:e.priority||"medium",status:e.status||"Новые",dueDate:e.due_date?e.due_date.split("T")[0]:"",dealId:e.deal_id,notes:e.result||"",createdBy:e.created_by||"ИИ-агент",createdDate:e.created_at?e.created_at.split("T")[0]:(new Date).toLocaleDateString("ru-RU")}));console.log("Setting deals:",e.length),console.log("Setting clients:",sn.length),console.log("Formatted deals:",e),tn(e),vs(t),nn(sn),console.log("CRM data loaded successfully:",{deals:e.length,tasks:t.length})}catch(e){console.error("Error loading CRM data:",e);const t=localStorage.getItem(`deals_${r.id}`);t&&tn(JSON.parse(t));const s=localStorage.getItem(`tasks_${r.id}`);s&&vs(JSON.parse(s))}}catch(e){console.error("Error loading user data:",e);const s=localStorage.getItem(`botCorrections_${r.id}`);s&&Lr(JSON.parse(s));const n=localStorage.getItem(`knowledgeItems_${r.id}`);if(n){const e=JSON.parse(n);ta(e),Zr(e.length>0),e.length>0&&e[0].nicheId&&!ia&&(console.log("=== RESTORING NICHE FROM LOCALSTORAGE ==="),console.log("First localStorage item:",e[0]),console.log("Restoring nicheId:",e[0].nicheId),la(e[0].nicheId),na(t=>({...t,nicheId:e[0].nicheId})))}const a=localStorage.getItem(`chatHistory_${r.id}`);Er(a?JSON.parse(a):[{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?"}]);try{if({success:!1,isOnline:!1}.success);else{console.warn("Ошибка загрузки статуса пользователя, используем localStorage как fallback");const e=localStorage.getItem(`operatorStatus_${r.id}`);null!==e&&Ai(JSON.parse(e))}}catch(t){console.error("Ошибка загрузки статуса пользователя:",t);const e=localStorage.getItem(`operatorStatus_${r.id}`);null!==e&&Ai(JSON.parse(e))}try{console.log("Loading user profile data for:",r.id);const{data:e,error:t}=await tm.from("users").select("name, email, company_name, phone, company_field").eq("id",r.id).single();t&&(console.error("Error loading user profile from Supabase:",t),console.log("Using currentUser data as fallback"));const s=e||r;console.log("Setting personal info with data:",s),bn({name:s.name||"",email:s.email||"",company:s.company_name||"",phone:s.phone||"",newPassword:"",confirmPassword:""}),yn({name:s.name||"",email:s.email||"",company:s.company_name||"",phone:s.phone||""})}catch(t){console.error("Error loading user profile:",t),bn({name:(null==r?void 0:r.name)||"",email:(null==r?void 0:r.email)||"",company:(null==r?void 0:r.company_name)||"",phone:(null==r?void 0:r.phone)||"",newPassword:"",confirmPassword:""})}if(r&&r.id){const t=r.id;(async(t,s)=>{try{console.log("🤖 Инициализация новой системы ai-agent-system...");const e=await fetch(`${$m}/api/agent/settings/${s}`,{headers:{"x-user-id":t,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();console.log("✅ Настройки агента загружены:",t)}const n=await fetch(`${$m}/api/knowledge/sources`,{headers:{"x-user-id":t,"Content-Type":"application/json"}});if(n.ok){const e=await n.json();console.log("✅ База знаний загружена:",e)}Sr(!0),console.log("🎉 Система ai-agent-system инициализирована!")}catch(e){console.error("❌ Ошибка инициализации ai-agent-system:",e)}})(r.id,t)}}})()},[s,r]),z.useEffect(()=>{r&&en.length>0&&localStorage.setItem(`deals_${r.id}`,JSON.stringify(en))},[en,r]),z.useEffect(()=>{r&&bs.length>0&&localStorage.setItem(`tasks_${r.id}`,JSON.stringify(bs))},[bs,r]),z.useEffect(()=>{r&&void 0!==Si&&localStorage.setItem(`operatorStatus_${r.id}`,JSON.stringify(Si))},[Si,r]),z.useEffect(()=>{if(!s||!r)return;(()=>{const e=[];kr.task&&kr.mainGoal&&kr.addressing&&kr.communicationStyle&&e.push(1),Xr&&ea.length>0&&e.push(2),Mc.accentColor&&Mc.buttonText&&Mc.buttonColor&&e.push(3),X(e),3===e.length&&(se(!1),localStorage.setItem(`setupCompleted_${r.id}`,"true"))})()},[s,r,kr,Xr,ea,Mc]),z.useEffect(()=>{if(s&&r){"true"===localStorage.getItem(`setupCompleted_${r.id}`)&&se(!1)}},[s,r]),z.useEffect(()=>{s&&r&&localStorage.setItem(`botCorrections_${r.id}`,JSON.stringify(Mr))},[Mr,s,r]),z.useEffect(()=>{(async()=>{if("model-settings"===o&&s&&r)try{console.log("Loading model settings from database for user:",r.id);const e=await Im(r.id);if(console.log("Loaded settings from DB:",e),e)console.log("Loaded settings from DB:",e),Fr(t=>({...t,...e})),console.log("Model settings loaded and applied to state");else{console.log("No model settings found in database, using defaults");const e=Lm();Fr(t=>({...t,...e}))}}catch(e){console.error("Error loading model settings:",e),Pc("❌ Ошибка при загрузке настроек из базы данных: "+e.message);const t=Lm();Fr(e=>({...e,...t}))}})(),(async()=>{if("widget-development"===o&&s&&r)try{console.log("Loading widget settings from database for user:",r.id);const e=await Mc.getWidgetDevelopmentSettings(r.id);if(console.log("Loaded widget settings from DB:",e),e&&Object.keys(e).length>0){console.log("=== LOADING WIDGET SETTINGS TO STATE ==="),console.log("DB Settings:",e);const t={accentColor:e.accent_color||"#0084FF",buttonColor:e.button_color||"custom",buttonText:e.button_text||"Написать нам",buttonSubtext:e.button_subtext||"Задать вопрос",avatar:e.avatar||"default",customButtonColor:e.custom_button_color||"#0084FF",widgetLocation:e.widget_location||"default",desktopBottomOffset:e.desktop_bottom_offset||20,desktopRightOffset:e.desktop_right_offset||20,mobileBottomOffset:e.mobile_bottom_offset||20,mobileRightOffset:e.mobile_right_offset||20,zIndex:e.z_index||9999,welcomeMessages:e.welcome_messages||["Привет! Меня зовут Adapto, я ИИ ассистент."],triggerQuestion:e.trigger_question||"Задать вопрос",triggerQuestionEnabled:e.trigger_question_enabled||"no",triggerQuestionDelay:e.trigger_question_delay||5,triggerQuestionText:e.trigger_question_text||"Здравствуйте! Если появится вопрос, можете задать его в чате, я оперативно отвечу",triggerQuickReply:e.trigger_quick_reply||"Задать вопрос",followUpMessage:e.follow_up_message||"no",followUpDelay:e.follow_up_delay||10,followUpQuestion:e.follow_up_question||"Продолжим диалог?",followUpQuickReply:e.follow_up_quick_reply||"Расскажи подробнее",quickReplies:e.quick_replies||["Расскажи подробнее"],privacyPolicyUrl:e.privacy_policy_url||"https://",dataTags:e.data_tags||["utm_source","utm_medium","utm_campaign","utm_term","utm_content","roistat_visit","gclid","fbclid"],excludedPages:e.excluded_pages||[],widgetMode:e.widget_mode||"chat",quickQuestions:e.quick_questions||[{question:"Как работает ваш сервис?",answer:"Наш сервис использует ИИ для автоматизации общения с клиентами."},{question:"Сколько стоит?",answer:"У нас есть несколько тарифных планов. Базовый план стоит 2990₽ в месяц."},{question:"Есть ли демо?",answer:"Да, вы можете попробовать демо-версию бесплатно в течение 14 дней."}],leadFormEnabled:!0===e.lead_form_enabled||"yes"===e.lead_form_enabled,leadFormTitle:e.lead_form_title||"Оставьте заявку",leadFormDescription:e.lead_form_description||"Мы свяжемся с вами в ближайшее время",leadFormFields:e.lead_form_fields||[{name:"name",label:"Имя",type:"text",required:!0},{name:"phone",label:"Телефон",type:"tel",required:!0},{name:"email",label:"Email",type:"email",required:!1}],widgetTheme:e.widget_theme||"light",widgetSize:e.widget_size||"medium",showAvatar:void 0===e.show_avatar||e.show_avatar,showTypingIndicator:void 0===e.show_typing_indicator||e.show_typing_indicator,autoOpenOnScroll:void 0!==e.auto_open_on_scroll&&e.auto_open_on_scroll,autoOpenDelay:e.auto_open_delay||0,showOnMobile:void 0===e.show_on_mobile||e.show_on_mobile,notificationSound:void 0===e.notification_sound||e.notification_sound,notificationTitle:e.notification_title||"Новое сообщение",trackEvents:void 0===e.track_events||e.track_events,trackConversions:void 0===e.track_conversions||e.track_conversions,logoUrl:e.logo_url||"",logoName:e.logo_name||"",suggestions:e.suggestions||[]};console.log("New widget settings to set:",t),Lc(t),console.log("Widget settings loaded successfully from database")}else console.log("No widget settings found in database, using defaults")}catch(e){console.error("Error loading widget settings from database:",e),Pc("❌ Ошибка при загрузке настроек виджета из базы данных: "+e.message)}})()},[o,s,r]),z.useEffect(()=>{if("knowledge"===o&&s&&r){const t=localStorage.getItem(`knowledgeItems_${r.id}`);if(t)try{const e=JSON.parse(t);ta(e),Zr(e.length>0),e.length>0&&e[0].nicheId&&!ia&&(console.log("=== RESTORING NICHE FROM LOCALSTORAGE (SECTION) ==="),console.log("First localStorage item:",e[0]),console.log("Restoring nicheId:",e[0].nicheId),la(e[0].nicheId),na(t=>({...t,nicheId:e[0].nicheId})))}catch(e){console.error("Error loading knowledge items:",e)}}},[o,s,r]),z.useEffect(()=>{s&&r&&(localStorage.setItem(`knowledgeItems_${r.id}`,JSON.stringify(ea)),Zr(ea.length>0))},[ea,s,r]),z.useEffect(()=>{const e=document.querySelector(".chat-history-container");e&&(e.scrollTop=e.scrollHeight)},[_r]),z.useEffect(()=>{const e=document.querySelector(".widget-chat-container");e&&(e.scrollTop=e.scrollHeight)},[al]);const td=e=>{const t=new Date,s=new Date(e),n=Math.floor((t-s)/6e4);return n<1?"Только что":n<60?`${n} мин назад`:n<1440?`${Math.floor(n/60)} ч назад`:`${Math.floor(n/1440)} дн назад`};z.useEffect(()=>{const e=setInterval(()=>{Er(e=>e.map(e=>({...e,time:e.timestamp?td(e.timestamp):e.time}))),il(e=>e.map(e=>({...e,time:e.timestamp?td(e.timestamp):e.time})))},6e4);return()=>clearInterval(e)},[]),z.useEffect(()=>{s&&r&&localStorage.setItem(`chatHistory_${r.id}`,JSON.stringify(_r))},[_r,s,r]);const sd={email:"admin@adapto.ai",password:"admin123",name:"Администратор",role:"super_admin",id:"admin-uuid-12345"},nd=async e=>{if(e.preventDefault(),Jn({}),console.log("🔑 Login attempt:",{email:Vn.email,hasPassword:!!Vn.password}),!Vn.email||!Vn.password)return console.error("❌ Missing email or password"),void Jn({general:"Пожалуйста, заполните все поля"});if(await(async(e,t)=>e===sd.email&&t===sd.password&&(a(sd),n(!0),g("dashboard"),c("main"),localStorage.setItem("currentUser",JSON.stringify(sd)),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("currentSection","main"),Oc("Вход в админ-панель выполнен успешно!"),!0))(Vn.email,Vn.password))console.log("✅ Admin login successful");else try{console.log("🚀 Attempting Supabase login...");const{data:e,error:t}=await tm.auth.signInWithPassword({email:Vn.email,password:Vn.password}),s=!t&&(null==e?void 0:e.user),r=(null==e?void 0:e.user)||null,i=(null==t?void 0:t.message)||null;if(!s)return console.error("❌ Login failed:",i),void Jn({general:i});console.log("✅ Login successful, user:",r),await(async e=>{try{const{data:t,error:s}=await tm.from("users").select("*").eq("id",e.id).single();s?(console.error("Error loading user data:",s),a({...e,role:e.role||"user"})):a({...e,...t,role:t.role||"user"}),n(!0),g("dashboard"),c("main"),Oc("Успешный вход в систему!")}catch(i){console.error("Login error:",i)}})(r)}catch(t){console.error("❌ Login error:",t),Jn({general:"Произошла ошибка при входе"})}},rd=async e=>{if(e.preventDefault(),Jn({}),!(Vn.name&&Vn.company&&Vn.email&&Vn.phone&&Vn.password))return void Jn({general:"Пожалуйста, заполните все поля"});const t=jr(Vn.phone);if(t)Xn({...Yn,phone:t});else try{console.log("🚀 ШАГ 1: Регистрация в Supabase Auth...");const{data:e,error:t}=await tm.auth.signUp({email:Vn.email,password:Vn.password});if(t)return console.error("❌ ШАГ 1 FAILED:",t),console.error("Error details:",{message:t.message,code:t.code,status:t.status}),void(t.message.includes("already registered")||t.message.includes("already exists")||t.message.includes("User already registered")||t.message.includes("already been registered")||"user_already_registered"===t.code||422===t.status?Jn({general:'⚠️ Этот email уже зарегистрирован. Перейдите на вкладку "Вход" и войдите в систему.'}):Jn({general:t.message||"Ошибка регистрации"}));if(!e.user)return console.error("❌ ШАГ 1 FAILED: No user data"),void Jn({general:"Не удалось создать пользователя"});console.log("✅ ШАГ 1 OK: User created:",e.user.id),console.log("Session:",e.session?"Active":"Pending confirmation"),console.log("🚀 ШАГ 2: Создание проекта...");const{data:s,error:r}=await tm.from("projects").insert({name:Vn.company||`${Vn.name}'s Project`,description:`Проект пользователя ${Vn.name}`,owner_id:e.user.id}).select().single();if(r)return console.error("❌ ШАГ 2 FAILED:",r),void Jn({general:"Ошибка при создании проекта: "+r.message});console.log("✅ ШАГ 2 OK: Project created:",s.id),console.log("🚀 ШАГ 3: Создание профиля пользователя...");const{error:i}=await tm.from("users").upsert({id:e.user.id,email:Vn.email,name:Vn.name,company_name:Vn.company,phone:Vn.phone,company_field:Vn.companyField||null,project_id:s.id},{onConflict:"id"});if(i)return console.error("❌ ШАГ 3 FAILED:",i),void Jn({general:"Ошибка при создании профиля: "+i.message});console.log("✅ ШАГ 3 OK: User profile created"),console.log("🚀 ШАГ 4: Добавление в команду проекта...");const{error:l}=await tm.from("project_members").upsert({project_id:s.id,user_id:e.user.id,email:Vn.email,role:"owner"},{onConflict:"project_id,user_id"});if(l)return console.error("❌ ШАГ 4 FAILED:",l),void Jn({general:"Ошибка при добавлении в команду проекта: "+l.message});console.log("✅ ШАГ 4 OK: Added to project_members"),console.log("🚀 ШАГ 5: Финализация регистрации...");const o={id:e.user.id,name:Vn.name,company_name:Vn.company,email:Vn.email,phone:Vn.phone,company_field:Vn.companyField||null,project_id:s.id,role:"user"};a(o),n(!0),g("dashboard"),c("main"),Un(!0),console.log("✅ ВСЕ ШАГИ ВЫПОЛНЕНЫ! Переход на dashboard..."),Oc("Регистрация успешна! Добро пожаловать в Adapto!"),Kn({email:"",password:"",name:"",company:"",phone:"",companyField:""}),Xn({})}catch(s){console.error("Registration error:",s),Jn({general:"Произошла ошибка при регистрации"})}},ad=async e=>{if(e.preventDefault(),Jn({}),Vn.name&&Vn.email&&Vn.password)try{const{data:e,error:t}=await tm.auth.signUp({email:Vn.email,password:Vn.password});if(t)return void(t.message.includes("already registered")||t.message.includes("already exists")?Jn({general:"Этот email уже зарегистрирован"}):Jn({general:t.message}));if(!e.user)return void Jn({general:"Не удалось создать пользователя"});const{data:s}=await tm.from("users").select("project_id").eq("id",jt).single();if(!(null==s?void 0:s.project_id))return void Jn({general:"Не удалось определить проект"});const{error:r}=await sm.from("users").upsert({id:e.user.id,email:Vn.email,name:Vn.name,project_id:s.project_id,role:"operator"},{onConflict:"id"});if(r)return console.error("Profile creation error:",r),void Jn({general:"Ошибка при создании профиля: "+r.message});const{error:i}=await sm.from("project_members").upsert({project_id:s.project_id,user_id:e.user.id,email:Vn.email,role:"member"},{onConflict:"project_id,user_id"});i&&console.error("Member creation error:",i);const l={id:e.user.id,name:Vn.name,email:Vn.email,project_id:s.project_id,role:"operator"};a(l),n(!0),g("dashboard"),c("main"),Oc("Регистрация оператора успешна! Добро пожаловать в команду!"),Kn({email:"",password:"",name:"",company:"",phone:"",companyField:""}),Xn({}),wt(null),Nt(null)}catch(t){console.error("Operator registration error:",t),Jn({general:"Произошла ошибка при регистрации"})}else Jn({general:"Пожалуйста, заполните все поля"})},id=async()=>{if(Dr.trim())try{if(!(await Zc()))return void Oc("Ошибка: не удалось создать пользователя");if(await Em(r.id,Dr)){const e={id:pg(),correction:Dr,created_at:(new Date).toISOString()};Lr(t=>[...t,e]),Ir(""),Oc("Корректировка добавлена!")}else Oc("Ошибка при добавлении корректировки")}catch(e){console.error("Error adding correction:",e),Oc("Ошибка при добавлении корректировки")}},[ld,od]=z.useState(!1),cd=async()=>{if(!ld&&Ur.trim()&&(null==r?void 0:r.id)){od(!0);try{if(await Em(r.id,Ur.trim(),"admin")){const e={id:pg(),correction:Ur.trim(),created_at:(new Date).toISOString()};Lr(t=>[...t,e]),qr(""),zr(!1),Oc("Корректировка добавлена")}else Oc("Ошибка при добавлении корректировки")}catch(e){console.error("Error adding correction:",e),Oc("Ошибка при добавлении корректировки")}finally{od(!1)}}},dd=async(e=null)=>{var t;if(console.log("handleAddKnowledgeItem called with:",e),console.log("currentUser:",r),console.log("currentUser?.id:",null==r?void 0:r.id),!(null==r?void 0:r.id))return console.log("No currentUser.id, cannot add knowledge item"),void Oc("Необходимо войти в систему");const s=e||sa;if(console.log("Item to add:",s),console.log("Item nicheId:",s.nicheId),console.log("Selected niche ID:",ia),s.content.trim())try{console.log("Getting or creating user...");if(!(await Zc()))return void Oc("Ошибка: не удалось создать пользователя");const i={...s,status:"Обработка",created_at:(new Date).toISOString()},l=await km(r.id);if(l.some(e=>e.content===s.content&&e.type===s.type))return void Oc("Этот элемент уже существует в базе знаний");const o={...i,id:"temp_"+pg(),status:"Обработка"};if("site"===s.type){Oc("🌐 Парсинг сайта... Ожидайте 2-5 минут"),ud(o.id,10,"Начинаем парсинг сайта...");const e=setInterval(()=>{var e;const t=(null==(e=ha[o.id])?void 0:e.progress)||10,s=Math.min(t+15,90);ud(o.id,s,"⏳ Парсинг продолжается... Загружаем товары и цены")},3e4);setTimeout(()=>{clearInterval(e)},3e5)}else ud(o.id,20,"Обработка контента...");ta(e=>[...e,o]),Zr(!0),Oc("Элемент добавлен в базу знаний! Статус: Обработка"),console.log("Sending to API for processing and storage:",i);const c=await fetch(`${$m}/api/knowledge/upload`,{method:"POST",headers:{"x-user-id":r.id,"Content-Type":"application/json"},body:JSON.stringify({sourceType:s.type,content:s.content,title:s.title||"Загруженный контент",sourceUrl:s.url||null,nicheId:s.nicheId&&""!==s.nicheId.trim()?s.nicheId:null})}),d=await c.json();if(console.log("API response:",d),!c.ok||!d.success)return console.error("Failed to process through API:",d),ta(e=>e.map(e=>e.id===o.id?{...e,status:"Ошибка"}:e)),xa(e=>{const t={...e};return delete t[o.id],t}),void Oc("Ошибка при обработке контента. Проверьте подключение к серверу.");if("site"===s.type||"website"===s.type){console.log("Starting website parsing through RAG system...");try{const e=await fetch(`${$m}/api/parse-website`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s.content,userId:r.id,nicheId:s.nicheId||ia})}),t=await e.json();console.log("Website parsing result:",t),t.success?(console.log("✅ Website parsing completed successfully"),console.log(`📝 Created ${t.data.chunksCount} chunks`)):console.log("❌ Website parsing failed:",t.error)}catch(n){console.error("❌ Error during website parsing:",n)}}try{if("site"===s.type||"website"===s.type){const e=null==(t=null==d?void 0:d.data)?void 0:t.id;if(e){let t=0;const s=setInterval(async()=>{var n,a;t+=1;try{const t=await fetch(`${$m}/api/knowledge/sources`,{headers:{"x-user-id":r.id}}),i=await t.json(),l=((null==i?void 0:i.data)||[]).find(t=>t.id===e),c=Array.isArray(null==(n=null==l?void 0:l.structured_data)?void 0:n.links)?l.structured_data.links.length:0;c>0?(ud(o.id,95,`Найдено ссылок: ${c}`),clearInterval(s)):ud(o.id,Math.min(((null==(a=ha[o.id])?void 0:a.progress)||40)+5,90),"Краулинг ссылок...")}catch(i){}t>=20&&clearInterval(s)},5e3)}}}catch(a){console.warn("Crawl poll error",a)}console.log("Waiting for AI processing...");let u=0;const h="site"===s.type?60:20;for(;u<h;){await new Promise(e=>setTimeout(e,5e3));const e=Math.min(30+2*u,95),t=Math.floor(5*u/60),n=t>0?` (${t} мин)`:"";ud(o.id,e,`Обработка ИИ...${n}`);const a=(await km(r.id)).find(e=>e.original_content===s.content&&e.source_type===s.type&&new Date(e.created_at)>new Date(Date.now()-6e5));if(a&&a.processed_content&&"Понял, информация сохранена."!==a.processed_content&&("Обработано"===a.status||"Загружено"===a.status)){ud(o.id,100,"Загружено"),ta(e=>e.map(e=>e.id===o.id?{...a,status:"Загружено"}:e)),setTimeout(()=>{xa(e=>{const t={...e};return delete t[o.id],t})},2e3),Oc("✅ Контент успешно обработан ИИ!");break}u++}u>=h&&(ta(e=>e.map(e=>e.id===o.id?{...e,status:"Обработка (таймаут)"}:e)),xa(e=>{const t={...e};return delete t[o.id],t}),Oc("⏳ Обработка занимает больше времени. Проверьте статус позже.")),e||na({type:"text",content:"",nicheId:""})}catch(i){console.error("Error adding knowledge item:",i),Oc("Ошибка при добавлении элемента")}else console.log("Item content is empty, returning")},ud=(e,t,s)=>{xa(n=>({...n,[e]:{progress:t,message:s,timestamp:Date.now()}}))},hd=e=>{if("Обработка"!==e.status)return e.status;const t=ha[e.id];if(!t)return"Обработка";if(t.progress>=100)return"Загружено";if("site"===e.type&&t.progress<50){const e=Math.floor((Date.now()-t.timestamp)/1e3);return`Обработка: ${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`}return`Обработка: ${t.progress}%`},xd=async()=>{const e=ea.filter(e=>"Обработка"===e.status||"Обработка (таймаут)"===e.status);if(0!==e.length)try{const t=await km(r.id);e.forEach(e=>{const s=t.find(t=>t.id===e.id||t.original_content===e.content&&t.source_type===e.type&&new Date(t.created_at)>new Date(Date.now()-3e5));s&&"Загружено"===s.status&&(ta(t=>t.map(t=>t.id===e.id?{...s,status:"Загружено"}:t)),xa(t=>{const s={...t};return delete s[e.id],s}),Oc("✅ Контент успешно обработан!"))})}catch(t){console.error("Error checking processing status:",t)}};z.useEffect(()=>{const e=setInterval(xd,1e4);return()=>clearInterval(e)},[ea,null==r?void 0:r.id]),z.useEffect(()=>{if(0===ea.filter(e=>"Обработка"===e.status&&ha[e.id]).length)return;const e=setInterval(()=>{xa(e=>({...e}))},1e3);return()=>clearInterval(e)},[ea,ha]);const pd=()=>{va(!0),La(""),Oa([""]),$a(""),za([""]),Ia("full")},md=()=>{va(!1),La(""),Oa([""]),$a(""),za([""])},gd=()=>{wa(!0),qa(""),Ha("")},fd=()=>{wa(!1),qa(""),Ha("")},bd=()=>{Na(!0),Va([]),Ga([])},vd=()=>{Na(!1),Va([]),Ga([])},yd=()=>{Fa(!0),Ya(""),Za("")},wd=()=>{Fa(!1),Ya(""),Za("")};return s?i?J.jsx("div",{className:"h-screen flex items-center justify-center bg-[#F2F3F4]",children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#0084FF]"}),J.jsx("p",{className:"mt-4 text-[#8E8E93]",children:"Загрузка..."})]})}):J.jsxs("div",{className:"h-screen flex "+("light"===me?"bg-[#F2F3F4]":"bg-[#070F1A]"),children:["super_admin"===(null==r?void 0:r.role)&&J.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-gray-800 text-white p-3 rounded-lg shadow-lg",children:[J.jsx("div",{className:"text-sm mb-2",children:"Режим тестирования (только для супер-админа):"}),J.jsxs("div",{className:"flex gap-2",children:[J.jsx("button",{onClick:()=>Zn("admin"),className:"px-3 py-1 rounded text-xs transition-colors "+("admin"===(null==r?void 0:r.role)?"bg-green-500":"bg-gray-600 hover:bg-gray-500"),children:"Админ"}),J.jsx("button",{onClick:()=>Zn("operator"),className:"px-3 py-1 rounded text-xs transition-colors "+("operator"===(null==r?void 0:r.role)?"bg-green-500":"bg-gray-600 hover:bg-gray-500"),children:"Оператор"}),J.jsx("button",{onClick:()=>Zn("user"),className:"px-3 py-1 rounded text-xs transition-colors "+("user"===(null==r?void 0:r.role)?"bg-green-500":"bg-gray-600 hover:bg-gray-500"),children:"Пользователь"}),J.jsx("button",{onClick:()=>{localStorage.removeItem("currentUser"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("currentSection"),a(null),n(!1),g("login"),Oc("Данные пользователя очищены. Войдите заново.")},className:"px-3 py-1 rounded text-xs bg-red-600 hover:bg-red-700 text-white transition-colors",children:"Очистить данные"})]})]}),F&&J.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300",children:[J.jsx("div",{className:"text-sm font-medium mb-[11px]",children:"Уведомление"}),J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("span",{className:"text-sm",children:E}),J.jsx("button",{onClick:()=>_(!1),className:"ml-4 text-red-600 hover:text-red-800 transition-colors",children:"×"})]})]}),T&&J.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300",children:[J.jsx("div",{className:"text-sm font-medium mb-[11px]",children:"Система"}),J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("span",{className:"text-sm",children:S}),J.jsx("button",{onClick:()=>D(!1),className:"ml-4 text-green-600 hover:text-green-800 transition-colors",children:"×"})]})]}),Ce&&Ae&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:J.jsxs("div",{className:"rounded-[20px] p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto "+("dark"===me?"bg-[#070F1A]":"bg-white"),children:[J.jsxs("div",{className:"flex items-center justify-between mb-6",children:[J.jsx("h2",{className:"text-[20px] font-[500] "+("dark"===me?"text-white":"text-[#070F1A]"),children:Ae.title}),J.jsx("button",{onClick:()=>Se(!1),className:"transition-colors "+("dark"===me?"text-white/70 hover:text-white":"text-gray-400 hover:text-gray-600"),children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-6 h-6"})})]}),J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Описание"}),J.jsx("p",{className:"text-[14px] leading-relaxed "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:Ae.description})]}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Формула расчета"}),J.jsx("div",{className:"rounded-[10px] p-4 "+("dark"===me?"bg-[#1E2538]":"bg-[#F3F5F7]"),children:J.jsx("p",{className:"font-mono text-[14px] "+("dark"===me?"text-white":"text-[#070F1A]"),children:Ae.formula})})]}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Подробное объяснение"}),J.jsx("div",{className:"space-y-3",children:Ae.explanation.split("\n\n").map((e,t)=>J.jsx("p",{className:"text-[14px] leading-relaxed "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:e},t))})]})]}),J.jsx("div",{className:"mt-6 flex justify-end",children:J.jsx("button",{onClick:()=>Se(!1),className:"px-6 py-2 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors text-[14px]",children:"Понятно"})})]})}),De&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:J.jsxs("div",{className:"rounded-[20px] p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto "+("dark"===me?"bg-[#070F1A]":"bg-white"),children:[J.jsxs("div",{className:"flex items-center justify-between mb-6",children:[J.jsx("h2",{className:"text-[20px] font-[500] "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Помощь"}),J.jsx("button",{onClick:()=>Ie(!1),className:"transition-colors "+("dark"===me?"text-white/70 hover:text-white":"text-gray-400 hover:text-gray-600"),children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-6 h-6"})})]}),J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-3 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Добро пожаловать в Adapto!"}),J.jsx("p",{className:"text-[14px] leading-relaxed "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"Мы поможем вам настроить и использовать платформу для управления ИИ-агентами."})]}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-3 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Основные разделы"}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"rounded-[10px] p-4 "+("dark"===me?"bg-[#1E2538]":"bg-[#F3F5F7]"),children:[J.jsx("h4",{className:"font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Главная"}),J.jsx("p",{className:"text-[14px] "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"Обзор статистики и ключевых метрик вашего проекта"})]}),J.jsxs("div",{className:"rounded-[10px] p-4 "+("dark"===me?"bg-[#1E2538]":"bg-[#F3F5F7]"),children:[J.jsx("h4",{className:"font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Диалоги"}),J.jsx("p",{className:"text-[14px] "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"Управление чат-ботами и настройка диалогов"})]}),J.jsxs("div",{className:"rounded-[10px] p-4 "+("dark"===me?"bg-[#1E2538]":"bg-[#F3F5F7]"),children:[J.jsx("h4",{className:"font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Тестирование"}),J.jsx("p",{className:"text-[14px] "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"Тестирование и отладка ИИ-агентов"})]}),J.jsxs("div",{className:"rounded-[10px] p-4 "+("dark"===me?"bg-[#1E2538]":"bg-[#F3F5F7]"),children:[J.jsx("h4",{className:"font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Интеграции"}),J.jsx("p",{className:"text-[14px] "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"Подключение внешних сервисов и API"})]})]})]}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-lg font-medium text-[#070F1A] mb-3",children:"Нужна дополнительная помощь?"}),J.jsx("p",{className:"text-[#8E8E93] text-sm leading-relaxed",children:"Обратитесь к нашей команде поддержки или ознакомьтесь с подробной документацией."})]})]}),J.jsx("div",{className:"mt-6 flex justify-end",children:J.jsx("button",{onClick:()=>Ie(!1),className:"px-6 py-2 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors text-[14px]",children:"Понятно"})})]})}),Tn&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:J.jsxs("div",{className:"rounded-[20px] p-6 max-w-md w-full mx-4 "+("dark"===me?"bg-[#070F1A]":"bg-white"),children:[J.jsx("h3",{className:"text-[18px] font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Несохраненные изменения"}),J.jsx("p",{className:"text-[14px] mb-6 "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"У вас есть несохраненные изменения. Вы уверены, что хотите покинуть эту страницу? Все несохраненные изменения будут потеряны."}),J.jsxs("div",{className:"flex gap-3 justify-end",children:[J.jsx("button",{onClick:()=>{Dn(!1),Mn(null)},className:"px-4 py-2 text-[14px] font-[500] transition-colors "+("dark"===me?"text-white/70 hover:text-white":"text-[#8E8E93] hover:text-[#070F1A]"),children:"Отмена"}),J.jsx("button",{onClick:()=>{In&&(c(In),An(!1)),Dn(!1),Mn(null)},className:"px-4 py-2 bg-[#FF0D0D] text-white text-[14px] font-[500] rounded-[10px] hover:bg-[#E00D0D] transition-colors",children:"Покинуть без сохранения"})]})]})}),J.jsxs("div",{className:`fixed md:relative z-50 md:z-auto transform transition-transform duration-300 ease-in-out ${w?"translate-x-0":"-translate-x-full"} md:translate-x-0 ${N?"w-12":"w-56"} h-full ${"light"===me?"bg-[#F2F3F4]":"bg-[#070F1A]"} flex flex-col overflow-hidden`,children:[J.jsx("div",{className:"px-[10px] pt-5 pb-0",style:{width:"calc(100% + 10px)"},children:J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("div",{className:"flex items-center pl-[10px]",children:!N&&J.jsx("button",{onClick:()=>{c("main"),localStorage.setItem("currentSection","main"),j(!1)},className:"hover:opacity-80 transition-opacity",children:J.jsx("img",{src:"light"===me?"/Логотип-блэк.svg":"/logo.svg",alt:"Adapto",className:"w-[110px] h-6"})})}),J.jsx("div",{className:"flex items-center "+(N?"justify-center w-full":"gap-2"),children:J.jsx("button",{onClick:()=>k(!N),className:"text-gray-400 hover:text-white transition-colors "+(N?"-ml-[6px]":""),children:J.jsx("img",{src:"light"===me?"/светлая тема.svg":"/темная тема.svg",alt:"Toggle sidebar",className:"w-4 h-4"})})})]})}),J.jsx("div",{className:"flex-1 px-[10px] pt-5 overflow-y-auto",style:{width:"calc(100% + 10px)"},children:J.jsx("nav",{className:"space-y-[5px]",children:Rc.map(e=>J.jsxs("div",{children:[!N&&"statistics"===e.id&&J.jsx("div",{className:"text-[10px] text-[#8E8E93] mb-1 ml-[12px]",children:"Основные"}),!N&&"adapto-ai"===e.id&&J.jsx("div",{className:"text-[10px] text-[#8E8E93] mb-1 mt-[18px] ml-[12px]",children:"Управление"}),J.jsxs("button",{onClick:()=>{e.hasSubmenu?N?(k(!1),je(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id])):je(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id]):(c(e.id),localStorage.setItem("currentSection",e.id),j(!1),"my-adapto"===e.id?Jm.scrollToBottom(Nn,500):"widget-dev"===e.id&&Jm.scrollToBottom(kn,500))},className:`w-full flex items-center ${N?"justify-center w-[34px] h-[34px]":"gap-3"} px-3 h-[34px] rounded-[10px] text-left transition-colors ${o===e.id||Ke===e.id?"bg-[#F8F8FA] text-[#0084FF]":"light"===me?"text-[#8E8E93] hover:text-[#0084FF] hover:bg-[#F8F8FA]":"text-[#B3B7B9] hover:text-white hover:bg-[#1E2538]"}`,title:N?e.label:"",onMouseEnter:()=>Ge(e.id),onMouseLeave:()=>Ge(null),children:["function"==typeof e.icon?J.jsx("div",{className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),children:(()=>{const t=e.icon();return"img"===t.type?U.cloneElement(t,{className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),style:{filter:o===e.id||Ke===e.id?"light"===me?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) invert(1)":"light"===me?"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)":"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.7) contrast(1)",opacity:o===e.id||Ke===e.id?1:.8}}):U.cloneElement(t,{className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),style:{color:o===e.id||Ke===e.id?"light"===me?"#0084FF":"#FFFFFF":"light"===me?"#8E8E93":"#B3B7B9",opacity:o===e.id||Ke===e.id?1:.8}})})()}):J.jsx("img",{src:`/${"statistics"===e.id?"dashboard":"dialogs"===e.id?"chat":"knowledge"===e.id?"knowledge-base":"integrations"===e.id?"integration-2":"default"}.svg?v=${Date.now()}`,alt:e.label,className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),style:{filter:o===e.id?"light"===me?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) invert(1)":"light"===me?"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)":"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.7) contrast(1)",opacity:o===e.id?1:.8}}),!N&&J.jsxs("div",{className:"flex items-center justify-between flex-1",children:[J.jsx("span",{className:"text-[13px] font-medium tracking-[0px]",children:e.label}),e.hasSubmenu&&J.jsx("img",{src:"/chevron-right.svg",alt:"Expand",className:"w-4 h-4 transition-transform "+(we.includes(e.id)?"rotate-90":""),style:{filter:o===e.id||Ke===e.id?"light"===me?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) invert(1)":"light"===me?"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)":"brightness(0) saturate(100%) invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.7) contrast(1)",opacity:o===e.id||Ke===e.id?1:.8}})]})]}),e.hasSubmenu&&we.includes(e.id)&&!N&&J.jsx("div",{className:"ml-4 mt-1 space-y-1",children:e.submenu.map(e=>J.jsxs("button",{onClick:()=>{c(e.id),localStorage.setItem("currentSection",e.id),j(!1),"my-adapto"===e.id?Jm.scrollToBottom(Nn,500):"widget-dev"===e.id&&Jm.scrollToBottom(kn,500)},className:"w-full flex items-center gap-3 pl-[20px] pr-3 h-[34px] rounded-[8px] text-left transition-colors tracking-[0px] "+(o===e.id?"bg-[#F8F8FA] text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF] hover:bg-[#F8F8FA]"),onMouseEnter:()=>Ye(e.id),onMouseLeave:()=>Ye(null),children:["function"==typeof e.icon?J.jsx("div",{className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),children:(()=>{const t=e.icon();return"img"===t.type?U.cloneElement(t,{className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),style:{filter:o===e.id||Je===e.id?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)",opacity:o===e.id||Je===e.id?1:.8}}):t})()}):J.jsx("img",{src:`/${"my-adapto"===e.id?"mouse-square-menu":"model-settings"===e.id?"model-settings":"model-extensions"===e.id?"extensions":"widget-settings"===e.id?"widget":"messengers"===e.id?"chat":"crm-systems"===e.id?"crm":"other-integrations"===e.id?"other":"default"}.svg?v=${Date.now()}`,alt:e.label,className:""+(N?"w-[18px] h-[18px]":"w-4 h-4"),style:{filter:o===e.id||Je===e.id?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)",opacity:o===e.id||Je===e.id?1:.8}}),J.jsx("span",{className:"text-[13px] font-medium tracking-[-0.1px]",children:e.label})]},e.id))})]},e.id))})}),J.jsx("div",{className:"px-[10px] pb-[15px]",style:{width:"calc(100% + 10px)"},children:N?J.jsx("div",{className:"flex flex-col items-center gap-2",children:J.jsx("div",{className:"cursor-pointer "+("light"===me?"hover:bg-gray-50 rounded-[10px] p-1":""),onClick:()=>{c("profile"),localStorage.setItem("currentSection","profile"),j(!1)},children:J.jsx("div",{className:"w-4 h-4 rounded-[90px] flex items-center justify-center",style:{backgroundColor:Nr(null==r?void 0:r.name).color},children:J.jsx("span",{className:"text-white font-semibold text-[10px]",children:Nr(null==r?void 0:r.name).letter})})})}):J.jsxs(J.Fragment,{children:[!p&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{className:"w-full h-[60px] rounded-[10px] mb-[10px] relative overflow-hidden",children:[J.jsx("img",{src:"/Frame 145.png",alt:"Pro Background",className:"w-full h-full object-cover absolute inset-0"}),J.jsx("div",{className:"p-3 h-full flex flex-col justify-center relative z-10",children:J.jsxs("div",{className:"flex flex-col items-start",children:[J.jsx("span",{className:"text-white text-[14px] font-medium",children:"Тариф Pro со скидкой"}),J.jsx("span",{className:"text-white text-[14px] font-medium",children:"-50% на первый год"})]})})]}),J.jsxs("div",{className:"w-full h-[80px] bg-white rounded-[10px] p-[7px] mb-[10px]",children:[J.jsx("div",{className:"h-[22px] bg-[#EFFBF3] rounded-[7px] flex items-center justify-center mb-[7px]",children:J.jsx("span",{className:"text-[#36C76A] text-[10px] font-medium",children:"Пробная подписка"})}),J.jsxs("div",{className:"flex justify-between",children:[J.jsxs("div",{className:"flex-1 text-center",children:[J.jsx("div",{className:"text-[10px] text-[#070F1A] opacity-60 mb-1",children:"Срок:"}),J.jsxs("div",{className:"flex items-center justify-center gap-1",children:[J.jsx("img",{src:"/clock.svg",alt:"Clock",className:"w-3 h-3"}),J.jsxs("span",{className:"text-[12px] text-[#070F1A] font-medium",children:[(null==wn?void 0:wn.daysRemaining)||0,"/7 дней"]})]})]}),J.jsxs("div",{className:"flex-1 text-center",children:[J.jsx("div",{className:"text-[10px] text-[#070F1A] opacity-60 mb-1",children:"Токены:"}),J.jsxs("div",{className:"flex items-center justify-center gap-1",children:[J.jsx("img",{src:"/Vector09.svg",alt:"Tokens",className:"w-3 h-3"}),J.jsxs("span",{className:"text-[12px] text-[#070F1A] font-medium",children:[(null==wn?void 0:wn.tokensRemaining)||0,"/",(null==wn?void 0:wn.totalTokens)||1e3]})]})]})]})]})]}),p&&J.jsxs("div",{className:"flex items-center justify-between mb-3 px-3 py-2 bg-[#F9FAFB] rounded-[12px] h-[40px] border border-[#E5E7EB]",children:[J.jsx("span",{className:"text-[12px] text-[#070F1A]",children:Si?"В сети":"Не в сети"}),J.jsx("img",{src:Si?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Статус",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>Ai(!Si)})]}),J.jsxs("div",{className:"relative user-dropdown",children:[J.jsxs("div",{className:"rounded-[10px] py-3 pr-3 pl-0 mb-[10px] mt-[5px] cursor-pointer transition-colors h-[40px] flex items-center justify-between "+("light"===me?"hover:bg-gray-50":"hover:bg-[#1E2538]"),onClick:()=>pe(!xe),children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-[28px] h-[28px] rounded-[7px] flex items-center justify-center",style:{backgroundColor:Nr(null==r?void 0:r.name).color},children:J.jsx("span",{className:"text-white font-semibold text-xs",children:Nr(null==r?void 0:r.name).letter})}),J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"text-[13px] font-medium "+("light"===me?"text-[#070F1A]":"text-white"),children:(null==r?void 0:r.company_name)||"Компания"}),J.jsx("div",{className:"text-[11px] text-[#8E8E93]",children:(null==r?void 0:r.email)||"email@example.com"})]})]}),J.jsx("div",{className:"flex items-center",children:J.jsx("img",{src:"/chevron-right.svg",alt:"Expand",className:"w-4 h-4 transition-transform duration-200 "+(xe?"rotate-90":"-rotate-90"),style:{filter:"light"===me?"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)":"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.7) contrast(1)"}})})]}),xe&&J.jsxs("div",{className:"user-dropdown absolute bottom-full left-0 right-0 mb-2 bg-white rounded-[15px] shadow-lg border border-gray-200 p-2 z-50",children:[J.jsxs("button",{onClick:()=>{c("profile"),pe(!1),j(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] "+("profile"===o?"text-[#0084FF] bg-white":"text-[#8E8E93] hover:text-[#0084FF] hover:bg-white"),children:[J.jsx("img",{src:"/Icon%20pers.svg",alt:"Мой аккаунт",className:"w-4 h-4 transition-all duration-200",style:{filter:"profile"===o?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Мой аккаунт"]}),J.jsxs("button",{onClick:()=>{c("profile"),he("notifications"),pe(!1),j(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] "+("profile"===o&&"notifications"===ue?"text-[#0084FF] bg-white":"text-[#8E8E93] hover:text-[#0084FF] hover:bg-white"),children:[J.jsx("img",{src:"./Icon%20notific.svg",alt:"Уведомления",className:"w-4 h-4 transition-all duration-200",style:{filter:"profile"===o&&"notifications"===ue?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Уведомления"]}),!p&&J.jsxs("button",{onClick:()=>{c("profile"),he("subscription"),pe(!1),j(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] "+("subscription"===o?"text-[#0084FF] bg-white":"text-[#8E8E93] hover:text-[#0084FF] hover:bg-white"),children:[J.jsx("img",{src:"/Icon%20pers-1.svg",alt:"Оплата и тарифы",className:"w-4 h-4 transition-all duration-200",style:{filter:"subscription"===o?"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)":"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Оплата и тарифы"]}),J.jsxs("button",{onClick:()=>{Ie(!0),pe(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] text-[#8E8E93] hover:text-[#0084FF] hover:bg-white",children:[J.jsx("img",{src:"/Icon%20quest.svg",alt:"Помощь",className:"w-4 h-4 transition-all duration-200",style:{filter:"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Помощь"]}),J.jsxs("button",{onClick:()=>{pe(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] text-[#8E8E93] hover:text-[#0084FF] hover:bg-white",children:[J.jsx("img",{src:"/Icon%20wor.svg",alt:"Язык",className:"w-4 h-4 transition-all duration-200",style:{filter:"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Язык"]}),J.jsx("div",{className:"border-t border-gray-200 my-2"}),J.jsxs("button",{onClick:()=>{(async()=>{try{n(!1),a(null),g("login"),c("main"),Oc("Вы вышли из системы")}catch(e){console.error("Logout error:",e),n(!1),a(null),g("login"),c("main")}})(),pe(!1)},className:"w-full text-left px-3 py-2 text-[13px] rounded-[6px] transition-colors flex items-center gap-3 group tracking-[0px] text-[#8E8E93] hover:text-[#0084FF] hover:bg-white",children:[J.jsx("img",{src:"/Icon%20ex.svg",alt:"Выйти",className:"w-4 h-4 transition-all duration-200",style:{filter:"brightness(0) saturate(100%) invert(60%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(0.8) contrast(1)"}}),"Выйти"]})]})]})]})})]}),J.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[J.jsxs("div",{className:"md:hidden flex items-center gap-4 p-4 border-b "+("light"===me?"border-gray-200 bg-white":"border-gray-700 bg-[#070F1A]"),children:[J.jsx("img",{src:"/logo.svg",alt:"Adapto",className:"w-8 h-8"}),J.jsx(og,{variant:"ghost",size:"sm",onClick:()=>j(!0),className:("light"===me?"text-[#070F1A]":"text-white")+" ml-auto",children:J.jsx(xm,{className:"w-3 h-3"})})]}),J.jsx("main",{className:"flex-1 bg-[#F8F8FA] rounded-[0px] ml-[10px] border-l flex flex-col overflow-hidden",style:{borderColor:"#E5E6E7",marginTop:0,marginRight:0,marginBottom:0},children:J.jsx("div",{className:"p-4 flex-1 min-h-0 overflow-y-auto",children:(()=>{var e,t,n,a,i,l,d,u,m,g,f,b,v,y,w,k;switch(o){case"main":return J.jsxs("div",{className:"p-0",children:[J.jsx("div",{className:"text-left mb-[16px]",children:J.jsxs("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:["Приветствуем вас, ",(null==r?void 0:r.name)||(null==(e=null==r?void 0:r.email)?void 0:e.split("@")[0])||"Пользователь","! С чего начнем?"]})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-[50px]",style:{marginLeft:"-32px",marginRight:"-32px"}}),J.jsxs("div",{className:"mb-[50px]",children:[J.jsx("h2",{className:"text-[16px] font-[500] text-[#070F1A] mb-[20px]",children:"Сторисы"}),J.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:L.map(e=>J.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center",children:[J.jsx("div",{className:"w-[70px] h-[70px] border border-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("div",{className:"w-[64px] h-[64px] bg-white rounded-[90px] relative overflow-hidden",children:J.jsx("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-cover"})})}),J.jsx("span",{className:"text-[11px] font-[400] text-[#070F1A] text-center leading-tight mt-2",children:e.title.split(" ").map((t,s)=>J.jsxs("span",{children:[t,s<e.title.split(" ").length-1&&J.jsx("br",{})]},s))})]},e.id))})]}),te&&J.jsxs("div",{className:"mb-[50px]",children:[J.jsxs("div",{className:"flex items-center gap-3 mb-[20px]",children:[J.jsx("div",{className:"relative w-[22px] h-[22px]",children:J.jsxs("svg",{className:"w-[22px] h-[22px]",viewBox:"0 0 32 32",style:{transform:"rotate(-90deg)"},children:[J.jsx("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"#E5E7EB",strokeWidth:"4"}),J.jsx("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"#36C76A",strokeWidth:"4",strokeDasharray:""+2*Math.PI*14,strokeDashoffset:""+2*Math.PI*14*(1-Y.length/3),strokeLinecap:"round",className:"transition-all duration-500"})]})}),J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Запуск Adapto"}),J.jsxs("div",{className:"flex items-center gap-[10px]",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"•"}),J.jsxs("span",{className:"text-[14px] text-[#8E8E93]",children:[Y.length," / 3 шага"]})]})]}),J.jsxs("div",{className:"bg-white rounded-[20px] p-5 w-full",children:[J.jsx("h3",{className:"text-[20px] font-[500] text-[#070F1A] mb-[34px]",children:"Настройте и подключите ИИ-агента:"}),J.jsx("div",{className:"w-full",children:J.jsxs("div",{className:"w-full space-y-4 pb-0",children:[J.jsxs("div",{className:"rounded-[15px] p-0",children:[J.jsxs("div",{className:"flex items-start justify-between mb-3",children:[J.jsxs("div",{className:"flex items-center gap-[10px]",children:[Y.includes(1)?J.jsx("img",{src:"/Checkbox.svg",alt:"Выполнено",className:"w-[16px] h-[16px]"}):J.jsx("img",{src:"/Checkbox-1.svg",alt:"Не выполнено",className:"w-[16px] h-[16px]"}),J.jsx("h4",{className:"text-[16px] font-[500] cursor-pointer "+(Y.includes(1)?"line-through text-[#8E8E93]":"text-[#070F1A]"),onClick:()=>ee(1===Z?null:1),children:"Настройте ИИ-модель под ваш бизнес"})]}),J.jsx("button",{onClick:()=>ee(1===Z?null:1),className:"text-[#0084FF] hover:text-[#0073E6] transition-colors",children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px] transition-transform duration-300 "+(1===Z?"rotate-90":""),style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),1===Z&&J.jsxs("div",{className:"space-y-4",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:"Настройте параметры вашей ИИ-модели: стиль общения, правила, ограничения и сценарии диалогов для эффективного взаимодействия с клиентами."}),J.jsx("button",{onClick:()=>c("model-settings"),className:"h-[34px] w-full px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Настроить"})]})]}),J.jsx("div",{className:"h-px bg-[#E5E7EB] my-[15px]"}),J.jsxs("div",{className:"rounded-[15px] p-0",children:[J.jsxs("div",{className:"flex items-start justify-between mb-3",children:[J.jsxs("div",{className:"flex items-center gap-[10px]",children:[Y.includes(2)?J.jsx("img",{src:"/Checkbox.svg",alt:"Выполнено",className:"w-[16px] h-[16px]"}):J.jsx("img",{src:"/Checkbox-1.svg",alt:"Не выполнено",className:"w-[16px] h-[16px]"}),J.jsx("h4",{className:"text-[16px] font-[500] cursor-pointer "+(Y.includes(2)?"line-through text-[#8E8E93]":"text-[#070F1A]"),onClick:()=>ee(2===Z?null:2),children:"Загрузите информацию о компании в базу знаний"})]}),J.jsx("button",{onClick:()=>ee(2===Z?null:2),className:"text-[#0084FF] hover:text-[#0073E6] transition-colors",children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px] transition-transform duration-300 "+(2===Z?"rotate-90":""),style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),2===Z&&J.jsxs("div",{className:"space-y-4",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:"Загрузите информацию о вашей компании, продуктах и услугах. Это позволит ИИ-боту давать точные и релевантные ответы вашим клиентам."}),J.jsx("button",{onClick:()=>c("knowledge"),className:"h-[34px] w-full px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Загрузить"})]})]}),J.jsx("div",{className:"h-px bg-[#E5E7EB] my-[15px]"}),J.jsxs("div",{className:"rounded-[15px] p-0",children:[J.jsxs("div",{className:"flex items-start justify-between mb-3",children:[J.jsxs("div",{className:"flex items-center gap-[10px]",children:[Y.includes(3)?J.jsx("img",{src:"/Checkbox.svg",alt:"Выполнено",className:"w-[16px] h-[16px]"}):J.jsx("img",{src:"/Checkbox-1.svg",alt:"Не выполнено",className:"w-[16px] h-[16px]"}),J.jsx("h4",{className:"text-[16px] font-[500] cursor-pointer "+(Y.includes(3)?"line-through text-[#8E8E93]":"text-[#070F1A]"),onClick:()=>ee(3===Z?null:3),children:"Протестируйте и интегрируйте в каналы связи"})]}),J.jsx("button",{onClick:()=>ee(3===Z?null:3),className:"text-[#0084FF] hover:text-[#0073E6] transition-colors",children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px] transition-transform duration-300 "+(3===Z?"rotate-90":""),style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),3===Z&&J.jsxs("div",{className:"space-y-4",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:"Протестируйте работу вашего ИИ-бота, задав ему различные вопросы. Убедитесь, что он корректно отвечает и применяет настройки."}),J.jsx("button",{onClick:()=>c("my-solo"),className:"h-[34px] w-full px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Тестировать"})]})]})]})})]})]}),J.jsxs("div",{className:"mb-[50px]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A] mb-[20px]",children:"Дашборд"}),J.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[J.jsxs("div",{className:"rounded-[16px] p-6 cursor-pointer flex flex-col items-center text-center transition-all duration-200",onClick:()=>c("crm"),style:{...jm.whiteButton,":hover":{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=jm.whiteButton.backgroundColor,e.currentTarget.style.boxShadow=jm.whiteButton.boxShadow},children:[J.jsx("div",{className:"w-[24px] h-[24px] flex items-center justify-center mb-[5px]",children:J.jsx("img",{src:"./crm.svg",alt:"CRM",className:"w-[24px] h-[24px]",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)"}})}),J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"CRM"})]}),J.jsxs("div",{className:"rounded-[16px] p-6 cursor-pointer flex flex-col items-center text-center transition-all duration-200",onClick:()=>c("dialogs"),style:{...jm.whiteButton,":hover":{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=jm.whiteButton.backgroundColor,e.currentTarget.style.boxShadow=jm.whiteButton.boxShadow},children:[J.jsx("div",{className:"w-[24px] h-[24px] flex items-center justify-center mb-[5px]",children:J.jsx("img",{src:"./dialog.svg",alt:"Диалоги",className:"w-[24px] h-[24px]",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)"}})}),J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Диалоги"})]}),J.jsxs("div",{className:"rounded-[16px] p-6 cursor-pointer flex flex-col items-center text-center transition-all duration-200",onClick:()=>c("statistics"),style:{...jm.whiteButton,":hover":{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=jm.whiteButton.backgroundColor,e.currentTarget.style.boxShadow=jm.whiteButton.boxShadow},children:[J.jsx("div",{className:"w-[24px] h-[24px] flex items-center justify-center mb-[5px]",children:J.jsx("img",{src:"./stat.svg",alt:"Статистика",className:"w-[24px] h-[24px]",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(199deg) brightness(104%) contrast(101%)"}})}),J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Статистика"})]})]})]}),J.jsxs("div",{className:"mt-[20px]",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A] mb-[20px]",children:"Мини-обучение по платформе"}),J.jsx("div",{className:"w-full h-32 rounded-[15px] flex items-center justify-start cursor-pointer transition-all duration-300 p-0",children:J.jsx("img",{src:"/Frame 131.png",alt:"Мини-обучение",className:"w-[290px] h-[140px] object-contain"})})]})]});case"my-solo":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Мой Adapto"}),J.jsx("p",{className:"text-[#8E8E93] text-[14px]",style:{marginTop:"12px"},children:"Проверьте своего бота на знание скрипта и информации о вашей компании"}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsxs("div",{className:"flex-1 bg-white rounded-[20px] flex flex-col",style:{marginLeft:"-15px",marginRight:"10px",padding:"16px 16px 0px 16px"},children:[!Xr&&J.jsx("div",{className:"bg-[#FF3B30]/5 border border-[#FF3B30]/15 rounded-[15px] p-[15px] mb-6",children:J.jsxs("div",{className:"flex items-start gap-[11px]",children:[J.jsx("img",{src:"/alarm.svg",alt:"Предупреждение",className:"w-4 h-4 flex-shrink-0",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(340deg) brightness(104%) contrast(97%)"}}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[#FF3B30] font-[500] text-base mb-[11px]",children:"Предупреждение"}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("p",{className:"text-[#916464]/90 text-sm flex-1",children:"Вы не загрузили ничего в вашу базу знаний, ИИ-бот не готов к полноценной работе и будет отвечать некорректно!"}),J.jsx("button",{className:"text-[#FF3B30] font-[500] text-sm px-4 h-[34px] bg-[#FF3B30]/10 rounded-[12px] hover:bg-[#FF3B30]/20 transition-colors flex items-center ml-4",children:"Перейти в базу знаний"})]})]})]})}),J.jsx("div",{className:"flex-1 space-y-3 mb-6",children:Mr.map((e,t)=>J.jsxs("div",{className:"flex items-center",children:[J.jsx("div",{className:"w-[40px] h-[40px] border border-[#070F1A]/10 rounded-[10px] flex items-center justify-center",children:J.jsx("span",{className:"text-[#0084FF] font-semibold text-[14px]",children:t+1})}),J.jsx("div",{className:"w-[10px]"}),J.jsx("div",{className:"flex-1 h-[40px] bg-[#F3F5F7] rounded-[10px] flex items-center px-[10px]",children:J.jsx("span",{className:"text-[#070F1A] font-medium text-[14px] opacity-90",children:e.correction||e})}),J.jsx("div",{className:"w-[10px]"}),J.jsx("div",{className:"w-[40px] h-[40px] border border-[#070F1A]/10 rounded-[10px] flex items-center justify-center",children:J.jsx("button",{onClick:()=>(async e=>{try{console.log("Removing correction at index:",e);const t=Mr[e];if(console.log("Correction to remove:",t),t&&t.id){console.log("Deleting correction with ID:",t.id);const s=await Cm(t.id);console.log("Delete result:",s),s?(Lr(t=>t.filter((t,s)=>s!==e)),Oc("Корректировка удалена")):Oc("Ошибка при удалении корректировки")}else console.log("No ID found, removing from local state only"),Lr(t=>t.filter((t,s)=>s!==e)),Oc("Корректировка удалена")}catch(t){console.error("Error removing correction:",t),Oc("Ошибка при удалении корректировки")}})(t),className:"w-[16px] h-[16px] flex items-center justify-center",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-[16px] h-[16px] text-red-500",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"}})})})]},t))}),J.jsxs("div",{className:"relative",children:[J.jsx("textarea",{value:Dr,onChange:e=>Ir(e.target.value),placeholder:"Если вы увидели ошибку в ответах – напишите правильный вариант здесь",className:"w-full h-[48px] border border-gray-300 rounded-[90px] px-[15px] py-[12px] text-[#8E8E93] text-[14px] resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 pr-[60px]"}),J.jsx("img",{src:"/send-button.svg",alt:"Отправить",className:"absolute top-[5px] right-[5px] w-[38px] h-[38px] cursor-pointer",onClick:id})]})]}),J.jsxs("div",{className:"w-[400px] bg-[#070F1A] rounded-[20px] p-0 flex flex-col",style:{marginLeft:"15px",marginRight:"0px",height:"583px",flexShrink:0},children:[J.jsxs("div",{className:"flex items-center justify-between mb-4 px-4 pt-4",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"/logo-testing.svg",alt:"Тест",className:"w-5 h-5"}),J.jsx("h2",{className:"text-[18px] font-[500] text-white",children:"Тестирование Адапто"})]}),J.jsx("button",{onClick:async()=>{if(null==r?void 0:r.id)try{if(console.log("Attempting to clear chat history for user:",r.id),console.log("chatHistoryAPI object:",Am),console.log("clearChatHistory function:",Am.clearChatHistory),"function"!=typeof Am.clearChatHistory)throw new Error("clearChatHistory is not a function");const e=await Am.clearChatHistory(r.id);console.log("Clear chat history result:",e),e?(Er([{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?",time:"Только что",timestamp:Date.now()}]),Oc("История чата очищена"),Jm.scrollToBottom(Nn)):Oc("Ошибка при очистке истории")}catch(e){console.error("Error clearing chat history:",e),Oc("Ошибка при очистке истории: "+e.message)}else console.error("No current user ID available"),Oc("Ошибка: пользователь не найден")},className:"text-white text-xs px-2 py-1 rounded hover:bg-white/10 transition-colors",title:"Очистить историю",children:"Очистить"})]}),J.jsxs("div",{className:"flex-1 flex flex-col",children:[J.jsxs("div",{ref:Nn,className:"flex-1 space-y-4 overflow-y-auto mb-4 chat-history-container",style:{flexBasis:0},children:[J.jsxs("div",{className:"text-xs text-gray-500 p-2 bg-yellow-100 rounded",children:["DEBUG: chatHistory.length = ",_r.length,", currentUser.email = ",null==r?void 0:r.email,", currentUser.id = ",null==r?void 0:r.id,J.jsx("br",{}),"chatHistory: ",JSON.stringify(_r.slice(0,2))]}),J.jsx(Gm,{messages:_r,getMessageAlignment:rr,getMessageOrder:ar,getMessageStyle:ir,getMessageFooter:lr,aiAgentName:Vi,containerRef:Nn})]}),J.jsxs("div",{className:"relative flex-shrink-0 px-0 pb-4",children:[J.jsx("input",{type:"text",value:Ar,onChange:e=>Tr(e.target.value),placeholder:"Нажмите, чтобы печатать",className:"w-full h-[48px] px-0 py-2 rounded-[90px] focus:outline-none focus:ring-2 focus:ring-blue-500 pr-[50px]",style:{border:"1px solid rgba(255, 255, 255, 0.1)",backgroundColor:"#070F1A",color:"#8E8E93",fontSize:"14px"},onKeyPress:e=>"Enter"===e.key&&Kc()}),J.jsx("img",{src:"/send-button2.svg",alt:"Отправить",className:"absolute top-[5px] right-[5px] w-[38px] h-[38px] cursor-pointer",onClick:Kc})]})]})]})]})]});case"knowledge":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsxs("div",{children:[J.jsx("h1",{className:"text-[20px] font-[500]",children:"База знаний"}),(()=>{const e=ea.filter(e=>!ia||e.nicheId===ia),t=ea.length,s=e.length;return t>0?J.jsx("p",{className:"text-[12px] text-[#8E8E93] mt-1",children:ia?`Показано: ${s} из ${t} источников`:`Всего источников: ${t}`}):null})()]})}),J.jsxs("div",{children:[J.jsx("div",{className:"border-b border-gray-200 mb-0",style:{borderColor:"#E5E6E7",marginTop:"16px",marginLeft:"-24px",marginRight:"-24px",width:"calc(100% + 48px)"}}),ea.filter(e=>!ia||e.nicheId===ia).length>0?J.jsxs("div",{className:"border border-t-0 border-[#070F1A]/10 rounded-none overflow-hidden",style:{marginLeft:"-24px",marginRight:"-24px",width:"calc(100% + 48px)"},children:[J.jsxs("div",{className:"grid grid-cols-4 gap-4 px-[26px] py-4 border-b border-[#070F1A]/10 bg-gray-50",children:[J.jsx("div",{className:"font-[400] text-[14px] text-[#8E8E93]",children:"Название"}),J.jsx("div",{className:"font-[400] text-[14px] text-[#8E8E93] text-center",children:"Ресурс"}),J.jsx("div",{className:"font-[400] text-[14px] text-[#8E8E93]",children:"Статус"}),J.jsx("div",{className:"font-[400] text-[14px] text-[#8E8E93]"})]}),J.jsx("div",{className:"divide-y divide-[#070F1A]/10",children:ea.filter(e=>!ia||e.nicheId===ia).map((e,t)=>J.jsxs("div",{className:"grid grid-cols-4 gap-4 px-[26px] py-4 hover:bg-gray-50 transition-colors",children:[J.jsx("div",{className:"text-[#070F1A] text-sm truncate font-[500] "+("Обработка"===e.status?"animate-pulse":""),children:(e.original_content||e.content||"").length>50?`${(e.original_content||e.content||"").substring(0,50)}...`:e.original_content||e.content||""}),J.jsx("div",{className:"flex items-center justify-center",children:J.jsxs("div",{className:"h-[24px] px-2 rounded-[7px] bg-gray-100 flex items-center gap-[2px]",children:[J.jsx("img",{src:"site"===(e.source_type||e.type)?"/global2.svg":"feed"===(e.source_type||e.type)?"/document-code.svg":"text"===(e.source_type||e.type)?"/edit-2.svg":"/document-copy.svg",alt:e.type,className:"w-[10px] h-[10px]"}),J.jsxs("span",{className:"text-[12px] font-[400] text-[#070F1A]",children:["site"===(e.source_type||e.type)&&"Сайт","feed"===(e.source_type||e.type)&&"Товарный фид","text"===(e.source_type||e.type)&&"Текст","file"===(e.source_type||e.type)&&"Файл","website"===(e.source_type||e.type)&&"Сайт"]})]})}),J.jsx("div",{className:"flex items-center",children:J.jsxs("div",{className:"h-[24px] px-3 rounded-[50px] flex items-center gap-2 relative overflow-hidden "+("Загружено"===e.status?"bg-[#36C76A]/15 text-[#36C76A]":"Обработка"===e.status?"bg-[#0084FF]/15 text-[#0084FF]":"Ошибка"===e.status?"bg-[#FF3B30]/15 text-[#FF3B30]":"bg-[#0084FF]/15 text-[#0084FF]"),children:["Обработка"===e.status&&J.jsx("div",{className:"w-3 h-3 border-2 border-[#0084FF] border-t-transparent rounded-full animate-spin"}),J.jsx("span",{className:"text-[12px] font-[400] relative z-10",children:hd(e)}),"Обработка"===e.status&&ha[e.id]&&J.jsx("div",{className:"absolute inset-0 bg-[#0084FF]/20 transition-all duration-300 ease-out",style:{width:`${ha[e.id].progress}%`,left:0,top:0,height:"100%"}})]})}),J.jsx("div",{className:"flex justify-end items-center gap-2",children:J.jsxs("div",{className:"relative dropdown-menu",children:[(null==ga?void 0:ga.id)===e.id&&J.jsxs("div",{className:"absolute right-8 top-0 bg-white border border-gray-200 rounded-[10px] shadow-lg z-[9999] w-[120px]",children:[J.jsxs("button",{onClick:t=>{t.stopPropagation(),(e=>{Sa(e),Ea(!0),fa(null)})(e)},className:"w-full h-[34px] px-3 text-left text-[13px] text-[#070F1A] hover:bg-gray-50 rounded-t-[10px] transition-colors flex items-center gap-2",children:[J.jsx("img",{src:"/eye-open.svg",alt:"Подробнее",className:"w-4 h-4"}),"Подробнее"]}),J.jsxs("button",{onClick:s=>{s.stopPropagation(),(async e=>{try{await Fm(e)?(ta(t=>t.filter(t=>t.id!==e)),Oc("Элемент удален из базы знаний")):Oc("Ошибка при удалении элемента")}catch(t){console.error("Error deleting knowledge item:",t),Oc("Ошибка при удалении элемента")}})(e.id||t),fa(null)},className:"w-full h-[34px] px-3 text-left text-[13px] text-red-600 hover:bg-red-50 rounded-b-[10px] transition-colors flex items-center gap-2",children:[J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4"}),"Удалить"]})]}),J.jsx("button",{onClick:t=>{t.stopPropagation(),fa((null==ga?void 0:ga.id)===e.id?null:e)},className:"p-1 hover:bg-gray-100 rounded-[90px] transition-colors",children:J.jsx(dm,{className:"w-4 h-4 text-gray-500"})})]})})]},e.id||t))})]}):J.jsx("div",{className:"bg-[#F8F8FA] rounded-none border border-[#070F1A]/10 p-8 text-center",style:{marginLeft:"-24px",marginRight:"-24px",width:"calc(100% + 48px)",borderTopWidth:0},children:J.jsxs("div",{className:"max-w-md mx-auto",children:[J.jsx("span",{className:"w-8 h-8 mx-auto mb-4 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/baza.svg)",maskImage:"url(/baza.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}}),J.jsx("h3",{className:"text-[20px] font-medium mb-2",style:{color:"#8E8E93",opacity:.7},children:ia?`Нет источников для ниши "${(null==(t=ra.find(e=>e.id===ia))?void 0:t.name)||"Выбранная ниша"}"`:"База знаний пока пуста"}),J.jsx("p",{className:"text-sm mb-6",style:{color:"#8E8E93",opacity:.7},children:ia?"Загрузите источники знаний для выбранной ниши или выберите другую нишу":"Добавьте первый ресурс, чтобы начать работу с Adapto"})]})})]}),J.jsxs("div",{className:"relative rounded-[20px] border border-[#070F1A]/10 p-6 text-center bg-transparent overflow-hidden",children:[J.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-10 w-[240px] h-[120px] rounded-b-[240px] blur-[120px] opacity-50 pointer-events-none",style:{background:ia?ua(ia):"#E5E6E7",zIndex:0}}),J.jsx("h3",{className:"text-[20px] font-[500] text-[#070F1A] mb-[10px]",children:ia?J.jsxs(J.Fragment,{children:["Ваша ниша: ",J.jsx("span",{style:{color:ua(ia)},children:da((null==(n=ra.find(e=>e.id===ia))?void 0:n.name)||"")})]}):"Ваша ниша"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-[30px]",children:"Для улучшения качества работы системы базы знаний выберите свою нишу"}),J.jsx("div",{className:"relative z-10 flex flex-wrap justify-center gap-2",children:[{id:"",name:"Без ниши"},...ra.slice(0,10).map(e=>({...e,name:da(e.name)}))].map(e=>{const t=(ia||"")===(e.id||""),s=e.id?ua(e.id):"#8EE38A",n=t?e.id?s:"#070F1A":"transparent";return J.jsx("button",{onClick:()=>(async e=>{try{if(console.log("=== SELECTING NICHE ==="),console.log("Selected nicheId:",e),console.log("Current user ID:",null==r?void 0:r.id),la(e),na(t=>{const s={...t,nicheId:e};return console.log("Updated newKnowledgeItem:",s),s}),null==r?void 0:r.project_id){if(await tm.from("user_niches").delete().eq("project_id",r.project_id),e&&""!==e.trim()){const{error:t}=await tm.from("user_niches").insert({project_id:r.project_id,niche_id:e,created_at:(new Date).toISOString()});if(t)throw console.error("Error saving niche:",t),t}console.log("Niche saved to user_niches table")}const t=await Tm(r.id),s={...(null==t?void 0:t.settings)||{},nicheId:e};await Dm(r.id,s),Oc("✅ Ниша сохранена")}catch(t){console.error("Ошибка сохранения ниши:",t),Oc("❌ Не удалось сохранить нишу")}})(e.id||""),className:"h-[34px] px-4 rounded-[90px] text-[13px] font-[500] border transition-colors",style:{backgroundColor:n,color:t?"#FFFFFF":"#8E8E93",borderColor:t?n:"#E5E6E7"},children:e.name},e.id||"none")})})]}),J.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",style:{marginLeft:"1px",marginRight:"1px"},children:[J.jsx("div",{className:"border border-[#070F1A]/10 bg-white rounded-[15px] group hover:-translate-y-[10px] transition-all duration-300 cursor-pointer overflow-hidden "+(N?"h-[280px]":"h-[255px]"),onClick:pd,children:J.jsxs("div",{className:"w-full h-full flex flex-col",children:[J.jsx("div",{className:"w-full flex-shrink-0",style:{borderRadius:"15px 15px 0 0"},children:J.jsx("img",{src:"/Frame 2081.png",alt:"Веб-сайт",className:"w-[101%] h-auto"})}),J.jsxs("div",{className:"flex-1 p-[16px]",children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Веб-сайт"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Предоставьте ссылку на сайт, чтобы обеспечить ИИ знаниями"})]})]})}),J.jsx("div",{className:"border border-[#070F1A]/10 bg-white rounded-[15px] group hover:-translate-y-[10px] transition-all duration-300 cursor-pointer overflow-hidden "+(N?"h-[280px]":"h-[255px]"),onClick:gd,children:J.jsxs("div",{className:"w-full h-full flex flex-col",children:[J.jsx("div",{className:"w-full flex-shrink-0",style:{borderRadius:"15px 15px 0 0"},children:J.jsx("img",{src:"/Frame 2082.png",alt:"Товарный фид",className:"w-[101%] h-auto"})}),J.jsxs("div",{className:"flex-1 p-[16px]",children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Товарный фид"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Загрузите CSV/XML фид или ссылку на товарный каталог"})]})]})}),J.jsx("div",{className:"border border-[#070F1A]/10 bg-white rounded-[15px] group hover:-translate-y-[10px] transition-all duration-300 cursor-pointer overflow-hidden "+(N?"h-[280px]":"h-[255px]"),onClick:bd,children:J.jsxs("div",{className:"w-full h-full flex flex-col",children:[J.jsx("div",{className:"w-full flex-shrink-0",style:{borderRadius:"15px 15px 0 0"},children:J.jsx("img",{src:"/Frame 2083.png",alt:"Файл",className:"w-[101%] h-auto"})}),J.jsxs("div",{className:"flex-1 p-[16px]",children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Файл"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Импортируйте знания из документов или файлов для обучения ИИ"})]})]})}),J.jsx("div",{className:"border border-[#070F1A]/10 bg-white rounded-[15px] group hover:-translate-y-[10px] transition-all duration-300 cursor-pointer overflow-hidden "+(N?"h-[280px]":"h-[255px]"),onClick:yd,children:J.jsxs("div",{className:"w-full h-full flex flex-col",children:[J.jsx("div",{className:"w-full flex-shrink-0",style:{borderRadius:"15px 15px 0 0"},children:J.jsx("img",{src:"/Frame 2084.png",alt:"Текст",className:"w-[101%] h-auto"})}),J.jsxs("div",{className:"flex-1 p-[16px]",children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Текст"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Напишите текстом информацию, которую важно знать ИИ"})]})]})})]})]});case"statistics":return J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"flex justify-between items-center mb-4",children:[J.jsx("h1",{className:"text-[20px] font-[500]",children:"Статистика"}),J.jsxs("div",{className:"flex gap-3",children:[J.jsxs("div",{className:"relative",children:[J.jsxs(og,{variant:"outline",size:"sm",onClick:()=>{console.log("Calendar button clicked"),ti(!ei)},className:"h-[34px] bg-[#0084FF] text-white rounded-[10px] border-none",style:jm.blueButton,children:[J.jsx("svg",{width:"17",height:"17",viewBox:"0 0 23 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-[5px]",children:J.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.43597 4.18404C3 5.03969 3 6.15979 3 8.4V13.6C3 15.8402 3 16.9603 3.43597 17.816C3.81947 18.5686 4.43139 19.1805 5.18404 19.564C6.03969 20 7.15979 20 9.4 20H14.6C16.8402 20 17.9603 20 18.816 19.564C19.5686 19.1805 20.1805 18.5686 20.564 17.816C21 16.9603 21 15.8402 21 13.6V8.4C21 6.15979 21 5.03969 20.564 4.18404C20.1805 3.43139 19.5686 2.81947 18.816 2.43597C17.9603 2 16.9603 2 14.6 2H9.4C7.15979 2 6.03969 2 5.18404 2.43597C4.43139 2.81947 3.81947 3.43139 3.43597 4.18404ZM5.10899 7.54601C5 7.75992 5 8.03995 5 8.6V14.8C5 15.9201 5 16.4802 5.21799 16.908C5.40973 17.2843 5.71569 17.5903 6.09202 17.782C6.51984 18 7.0799 18 8.2 18H15.8C16.9201 18 17.4802 18 17.908 17.782C18.2843 17.5903 18.5903 17.2843 18.782 16.908C19 16.4802 19 15.9201 19 14.8V8.6C19 8.03995 19 7.75992 18.891 7.54601C18.7951 7.35785 18.6422 7.20487 18.454 7.10899C18.2401 7 17.9601 7 17.4 7H6.6C6.03995 7 5.75992 7 5.54601 7.10899C5.35785 7.20487 5.20487 7.35785 5.10899 7.54601Z",fill:"white"})}),si.start&&si.end?`${si.start.toLocaleDateString()} - ${si.end.toLocaleDateString()}`:"Выберите период"]}),ei&&J.jsx("div",{className:"absolute top-full right-0 mt-2 bg-white border border-gray-200 rounded-[15px] shadow-lg z-50 w-[400px]",children:J.jsxs("div",{className:"p-4",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h4",{className:"font-medium text-sm",children:"Выберите период"}),J.jsx("button",{onClick:()=>ti(!1),className:"w-7 h-7 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 text-gray-500",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]}),J.jsx("div",{className:"mb-4",children:J.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("today"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"today"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date;ni({start:e,end:e}),ci(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),ui(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),li("today"),(async(e,t)=>{if(null==r?void 0:r.id)try{const s=await Pm.getAggregates(r.id,e,t);s&&ma(s)}catch(s){console.warn("Failed to update statistics for period:",s)}})(e,e)},children:"Сегодня"}),J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("yesterday"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"yesterday"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date;e.setDate(e.getDate()-1),ni({start:e,end:e}),ci(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),ui(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),li("yesterday")},children:"Вчера"}),J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("last7days"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"last7days"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date,t=new Date;t.setDate(e.getDate()-6),ni({start:t,end:e}),ci(gi(`${String(t.getDate()).padStart(2,"0")}${String(t.getMonth()+1).padStart(2,"0")}${t.getFullYear()}`)),ui(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),li("last7days")},children:"7 дней"}),J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("thisMonth"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"thisMonth"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);ni({start:t,end:s}),ci(gi(`${String(t.getDate()).padStart(2,"0")}${String(t.getMonth()+1).padStart(2,"0")}${t.getFullYear()}`)),ui(gi(`${String(s.getDate()).padStart(2,"0")}${String(s.getMonth()+1).padStart(2,"0")}${s.getFullYear()}`)),li("thisMonth")},children:"Этот месяц"}),J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("last30days"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"last30days"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date,t=new Date;t.setDate(e.getDate()-29),ni({start:t,end:e}),ci(gi(`${String(t.getDate()).padStart(2,"0")}${String(t.getMonth()+1).padStart(2,"0")}${t.getFullYear()}`)),ui(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),li("last30days")},children:"30 дней"}),J.jsx("button",{className:"px-3 h-[34px] rounded-[90px] text-center transition-colors text-[13px] "+("last90days"===ii?"bg-[#0084FF] text-white":"bg-gray-100 hover:bg-gray-200"),style:"last90days"===ii?jm.blueButton:jm.whiteButton,onClick:()=>{const e=new Date,t=new Date;t.setDate(e.getDate()-89),ni({start:t,end:e}),ci(gi(`${String(t.getDate()).padStart(2,"0")}${String(t.getMonth()+1).padStart(2,"0")}${t.getFullYear()}`)),ui(gi(`${String(e.getDate()).padStart(2,"0")}${String(e.getMonth()+1).padStart(2,"0")}${e.getFullYear()}`)),li("last90days")},children:"90 дней"})]})}),J.jsxs("div",{className:"mb-4",children:[J.jsxs("div",{className:"flex justify-between items-center mb-2",children:[J.jsx("button",{onClick:()=>{ai(e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t})},className:"p-1 hover:bg-gray-100 rounded",children:"←"}),J.jsx("span",{className:"text-sm font-medium",children:ri.toLocaleDateString("ru-RU",{month:"long",year:"numeric"})}),J.jsx("button",{onClick:()=>{ai(e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t})},className:"p-1 hover:bg-gray-100 rounded",children:"→"})]}),J.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"].map(e=>J.jsx("div",{className:"text-xs text-gray-500 text-center",style:{width:"49px"},children:e},e))}),J.jsx("div",{className:"grid grid-cols-7 gap-1",children:(()=>{const e=[],t=ri.getFullYear(),s=ri.getMonth(),n=new Date(t,s,1),r=new Date(t,s+1,0),a=n.getDay(),i=0===a?6:a-1;for(let l=0;l<i;l++)e.push(null);for(let l=1;l<=r.getDate();l++)e.push(new Date(t,s,l));for(;e.length<42;)e.push(null);return e.map((e,t)=>{if(!e)return J.jsx("div",{className:"w-[49px] h-8"},t);const s=new Date,n=e.toDateString()===s.toDateString(),r=si.start&&e.toDateString()===si.start.toDateString(),a=si.start&&si.end&&e>=si.start&&e<=si.end;let i="h-8 rounded hover:bg-gray-100 text-center text-xs cursor-pointer inline-flex items-center justify-center";return r?i+=" bg-[#F3F5F7] text-[#070F1A]":a?i+=" bg-[#0084FF]/20 text-[#0084FF]":n&&(i+=" bg-gray-200 text-gray-800"),J.jsx("button",{onClick:()=>{si.start&&!si.end?ni(t=>({...t,end:e})):ni({start:e,end:null}),li(null)},className:i,style:{width:"49px",paddingLeft:"8px",paddingRight:"8px"},children:e.getDate()},t)})})()})]}),J.jsx("div",{className:"mb-4",children:J.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[J.jsx("div",{children:J.jsx("input",{type:"text",value:oi,onChange:e=>{const t=gi(e.target.value);ci(t),xi(!1)},onBlur:()=>{if(!fi(oi))return void xi(!0);const e=bi(oi);e&&(ni(t=>({...t,start:e})),li(null))},placeholder:"ДД.ММ.ГГГГ",className:"w-full h-[34px] px-3 text-[12px] border rounded-[10px] "+(hi?"border-red-400":"border-gray-300")})}),J.jsx("div",{children:J.jsx("input",{type:"text",value:di,onChange:e=>{const t=gi(e.target.value);ui(t),mi(!1)},onBlur:()=>{if(!fi(di))return void mi(!0);const e=bi(di);e&&(ni(t=>({...t,end:e})),li(null))},placeholder:"ДД.ММ.ГГГГ",className:"w-full h-[34px] px-3 text-[12px] border rounded-[10px] "+(pi?"border-red-400":"border-gray-300")})})]})}),J.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[J.jsx("button",{onClick:()=>ti(!1),className:"h-[34px] w-full bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[10px]",style:jm.blueButton,children:"Применить"}),J.jsx("button",{onClick:()=>{ni({start:null,end:null}),li(null),ci(""),ui(""),ti(!1)},className:"h-[34px] w-full text-gray-700 hover:bg-[#E5E7EB] rounded-[10px]",style:jm.whiteButton,children:"Сбросить"})]})]})})]}),J.jsxs("div",{className:"flex gap-2",children:[J.jsxs(og,{variant:"outline",size:"sm",onClick:()=>(()=>{const e=si.start&&si.end?`${si.start.toLocaleDateString()} - ${si.end.toLocaleDateString()}`:"Все время",t=[["Метрика","Значение","Период"],["Количество диалогов",pa.dialogsTotal||0,e],["Количество сообщений",pa.messagesTotal||0,e],["Среднее сообщений на диалог",(pa.avgMessagesPerDialog||0).toFixed(2),e],["Открытий виджета",pa.widget_opens||0,e],["Конверсия в основную цель",`${Math.round(pa.conversionRate||0)}%`,e],["Процент отказов",`${Math.round(pa.bounce_rate||0)}%`,e],["Вовлечение клиента",`${Math.round(pa.customer_engagement||0)}%`,e],["Решенных вопросов",pa.resolved_questions||0,e],["Коэффициент отклонений",`${Math.round(pa.escalation_rate||0)}%`,e],["Средняя скорость ответа",`${Math.round(pa.avg_response_time||0)}с`,e],["Средняя скорость разрешения",`${Math.round(pa.avg_resolution_time||0)}м`,e],["Оценка эффективности ИИ",`${(pa.ai_effectiveness_score||0).toFixed(1)}/10`,e],["Процент запросов о помощи",`${Math.round(pa.help_request_rate||0)}%`,e]].map(e=>e.join(",")).join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(s);n.setAttribute("href",r),n.setAttribute("download",`statistics_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)})(),className:"h-[34px] text-[#070F1A] rounded-[10px]",style:jm.whiteButton,children:[J.jsx("svg",{width:"17",height:"17",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-[5px]",children:J.jsx("path",{d:"M10 0.500244C15.2467 0.500244 19.5 4.75354 19.5 10.0002C19.5 15.2469 15.2467 19.5002 10 19.5002C4.75329 19.5002 0.5 15.2469 0.5 10.0002C0.5 4.75354 4.75329 0.500244 10 0.500244ZM10.5312 5.18384C10.2567 4.90956 9.82182 4.89203 9.52734 5.13208L9.4707 5.18384L6.04199 8.61255C5.74926 8.90535 5.7494 9.3802 6.04199 9.6731C6.33487 9.9659 6.80966 9.9659 7.10254 9.6731L9.25098 7.52466V14.2854C9.25098 14.6996 9.58683 15.0353 10.001 15.0354C10.4151 15.0353 10.751 14.6996 10.751 14.2854V7.52466L12.8994 9.6731C13.1923 9.96578 13.6671 9.96592 13.96 9.6731C14.2526 9.38026 14.2526 8.90539 13.96 8.61255L10.5312 5.18384Z",fill:"#070F1A"})}),"CSV"]}),J.jsxs(og,{variant:"outline",size:"sm",onClick:()=>(()=>{const e=si.start&&si.end?`${si.start.toLocaleDateString()} - ${si.end.toLocaleDateString()}`:"Все время",t=[["Метрика","Значение","Период"],["Количество диалогов",pa.dialogsTotal||0,e],["Количество сообщений",pa.messagesTotal||0,e],["Среднее сообщений на диалог",(pa.avgMessagesPerDialog||0).toFixed(2),e],["Открытий виджета",pa.widget_opens||0,e],["Конверсия в основную цель",`${Math.round(pa.conversionRate||0)}%`,e],["Процент отказов",`${Math.round(pa.bounce_rate||0)}%`,e],["Вовлечение клиента",`${Math.round(pa.customer_engagement||0)}%`,e],["Решенных вопросов",pa.resolved_questions||0,e],["Коэффициент отклонений",`${Math.round(pa.escalation_rate||0)}%`,e],["Средняя скорость ответа",`${Math.round(pa.avg_response_time||0)}с`,e],["Средняя скорость разрешения",`${Math.round(pa.avg_resolution_time||0)}м`,e],["Оценка эффективности ИИ",`${(pa.ai_effectiveness_score||0).toFixed(1)}/10`,e],["Процент запросов о помощи",`${Math.round(pa.help_request_rate||0)}%`,e]];let s="<table>";t.forEach(e=>{s+="<tr>",e.forEach(e=>{s+=`<td>${e}</td>`}),s+="</tr>"}),s+="</table>";const n=new Blob([s],{type:"application/vnd.ms-excel"}),r=document.createElement("a"),a=URL.createObjectURL(n);r.setAttribute("href",a),r.setAttribute("download",`statistics_${(new Date).toISOString().split("T")[0]}.xls`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)})(),className:"h-[34px] text-[#070F1A] rounded-[10px]",style:jm.whiteButton,children:[J.jsx("svg",{width:"17",height:"17",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-[5px]",children:J.jsx("path",{d:"M10 0.500244C15.2467 0.500244 19.5 4.75354 19.5 10.0002C19.5 15.2469 15.2467 19.5002 10 19.5002C4.75329 19.5002 0.5 15.2469 0.5 10.0002C0.5 4.75354 4.75329 0.500244 10 0.500244ZM10.5312 5.18384C10.2567 4.90956 9.82182 4.89203 9.52734 5.13208L9.4707 5.18384L6.04199 8.61255C5.74926 8.90535 5.7494 9.3802 6.04199 9.6731C6.33487 9.9659 6.80966 9.9659 7.10254 9.6731L9.25098 7.52466V14.2854C9.25098 14.6996 9.58683 15.0353 10.001 15.0354C10.4151 15.0353 10.751 14.6996 10.751 14.2854V7.52466L12.8994 9.6731C13.1923 9.96578 13.6671 9.96592 13.96 9.6731C14.2526 9.38026 14.2526 8.90539 13.96 8.61255L10.5312 5.18384Z",fill:"#070F1A"})}),"XLS"]})]})]})]}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px"}}),J.jsx("div",{children:J.jsxs("div",{className:"flex",children:[J.jsxs("div",{className:"flex-1 relative",children:[J.jsx("button",{onClick:()=>Ee("general"),className:"w-full py-3 px-4 text-[14px] font-medium transition-colors "+("general"===_e?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Общие метрики"}),"general"===_e&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]}),J.jsxs("div",{className:"flex-1 relative",children:[J.jsx("button",{onClick:()=>Ee("conversion"),className:"w-full py-3 px-4 text-[14px] font-medium transition-colors "+("conversion"===_e?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Метрики конверсий"}),"conversion"===_e&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]}),J.jsxs("div",{className:"flex-1 relative",children:[J.jsx("button",{onClick:()=>Ee("technical"),className:"w-full py-3 px-4 text-[14px] font-medium transition-colors "+("technical"===_e?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Технические метрики"}),"technical"===_e&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]}),J.jsxs("div",{className:"flex-1 relative",children:[J.jsx("button",{onClick:()=>Ee("channels"),className:"w-full py-3 px-4 text-[14px] font-medium transition-colors "+("channels"===_e?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Статистика по каналам"}),"channels"===_e&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]})]})}),J.jsx("div",{className:"border-b mb-0 mt-0",style:{borderColor:"#E5E6E7",marginTop:0,marginLeft:"-32px",marginRight:"-32px"}}),"general"===_e&&J.jsx("div",{className:"space-y-6",children:0===bc.length?J.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[J.jsx("span",{className:"w-8 h-8 mb-6 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/stat.svg)",maskImage:"url(/stat.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}}),J.jsx("h3",{className:"text-[20px] font-[500] mb-3",style:{color:"#8E8E93",opacity:.7},children:"Пока нет статистики"}),J.jsx("p",{className:"text-[14px] text-center max-w-[400px] mb-8",style:{color:"#8E8E93",opacity:.7},children:"Статистика появится после того, как клиенты начнут общаться с вашим ИИ-агентом"}),J.jsxs("div",{className:"flex flex-col gap-[10px] w-full max-w-[380px]",children:[J.jsx("button",{onClick:()=>{c("widget-dev"),Jm.scrollToBottom(kn,500)},className:"w-full h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Настроить виджет"}),J.jsx("button",{onClick:()=>c("my-adapto"),className:"w-full h-[34px] px-6 text-[#070F1A] rounded-[10px] hover:bg-[#F9FAFB] transition-colors",style:jm.whiteButton,children:"Протестировать ИИ"})]})]}):J.jsxs(J.Fragment,{children:[J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("widget-opens",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Кол-во открытий виджета"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:pa.widget_opens||0}),Uc("neutral","0%")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("dialog-count",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Кол-во диалогов"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:pa.dialogsTotal||0}),Uc("neutral","0%")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("message-count",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Кол-во сообщений"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:pa.messagesTotal||0}),Uc("neutral","0%")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("avg-messages-per-dialog",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Ср. кол-во смс на диалог"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:(null==(a=pa.avgMessagesPerDialog)?void 0:a.toFixed(2))||"0.00"}),Uc("neutral","0")]})})]})})]}),J.jsxs(ug,{className:"shadow-none",children:[J.jsx(hg,{children:J.jsx("h3",{style:{fontWeight:500},className:"text-lg font-semibold leading-none tracking-tight text-[18px] font-[500] text-[#070F1A]",children:"Активность по часам"})}),J.jsx(xg,{children:J.jsx("div",{className:"h-[300px] flex items-center justify-center",children:J.jsx(HourlyActivityChart,{userId:null==r?void 0:r.id,startDate:si.start,endDate:si.end})})})]})]})}),"conversion"===_e&&J.jsx("div",{className:"space-y-6",children:0===bc.length?J.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[J.jsx("span",{className:"w-8 h-8 mb-6 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/stat.svg)",maskImage:"url(/stat.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}}),J.jsx("h3",{className:"text-[20px] font-[500] mb-3",style:{color:"#8E8E93",opacity:.7},children:"Пока нет метрик конверсий"}),J.jsx("p",{className:"text-[14px] text-center max-w-[400px] mb-8",style:{color:"#8E8E93",opacity:.7},children:"Метрики конверсий появятся после начала работы с клиентами"}),J.jsxs("div",{className:"flex flex-col gap-[10px] w-full max-w-[380px]",children:[J.jsx("button",{onClick:()=>c("widget-dev"),className:"w-full h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Настроить виджет"}),J.jsx("button",{onClick:()=>c("my-adapto"),className:"w-full h-[34px] px-6 text-[#070F1A] rounded-[10px] hover:bg-[#F9FAFB] transition-colors",style:jm.whiteButton,children:"Протестировать ИИ"})]})]}):J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",style:{paddingTop:"12px"},children:[J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("conversion-rate",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Конверсия в основную цель"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.conversionRate||0),"%"]}),Uc("neutral","0%")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("bounce-rate",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Процент отказов"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.bounce_rate||0),"%"]}),Uc("neutral","0%",!1)]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("customer-engagement",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Вовлечение клиента"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.customer_engagement||0),"%"]}),Uc("neutral","0%")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("resolved-questions",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Кол-во решенных вопросов"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:pa.resolved_questions||0}),Uc("neutral","0")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("rejection-rate",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Коэффициент отклонений"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.escalation_rate||0),"%"]}),Uc("neutral","0%",!1)]})})]})})]})}),"technical"===_e&&J.jsx("div",{className:"space-y-6",children:0===bc.length?J.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[J.jsx("span",{className:"w-8 h-8 mb-6 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/stat.svg)",maskImage:"url(/stat.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}}),J.jsx("h3",{className:"text-[20px] font-[500] mb-3",style:{color:"#8E8E93",opacity:.7},children:"Пока нет технических метрик"}),J.jsx("p",{className:"text-[14px] text-center max-w-[400px] mb-8",style:{color:"#8E8E93",opacity:.7},children:"Технические метрики появятся после начала работы системы"}),J.jsxs("div",{className:"flex flex-col gap-[10px] w-full max-w-[380px]",children:[J.jsx("button",{onClick:()=>c("widget-dev"),className:"w-full h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Настроить виджет"}),J.jsx("button",{onClick:()=>c("my-adapto"),className:"w-full h-[34px] px-6 text-[#070F1A] rounded-[10px] hover:bg-[#F9FAFB] transition-colors",style:jm.whiteButton,children:"Протестировать ИИ"})]})]}):J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",style:{paddingTop:"12px"},children:[J.jsx(ug,{className:"shadow-none hover:bg-[#F9FAFB] hover:border-white transition-colors duration-150",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("avg-response-time",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Ср. скорость ответа ИИ-агента"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.avg_response_time||0),"с"]}),Uc("neutral","0",!1)]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("avg-resolution-time",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Ср. скорость разрешения вопроса"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.avg_resolution_time||0),"м"]}),Uc("neutral","0",!1)]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("ai-effectiveness",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Оценка эффективности ИИ-агента"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[(null==(i=pa.ai_effectiveness_score)?void 0:i.toFixed(1))||"0.0","/10"]}),Uc("neutral","0")]})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[170px] flex flex-col justify-between",style:{paddingTop:"15px"},children:[J.jsxs("div",{className:"flex items-center gap-2",style:{height:"21px"},children:[J.jsx("div",{onMouseEnter:e=>Bc("help-request-rate",e),onMouseLeave:zc,className:"w-4 h-4 text-gray-400 hover:text-gray-600 transition-colors relative cursor-help",children:J.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Процент чатов с запросом о помощи"})]}),J.jsx("div",{className:"flex flex-col",children:J.jsxs("div",{className:"flex items-end",children:[J.jsxs("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:[Math.round(pa.help_request_rate||0),"%"]}),Uc("neutral","0%",!1)]})})]})})]})}),"channels"===_e&&J.jsx("div",{className:"space-y-6",children:0===bc.length?J.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[J.jsx("span",{className:"w-8 h-8 mb-6 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/stat.svg)",maskImage:"url(/stat.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}}),J.jsx("h3",{className:"text-[20px] font-[500] mb-3",style:{color:"#8E8E93",opacity:.7},children:"Пока нет данных по каналам"}),J.jsx("p",{className:"text-[14px] text-center max-w-[400px] mb-8",style:{color:"#8E8E93",opacity:.7},children:"Статистика по каналам появится после настройки интеграций"}),J.jsxs("div",{className:"flex flex-col gap-[10px] w-full max-w-[380px]",children:[J.jsx("button",{onClick:()=>c("integrations"),className:"w-full h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Настроить интеграции"}),J.jsx("button",{onClick:()=>c("widget-dev"),className:"w-full h-[34px] px-6 text-[#070F1A] rounded-[10px] hover:bg-[#F9FAFB] transition-colors",style:jm.whiteButton,children:"Настроить виджет"})]})]}):J.jsx(ChannelStatistics,{userId:null==r?void 0:r.id,startDate:si.start,endDate:si.end})})]});case"integrations":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Интеграции"})}),J.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:Ln.map(e=>J.jsxs("div",{className:"border border-transparent rounded-[15px] p-[15px] group hover:border-[#070F1A]/10 transition-all duration-300",children:[J.jsxs("div",{className:"flex items-start gap-[15px] mb-[25px]",children:[J.jsx("div",{className:"flex-shrink-0",children:J.jsx("img",{src:`/${e.icon}`,alt:e.name,className:"w-[50px] h-[50px]"})}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:e.name}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:e.description})]})]}),J.jsx("div",{className:"w-full",children:e.installed?J.jsx("button",{className:"w-full h-[34px] border border-[#0084FF]/20 text-[#0084FF]/60 rounded-[12px] transition-colors hover:border-[#0084FF]/30 hover:text-[#0084FF]/80 text-[14px]",children:"Подключено"}):J.jsx("button",{onClick:()=>(e=>{"widget"===e.id?oe(!0):(ie(e),re(!0))})(e),className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[12px] hover:bg-[#0084FF]/90 transition-colors text-[14px]",children:"Подключить"})})]},e.id))}),J.jsx("div",{className:"mt-8 text-center",children:J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"*Instagram является продуктом Meta – признанной в РФ экстремисткой организацией"})})]});case"model-settings":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A] mb-[16px]",children:"Настройки модели"})}),J.jsx("div",{className:"border-b",style:{borderColor:"#E5E7EB",marginLeft:"-16px",marginRight:"-16px",marginTop:"0px"}}),J.jsxs("div",{className:"mb-[50px]",children:[J.jsxs("div",{className:"flex items-center gap-[15px] mb-6",children:[J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center mb-[20px]",children:J.jsx("span",{className:"text-white text-[10px] font-medium",children:"1"})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] tracking-[-3%]",children:"Уточните цели Adapto"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] tracking-[-2%]",children:"Настройте основные цели и задачи вашего ИИ-агента"})]})]}),J.jsxs("div",{className:"px-0 py-6",children:[J.jsxs("div",{className:"flex gap-6",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Какую роль должен выполнять бот?"}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsxs("button",{onClick:()=>Fr({...kr,task:"Продавать"}),className:"w-[220px] h-[190px] rounded-[15px] transition-all overflow-hidden flex flex-col border "+("Продавать"===kr.task?"bg-[#DBE9FF] border-[#0084FF]/50":"bg-[#F3F5F7] border-[#070F1A]/10"),children:[J.jsx("div",{className:"w-full h-[144px] rounded-t-[15px] overflow-hidden",children:J.jsx("img",{src:"/Продавец.png",alt:"Продавец",className:"w-full h-full object-cover object-top"})}),J.jsxs("div",{className:"flex-1 flex items-center gap-[7px] px-[15px]",children:["Продавать"===kr.task?J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}):J.jsx("div",{className:"w-[17px] h-[17px] bg-white rounded-[90px] border border-[#070F1A]/10"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Продавца"})]})]}),J.jsxs("button",{onClick:()=>Fr({...kr,task:"Консультировать"}),className:"w-[220px] h-[190px] rounded-[15px] transition-all overflow-hidden flex flex-col border "+("Консультировать"===kr.task?"bg-[#DBE9FF] border-[#0084FF]/50":"bg-[#F3F5F7] border-[#070F1A]/10"),children:[J.jsx("div",{className:"w-full h-[144px] rounded-t-[15px] overflow-hidden",children:J.jsx("img",{src:"/Консул.png",alt:"Консультант",className:"w-full h-full object-cover object-top"})}),J.jsxs("div",{className:"flex-1 flex items-center gap-[7px] px-[15px]",children:["Консультировать"===kr.task?J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}):J.jsx("div",{className:"w-[17px] h-[17px] bg-white rounded-[90px] border border-[#070F1A]/10"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Консультанта"})]})]})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Какая главная цель ИИ-агента?"}),J.jsxs("div",{className:"grid grid-cols-2 gap-[10px]",children:[J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:"Записать на консультацию"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Записать на консультацию"===kr.mainGoal?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Записать на консультацию"===kr.mainGoal?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"Записать на консультацию"})}),J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:"Продать продукт"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Продать продукт"===kr.mainGoal?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Продать продукт"===kr.mainGoal?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"Продать продукт"})}),J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:"Помочь решить проблему"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Помочь решить проблему"===kr.mainGoal?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Помочь решить проблему"===kr.mainGoal?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"Помочь решить проблему"})}),J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:"custom"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("custom"===kr.mainGoal?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"custom"===kr.mainGoal?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"Другое"})})]}),"custom"===kr.mainGoal&&J.jsx("div",{className:"mt-[10px]",children:J.jsx(cg,{placeholder:"Введите вариант",className:"w-full h-[34px] rounded-[10px] border border-[#070F1A]/10 text-[14px] text-[#070F1A]/70"})})]})]}),J.jsx("div",{className:"h-[50px]"}),J.jsxs("div",{className:"flex gap-6",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Какой цикл сделки в вашей компании?"}),J.jsx(dg,{value:kr.dealCycle||"",onChange:e=>Fr({...kr,dealCycle:e.target.value}),placeholder:"Обычно наши клиенты сначала оставляют заявку, далее наш менеджер связывается с ними по телефону, подтверждают заявку и ведут дальше по воронке: Тут 2 пути, зависит от того на что оставили заявку, но если 1 путь, то отправляет декларацию на отправку груза, обычный срок у нас 7 дней...",className:"min-h-[124px] rounded-[10px] border border-[#070F1A]/10 text-[14px] text-[#070F1A]/70"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Целевая аудитория"}),J.jsx(dg,{value:kr.targetAudience||"",onChange:e=>Fr({...kr,targetAudience:e.target.value}),placeholder:"Пол: Женщины Возраст: 18-45 Боль клиента: сложно найти подходящий размер",className:"min-h-[124px] rounded-[10px] border border-[#070F1A]/10 text-[14px] text-[#070F1A]/70"})]})]})]})]}),J.jsx("div",{className:"border-b",style:{borderColor:"#E5E7EB",marginLeft:"-16px",marginRight:"-16px",marginTop:"25px",marginBottom:"25px"}}),J.jsxs("div",{className:"mb-[50px]",children:[J.jsxs("div",{className:"flex items-center gap-[15px] mb-6",children:[J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center mb-[20px]",children:J.jsx("span",{className:"text-white text-[10px] font-medium",children:"2"})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] tracking-[-3%]",children:"Правила общения"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] tracking-[-2%]",children:"Настройте стиль общения и ограничения для вашего ИИ-агента"})]})]}),J.jsxs("div",{className:"px-0 py-6",children:[J.jsxs("div",{className:"flex gap-6",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Обращение к пользователю"}),J.jsxs("div",{className:"grid grid-cols-2 gap-[10px]",children:[J.jsx("button",{onClick:()=>Fr({...kr,addressing:"Вы"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Вы"===kr.addressing?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Вы"===kr.addressing?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:'На "Вы"'})}),J.jsx("button",{onClick:()=>Fr({...kr,addressing:"Ты"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Ты"===kr.addressing?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Ты"===kr.addressing?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:'На "Ты"'})})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Стиль общения"}),J.jsxs("div",{className:"grid grid-cols-2 gap-[10px]",children:[J.jsx("button",{onClick:()=>Fr({...kr,communicationStyle:"Дружелюбный"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Дружелюбный"===kr.communicationStyle?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Дружелюбный"===kr.communicationStyle?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"😊 Дружелюбный"})}),J.jsx("button",{onClick:()=>Fr({...kr,communicationStyle:"Нейтральный"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Нейтральный"===kr.communicationStyle?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Нейтральный"===kr.communicationStyle?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"😐 Нейтральный"})}),J.jsx("button",{onClick:()=>Fr({...kr,communicationStyle:"Профессиональный"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Профессиональный"===kr.communicationStyle?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Профессиональный"===kr.communicationStyle?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"💼 Профессиональный"})}),J.jsx("button",{onClick:()=>Fr({...kr,communicationStyle:"Юмористический"}),className:"h-[34px] rounded-[10px] transition-all text-[13px] "+("Юмористический"===kr.communicationStyle?"bg-[#0084FF] text-white":"bg-white border border-[#070F1A]/10 text-[#070F1A]/70"),style:"Юмористический"===kr.communicationStyle?jm.blueButton:jm.whiteButton,children:J.jsx("span",{className:"font-[500]",children:"😄 Юмористический"})})]})]})]}),J.jsx("div",{className:"h-[50px]"}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Ограничения Адапто"}),J.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Не обсуждай цены","Не давай финансовых советов","Не обсуждай политику","Не обсуждай религиозные темы","Не превышай полномочия и не создавай новые обязательства компании","Не давай юридические консультации","Не подтверждай наличие товара или услуги","Не гарантируй результат","Не давай длинных ответов","Поясняй ссылки при их отправке","Используй молодежный сленг","Не осуждай предпочтения клиента","Не оказывай давление на клиента","Избегай споров","Отвечай от первого лица","Используй бытовой язык","Не давай технические советы"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.restrictions||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,restrictions:s})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+((kr.restrictions||[]).includes(e)?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),style:(kr.restrictions||[]).includes(e)?jm.blueButton:jm.whiteButton,children:e},e)),J.jsx("button",{onClick:()=>Fr({...kr,showCustomRestriction:!kr.showCustomRestriction}),className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+(kr.showCustomRestriction?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),style:kr.showCustomRestriction?jm.blueButton:jm.whiteButton,children:"Другое"})]}),kr.showCustomRestriction&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customRestriction||"",onChange:e=>Fr({...kr,customRestriction:e.target.value}),placeholder:"Введите вариант",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customRestriction){const e=kr.restrictions||[];Fr({...kr,restrictions:[...e,kr.customRestriction],customRestriction:"",showCustomRestriction:!1})}},disabled:!kr.customRestriction,className:"bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0084FF]/90",style:jm.blueButton,children:"Добавить"})]})]}),J.jsx("div",{className:"h-[50px]"}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Дополнительные настройки общения"}),J.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Не гарантировать результат","Пояснять ссылки перед отправкой","Проверять понимание ответа","Избегать длинных сообщений","Уточнять задачу в начале общения","Не оказывать давление на клиента","Предупреждать об ожидании ответа","Избегать споров","Отвечать от первого лица"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.communicationSettings||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,communicationSettings:s})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+((kr.communicationSettings||[]).includes(e)?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),style:(kr.communicationSettings||[]).includes(e)?jm.blueButton:jm.whiteButton,children:e},e)),(kr.communicationSettings||[]).filter(e=>!["Не гарантировать результат","Пояснять ссылки перед отправкой","Проверять понимание ответа","Избегать длинных сообщений","Уточнять задачу в начале общения","Не оказывать давление на клиента","Предупреждать об ожидании ответа","Избегать споров","Отвечать от первого лица"].includes(e)).map(e=>J.jsx("button",{onClick:()=>{const t=(kr.communicationSettings||[]).filter(t=>t!==e);Fr({...kr,communicationSettings:t})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] border-[#0084FF] bg-[#0084FF] text-white",children:e},e)),J.jsx("button",{onClick:()=>Fr({...kr,showCustomCommunicationSetting:!kr.showCustomCommunicationSetting}),className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+(kr.showCustomCommunicationSetting?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),children:"Другое"})]}),kr.showCustomCommunicationSetting&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customCommunicationSetting||"",onChange:e=>Fr({...kr,customCommunicationSetting:e.target.value}),placeholder:"Введите вариант",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customCommunicationSetting){const e=kr.communicationSettings||[];Fr({...kr,communicationSettings:[...e,kr.customCommunicationSetting],customCommunicationSetting:"",showCustomCommunicationSetting:!1})}},disabled:!kr.customCommunicationSetting,className:"bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0084FF]/90",style:jm.blueButton,children:"Добавить"})]})]}),J.jsx("div",{className:"h-[50px]"}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Уточнять или задавать вопрос клиенту"}),J.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Если запрос неполный","Если клиент сомневается","Если есть риск ошибки","При выборе продукта или услуги","Если ответ зависит от тонкостей","Если клиент проявляет интерес к нескольким вариантам","Если клиент не понимает предложенное","Если требуется индивидуальный подбор","Если клиент задаёт вопросы вне своей компетенции","Если клиент спрашивает о вещах, которые требует специальных знаний","При оформлении заявки или заказа","Перед тем как оформить что-то важное","Если клиент долго молчит"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.clarificationQuestions||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,clarificationQuestions:s})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+((kr.clarificationQuestions||[]).includes(e)?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),style:(kr.clarificationQuestions||[]).includes(e)?jm.blueButton:jm.whiteButton,children:e},e)),(kr.clarificationQuestions||[]).filter(e=>!["Если запрос неполный","Если клиент сомневается","Если есть риск ошибки","При выборе продукта или услуги","Если ответ зависит от тонкостей","Если клиент проявляет интерес к нескольким вариантам","Если клиент не понимает предложенное","Если требуется индивидуальный подбор","Если клиент задаёт вопросы вне своей компетенции","Если клиент спрашивает о вещах, которые требует специальных знаний","При оформлении заявки или заказа","Перед тем как оформить что-то важное","Если клиент долго молчит"].includes(e)).map(e=>J.jsx("button",{onClick:()=>{const t=(kr.clarificationQuestions||[]).filter(t=>t!==e);Fr({...kr,clarificationQuestions:t})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] border-[#0084FF] bg-[#0084FF] text-white",children:e},e)),J.jsx("button",{onClick:()=>Fr({...kr,showCustomClarificationQuestion:!kr.showCustomClarificationQuestion}),className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+(kr.showCustomClarificationQuestion?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),children:"Другое"})]}),kr.showCustomClarificationQuestion&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customClarificationQuestion||"",onChange:e=>Fr({...kr,customClarificationQuestion:e.target.value}),placeholder:"Введите вариант",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customClarificationQuestion){const e=kr.clarificationQuestions||[];Fr({...kr,clarificationQuestions:[...e,kr.customClarificationQuestion],customClarificationQuestion:"",showCustomClarificationQuestion:!1})}},disabled:!kr.customClarificationQuestion,className:"bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0084FF]/90",style:jm.blueButton,children:"Добавить"})]})]}),J.jsx("div",{className:"h-[50px]"}),J.jsxs("div",{className:"flex gap-6",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Сбор данных"}),J.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Имя","Номер телефона","Почта","Адрес доставки","Город","Возраст"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.dataCollection||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,dataCollection:s})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+((kr.dataCollection||[]).includes(e)?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),style:(kr.dataCollection||[]).includes(e)?jm.blueButton:jm.whiteButton,children:e},e)),(kr.dataCollection||[]).filter(e=>!["Имя","Номер телефона","Почта","Адрес доставки","Город","Возраст"].includes(e)).map(e=>J.jsx("button",{onClick:()=>{const t=(kr.dataCollection||[]).filter(t=>t!==e);Fr({...kr,dataCollection:t})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] border-[#0084FF] bg-[#0084FF] text-white",children:e},e)),J.jsx("button",{onClick:()=>Fr({...kr,dataCollection:[]}),className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+(0===(kr.dataCollection||[]).length?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),children:"Не собирать данные"}),J.jsx("button",{onClick:()=>{Fr({...kr,showCustomData:!kr.showCustomData})},className:"px-4 h-[34px] rounded-[50px] border border-[1px] transition-all text-[13px] "+(kr.showCustomData?"border-[#0084FF] bg-[#0084FF] text-white":"border-[#070F1A]/10 bg-white text-[#070F1A]/70"),children:"Добавить данные"})]}),kr.showCustomData&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customData||"",onChange:e=>Fr({...kr,customData:e.target.value}),placeholder:"Ввести параметр",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customData){const e=kr.dataCollection||[];Fr({...kr,dataCollection:[...e,kr.customData],customData:"",showCustomData:!1})}},disabled:!kr.customData,className:"bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0084FF]/90",style:jm.blueButton,children:"Добавить"})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] tracking-[-3%] mb-[20px]",children:"Количество эмодзи в общении"}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsxs("button",{onClick:()=>Fr({...kr,emojiUsage:"Никогда"}),className:"relative w-[178px] h-[190px] rounded-[15px] transition-all overflow-hidden flex flex-col border "+("Никогда"===kr.emojiUsage?"bg-[#DBE9FF] border-[#0084FF]/50":"bg-[#F3F5F7] border-[#070F1A]/10"),children:[J.jsx("div",{className:"w-full h-[144px] rounded-t-[15px] overflow-hidden",children:J.jsx("div",{className:"w-full h-full bg-[#F3F5F7] flex items-center justify-center",children:J.jsx("img",{src:"/Frame 121.png",alt:"Никогда",className:"w-full h-full object-cover"})})}),J.jsxs("div",{className:"flex-1 flex items-center gap-[7px] px-[15px]",children:["Никогда"===kr.emojiUsage?J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}):J.jsx("div",{className:"w-[17px] h-[17px] bg-white rounded-[90px] border border-[#070F1A]/10"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Никогда"})]})]}),J.jsxs("button",{onClick:()=>Fr({...kr,emojiUsage:"Редко"}),className:"relative w-[178px] h-[190px] rounded-[15px] transition-all overflow-hidden flex flex-col border "+("Редко"===kr.emojiUsage?"bg-[#DBE9FF] border-[#0084FF]/50":"bg-[#F3F5F7] border-[#070F1A]/10"),children:[J.jsx("div",{className:"w-full h-[144px] rounded-t-[15px] overflow-hidden",children:J.jsx("div",{className:"w-full h-full bg-[#F3F5F7] flex items-center justify-center",children:J.jsx("img",{src:"/Frame 119.png",alt:"Редко",className:"w-full h-full object-cover"})})}),J.jsxs("div",{className:"flex-1 flex items-center gap-[7px] px-[15px]",children:["Редко"===kr.emojiUsage?J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}):J.jsx("div",{className:"w-[17px] h-[17px] bg-white rounded-[90px] border border-[#070F1A]/10"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Редко"})]})]}),J.jsxs("button",{onClick:()=>Fr({...kr,emojiUsage:"Часто"}),className:"relative w-[178px] h-[190px] rounded-[15px] transition-all overflow-hidden flex flex-col border "+("Часто"===kr.emojiUsage?"bg-[#DBE9FF] border-[#0084FF]/50":"bg-[#F3F5F7] border-[#070F1A]/10"),children:[J.jsx("div",{className:"w-full h-[144px] rounded-t-[15px] overflow-hidden",children:J.jsx("div",{className:"w-full h-full bg-[#F3F5F7] flex items-center justify-center",children:J.jsx("img",{src:"/Frame 120.png",alt:"Часто",className:"w-full h-full object-cover"})})}),J.jsxs("div",{className:"flex-1 flex items-center gap-[7px] px-[15px]",children:["Часто"===kr.emojiUsage?J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}):J.jsx("div",{className:"w-[17px] h-[17px] bg-white rounded-[90px] border border-[#070F1A]/10"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Часто"})]})]})]})]})]})]})]}),J.jsx("div",{className:"border-b",style:{borderColor:"#E5E7EB",marginLeft:"-16px",marginRight:"-16px",marginTop:"25px",marginBottom:"25px"}}),J.jsxs("div",{className:"mb-[50px]",children:[J.jsxs("div",{className:"flex items-center gap-[15px] mb-0",children:[J.jsx("div",{className:"w-[17px] h-[17px] bg-[#0084FF] rounded-[90px] flex items-center justify-center mb-[20px]",children:J.jsx("span",{className:"text-white text-[10px] font-medium",children:"3"})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] tracking-[-3%]",children:"Воронка продаж"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] tracking-[-2%]",children:"Опишите детально этапы диалога для вашего ИИ-агента"})]})]}),J.jsxs("div",{className:"px-0 py-6",style:{paddingTop:"0px"},children:[J.jsx("div",{className:"h-[20px]"}),J.jsxs("div",{className:"space-y-[10px]",children:[(kr.dialogStages||["🎯 УСТАНОВЛЕНИЕ КОНТАКТА: Поздоровайся тепло, представься как ИИ-помощник. Спроси имя клиента и как дела. Создай дружелюбную атмосферу.","🔍 ВЫЯСНЕНИЕ ПОТРЕБНОСТЕЙ: Задавай открытые вопросы о проблемах клиента, целях и ситуации. Уточни детали: бюджет, сроки, приоритеты.","💡 ПРЕЗЕНТАЦИЯ И ЗАКРЫТИЕ: Предложи решение на основе потребностей. Расскажи о преимуществах и выгодах. При возражениях - выясни причину и предложи альтернативы. Когда готов - подведи итоги и предложи оформить заказ."]).map((e,t)=>{const s=kr.editingStage===t;return J.jsxs("div",{className:"flex items-center gap-[10px]",children:[J.jsx("div",{className:"w-[34px] h-[34px] bg-[#F3F8FF] border border-[#070F1A]/10 rounded-[10px] flex items-center justify-center",children:J.jsx("span",{className:"text-[14px] text-[#0084FF] font-medium",children:t+1})}),J.jsx("div",{className:"flex-1",children:J.jsx("div",{className:"flex-1",children:J.jsx(dg,{value:e,onChange:e=>{const s=[...kr.dialogStages||[]];s[t]=e.target.value,Fr({...kr,dialogStages:s})},className:"w-full resize-none border rounded-[10px] p-3 min-h-[60px] "+(s?"border-[#070F1A]/10 bg-white":"border-[#070F1A]/10 bg-gray-50 cursor-not-allowed"),rows:1,placeholder:"Опишите этап диалога",readOnly:!s,style:{minHeight:"60px",height:"auto"},onInput:e=>{e.target.style.height="auto",e.target.style.height=Math.max(60,e.target.scrollHeight)+"px"},"data-stage-index":t})})}),J.jsx("button",{onClick:()=>{s?Fr({...kr,editingStage:null}):(Fr({...kr,editingStage:t}),setTimeout(()=>{const e=document.querySelector(`textarea[data-stage-index="${t}"]`);e&&(e.focus(),e.setSelectionRange(e.value.length,e.value.length))},100))},className:"w-[34px] h-[34px] bg-white border border-[#070F1A]/10 rounded-[10px] flex items-center justify-center hover:bg-gray-50",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[14px] h-[14px]",style:{filter:"brightness(0) saturate(100%) invert(59%) sepia(2%) saturate(0%) hue-rotate(217deg) brightness(92%) contrast(89%)"}})}),J.jsx("button",{onClick:()=>{const e=[...kr.dialogStages||[]];e.splice(t,1),Fr({...kr,dialogStages:e})},className:"w-[34px] h-[34px] bg-white border border-[#070F1A]/10 rounded-[10px] flex items-center justify-center",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-5 h-5",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"}})})]},t)}),J.jsxs("div",{className:"flex gap-2",children:[J.jsx(og,{onClick:()=>{const e=[...kr.dialogStages||[],"Новый этап диалога"];Fr({...kr,dialogStages:e})},className:"flex-1 h-[34px] bg-white border border-[#E5E6E7] text-[#070F1A] hover:bg-[#F2F3F4] text-[14px] transition-all shadow-[0_1px_2px_rgba(7,15,26,0.06)]",children:"Добавить этап"}),J.jsx(og,{onClick:()=>{Fr({...kr,dialogStages:["🎯 УСТАНОВЛЕНИЕ КОНТАКТА: Поздоровайся тепло, представься как ИИ-помощник. Спроси имя клиента и как дела. Создай дружелюбную атмосферу.","🔍 ВЫЯСНЕНИЕ ПОТРЕБНОСТЕЙ: Задавай открытые вопросы о проблемах клиента, целях и ситуации. Уточни детали: бюджет, сроки, приоритеты.","💡 ПРЕЗЕНТАЦИЯ И ЗАКРЫТИЕ: Предложи решение на основе потребностей. Расскажи о преимуществах и выгодах. При возражениях - выясни причину и предложи альтернативы. Когда готов - подведи итоги и предложи оформить заказ."],dialogStagesModified:!0})},className:"flex-1 h-[34px] bg-[#F2F3F4] border border-[#E5E6E7] text-[#070F1A] hover:bg-white text-[14px] transition-all shadow-[0_1px_2px_rgba(7,15,26,0.06)]",children:"Сбросить к стандартным"})]})]}),J.jsx("div",{className:"h-[20px]"}),J.jsx("div",{className:"h-[30px]"})]})]}),J.jsx("div",{className:"sticky bottom-0 z-10 mt-6",children:J.jsxs("div",{className:"flex gap-[20px] w-full shadow-[0_12px_30px_rgba(7,15,26,0.12)]/50",children:[J.jsx(og,{onClick:async()=>{if(s&&r)try{const t={task:kr.task,mainGoal:kr.mainGoal,mainGoalCustom:kr.mainGoalCustom,customGoal:kr.customGoal,dealCycle:kr.dealCycle,targetAudience:kr.targetAudience,addressing:kr.addressing,communicationStyle:kr.communicationStyle,restrictions:kr.restrictions,customRestriction:kr.customRestriction,communicationSettings:kr.communicationSettings,customCommunicationSetting:kr.customCommunicationSetting,dataCollection:kr.dataCollection,customData:kr.customData,clarificationQuestions:kr.clarificationQuestions,customClarificationQuestion:kr.customClarificationQuestion,emojiUsage:kr.emojiUsage,dialogStages:kr.dialogStages,dialogStagesModified:kr.dialogStagesModified,modelProvider:kr.modelProvider,modelName:kr.modelName,temperature:kr.temperature,maxTokens:kr.maxTokens,systemPrompt:kr.systemPrompt,customInstructions:kr.customInstructions,enableRag:kr.enableRag,enableValidation:kr.enableValidation,enableMonitoring:kr.enableMonitoring};try{const e=await Mm(r.id,t);Pc(e?"✅ Настройки модели успешно сохранены в базу данных!":"❌ Ошибка при сохранении в базу данных")}catch(e){console.error("Error saving model settings to database:",e),Pc("❌ Ошибка при сохранении в базу данных: "+e.message)}}catch(e){console.error("Error saving model settings:",e),Pc("❌ Ошибка при сохранении настроек")}else Pc("❌ Ошибка: пользователь не авторизован")},className:"flex-1 h-[34px] px-6 text-[#070F1A] rounded-[10px] hover:bg-[#F2F3F4] transition-colors",style:jm.whiteButton,children:"Сохранить изменения"}),J.jsx(og,{onClick:async()=>{if(s&&r)try{const t={task:kr.task,mainGoal:kr.mainGoal,mainGoalCustom:kr.mainGoalCustom,customGoal:kr.customGoal,dealCycle:kr.dealCycle,targetAudience:kr.targetAudience,addressing:kr.addressing,communicationStyle:kr.communicationStyle,restrictions:kr.restrictions,customRestriction:kr.customRestriction,communicationSettings:kr.communicationSettings,customCommunicationSetting:kr.customCommunicationSetting,dataCollection:kr.dataCollection,customData:kr.customData,clarificationQuestions:kr.clarificationQuestions,customClarificationQuestion:kr.customClarificationQuestion,emojiUsage:kr.emojiUsage,dialogStages:kr.dialogStages,dialogStagesModified:kr.dialogStagesModified,modelProvider:kr.modelProvider,modelName:kr.modelName,temperature:kr.temperature,maxTokens:kr.maxTokens,systemPrompt:kr.systemPrompt,customInstructions:kr.customInstructions,enableRag:kr.enableRag,enableValidation:kr.enableValidation,enableMonitoring:kr.enableMonitoring};try{const e=await Mm(r.id,t);Pc(e?"✅ Настройки модели успешно сохранены в базу данных!":"❌ Ошибка при сохранении в базу данных")}catch(e){console.error("Error saving model settings to database:",e),Pc("❌ Ошибка при сохранении в базу данных: "+e.message)}c("my-adapto"),Jm.scrollToBottom(Nn,500)}catch(e){console.error("Error saving model settings:",e),Pc("❌ Ошибка при сохранении настроек")}else Pc("❌ Ошибка: пользователь не авторизован")},className:"flex-1 h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Сохранить и протестировать"})]})})]});case"dialogs":return J.jsxs("div",{className:"flex flex-col h-full",children:[J.jsx("div",{className:"flex justify-between items-center mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500]",children:"Диалоги"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB]",style:{marginLeft:"-32px",marginRight:"-32px"}}),J.jsxs("div",{className:"grid grid-cols-12 gap-0 overflow-hidden flex-1 min-h-0 -mb-4",children:[J.jsxs("div",{className:"col-span-4 bg-[#F8F8FA] flex flex-col h-full min-h-0 overflow-hidden pr-4",children:[J.jsxs("div",{className:"p-0",children:[J.jsx("div",{className:"mb-[10px] mt-[10px]",children:J.jsxs("div",{className:"flex gap-0 bg-[#F2F3F4] h-[40px] rounded-[10px] p-[3px]",children:[J.jsx("button",{onClick:()=>ki("all"),className:"flex-1 h-[34px] rounded-[9px] text-[13px] font-medium transition-colors "+("all"===Ni?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Входящие"}),J.jsx("button",{onClick:()=>ki("active"),className:"flex-1 h-[34px] rounded-[9px] text-[13px] font-medium transition-colors "+("active"===Ni?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:p?"Мои":"Активные"}),J.jsx("button",{onClick:()=>ki("closed"),className:"flex-1 h-[34px] rounded-[9px] text-[13px] font-medium transition-colors "+("closed"===Ni?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Завершенные"})]})}),J.jsx("div",{className:"mb-[10px] mt-[10px]",children:J.jsxs("div",{className:"flex gap-1 bg-[#F8F8FA] h-[32px] rounded-[8px] p-[2px] overflow-x-auto",children:[J.jsx("button",{onClick:()=>_i("all"),className:"px-3 h-[28px] rounded-[6px] text-[12px] font-medium transition-colors whitespace-nowrap "+("all"===Fi?"bg-white text-[#0084FF] shadow-sm":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Все каналы"}),J.jsx("button",{onClick:()=>_i("widget"),className:"px-3 h-[28px] rounded-[6px] text-[12px] font-medium transition-colors whitespace-nowrap "+("widget"===Fi?"bg-white text-[#0084FF] shadow-sm":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Виджет"}),J.jsx("button",{onClick:()=>_i("telegram"),className:"px-3 h-[28px] rounded-[6px] text-[12px] font-medium transition-colors whitespace-nowrap "+("telegram"===Fi?"bg-white text-[#0084FF] shadow-sm":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Telegram"}),J.jsx("button",{onClick:()=>_i("whatsapp"),className:"px-3 h-[28px] rounded-[6px] text-[12px] font-medium transition-colors whitespace-nowrap "+("whatsapp"===Fi?"bg-white text-[#0084FF] shadow-sm":"text-[#8E8E93] hover:text-[#0084FF]"),children:"WhatsApp"}),J.jsx("button",{onClick:()=>_i("admin"),className:"px-3 h-[28px] rounded-[6px] text-[12px] font-medium transition-colors whitespace-nowrap "+("admin"===Fi?"bg-white text-[#0084FF] shadow-sm":"text-[#8E8E93] hover:text-[#0084FF]"),children:"Админ"})]})}),J.jsxs("div",{className:"relative",children:[J.jsx(gm,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-[#8E8E93]"}),J.jsx("input",{placeholder:"Найти чат",value:Ei,onChange:e=>sr(e.target.value),className:"w-full pl-10 h-[34px] text-[13px] border-0 bg-transparent focus:outline-none focus:ring-0",style:{color:"#070F1A"}})]}),J.jsx("div",{className:"border-b mt-[10px]",style:{borderColor:"#E5E6E7"}})]}),J.jsx("div",{className:"overflow-y-auto p-0 space-y-3 flex-1 mt-4",children:bc.length>0&&nr().map(e=>J.jsx("div",{className:"p-3 rounded-[15px] cursor-pointer transition-all "+((null==vi?void 0:vi.id)===e.id?"bg-[#F2F3F4] border border-transparent":"hover:bg-[#F2F3F4] border border-transparent"),onClick:()=>{yi(e),"active"===e.status||"waiting"===e.status?x(!0):x(!1)},children:J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsxs("div",{className:"w-[18px] h-[18px] bg-[#F3F4F6] rounded-[90px] flex items-center justify-center overflow-hidden",style:{marginBottom:"20px"},children:["widget"===e.source&&J.jsx("img",{src:"/Group 102.svg",alt:"Widget",className:"w-full h-full"}),"telegram"===e.source&&J.jsx("img",{src:"/Group 38.svg",alt:"Telegram",className:"w-full h-full"}),"whatsapp"===e.source&&J.jsx("img",{src:"/Group 37.svg",alt:"WhatsApp",className:"w-full h-full"}),"vk"===e.source&&J.jsx("img",{src:"/Group 39.svg",alt:"VK",className:"w-full h-full"})]}),J.jsxs("div",{className:"flex-1 min-w-0",children:[J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("h3",{className:"font-[500] text-[14px] text-[#070F1A] truncate",children:e.user}),J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(()=>{const t=e.priority||"low",s="rgba(7,15,26,0.2)",n="high"===t||"urgent"===t,r="medium"===t,a=n?"#FF3B30":r?"#FFCE52":"#05D560",i=n?"#FF3B30":r?"#FFCE52":s,l=n?"#FF3B30":s;return J.jsxs("g",{children:[J.jsx("rect",{x:"1",y:"10",width:"4",height:"6",rx:"1",fill:a}),J.jsx("rect",{x:"6",y:"6",width:"4",height:"10",rx:"1",fill:i}),J.jsx("rect",{x:"11",y:"3",width:"4",height:"13",rx:"1",fill:l})]})})()}),J.jsx("div",{className:"rounded-full flex items-center justify-center",style:{width:"18px",height:"18px",backgroundColor:"taken"===e.status?"#A684FF":"transparent"},children:"taken"===e.status?J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[11px] h-[11px]",style:{filter:"brightness(0) invert(1)"}}):J.jsx("span",{className:"w-[18px] h-[18px] inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/aiii.svg)",maskImage:"url(/aiii.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}})})]})]}),J.jsxs("div",{className:"flex items-center justify-between mt-1 gap-3",children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93] truncate flex-1",children:e.lastMessage}),J.jsx("span",{className:"text-[10px] text-[#9CA3AF] whitespace-nowrap",children:e.time})]})]})]}),("active"===e.status||"waiting"===e.status)&&J.jsx(J.Fragment,{children:e.canTakeover&&!e.assignedTo?J.jsx("button",{onClick:t=>{t.stopPropagation(),er(e.id)},className:"mt-[6px] h-[34px] px-4 bg-[#36C76A] text-white rounded-[10px] hover:bg-[#2BA855] transition-colors",style:jm.blueButton,children:"Взять диалог"}):e.assignedTo&&e.assignedTo!==(null==r?void 0:r.id)?J.jsx("button",{disabled:!0,className:"mt-[6px] h-[34px] px-4 bg-gray-300 text-gray-500 rounded-[10px] cursor-not-allowed",children:"Занят оператором"}):e.assignedTo===(null==r?void 0:r.id)?J.jsx("button",{disabled:!0,className:"mt-[6px] h-[34px] px-4 bg-[#0084FF] text-white rounded-[10px] cursor-default",children:"Ваш диалог"}):null})]})},e.id))})]}),J.jsx("div",{className:"col-span-5 bg-[#F8F8FA] rounded-[0px] flex flex-col h-full min-h-0 overflow-hidden",style:{borderLeft:"1px solid #E5E6E7"},children:vi?J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"px-4 pt-3 pb-3 border-b border-[#E5E7EB]",children:J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsxs("div",{className:"w-[20px] h-[20px] bg-[#F3F4F6] rounded-[90px] flex items-center justify-center overflow-hidden",children:["widget"===vi.source&&J.jsx("img",{src:"/Group 102.svg",alt:"Widget",className:"w-full h-full"}),"telegram"===vi.source&&J.jsx("img",{src:"/Group 38.svg",alt:"Telegram",className:"w-full h-full"}),"whatsapp"===vi.source&&J.jsx("img",{src:"/Group 37.svg",alt:"WhatsApp",className:"w-full h-full"}),"vk"===vi.source&&J.jsx("img",{src:"/Group 39.svg",alt:"VK",className:"w-full h-full"})]}),J.jsx("div",{children:J.jsx("div",{className:"flex items-center gap-2",children:J.jsx("h3",{className:"font-[500] text-[16px] text-[#070F1A]",children:vi.phone||vi.email||`Обращение №${vi.id.substring(0,8)}`})})})]}),J.jsx("div",{className:"flex items-center justify-end",children:J.jsx("button",{onClick:e=>{e.stopPropagation(),Sc(vi.id),Ec(!0)},className:"h-[30px] px-3 bg-white border border-[#E5E6E7] text-[#0084FF] rounded-[10px] text-[13px] font-[500] hover:opacity-90 transition-colors",children:"Завершить"})})]})}),J.jsx("div",{className:"overflow-y-auto p-4 flex-1",ref:$,children:J.jsx(Gm,{messages:vi.messages||[],getMessageAlignment:rr,getMessageOrder:ar,getMessageStyle:ir,getMessageFooter:lr,aiAgentName:Vi,containerRef:$})}),J.jsxs("div",{className:"p-4 pb-4 border-t border-[#E5E7EB]",style:{paddingTop:"14px",paddingBottom:"3px",paddingRight:"5px",paddingLeft:"14px"},children:[vi&&("active"===vi.status||"waiting"===vi.status)&&(h||!0===vi.need_handover)&&J.jsx("div",{className:"rounded-[15px] p-0",style:{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(40px)"},children:J.jsxs("div",{className:"p-4 flex flex-col items-center gap-2",style:{paddingTop:"0px !important",paddingBottom:"14px !important"},children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"/Frame 2085.svg",alt:"Frame 2085",className:"w-6 h-6"}),J.jsxs("div",{className:"flex items-center gap-[2px]",children:[J.jsx("div",{className:"w-[5px] h-[5px] rounded-full bg-[#8E8E93] opacity-[0.25] animate-pulse-1"}),J.jsx("div",{className:"w-[5px] h-[5px] rounded-full bg-[#8E8E93] opacity-[0.5] animate-pulse-2"}),J.jsx("div",{className:"w-[5px] h-[5px] rounded-full bg-[#8E8E93] opacity-[1] animate-pulse-3"})]}),J.jsx("img",{src:"/Frame 2086.svg",alt:"Frame 2086",className:"w-6 h-6"})]}),J.jsx("h4",{className:"text-[14px] text-[#070F1A] font-[500]",children:"Перехватить разговор"}),J.jsx("p",{className:"text-[12px] text-center",style:{color:"#8E8E93"},children:"Если вы нажмете на кнопку, то ИИ остановит свою работу в чате"}),J.jsx("button",{onClick:()=>(async e=>{const t=bc.find(t=>t.id===e);if(t&&t.assignedTo&&t.assignedTo!==(null==r?void 0:r.id))return C("Диалог уже перехвачен другим оператором"),_(!0),void setTimeout(()=>_(!1),3e3);if(vc(t=>t.map(t=>t.id===e?{...t,status:"taken",assignedTo:(null==r?void 0:r.id)||"current_operator",canTakeover:!1,need_handover:!1,lastMessage:"Диалог перехвачен оператором",interceptedBy:(null==r?void 0:r.id)||"current_operator",interceptedAt:(new Date).toISOString()}:t)),yi(t=>t&&t.id===e?{...t,status:"taken",assignedTo:(null==r?void 0:r.id)||"current_operator",canTakeover:!1,need_handover:!1,interceptedBy:(null==r?void 0:r.id)||"current_operator",interceptedAt:(new Date).toISOString()}:t),C("Диалог успешно перехвачен"),_(!0),setTimeout(()=>_(!1),3e3),x(!1),t&&(t.email||t.phone))try{await xs(t),console.log("✅ Лид автоматически создан в CRM при перехвате диалога:",e)}catch(s){console.warn("⚠️ Не удалось автоматически создать лид в CRM при перехвате:",s)}Oc("Диалог перехвачен. Теперь вы можете отвечать клиенту.");try{Om.updateDialog(e,{status:"taken",assigned_to:(null==r?void 0:r.id)||null,need_handover:!1,last_message_at:(new Date).toISOString()})}catch(n){console.warn("Failed to sync join to DB:",n)}if(t){const s=`🤖 Диалог ID: ${e}\n👤 Клиент: ${t.user||"Неизвестно"}\n📞 ${t.phone||t.email||"Нет контактов"}\n⚡ Статус: Перехвачен оператором`;fr(s,"operator_takeover")}})(vi.id),className:"h-[34px] w-[160px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors flex items-center justify-center mt-[10px]",style:jm.blueButton,children:"Вступить в диалог"})]})}),vi&&"taken"===vi.status&&vi.assignedTo===((null==r?void 0:r.id)||"current_operator")&&J.jsxs("div",{className:"relative",children:[J.jsx("textarea",{placeholder:"Введите сообщение...",value:wi,onChange:e=>ji(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),or())},className:"w-full min-h-[96px] resize-none rounded-[12px] border-0 p-0 pr-[70px] focus:outline-none focus:ring-0 text-[14px] text-[#070F1A] bg-[#F8F8FA]",style:{borderLeftWidth:0,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0,paddingLeft:0,paddingTop:0,paddingBottom:0,paddingRight:"70px"}}),J.jsxs("div",{className:"absolute right-2 bottom-2 flex items-center gap-0",style:{marginBottom:"0px",marginLeft:"0px",paddingLeft:"0px"},children:[J.jsx("button",{onClick:Vc,className:"w-[32px] h-[32px] flex items-center justify-center transition-colors",children:J.jsx("img",{src:"/paperclip.svg",alt:"Вложения",className:"w-[18px] h-[18px]"})}),J.jsx("button",{onClick:or,className:"w-[32px] h-[32px] bg-[#0084FF] rounded-[90px] flex items-center justify-center cursor-pointer disabled:bg-[#070F1A] disabled:bg-opacity-10 disabled:cursor-not-allowed transition-colors",disabled:!wi.trim(),children:J.jsx("img",{src:"/Frame 118.svg",alt:"Отправить",className:"w-3 h-3 "+(wi.trim()?"":"opacity-60")})})]})]})]})]}):J.jsx("div",{className:"flex-1 flex items-center justify-center",children:J.jsxs("div",{className:"text-center",children:[J.jsx("span",{className:"w-8 h-8 mx-auto mb-3 inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/dialog.svg)",maskImage:"url(/dialog.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"},role:"img","aria-label":"Пока нет диалогов"}),J.jsx("h3",{className:"text-[20px] font-[500] mb-2",style:{color:"#8E8E93",opacity:.7},children:"Пока нет диалогов"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] text-center mb-6",style:{width:"370px",opacity:.7},children:"Когда клиенты начнут общаться с вашим ИИ-агентом, диалоги появятся здесь"}),J.jsxs("div",{className:"flex flex-col gap-3 justify-center",children:[J.jsx("button",{className:"bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors h-[34px]",style:jm.blueButton,children:"Настроить виджет"}),J.jsx("button",{className:"text-[#070F1A] rounded-[10px] hover:bg-[#F9FAFB] transition-colors h-[34px]",style:jm.whiteButton,children:"Протестировать ИИ"})]})]})})}),J.jsxs("div",{className:"col-span-3 bg-[#F8F8FA] rounded-[0px] flex flex-col h-full min-h-0 overflow-hidden",style:{borderLeft:"1px solid #E5E6E7"},children:[vi?J.jsxs("div",{className:"p-4 overflow-y-auto flex-1 space-y-6",children:[J.jsx("h3",{className:"font-[500] text-[16px] text-[#070F1A] mb-4",children:"Информация о клиенте"}),J.jsx("div",{children:J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Источник"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("div",{className:"w-[16px] h-[16px] bg-[#F3F4F6] rounded-[90px] flex items-center justify-center",children:["widget"===vi.source&&J.jsx("img",{src:"/Group 102.svg",alt:"Widget",className:"w-full h-full"}),"telegram"===vi.source&&J.jsx("img",{src:"/Group 38.svg",alt:"Telegram",className:"w-full h-full"}),"whatsapp"===vi.source&&J.jsx("img",{src:"/Group 37.svg",alt:"WhatsApp",className:"w-full h-full"}),"vk"===vi.source&&J.jsx("img",{src:"/Group 39.svg",alt:"VK",className:"w-full h-full"})]}),J.jsx("span",{className:"text-[12px] text-[#070F1A] capitalize font-[500]",children:"vk"===vi.source?"Вконтакте":vi.source})]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Статус"}),J.jsxs("div",{className:"flex items-center gap-2",children:["waiting"===vi.status||"active"===vi.status||"taken"===vi.status?J.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[J.jsx("path",{d:"M20.25 12C20.25 7.44365 16.5563 3.75 12 3.75C7.44365 3.75 3.75 7.44365 3.75 12C3.75 16.5563 7.44365 20.25 12 20.25C16.5563 20.25 20.25 16.5563 20.25 12ZM21.75 12C21.75 17.3848 17.3848 21.75 12 21.75C6.61522 21.75 2.25 17.3848 2.25 12C2.25 6.61522 6.61522 2.25 12 2.25C17.3848 2.25 21.75 6.61522 21.75 12Z",fill:"waiting"===vi.status?"#FFCE52":"#05D560"}),J.jsx("path",{d:"M11.5 6C11.5 5.44772 11.9495 4.99353 12.4975 5.06216C14.1184 5.26514 15.634 5.95891 16.8033 7.05025C18.2098 8.36301 19 10.1435 19 12C19 13.8565 18.2098 15.637 16.8033 16.9497C15.634 18.0411 14.1184 18.7349 12.4975 18.9378C11.9495 19.0065 11.5 18.5523 11.5 18L11.5 12L11.5 6Z",fill:"waiting"===vi.status?"#FFCE52":"#05D560"})]}):J.jsx("svg",{width:"18",height:"18",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsxs("g",{children:[J.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"#0084FF"}),J.jsx("path",{d:"M5.5 8.5 L7.5 10.5 L11 6.5",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),J.jsx("span",{className:"text-[12px] text-[#070F1A] leading-[16px] font-[500]",children:"waiting"===vi.status?"Ожидает":"active"===vi.status||"taken"===vi.status?"Активный":"resolved"===vi.status||"resolved_by_operator"===vi.status||"closed"===vi.status?"Закрыт":"Активный"})]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Приоритет"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(()=>{const e=vi.priority||"low",t="rgba(7,15,26,0.2)",s="high"===e||"urgent"===e,n="medium"===e,r="low"===e?"#05D560":s?"#FF3B30":n?"#FFCE52":"#05D560",a="low"===e?t:s?"#FF3B30":n?"#FFCE52":t,i="low"===e?t:s?"#FF3B30":t;return J.jsxs("g",{children:[J.jsx("rect",{x:"1",y:"8",width:"4",height:"6",rx:"1",fill:r}),J.jsx("rect",{x:"6",y:"4",width:"4",height:"10",rx:"1",fill:a}),J.jsx("rect",{x:"11",y:"1",width:"4",height:"13",rx:"1",fill:i})]})})()}),J.jsx("span",{className:"text-[12px] text-[#070F1A] leading-[16px] font-[500]",children:"high"===vi.priority?"Высокий":"medium"===vi.priority?"Средний":"Низкий"})]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Ответственный"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("div",{className:"rounded-full flex items-center justify-center",style:{width:"16px",height:"16px",backgroundColor:"taken"===vi.status?"#A684FF":"transparent"},children:"taken"===vi.status?J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[10px] h-[10px]",style:{filter:"brightness(0) invert(1)"}}):J.jsx("span",{className:"w-[16px] h-[16px] inline-block",style:{backgroundColor:"#0084FF",WebkitMaskImage:"url(/aiii.svg)",maskImage:"url(/aiii.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"contain",maskSize:"contain",WebkitMaskPosition:"center",maskPosition:"center"}})}),J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:"taken"===vi.status?vi.assignedTo===((null==r?void 0:r.id)||"current_operator")?"Оператор (Вы)":"Оператор":"ИИ-агент"})]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Начало диалога"}),J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.createdAt?new Date(vi.createdAt).toLocaleString():vi.startTime||"—"})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Конец диалога"}),J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.updatedAt?new Date(vi.updatedAt).toLocaleString():vi.endTime||"—"})]})]})}),J.jsx("div",{className:"border-t border-[#E5E7EB] my-4"}),J.jsx("div",{children:J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Имя"}),vi.name&&"name"!==pt?J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.name}):"name"===pt?J.jsx("input",{type:"text",value:gt,onChange:e=>ft(e.target.value),placeholder:"Иван Иванов",className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("name","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Телефон"}),vi.phone&&"phone"!==pt?J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.phone}):"phone"===pt?J.jsx("input",{type:"tel",value:gt,onChange:e=>ft(e.target.value),placeholder:"+7 (999) 123-45-67",className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("phone","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Почта"}),vi.email&&"email"!==pt?J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.email}):"email"===pt?J.jsx("input",{type:"email",value:gt,onChange:e=>ft(e.target.value),placeholder:"ivan@example.com",className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("email","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"120px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Адрес"}),vi.address&&"address"!==pt?J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.address}):"address"===pt?J.jsx("input",{type:"text",value:gt,onChange:e=>ft(e.target.value),placeholder:"Москва",className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",style:{marginLeft:"-2px"},onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("address","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})]}),J.jsxs("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"120px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Компания"}),vi.company&&"company"!==pt?J.jsx("span",{className:"text-[12px] text-[#070F1A] font-[500]",children:vi.company}):"company"===pt?J.jsx("input",{type:"text",value:gt,onChange:e=>ft(e.target.value),placeholder:'ООО "АгроСтрой"',className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",style:{marginLeft:"-2px"},onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("company","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})]}),J.jsxs("div",{className:"space-y-1",children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Dialog ID"}),J.jsx("span",{className:"text-[12px] text-[#8E8E93] font-[500] font-mono",children:vi.id})]}),J.jsxs("div",{className:"grid gap-2",style:{gridTemplateColumns:"115px 1fr"},children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93] col-span-1",children:"Заметки"}),J.jsx("div",{className:"col-span-2",style:{gridColumn:"1 / -1"},children:"notes"===pt?J.jsx("textarea",{value:gt,onChange:e=>ft(e.target.value),placeholder:"Заметка",className:"text-[12px] text-[#070F1A] bg-transparent border-none outline-none p-0 w-full resize-none",rows:3,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),Ft()):"Escape"===e.key&&(e.preventDefault(),_t())},onBlur:e=>{e.preventDefault(),e.stopPropagation(),Ft()}}):vi.notes?J.jsx("div",{className:"text-[12px] text-[#070F1A] font-[500] whitespace-pre-wrap cursor-text",onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("notes",vi.notes||"")},children:vi.notes}):J.jsxs("button",{className:"text-[12px] text-[#8E8E93] flex items-center cursor-text focus:outline-none bg-transparent border-none p-0",onClick:e=>{e.preventDefault(),e.stopPropagation(),kt("notes","")},children:[J.jsx("span",{className:"text-[18px]",style:{fontWeight:300,marginBottom:"2px",marginRight:"4px"},children:"+"})," Добавить"]})})]})]})})]}):J.jsx("div",{className:"flex flex-col items-center justify-center h-full py-12"}),vi&&J.jsxs("div",{className:"p-4 border-t border-[#E5E7EB] space-y-3",children:[J.jsxs("div",{className:"flex gap-2",children:[J.jsx("button",{onClick:()=>(e=>{if(!e)return;let t=`ДИАЛОГ: ${e.name||"Без имени"}\n`;t+="====================================\n\n",t+=`Источник: ${"vk"===e.source?"Вконтакте":e.source}\n`,t+=`Email: ${e.email||"—"}\n`,t+=`Телефон: ${e.phone||"—"}\n`,t+=`Время начала: ${e.startTime}\n`,t+=`Последняя активность: ${e.lastActivity}\n`,t+=`Статус: ${e.status}\n`,e.assignedTo&&(t+=`Ответственный: ${e.assignedTo===((null==r?void 0:r.id)||"current_operator")?"Вы":"Другой оператор"}\n`),t+="\n==== СООБЩЕНИЯ ====\n\n",e.messages&&e.messages.length>0?e.messages.forEach(s=>{const n=s.isUser?e.name||"Клиент":"ИИ-агент";t+=`[${s.time}] ${n}: ${s.text}\n\n`}):t+="Сообщений нет\n",t+="\n==== ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ ====\n",t+=`Общее количество сообщений: ${e.messageCount}\n`,t+=`Приоритет: ${e.priority||"Не установлен"}\n`,t+=`Можно перехватить: ${e.canTakeover?"Да":"Нет"}\n`,t+=`\nЭкспортировано: ${(new Date).toLocaleString("ru-RU")}\n`;const s=new Blob([t],{type:"text/plain;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(s);n.setAttribute("href",a),n.setAttribute("download",`dialog_${e.name||"unknown"}_${(new Date).toISOString().split("T")[0]}.txt`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)})(vi),className:"flex-1 h-[34px] bg-[#F3F4F6] text-[#070F1A] hover:bg-[#E5E7EB] rounded-[10px] text-[14px] font-[500] transition-colors flex items-center justify-center gap-2",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M10 0.500244C15.2467 0.500244 19.5 4.75354 19.5 10.0002C19.5 15.2469 15.2467 19.5002 10 19.5002C4.75329 19.5002 0.5 15.2469 0.5 10.0002C0.5 4.75354 4.75329 0.500244 10 0.500244ZM10.5312 5.18384C10.2567 4.90956 9.82182 4.89203 9.52734 5.13208L9.4707 5.18384L6.04199 8.61255C5.74926 8.90535 5.7494 9.3802 6.04199 9.6731C6.33487 9.9659 6.80966 9.9659 7.10254 9.6731L9.25098 7.52466V14.2854C9.25098 14.6996 9.58683 15.0353 10.001 15.0354C10.4151 15.0353 10.751 14.6996 10.751 14.2854V7.52466L12.8994 9.6731C13.1923 9.96578 13.6671 9.96592 13.96 9.6731C14.2526 9.38026 14.2526 8.90539 13.96 8.61255L10.5312 5.18384Z",fill:"#0084FF"})})}),J.jsx("button",{onClick:()=>{Ic(vi.id),Tc(!0)},className:"flex-1 h-[34px] bg-[#FEF2F2] text-[#EF4444] hover:bg-[#FEE2E2] rounded-[10px] text-[14px] font-[500] transition-colors flex items-center justify-center gap-2",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"}})})]}),!vi.isAddedToCRM&&(vi.email||vi.phone)&&J.jsx(og,{onClick:()=>xs(vi),variant:"outline",size:"sm",className:"w-full h-[34px] bg-[#0084FF] border-none text-white hover:bg-[#0073E6] rounded-[10px] font-[500] text-[14px] transition-colors",children:"Добавить в CRM"})]})]})]})]});case"my-adapto":return J.jsxs("div",{className:"flex flex-col h-full",children:[J.jsx("div",{className:"flex items-center justify-between mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Тестирование"})}),J.jsx("div",{className:"border-b mb-0 mt-0",style:{borderColor:"#E5E6E7",marginTop:0,marginLeft:"-16px",marginRight:"-16px"}}),J.jsxs("div",{className:"flex gap-0 items-stretch flex-1 min-h-0 -mb-4",style:{marginLeft:0,marginRight:0},children:[J.jsxs("div",{className:"flex-1 bg-[#F8F8FA] rounded-none flex flex-col h-full overflow-y-auto",style:{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,marginLeft:0,marginRight:"16px",marginTop:"16px"},children:[J.jsxs("div",{className:"flex items-center justify-between mb-[30px]",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Корректировки"}),Rr.size>0&&J.jsxs("span",{className:"text-[14px] text-[#8E8E93]",children:["Выбрано: ",Rr.size]})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("button",{onClick:async()=>{Hr(!0),Oc("Обновление корректировок...");try{if(null==r?void 0:r.id){const e=await _m(r.id);Lr(e),console.log("Корректировки обновлены из базы данных:",e),Oc("Корректировки обновлены и применены к ИИ агенту")}else console.error("No current user ID available"),Oc("Ошибка: пользователь не найден")}catch(e){console.error("Ошибка при обновлении корректировок:",e),Oc("Ошибка при обновлении корректировок")}finally{Hr(!1)}},className:"h-[32px] px-3 text-[#8E8E93] hover:bg-[#F2F3F4] hover:text-[#070F1A] rounded-[10px] transition-colors flex items-center justify-center gap-2 group",style:jm.whiteButton,children:[J.jsx("img",{src:"/arrow-refresh-02.svg",alt:"Обновить",className:`w-[14px] h-[14px] transition-transform duration-200 ${Wr?"animate-spin":""} [filter:brightness(0)_saturate(100%)_invert(59%)_sepia(2%)_saturate(0%)_hue-rotate(217deg)_brightness(92%)_contrast(89%)] group-hover:[filter:none]`}),"Обновить"]}),Rr.size>0&&J.jsx(J.Fragment,{children:J.jsxs("button",{onClick:()=>Gr(!0),className:"h-[32px] px-3 bg-[#FEF2F2] text-[#FF0D0D] hover:text-[#FF0D0D] hover:bg-[#FEF2F2] rounded-[10px] transition-colors flex items-center justify-center gap-2",style:jm.whiteButton,children:[J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4"}),"Удалить"]})}),J.jsxs("button",{onClick:()=>zr(!Br),className:"h-[32px] px-3 bg-[#0084FF] rounded-[10px] text-white hover:bg-[#0073E6] transition-colors flex items-center justify-center gap-1",style:jm.blueButton,children:[J.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Добавить"]})]})]}),J.jsxs("div",{className:"space-y-3 mb-[15px]",children:[Mr.map((e,t)=>J.jsxs("div",{className:"flex items-center p-3 rounded-[15px] transition-colors cursor-pointer "+(Rr.has(t)?"bg-[#F9FAFB]":"hover:bg-[#F2F3F4]"),children:[J.jsx("div",{className:"w-4 mr-4",children:J.jsx("img",{src:Rr.has(t)?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Выбрать",className:"w-4 h-4 cursor-pointer",onClick:()=>(e=>{console.log(`toggleCorrectionSelection called with index: ${e}`),Or(t=>{const s=new Set(t);return s.has(e)?(s.delete(e),console.log(`Removed index ${e} from selection`)):(s.add(e),console.log(`Added index ${e} to selection`)),console.log("New selection set:",s),s})})(t)})}),J.jsx("div",{className:"flex-1",children:J.jsx("span",{className:"text-[#070F1A] font-medium text-[14px]",children:e.correction||e})}),J.jsx("div",{className:"flex items-center gap-2 ml-4",children:J.jsx("img",{src:Pr.has(t)?"/iOS/Switch-1.svg":"/iOS/Switch.svg",alt:"Активность",className:"w-[34px] h-[34px] cursor-pointer",onClick:()=>(async e=>{let t;if($r(s=>{const n=new Set(s);return n.has(e)?n.delete(e):n.add(e),t=n,n}),(null==r?void 0:r.id)&&t)try{const e=Array.from(t),s=await fetch(`${$m}/api/corrections/active/${r.id}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({activeCorrections:e})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();console.log("✅ Active corrections saved:",n)}catch(s){console.error("❌ Error saving active corrections:",s),Oc("Ошибка сохранения корректировок")}})(t)})})]},t)),Br&&J.jsxs("div",{className:"flex items-center p-3 rounded-[10px] transition-colors cursor-pointer bg-[#F9FAFB]",children:[J.jsx("div",{className:"w-4 mr-4",children:J.jsx("img",{src:"/Checkbox-1.svg",alt:"Выбрать",className:"w-4 h-4 cursor-pointer"})}),J.jsx("div",{className:"flex-1",children:J.jsx("input",{type:"text",value:Ur,onChange:e=>qr(e.target.value),placeholder:"Введите корректировку...",className:"w-full h-[34px] px-3 border-none bg-transparent text-[#070F1A] text-[14px] focus:outline-none focus:ring-0 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&cd()})}),J.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[J.jsx("button",{onClick:cd,disabled:ld,className:"h-[32px] px-4 rounded-[10px] transition-colors flex items-center justify-center "+(ld?"bg-[#0084FF]/50 text-white cursor-not-allowed":"bg-[#0084FF] text-white hover:bg-[#0073E6]"),style:ld?{fontSize:"13px",fontWeight:"500"}:jm.blueButton,children:ld?"Сохранение...":"Сохранить"}),J.jsx("button",{onClick:()=>zr(!1),className:"w-[32px] h-[32px] flex items-center justify-center text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx(vm,{className:"w-4 h-4"})})]})]})]})]}),J.jsxs("div",{className:"w-[400px] bg-[#F8F8FA] rounded-none p-4 flex flex-col border border-[#E5E7EB] border-t-0 h-full overflow-y-auto -mr-4",style:{flexShrink:0,paddingLeft:0,paddingRight:0,marginRight:"-16px"},children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",style:{paddingLeft:"16px",paddingRight:"16px"},children:[J.jsx("div",{className:"flex items-center gap-2",children:J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Чат"})}),J.jsx("button",{onClick:async()=>{if(null==r?void 0:r.id)try{Vr(!0),console.log("Attempting to clear chat history for user:",r.id);const e=await Am.clearChatHistory(r.id);console.log("Clear chat history result:",e),e?(Er([{type:"assistant",text:"Привет! Я ваш ИИ-ассистент Adapto. Как дела?",time:"Только что",timestamp:Date.now()}]),Oc("История чата очищена"),Jm.scrollToBottom(Nn)):Oc("Ошибка при очистке истории")}catch(e){console.error("Error clearing chat history:",e),Oc("Ошибка при очистке истории: "+e.message)}finally{Vr(!1)}else console.error("No current user ID available"),Oc("Ошибка: пользователь не найден")},className:"w-[32px] h-[32px] bg-[#FFFFFF] rounded-[90px] flex items-center justify-center hover:bg-gray-100 transition-colors",title:"Обновить диалог",children:J.jsx("img",{src:"/arrow-refresh-02.svg",alt:"Обновить",className:"w-4 h-4 transition-transform duration-200 "+(Qr?"animate-spin":""),style:{filter:"brightness(0) saturate(100%) invert(57%) sepia(0%) saturate(0%) hue-rotate(186deg) brightness(94%) contrast(92%)"}})})]}),J.jsx("div",{className:"border-b border-[#E5E7EB] mb-4"}),J.jsxs("div",{className:"flex-1 flex flex-col",style:{paddingLeft:"0px",paddingRight:"0px"},children:[J.jsxs("div",{ref:kn,className:"flex-1 space-y-4 overflow-y-auto mb-4 widget-chat-container",style:{paddingLeft:"16px",paddingRight:"16px",flexBasis:0},children:[J.jsx("div",{className:"text-center",children:J.jsx("span",{className:"bg-gray-100 text-gray-600 text-xs px-3 py-1 rounded-[90px]",children:"Сегодня"})}),J.jsx(Gm,{messages:al,getMessageAlignment:rr,getMessageOrder:ar,getMessageStyle:ir,getMessageFooter:lr,aiAgentName:Vi,containerRef:kn})]}),J.jsx("div",{className:"relative flex-shrink-0",style:{paddingLeft:"16px",paddingRight:"16px"},children:J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",value:Ar,onChange:e=>Tr(e.target.value),onKeyPress:e=>{"Enter"===e.key&&Gc()},placeholder:"Введите сообщение...",className:"w-full h-[40px] px-4 py-2 pr-[100px] rounded-[20px] border border-[#E5E7EB] focus:outline-none focus:ring-0 text-[14px] text-[#070F1A] bg-[#F8F8FA]"}),J.jsxs("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[J.jsx("button",{onClick:Vc,className:"w-[22px] h-[32px] flex items-center justify-center transition-colors",title:"Добавить вложение",children:J.jsx("img",{src:"/paperclip.svg",alt:"Вложение",className:"w-[18px] h-[18px] text-[#8E8E93] hover:text-[#070F1A] transition-colors"})}),J.jsx("button",{onClick:Gc,className:"w-[32px] h-[32px] bg-[#0084FF] rounded-[90px] flex items-center justify-center cursor-pointer disabled:bg-[#070F1A] disabled:bg-opacity-10 disabled:cursor-not-allowed transition-colors",disabled:!Ar.trim(),title:"Отправить сообщение",children:J.jsx("img",{src:"/Frame 118.svg",alt:"Отправить",className:"w-3 h-3 "+(Ar.trim()?"":"opacity-60")})})]})]})})]})]})]})]});case"model-extensions":return J.jsxs("div",{className:"space-y-0",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A] mb-[16px]",children:"Расширения"})}),J.jsx("div",{className:"border-b",style:{borderColor:"#E5E7EB",marginLeft:"-16px",marginRight:"-16px"}}),J.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",style:{marginLeft:"1px",marginRight:"1px",marginTop:"20px"},children:[J.jsxs("div",{className:"border border-transparent rounded-[16px] p-[15px] bg-white",children:[J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/333312.png",alt:"Telegram",className:"w-[24px] h-[24px]"})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Уведомления в Telegram"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Будьте всегда в курсе процессов"})]})]}),J.jsx("div",{className:"w-full mt-[20px]",children:J.jsx("button",{onClick:()=>{c("profile"),he("notifications"),j(!1)},className:"w-full h-[34px] text-[#8E8E93] rounded-[12px] transition-colors hover:bg-[#F2F3F4]",style:jm.whiteButton,children:"Не подключено"})})]}),J.jsxs("div",{className:"border border-transparent rounded-[16px] p-[15px] bg-white",children:[J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/333313.png",alt:"Автопереключения",className:"w-[24px] h-[24px]"})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-medium text-[#070F1A] mb-1",children:"Автопереключения диалогов"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Настройте ИИ-агента при перехвате"})]})]}),J.jsx("div",{className:"w-full mt-[20px]",children:J.jsx("button",{onClick:()=>Nc(!0),className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[12px] transition-colors hover:bg-[#0073E6]",style:jm.blueButton,children:"Настроить"})})]})]}),jc&&J.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-[16px] p-5 w-[500px] max-h-[90vh] overflow-y-auto",children:[J.jsxs("div",{className:"flex justify-between items-center mb-3",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Настройки автопереключения"}),J.jsx("button",{onClick:()=>Nc(!1),className:"w-8 h-8 flex items-center justify-center text-[#8E8E93] hover:text-[#070F1A] transition-colors rounded-[8px] hover:bg-[#F2F3F4]",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]}),J.jsxs("div",{className:"space-y-[15px]",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:"ИИ-агент может полностью отключиться от диалога или вступить в него спустя время"}),J.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[12px] mt-[30px]",style:{background:"#F8F8FA"},children:[J.jsxs("div",{className:"w-[310px]",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A] mb-1",children:"Выключать ИИ-ассистента при вмешательстве в диалог человека"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Диалог полностью перейдет в работу оператору"})]}),J.jsx("div",{className:"flex items-center",children:J.jsx("img",{src:kc.disableOnHumanIntervention?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Переключатель",className:"w-[34px] h-6 cursor-pointer",onClick:()=>Fc(e=>({...e,disableOnHumanIntervention:!e.disableOnHumanIntervention}))})})]}),J.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[12px]",style:{background:"#F8F8FA"},children:[J.jsxs("div",{className:"w-[310px]",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A] mb-1",children:"Включать ИИ-ассистента после переключения диалога на оператора"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"ИИ-агент спустя время вернется в диалог"})]}),J.jsx("div",{className:"flex items-center",children:J.jsx("img",{src:kc.enableAfterOperatorSwitch?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Переключатель",className:"w-[34px] h-6 cursor-pointer",onClick:()=>Fc(e=>({...e,enableAfterOperatorSwitch:!e.enableAfterOperatorSwitch}))})})]}),kc.enableAfterOperatorSwitch&&J.jsxs("div",{className:"p-4 rounded-[12px]",style:{background:"#F8F8FA"},children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Включать ассистента через"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"number",min:"1",max:"60",value:kc.switchDelayMinutes,onChange:e=>Fc(t=>({...t,switchDelayMinutes:parseInt(e.target.value)||5})),className:"w-20 h-10 px-3 rounded-[8px] focus:outline-none",style:Nm.inputField}),J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"минут"})]})]}),J.jsxs("div",{className:"flex gap-3 pt-4",children:[J.jsx("button",{onClick:()=>Nc(!1),className:"flex-1 h-[34px] text-[#070F1A] rounded-[12px] transition-colors hover:border-[#070F1A]/20",style:jm.whiteButton,children:"Отмена"}),J.jsx("button",{onClick:async()=>{try{(await fetch(`${$m}/api/autoswitch/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(kc)})).ok&&(Nc(!1),_(!0),setTimeout(()=>_(!1),3e3))}catch(e){console.error("Ошибка сохранения настроек:",e)}},className:"flex-1 h-[34px] bg-[#0084FF] text-white rounded-[12px] transition-colors hover:bg-[#0066CC]",style:jm.blueButton,children:"Сохранить"})]})]})]})})]});case"widget-settings":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Виджет на сайт"}),J.jsx("div",{className:"bg-white rounded-[20px] p-6 border border-gray-200",children:J.jsxs("div",{className:"space-y-8",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Акцентный цвет"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("input",{type:"text",value:Mc.accentColor,onChange:e=>Lc({...Mc,accentColor:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"HEX"}),J.jsx("input",{type:"color",value:Mc.accentColor,onChange:e=>Lc({...Mc,accentColor:e.target.value}),className:"w-10 h-10 rounded-lg border-2 border-gray-300 cursor-pointer"}),J.jsx("button",{onClick:()=>Lc({...Mc,accentColor:"#1354FC"}),className:"text-gray-400 hover:text-gray-600",children:"×"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Цвет кнопки"}),J.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{id:"light",label:"Светлый фон",bg:"bg-white",border:"border-blue-500",text:"text-blue-500"},{id:"dark",label:"Темный фон",bg:"bg-gray-900",border:"border-white",text:"text-white"},{id:"custom",label:"Задать свой цвет",bg:"bg-gradient-to-r from-yellow-400 via-pink-500 to-blue-500",border:"border-blue-500",text:"text-white"}].map(e=>J.jsxs("button",{onClick:()=>Lc({...Mc,buttonColor:e.id}),className:"p-3 rounded-lg border-2 transition-all "+(Mc.buttonColor===e.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsxs("div",{className:"w-[140px] h-[42px] rounded-xl flex items-center justify-center gap-2 mb-2 mx-auto "+("light"===e.id?"bg-white border-2 border-gray-300":"dark"===e.id?"bg-gray-900":"bg-gradient-to-r from-yellow-400 via-pink-500 to-blue-500"),style:{borderColor:"light"===e.id?Mc.accentColor:"transparent",color:"light"===e.id?Mc.accentColor:"white"},children:[J.jsx("div",{className:"w-4 h-4 rounded-[90px] opacity-80",style:{backgroundColor:"light"===e.id?Mc.accentColor:"currentColor"}}),J.jsx("span",{className:"text-sm font-medium",style:{maxWidth:"90px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:"Написать нам"})]}),J.jsx("span",{className:"text-xs "+(Mc.buttonColor===e.id?"text-blue-600":"text-gray-600"),children:e.label})]},e.id))})]}),"custom"===Mc.buttonColor&&J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Введите цвет для фона"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("input",{type:"text",value:Mc.customButtonColor,onChange:e=>Lc({...Mc,customButtonColor:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"HEX"}),J.jsx("input",{type:"color",value:Mc.customButtonColor,onChange:e=>Lc({...Mc,customButtonColor:e.target.value}),className:"w-10 h-10 rounded-lg border-2 border-gray-300 cursor-pointer"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Название кнопки"}),J.jsx("input",{type:"text",value:Mc.buttonText,onChange:e=>Lc({...Mc,buttonText:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Написать нам"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Стиль кнопки"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[J.jsx("button",{onClick:()=>Lc({...Mc,buttonColor:"rectangle"}),className:"p-4 rounded-lg border-2 transition-all "+("rectangle"===Mc.buttonColor?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"w-[120px] h-[40px] bg-blue-600 rounded-lg mx-auto mb-2 flex items-center justify-center",children:J.jsx("span",{className:"text-white text-sm font-medium",children:"Спросить ИИ"})}),J.jsx("div",{className:"text-sm font-medium",children:"Прямоугольная"})]})}),J.jsx("button",{onClick:()=>Lc({...Mc,buttonColor:"ellipse"}),className:"p-4 rounded-lg border-2 transition-all "+("ellipse"===Mc.buttonColor?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"w-[120px] h-[40px] bg-blue-600 rounded-[90px] mx-auto mb-2 flex items-center justify-center",children:J.jsx("span",{className:"text-white text-sm font-medium",children:"💬"})}),J.jsx("div",{className:"text-sm font-medium",children:"Круглая"})]})})]})]}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[J.jsx("div",{className:"space-y-6 border p-4 rounded-lg",children:J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Название рядом с логотипом"}),J.jsx("input",{type:"text",value:Mc.logoName||"",onChange:e=>Lc({...Mc,logoName:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Введите название"}),J.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Текст, отображаемый рядом с логотипом в виджете."})]})}),J.jsx("div",{className:"space-y-6 border p-4 rounded-lg",children:J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ссылка на логотип"}),J.jsx("input",{type:"url",value:Mc.logoUrl||"",onChange:e=>Lc({...Mc,logoUrl:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Введите ссылку на логотип"}),J.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Вставьте URL логотипа вашей компании, который будет отображаться в виджете."})]})})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Предложения"}),J.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Укажите сообщения, которые будут автоматически видны в виджете и предложены пользователю для отправки"}),J.jsxs("div",{className:"space-y-4",children:[null==(l=Mc.suggestions)?void 0:l.map((e,t)=>J.jsxs("div",{className:"flex items-center border rounded-md p-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.suggestions||[]];s[t]=e.target.value,Lc({...Mc,suggestions:s})},className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",placeholder:`Сообщение ${t+1}`}),J.jsx("button",{onClick:()=>{const e=(Mc.suggestions||[]).filter((e,s)=>s!==t);Lc({...Mc,suggestions:e})},className:"ml-2 text-red-400 hover:text-red-600 flex-none whitespace-nowrap",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"inline-block mr-1",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.suggestions||[],""];Lc({...Mc,suggestions:e})},className:"text-blue-400 hover:text-blue-600 font-medium",children:"+ Добавить сообщение"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Аватар Adapto"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[J.jsxs("button",{onClick:()=>Lc({...Mc,avatar:"default"}),className:"p-3 rounded-lg border-2 transition-all "+("default"===Mc.avatar?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-[90px] mx-auto mb-2 flex items-center justify-center",children:J.jsxs("div",{className:"flex items-center justify-center w-6 h-6",children:[J.jsx("div",{className:"w-3 h-3 bg-white rounded-[90px] mr-1"}),J.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-[90px]"})]})}),J.jsx("span",{className:"text-xs text-center block",children:"По умолчанию"})]}),J.jsxs("button",{onClick:()=>{var e;return null==(e=document.getElementById("avatar-input"))?void 0:e.click()},className:"p-3 rounded-lg border-2 transition-all "+("custom"===Mc.avatar?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-[90px] mx-auto mb-2 flex items-center justify-center",children:J.jsx("span",{className:"text-gray-500",children:"+"})}),J.jsx("span",{className:"text-xs text-center block",children:"Загрузить"}),J.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;(null==(t=e.target.files)?void 0:t[0])&&(Lc({...Mc,avatar:"custom"}),Oc("Аватар загружен!"))}})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Расположение виджета"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[J.jsx("button",{onClick:()=>Lc({...Mc,widgetLocation:"default"}),className:"p-4 rounded-lg border-2 transition-all "+("default"===Mc.widgetLocation?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"По умолчанию"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Правый нижний угол"})]})}),J.jsx("button",{onClick:()=>Lc({...Mc,widgetLocation:"custom"}),className:"p-4 rounded-lg border-2 transition-all "+("custom"===Mc.widgetLocation?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"Настроить"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Выбрать позицию"})]})})]}),"custom"===Mc.widgetLocation&&J.jsxs("div",{className:"mt-4 space-y-6 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-sm font-medium mb-3",children:"Для компьютеров"}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ снизу"}),J.jsx("input",{type:"number",value:Mc.desktopBottomOffset,onChange:e=>Lc({...Mc,desktopBottomOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ справа"}),J.jsx("input",{type:"number",value:Mc.desktopRightOffset,onChange:e=>Lc({...Mc,desktopRightOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-sm font-medium mb-3",children:"Для телефонов"}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ снизу"}),J.jsx("input",{type:"number",value:Mc.mobileBottomOffset,onChange:e=>Lc({...Mc,mobileBottomOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ справа"}),J.jsx("input",{type:"number",value:Mc.mobileRightOffset,onChange:e=>Lc({...Mc,mobileRightOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Z-index"}),J.jsx("input",{type:"number",value:Mc.zIndex,onChange:e=>Lc({...Mc,zIndex:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"1"})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Приветственное сообщение"}),J.jsxs("div",{className:"space-y-3",children:[Mc.welcomeMessages.map((e,t)=>J.jsxs("div",{className:"flex gap-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.welcomeMessages];s[t]=e.target.value,Lc({...Mc,welcomeMessages:s})},className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Приветственное сообщение"}),J.jsx("button",{onClick:()=>{const e=Mc.welcomeMessages.filter((e,s)=>s!==t);Lc({...Mc,welcomeMessages:e})},className:"px-3 py-2 text-red-500 hover:text-red-700",children:"×"})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.welcomeMessages,""];Lc({...Mc,welcomeMessages:e})},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить сообщение"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Триггерный вопрос"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[J.jsx("button",{onClick:()=>Lc({...Mc,triggerQuestionEnabled:"no"}),className:"p-4 rounded-lg border-2 transition-all "+("no"===Mc.triggerQuestionEnabled?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Нет"})})}),J.jsx("button",{onClick:()=>Lc({...Mc,triggerQuestionEnabled:"yes"}),className:"p-4 rounded-lg border-2 transition-all "+("yes"===Mc.triggerQuestionEnabled?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Есть"})})})]}),"yes"===Mc.triggerQuestionEnabled&&J.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Через какое время показать:"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"number",value:Mc.triggerQuestionDelay,onChange:e=>Lc({...Mc,triggerQuestionDelay:parseInt(e.target.value)}),className:"w-20 p-2 border border-gray-300 rounded-lg text-sm",min:"1"}),J.jsx("span",{className:"text-sm text-gray-600",children:"сек"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Вопрос:"}),J.jsx("textarea",{value:Mc.triggerQuestionText,onChange:e=>Lc({...Mc,triggerQuestionText:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",rows:"3",placeholder:"Введите вопрос"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Быстрые ответы:"}),J.jsxs("div",{className:"space-y-2",children:[Mc.quickReplies.map((e,t)=>J.jsxs("div",{className:"flex gap-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.quickReplies];s[t]=e.target.value,Lc({...Mc,quickReplies:s})},className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Быстрый ответ"}),J.jsx("button",{onClick:()=>{const e=Mc.quickReplies.filter((e,s)=>s!==t);Lc({...Mc,quickReplies:e})},className:"px-3 py-2 text-red-500 hover:text-red-700",children:"×"})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.quickReplies,""];Lc({...Mc,quickReplies:e})},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить быстрый ответ"})]})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Follow up сообщение"}),J.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Сообщение, которое увидит пользователь, если выйдет из диалога"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[J.jsx("button",{onClick:()=>Lc({...Mc,followUpMessage:"no"}),className:"p-4 rounded-lg border-2 transition-all "+("no"===Mc.followUpMessage?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Нет"})})}),J.jsx("button",{onClick:()=>Lc({...Mc,followUpMessage:"yes"}),className:"p-4 rounded-lg border-2 transition-all "+("yes"===Mc.followUpMessage?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Есть"})})})]}),"yes"===Mc.followUpMessage&&J.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Через какое время показать:"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"number",value:Mc.followUpDelay,onChange:e=>Lc({...Mc,followUpDelay:parseInt(e.target.value)}),className:"w-20 p-2 border border-gray-300 rounded-lg text-sm",min:"1"}),J.jsx("span",{className:"text-sm text-gray-600",children:"сек"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Вопрос:"}),J.jsx("textarea",{value:Mc.followUpQuestion,onChange:e=>Lc({...Mc,followUpQuestion:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",rows:"3",placeholder:"Введите вопрос"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Быстрые ответы:"}),J.jsx("div",{className:"space-y-2",children:Mc.followUpQuickReply&&J.jsx("div",{className:"flex gap-2",children:J.jsx("input",{type:"text",value:Mc.followUpQuickReply,onChange:e=>Lc({...Mc,followUpQuickReply:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Быстрый ответ"})})})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ссылка на политику обработки персональных данных"}),J.jsx("input",{type:"url",value:Mc.privacyPolicyUrl,onChange:e=>Lc({...Mc,privacyPolicyUrl:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"https://example.com/privacy"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Какие метки собирать"}),J.jsx("div",{className:"grid grid-cols-2 gap-2",children:["utm_source","utm_medium","utm_campaign","utm_term","utm_content","roistat_visit","gclid","fbclid"].map(e=>J.jsx("button",{onClick:()=>{const t=Mc.dataTags||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Lc({...Mc,dataTags:s})},className:"p-2 rounded-lg border-2 transition-all text-sm "+((Mc.dataTags||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e))}),J.jsx("div",{className:"mt-3",children:J.jsx("button",{onClick:()=>{const e=prompt("Введите название метки:");if(e&&!Mc.dataTags.includes(e)){const t=[...Mc.dataTags,e];Lc({...Mc,dataTags:t})}},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить метку"})})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Превью виджета"}),J.jsxs("div",{className:"border rounded-lg shadow-inner h-[400px] overflow-hidden relative bg-gray-50",children:[J.jsx("div",{className:"absolute bottom-4 right-4",children:"ellipse"===Mc.buttonColor?J.jsx("div",{className:"w-12 h-12 rounded-[90px] flex items-center justify-center cursor-pointer shadow-lg",style:{backgroundColor:"custom"===Mc.buttonColor?Mc.customButtonColor:"dark"===Mc.buttonColor?"#1f2937":"#3b82f6"},children:J.jsx("span",{className:"text-white text-lg",children:"💬"})}):J.jsxs("div",{className:"px-4 py-2 rounded-lg flex items-center gap-2 cursor-pointer shadow-lg",style:{backgroundColor:"custom"===Mc.buttonColor?Mc.customButtonColor:"dark"===Mc.buttonColor?"#1f2937":"#3b82f6"},children:[J.jsx("div",{className:"w-4 h-4 rounded-[90px] opacity-80",style:{backgroundColor:Mc.accentColor}}),J.jsx("span",{className:"text-white text-sm font-medium",children:Mc.buttonText||"Спросить ИИ"})]})}),J.jsxs("div",{className:"absolute bottom-20 right-4 w-80 h-64 bg-white rounded-lg shadow-lg border",children:[J.jsx("div",{className:"p-3 border-b bg-gray-50 rounded-t-lg",children:J.jsxs("div",{className:"flex items-center gap-2",children:[Mc.logoUrl?J.jsx("img",{src:Mc.logoUrl,alt:"Logo",className:"w-6 h-6 rounded"}):J.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded flex items-center justify-center",children:J.jsx("span",{className:"text-white text-xs",children:"A"})}),J.jsx("span",{className:"text-sm font-medium",children:Mc.logoName||"Adapto"})]})}),J.jsxs("div",{className:"p-3 space-y-2",children:[null==(d=Mc.welcomeMessages)?void 0:d.slice(0,2).map((e,t)=>J.jsx("div",{className:"text-sm text-gray-700",children:e||`Приветственное сообщение ${t+1}`},t)),null==(u=Mc.suggestions)?void 0:u.slice(0,2).map((e,t)=>J.jsx("div",{className:"mt-2",children:J.jsx("button",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200",children:e||`Предложение ${t+1}`})},t))]})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Код для вставки на сайт"}),J.jsx("div",{className:"bg-gray-900 text-white p-4 rounded-lg font-mono text-sm overflow-x-auto",children:J.jsx("pre",{children:qc()})}),J.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[J.jsx("button",{onClick:()=>{navigator.clipboard.writeText(qc()),Oc("Код скопирован!")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors",children:"Скопировать код"}),J.jsx("button",{onClick:Wc,className:"bg-gray-100 text-gray-900 px-4 py-2 rounded-lg text-sm hover:bg-gray-200 transition-colors border border-gray-300",children:"Открыть в новой вкладке"})]})]})]})})]});case"messengers":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Мессенджеры"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px",marginTop:"0px"}}),J.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/tg.png",alt:"Telegram",className:"w-[24px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Telegram"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:We?"ИИ-бот подключен к Telegram":"Подключите ИИ-бота к Telegram"}),We?J.jsxs("div",{className:"mt-[20px] space-y-2",children:[J.jsx("button",{className:"w-full h-[34px] text-[13px] bg-[#6B7280] text-white rounded-[10px] cursor-default",style:jm.blueButton,children:"Подключено"}),Qe&&J.jsxs("div",{className:"text-[11px] text-[#8E8E93] text-center",children:["Диалогов: ",Qe.total," | Сегодня: ",Qe.today]})]}):J.jsx("button",{onClick:()=>$e(!0),className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})}),J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/wa.png",alt:"WhatsApp",className:"w-[24px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"WhatsApp"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Подключите ИИ-бота к WhatsApp"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})}),J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/vk.png",alt:"VK",className:"w-[24px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Вконтакте"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Подключите ИИ-бота к ВКонтакте"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})}),J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/ig.png",alt:"Instagram",className:"w-[24px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Instagram*"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Внедрите ИИ-бота прямо в Директ"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})})]}),J.jsx("div",{className:"mt-8 text-center",children:J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"*Instagram является продуктом Meta – признанной в РФ экстремисткой организацией"})})]});case"crm-systems":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"CRM-системы"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px",marginTop:"0px"}}),J.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/bitrix.png",alt:"Битрикс24",className:"w-[55px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Битрикс24"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Интеграция с Битрикс24"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})}),J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/amo.png",alt:"AmoCRM",className:"w-[39px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"amoCRM"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Интеграция с amoCRM"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})})]})]});case"other-integrations":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Сервисы"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px",marginTop:"0px"}}),J.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-[20px]",children:J.jsx("div",{className:"bg-white rounded-[16px] p-[16px]",children:J.jsxs("div",{className:"flex flex-col",children:[J.jsx("div",{className:"flex-shrink-0 mb-3",children:J.jsx("img",{src:"/yc.png",alt:"Yclients",className:"w-[24px] h-[24px]"})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Yclients"}),J.jsx("p",{className:"text-[13px] text-[#8E8E93]",children:"Интеграция с Yclients"}),J.jsx("button",{className:"w-full h-[34px] mt-[20px] text-[13px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6]",style:jm.blueButton,children:"Подключить"})]})})})]});case"profile":return J.jsx("div",{className:"space-y-6",children:J.jsx("div",{className:"bg-[#F8F8FA] min-h-[600px] h-full relative",children:J.jsxs("div",{className:"flex h-full",children:[J.jsx("div",{className:"w-64 space-y-4 pr-4",children:J.jsxs("div",{children:[J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",style:{marginBottom:"16px"},children:"Пользователь"}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-22px"}}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("button",{onClick:()=>he("personal"),className:"w-full h-[34px] flex items-center gap-3 px-3 rounded-[10px] text-left transition-colors "+("personal"===ue?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:bg-white hover:text-[#0084FF]"),children:[J.jsx("img",{src:"/Icon%20pers.svg",alt:"Мой аккаунт",className:"w-4 h-4",style:{filter:"personal"===ue?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(100%) contrast(100%)"}}),J.jsx("span",{className:"text-[13px] font-[500]",children:"Мой аккаунт"})]}),!p&&J.jsxs("button",{onClick:()=>he("subscription"),className:"w-full h-[34px] flex items-center gap-3 px-3 rounded-[10px] text-left transition-colors "+("subscription"===ue?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:bg-white hover:text-[#0084FF]"),children:[J.jsx("img",{src:"/Icon%20pers-1.svg",alt:"Оплата и тарифы",className:"w-4 h-4",style:{filter:"subscription"===ue?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(100%) contrast(100%)"}}),J.jsx("span",{className:"text-[13px] font-[500]",children:"Оплата и тарифы"})]}),!p&&J.jsxs("button",{onClick:()=>he("notifications"),className:"w-full h-[34px] flex items-center gap-3 px-3 rounded-[10px] text-left transition-colors "+("notifications"===ue?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:bg-white hover:text-[#0084FF]"),children:[J.jsx("img",{src:"/Icon%20notific.svg",alt:"Уведомления",className:"w-4 h-4",style:{filter:"notifications"===ue?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(100%) contrast(100%)"}}),J.jsx("span",{className:"text-[13px] font-[500]",children:"Уведомления"})]}),J.jsxs("button",{onClick:()=>he("theme"),className:"w-full h-[34px] flex items-center gap-3 px-3 rounded-[10px] text-left transition-colors "+("theme"===ue?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:bg-white hover:text-[#0084FF]"),children:[J.jsx("img",{src:"/Icon%20tema.svg",alt:"Тема",className:"w-4 h-4",style:{filter:"theme"===ue?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(100%) contrast(100%)"}}),J.jsx("span",{className:"text-[13px] font-[500]",children:"Тема"})]})]})]})}),J.jsx("div",{className:"w-px bg-[#E5E6E7] absolute left-64",style:{top:"-24px",bottom:"-24px"}}),J.jsxs("div",{className:"flex-1 pl-5",children:[J.jsxs("div",{className:"mb-[16px]",children:[J.jsxs("h1",{className:"text-[20px] font-[500] text-[#070F1A]",style:{marginBottom:"16px"},children:["personal"===ue&&"Мой аккаунт","subscription"===ue&&"Оплата и тарифы","notifications"===ue&&"Уведомления","theme"===ue&&"Тема"]}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-22px"}})]}),"personal"===ue&&J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[J.jsx("div",{className:"w-16 h-16 rounded-[90px] flex items-center justify-center",style:{backgroundColor:Nr(null==r?void 0:r.name).color},children:J.jsx("span",{className:"text-white font-semibold text-xl",children:Nr(null==r?void 0:r.name).letter})}),J.jsxs("div",{children:[J.jsx("h2",{className:"text-[18px] font-medium text-[#070F1A]",children:(null==r?void 0:r.name)||"Пользователь"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93]",children:(null==r?void 0:r.company_name)||"Компания не указана"})]})]}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Имя"}),J.jsx("input",{type:"text",value:fn.name,onChange:e=>bn({...fn,name:e.target.value}),className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Название компании"}),J.jsx("input",{type:"text",value:fn.company,onChange:e=>bn({...fn,company:e.target.value}),className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Email"}),J.jsx("input",{type:"email",value:fn.email,onChange:e=>bn({...fn,email:e.target.value}),className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Телефон"}),J.jsx("input",{type:"tel",value:fn.phone,onChange:e=>bn({...fn,phone:e.target.value}),className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Новый пароль"}),J.jsx("input",{type:"password",value:fn.newPassword,onChange:e=>bn({...fn,newPassword:e.target.value}),placeholder:"Введите новый пароль",className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Подтвердите пароль"}),J.jsx("input",{type:"password",value:fn.confirmPassword,onChange:e=>bn({...fn,confirmPassword:e.target.value}),placeholder:"Подтвердите новый пароль",className:"w-full h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField})]})]}),J.jsx("div",{className:"w-full",children:J.jsx("button",{onClick:wr,disabled:!yr(),className:"w-full h-[34px] rounded-[10px] transition-colors text-[13px] "+(yr()?"bg-[#0084FF] text-white hover:bg-[#0073E6]":"bg-gray-200 text-gray-400 cursor-not-allowed"),style:yr()?jm.blueButton:jm.whiteButton,children:"Сохранить изменения"})})]}),"invite"===ue&&J.jsxs("div",{className:"space-y-6",children:[!p&&J.jsxs("div",{className:"bg-white rounded-[16px] p-5",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A] mb-4",children:"Пригласите коллег для совместной работы над проектом"}),J.jsx("div",{className:"space-y-4",children:J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-medium text-[#8E8E93] mb-2",children:"Email участника"}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("input",{type:"email",placeholder:"example@company.com",className:"flex-1 h-[34px] px-4 rounded-[10px] focus:outline-none",style:Nm.inputField}),J.jsx("button",{className:"h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Пригласить"})]})]})})]}),J.jsxs("div",{className:"p-0",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A] mb-4",children:"Текущие участники"}),J.jsx("div",{className:"space-y-3",children:J.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-[16px]",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-8 h-8 rounded-[90px] bg-[#0084FF] flex items-center justify-center",children:J.jsx("span",{className:"text-white text-sm font-medium",children:Nr(null==r?void 0:r.name).letter})}),J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:(null==r?void 0:r.name)||"Пользователь"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:(null==r?void 0:r.email)||"vibe@mail.ru"})]})]}),J.jsx("span",{className:"text-[12px] bg-[#10B981]/10 text-[#10B981] px-2 py-1 rounded-[6px] font-[500]",children:"Владелец"})]})})]})]}),"subscription"===ue&&!p&&J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"bg-white rounded-[16px] p-6",children:[J.jsx("p",{className:"text-[12px] text-[#8E8E93] mb-2",children:"Текущий тариф"}),J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A] mb-4",children:"Бесплатный"}),J.jsxs("div",{className:"space-y-4",children:[J.jsx("div",{children:J.jsxs("div",{className:"flex justify-between items-center mb-2",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"/clock.svg",alt:"Clock",className:"w-3 h-3"}),J.jsx("span",{className:"text-[12px] text-[#8E8E93]",children:"Дни"})]}),J.jsx("span",{className:"text-[12px] font-medium text-[#070F1A]",children:"3 / 3"})]})}),J.jsxs("div",{children:[J.jsxs("div",{className:"flex justify-between items-center mb-2",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"/Vector09.svg",alt:"Tokens",className:"w-3 h-3"}),J.jsx("span",{className:"text-[12px] text-[#8E8E93]",children:"Токены"})]}),J.jsx("span",{className:"text-[12px] font-medium text-[#070F1A]",children:"50000 / 50000"})]}),J.jsx("div",{className:"w-full bg-gray-200 rounded-[90px] h-[3px]",children:J.jsx("div",{className:"bg-[#0084FF] h-[3px] rounded-[90px] transition-all duration-300",style:{width:"100%"}})})]})]})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-4",children:"Настройте объем сообщений под вашу компанию"}),J.jsxs("h2",{className:"text-[18px] font-medium text-[#070F1A] mb-6",children:["Мне нужно обрабатывать ",fe.toLocaleString()," сообщений ≈ ",Math.round(fe/5)," диалогов ежемесячно"]}),J.jsxs("div",{className:"w-full relative",children:[J.jsx("input",{type:"range",min:"500",max:"25000",step:"500",value:fe,onChange:e=>be(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer relative z-10",style:{background:`linear-gradient(to right, #0084FF 0%, #0084FF ${(fe-500)/24500*100}%, #E5E7EB ${(fe-500)/24500*100}%, #E5E7EB 100%)`}}),J.jsxs("div",{className:"absolute top-0 left-0 w-full h-2 pointer-events-none",children:[J.jsx("div",{className:"absolute top-0 left-0 w-px h-2 bg-gray-400"}),J.jsx("div",{className:"absolute top-0 left-[20%] w-px h-2 bg-gray-400"}),J.jsx("div",{className:"absolute top-0 left-[40%] w-px h-2 bg-gray-400"}),J.jsx("div",{className:"absolute top-0 left-[60%] w-px h-2 bg-gray-400"}),J.jsx("div",{className:"absolute top-0 left-[80%] w-px h-2 bg-gray-400"}),J.jsx("div",{className:"absolute top-0 right-0 w-px h-2 bg-gray-400"})]}),J.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[J.jsx("span",{children:"500"}),J.jsx("span",{children:"5000"}),J.jsx("span",{children:"10000"}),J.jsx("span",{children:"15000"}),J.jsx("span",{children:"20000"}),J.jsx("span",{children:"25000"})]})]})]}),J.jsx("div",{className:"flex justify-center",children:J.jsxs("div",{className:"flex justify-center gap-2 bg-white border w-fit mx-auto p-1.5 rounded-full",children:[J.jsx("button",{onClick:()=>ye("monthly"),className:"px-4 relative py-1 rounded-full duration-100 transition font-medium text-sm "+("monthly"===ve?"bg-emerald-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"1 месяц"}),J.jsxs("button",{onClick:()=>ye("quarterly"),className:"px-4 relative py-1 rounded-full duration-100 transition font-medium text-sm "+("quarterly"===ve?"bg-emerald-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:["3 месяца",J.jsx("div",{className:"!absolute truncate text-xs bg-primary text-white rounded-full px-2 py-0.5 -top-3.5 -right-2",children:"15% скидка"})]})]})}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-stretch",children:[J.jsxs("div",{className:"bg-white rounded-[16px] p-6 flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h4",{className:"text-[18px] font-medium text-[#070F1A]",children:"Старт"}),J.jsxs("div",{className:"text-right",children:[J.jsx("span",{className:"text-[24px] font-medium text-[#070F1A]",children:Fe("Старт",fe,ve).toLocaleString()}),J.jsx("span",{className:"text-[14px] font-medium text-[#070F1A]",children:" ₽/мес"})]})]}),J.jsxs("div",{className:"space-y-2 text-[14px] text-[#8E8E93] flex-grow",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Каналы интеграций: 1 мессенджер + виджет на сайт"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"База знаний: до 50 МБ"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Метрики: только общие"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Команда: 1 аккаунт в проекте"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Обновления: AdaptoGPT"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Техническая поддержка"})]})]}),J.jsx("button",{className:"w-full mt-6 h-[34px] bg-[#0084FF] text-white rounded-[10px] text-[14px] font-[500] hover:bg-[#0073E6] transition-colors",children:"Выбрать тариф"})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h4",{className:"text-[18px] font-medium text-[#070F1A]",children:"Про"}),J.jsxs("div",{className:"text-right",children:[J.jsx("span",{className:"text-[24px] font-medium text-[#070F1A]",children:Fe("Про",fe,ve).toLocaleString()}),J.jsx("span",{className:"text-[14px] font-medium text-[#070F1A]",children:" ₽/мес"})]})]}),J.jsxs("div",{className:"space-y-2 text-[14px] text-[#8E8E93] flex-grow",children:[J.jsx("div",{className:"text-[16px] font-medium text-[#070F1A] mb-2",children:'Все, что входит в тариф "Старт" +'}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Каналы интеграций: все доступные (мессенджеры + виджет)"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"База знаний: до 200 МБ"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"CRM-система от Adapto и интеграция с др. CRM"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Метрики: углубленная аналитика"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Команда: до 5 пользователей"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Расширения: все доступные функции"})]})]}),J.jsx("button",{className:"w-full mt-6 h-[34px] bg-[#0084FF] text-white rounded-[10px] text-[14px] font-[500] hover:bg-[#0073E6] transition-colors",children:"Выбрать тариф"})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h4",{className:"text-[18px] font-medium text-[#070F1A]",children:"Бизнес"}),J.jsxs("div",{className:"text-right",children:[J.jsx("span",{className:"text-[24px] font-medium text-[#070F1A]",children:Fe("Бизнес",fe,ve).toLocaleString()}),J.jsx("span",{className:"text-[14px] font-medium text-[#070F1A]",children:" ₽/мес"})]})]}),J.jsxs("div",{className:"space-y-2 text-[14px] text-[#8E8E93] flex-grow",children:[J.jsx("div",{className:"text-[16px] font-medium text-[#070F1A] mb-2",children:'Все, что входит в тариф "Про" +'}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"База знаний: неограниченно"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Команда: до 20 пользователей"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Поддержка: приоритетная"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Интеграции: индивидуальные решения под проект"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"Обновления: приоритетный доступ к новым версиям"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:"./Checkbox.svg",alt:"✓",className:"w-4 h-4"}),J.jsx("span",{children:"White-label виджета"})]})]}),J.jsx("button",{className:"w-full mt-6 h-[34px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Выбрать тариф"})]})]})]}),"notifications"===ue&&!p&&J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"border border-[#070F1A]/10 rounded-[16px] p-5",children:[J.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A]",children:"Уведомления в"}),J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("span",{className:"text-[18px] font-medium text-[#070F1A]",children:"Telegram"}),J.jsx("img",{src:"/tg.png",alt:"Telegram",className:"w-[15px] h-[13px]"})]})]}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-6",children:"Получайте информацию о новых сообщениях, уведомлениях о переключения чата на оператора и тд. Это поможет вам быть на связи с клиентами круглосуточно и быть в курсе о перехватах диалогов человеком!"}),J.jsxs("div",{className:"mt-[30px]",children:[J.jsxs("p",{className:"text-[14px] font-[500] text-[#070F1A] mb-4",children:["Перейдите в ",J.jsx("a",{href:"https://t.me/Adapto_notifications_bot",target:"_blank",rel:"noopener noreferrer",className:"text-[#0084FF] hover:underline",children:"наш Telegram-бот"})," и отправьте команду ",J.jsx("span",{className:"text-[#0084FF]",children:"/start"}),".",J.jsx("br",{}),"После чего бот вышлет API ключ, который необходимо вставить в поле ниже"]}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsx("input",{type:"text",placeholder:"Введите API ключ из @Adapto_notifications_bot",value:cn,onChange:e=>dn(e.target.value),className:"flex-1 h-[34px] px-4 border border-[#E5E7EB] rounded-[10px] text-[13px] font-[400] focus:outline-none focus:border-[#0084FF]",style:Nm.inputField}),J.jsx("button",{onClick:xr,disabled:un,className:"h-[34px] px-6 bg-[#0084FF] text-white rounded-[10px] text-[13px] font-[500] hover:bg-[#0073E6] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:jm.blueButton,children:un?"Подключение...":"Подключить"})]})]})]}),J.jsxs("div",{className:"border border-[#070F1A]/10 rounded-[16px] p-5",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A] mb-4",children:"Типы уведомлений"}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Новые сообщения в чатах"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Уведомления о входящих сообщениях от клиентов"})]}),J.jsx("img",{src:(null==(m=null==mn?void 0:mn.notification_types)?void 0:m.includes("new_messages"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("new_messages")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Перехваты оператором"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Уведомления когда диалог перехватывает человек"})]}),J.jsx("img",{src:(null==(g=null==mn?void 0:mn.notification_types)?void 0:g.includes("operator_takeover"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("operator_takeover")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Системные уведомления"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Уведомления о системных событиях и ошибках"})]}),J.jsx("img",{src:(null==(f=null==mn?void 0:mn.notification_types)?void 0:f.includes("system_alerts"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("system_alerts")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Ежедневные отчеты"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Ежедневная статистика и аналитика"})]}),J.jsx("img",{src:(null==(b=null==mn?void 0:mn.notification_types)?void 0:b.includes("daily_reports"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("daily_reports")})]})]})]})]}),"theme"===ue&&J.jsx("div",{className:"space-y-6",children:J.jsxs("div",{className:"flex gap-[15px]",children:[J.jsx("div",{className:"w-[250px] h-[170px] rounded-[16px] border cursor-pointer transition-all "+("light"===me?"bg-[#DBE9FF] border-[#0084FF]":"bg-[#F3F5F7] border-[#070F1A]/10"),onClick:()=>ge("light"),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsx("div",{className:"w-full h-[120px] bg-white rounded-t-[16px] flex items-center justify-center border border-gray-200",children:J.jsx("img",{src:"/Group 172.png",alt:"Светлая тема",className:"w-full h-full object-cover rounded-t-[16px]"})}),J.jsxs("div",{className:"flex items-center gap-2 pl-[12px] h-[50px]",children:[J.jsx("img",{src:"light"===me?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Светлая",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Светлая тема"})]})]})}),J.jsx("div",{className:"w-[250px] h-[170px] rounded-[16px] border cursor-pointer transition-all "+("dark"===me?"bg-[#DBE9FF] border-[#0084FF]":"bg-[#F3F5F7] border-[#070F1A]/10"),onClick:()=>ge("dark"),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsx("div",{className:"w-full h-[120px] bg-gray-800 rounded-t-[16px] flex items-center justify-center border border-gray-200",children:J.jsx("img",{src:"/Group 173.png",alt:"Темная тема",className:"w-full h-full object-cover rounded-t-[16px]"})}),J.jsxs("div",{className:"flex items-center gap-2 pl-[12px] h-[50px]",children:[J.jsx("img",{src:"dark"===me?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Темная",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Темная тема"})]})]})})]})})]})]})})});case"widget-dev":return J.jsxs("div",{className:"space-y-0",children:[J.jsxs("div",{className:"flex justify-between items-center",style:{marginBottom:"16px"},children:[J.jsx("div",{children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Виджет на сайт"})}),J.jsx("div",{className:"flex items-center gap-2",children:J.jsxs(og,{onClick:oc,className:"h-[34px] px-4 bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[10px] font-[500] text-[13px] flex items-center gap-2",style:jm.blueButton,children:[J.jsx("img",{src:"/document-copy.svg",alt:"Копировать",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(1)"}}),"Скопировать скрипт"]})})]}),J.jsx("div",{className:"border-b",style:{borderColor:"#E5E6E7",marginLeft:"-16px",marginRight:"-16px"}}),J.jsxs("div",{className:"flex h-[calc(100vh-200px)]",children:[J.jsxs("div",{className:"flex-[1.2] flex flex-col",style:{marginTop:"20px"},children:[J.jsxs("div",{className:"space-y-[10px] flex-1",children:[J.jsxs("div",{className:"bg-white rounded-[16px] overflow-hidden",children:[J.jsxs("div",{className:"p-[20px] h-[76px] flex items-center gap-4 cursor-pointer",onClick:()=>Ri(e=>({...e,sections:!e.sections})),children:[J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:J.jsx("img",{src:"/1231234.png",alt:"Разделы",className:"w-full h-full object-contain"})}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Разделы виджета"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Выберите из чего будет состоять ваш виджет"})]}),J.jsx("div",{className:"transition-transform duration-300 "+(Li.sections?"-rotate-90":"rotate-90"),children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),Li.sections&&J.jsx("div",{className:"px-[15px] pb-[15px]",children:J.jsxs("div",{className:"pt-4",children:[J.jsx("div",{className:"border-b border-gray-200 mb-5",children:J.jsxs("div",{className:"flex",children:[J.jsxs("div",{className:"flex-1 relative",children:[J.jsxs("button",{onClick:()=>Pi("main"),className:"w-full py-3 px-4 text-sm font-medium transition-colors flex items-center justify-center gap-[5px] "+("main"===Oi?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#070F1A]"),children:[J.jsx("img",{src:"/house.svg",alt:"Главная",className:"w-[17px] h-[17px]",style:{filter:"main"===Oi?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}}),J.jsx("span",{className:"text-[14px]",children:"Главная"})]}),"main"===Oi&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]}),J.jsxs("div",{className:"flex-1 relative",children:[J.jsxs("button",{onClick:()=>Pi("chat"),className:"w-full py-3 px-4 text-sm font-medium transition-colors flex items-center justify-center gap-[5px] "+("chat"===Oi?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#070F1A]"),children:[J.jsx("img",{src:"/Frame 147.svg",alt:"Чат",className:"w-[17px] h-[17px]",style:{filter:"chat"===Oi?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}}),J.jsx("span",{className:"text-[14px]",children:"Чат"})]}),"chat"===Oi&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]}),J.jsxs("div",{className:"flex-1 relative",children:[J.jsxs("button",{onClick:()=>Pi("form"),className:"w-full py-3 px-4 text-sm font-medium transition-colors flex items-center justify-center gap-[5px] "+("form"===Oi?"text-[#0084FF]":"text-[#8E8E93] hover:text-[#070F1A]"),children:[J.jsx("img",{src:"/clipboard-text.svg",alt:"Форма",className:"w-[17px] h-[17px]",style:{filter:"form"===Oi?"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(204deg) brightness(101%) contrast(101%)":"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}}),J.jsx("span",{className:"text-[14px]",children:"Форма"})]}),"form"===Oi&&J.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[4px] bg-[#0084FF] rounded-t-[4px]"})]})]})}),"main"===Oi&&J.jsxs("div",{className:"space-y-5",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Имя ИИ-агента"}),J.jsxs("div",{className:"flex items-center gap-[15px]",children:[J.jsx("input",{type:"text",value:Vi,onChange:e=>Ki(e.target.value),className:"w-[256px] h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("img",{src:$i?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Переключатель",className:"w-[34px] h-[34px] cursor-pointer",onClick:()=>Bi(!$i)}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Показывать метку ИИ агента"})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Логотип"}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>Ui("default"),children:[J.jsx("img",{src:"default"===zi?"/Checkbox.svg":"/Checkbox-1.svg",alt:"По умолчанию",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"По умолчанию"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>Ui("custom"),children:[J.jsx("img",{src:"custom"===zi?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Загрузить свой",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Загрузить свой логотип"})]}),"custom"===zi&&J.jsxs("div",{className:"flex items-center gap-[10px] cursor-pointer",onClick:()=>document.getElementById("logo-upload").click(),children:[J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:qi?J.jsx("img",{src:qi,alt:"Логотип",className:"w-full h-full object-contain"}):J.jsx("img",{src:"/Group 125.svg",alt:"Логотип",className:"w-full h-full object-contain"})}),J.jsx("div",{children:Hi?J.jsxs(J.Fragment,{children:[J.jsxs("p",{className:"text-[14px] text-[#070F1A] font-[500]",children:["Загружен: ",Hi]}),J.jsx("p",{className:"text-[9px] text-[#8E8E93]",children:"Нажмите, чтобы изменить логотип"})]}):J.jsxs(J.Fragment,{children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] font-[500]",children:"Загрузите файл"}),J.jsx("p",{className:"text-[9px] text-[#8E8E93]",children:"Углы вашего логотипа будут закруглены, загрузите логотип с четкими углами."})]})}),J.jsx("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/*",onChange:uc})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Заголовок"}),J.jsx("textarea",{value:Po,onChange:e=>$o(e.target.value),className:"w-full h-[80px] px-3 py-2 border border-[#070F1A]/10 rounded-[10px] text-[13px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 resize-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Описание"}),J.jsx("textarea",{value:Ko,onChange:e=>Go(e.target.value),className:"w-full h-[80px] px-3 py-2 border border-[#070F1A]/10 rounded-[10px] text-[13px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 resize-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Вопросы"}),J.jsx("div",{className:"space-y-[10px]",children:ec.map(e=>J.jsxs("div",{className:"bg-[#F3F5F7] rounded-[10px] p-3 h-[50px] flex items-center gap-[10px]",children:[J.jsx("img",{src:"/Group 1.svg",alt:"Перетащить",className:"w-4 h-4 cursor-move"}),J.jsx("input",{type:"text",value:e.text,onChange:t=>{return s=e.id,n=t.target.value,void tc(e=>e.map(e=>e.id===s?{...e,text:n}:e));var s,n},className:"flex-1 h-[40px] px-3 border border-[#070F1A]/10 rounded-[7px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"}),J.jsx("img",{src:e.enabled?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer",onClick:()=>{return t=e.id,void tc(e=>e.map(e=>e.id===t?{...e,enabled:!e.enabled}:e));var t}}),J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4 cursor-pointer ml-[10px]",onClick:()=>{lc(e.id),ac(!0)}})]},e.id))}),J.jsxs("button",{onClick:dc,className:"mt-3 h-[34px] px-4 bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[90px] font-[500] text-[14px] transition-colors flex items-center justify-center gap-[2px]",children:[J.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Добавить вопрос"]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Заголовок кнопки"}),J.jsx("input",{type:"text",value:Jo,onChange:e=>Yo(e.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[13px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Описание кнопки"}),J.jsx("input",{type:"text",value:Xo,onChange:e=>Zo(e.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[13px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20",style:Nm.inputField})]})]}),"chat"===Oi&&J.jsxs("div",{className:"space-y-5",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Фото менеджеров в правом углу виджета"}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>Ji("none"),children:[J.jsx("img",{src:"none"===Gi?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Не добавлять",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Не добавлять"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>Ji("add"),children:[J.jsx("img",{src:"add"===Gi?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Добавить",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Добавить (максимум 2)"})]}),"add"===Gi&&J.jsxs("div",{className:"flex items-center gap-[10px] cursor-pointer",onClick:()=>document.getElementById("manager-photo-upload").click(),children:[J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:J.jsx("img",{src:"/Group 125.svg",alt:"Фото менеджера",className:"w-full h-full object-contain"})}),J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] font-[500]",children:"Загрузите файл"}),J.jsx("p",{className:"text-[9px] text-[#8E8E93]",children:"Вес файла не более 500 КБ"})]}),J.jsx("input",{type:"file",id:"manager-photo-upload",className:"hidden",accept:"image/*"})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Статус"}),J.jsxs("div",{className:"flex items-center gap-[15px]",children:[J.jsx("input",{type:"text",value:Zi,onChange:e=>el(e.target.value),className:"flex-1 h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"}),J.jsx("div",{className:"flex items-center gap-2",children:J.jsx("img",{src:tl?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Переключатель",className:"w-[34px] h-[34px] cursor-pointer",onClick:()=>sl(!tl)})})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Приветственное сообщение"}),J.jsx("input",{type:"text",value:nl,onChange:e=>rl(e.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20",placeholder:"Доброго дня! Чем мы можем помочь?"})]})]}),"form"===Oi&&J.jsxs("div",{className:"space-y-5",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Когда запрашивать"}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>ol("never"),children:[J.jsx("img",{src:"never"===ll?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Никогда",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Никогда"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>ol("before"),children:[J.jsx("img",{src:"before"===ll?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Перед началом диалога",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Перед началом диалога"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>ol("during"),children:[J.jsx("img",{src:"during"===ll?"/Checkbox.svg":"/Checkbox-1.svg",alt:"В процессе диалога",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"В процессе диалога"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>ol("timer"),children:[J.jsx("img",{src:"timer"===ll?"/Checkbox.svg":"/Checkbox-1.svg",alt:"По таймеру",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"По таймеру"})]}),J.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>ol("after_answer"),children:[J.jsx("img",{src:"after_answer"===ll?"/Checkbox.svg":"/Checkbox-1.svg",alt:"После ответа на вопрос клиента",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"После ответа на вопрос клиента"})]})]})]}),"timer"===ll&&J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Время показа формы (секунды)"}),J.jsx("input",{type:"number",value:vl,onChange:e=>yl(parseInt(e.target.value)||30),min:"1",max:"300",className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]}),"never"!==ll&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Поля формы"}),J.jsxs("div",{className:"relative",children:[J.jsxs("button",{onClick:()=>dl(!cl),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 flex items-center justify-between",children:[J.jsx("span",{children:"Выбрать (до 4-х полей)"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-3 h-3 transition-transform duration-300",style:{transform:cl?"rotate(-90deg)":"rotate(90deg)",filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})]}),cl&&J.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-1 bg-white border border-[#070F1A]/10 rounded-[10px] shadow-lg z-50 max-h-[200px] overflow-hidden",children:J.jsx("div",{className:"p-2 max-h-[180px] overflow-y-auto",children:J.jsx("div",{className:"space-y-2",children:xl.map(e=>J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{return t=e.type,void hl(e=>e.includes(t)?e.filter(e=>e!==t):e.length<4?[...e,t]:e);var t},children:[J.jsx("img",{src:ul.includes(e.type)?"/Checkbox.svg":"/Checkbox-1.svg",alt:e.label,className:"w-4 h-4"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:e.label})]},e.id))})})})]})]}),ul.length>0&&J.jsx("div",{children:J.jsx("div",{className:"space-y-[10px]",children:xl.filter(e=>ul.includes(e.type)).map(e=>J.jsxs("div",{className:"bg-[#F3F5F7] rounded-[10px] p-3 h-[70px] flex items-center gap-[10px]",children:[J.jsx("img",{src:"/Group 1.svg",alt:"Перетащить",className:"w-4 h-4 cursor-move"}),J.jsxs("div",{className:"flex-1 flex items-center gap-[10px]",children:[J.jsxs("div",{className:"bg-white rounded-[7px] px-3 py-2 flex-1 flex flex-col gap-[5px]",children:[J.jsx("span",{className:"text-[10px] text-[#8E8E93]",children:e.label}),J.jsxs("div",{className:"flex items-center gap-[10px]",children:[J.jsx("input",{type:"text",value:e.placeholder,onChange:t=>{return s=e.id,n=t.target.value,void pl(e=>e.map(e=>e.id===s?{...e,placeholder:n}:e));var s,n},className:"flex-1 text-[14px] text-[#070F1A] focus:outline-none"}),J.jsx("img",{src:"/vector.svg",alt:"Редактировать",className:"w-2 h-2 cursor-pointer"})]})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Обязательно"}),J.jsx("img",{src:e.required?"/iOS/Switch-1.svg":"/iOS/Switch.svg",alt:"Обязательно",className:"w-[34px] h-[34px] cursor-pointer",onClick:()=>{return t=e.id,void pl(e=>e.map(e=>e.id===t?{...e,required:!e.required}:e));var t}})]})]})]},e.id))})}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Заголовок формы"}),J.jsx("input",{type:"text",value:fl,onChange:e=>bl(e.target.value),placeholder:"Пожалуйста заполните форму",className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Ссылка на политику обработки персональных данных"}),J.jsx("input",{type:"url",value:ml,onChange:e=>gl(e.target.value),placeholder:"https://example.com/privacy-policy",className:"w-full h-[34px] px-3 border rounded-[10px] text-[14px] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 "+(ml&&!hc(ml)?"border-red-500":"border-[#070F1A]/10")}),ml&&!hc(ml)&&J.jsx("p",{className:"text-[12px] text-red-500 mt-1",children:"Введите корректную ссылку"})]})]})]})})]}),J.jsxs("div",{className:"bg-white rounded-[16px] overflow-hidden",children:[J.jsxs("div",{className:"p-[20px] h-[76px] flex items-center gap-4 cursor-pointer",onClick:()=>Ri(e=>({...e,styling:!e.styling})),children:[J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:J.jsx("img",{src:"/1231235.png",alt:"Стилизация",className:"w-full h-full object-contain"})}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Стилизация виджета"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Настройте стилистику виджета под ваш бренд"})]}),J.jsx("div",{className:"transition-transform duration-300 "+(Li.styling?"-rotate-90":"rotate-90"),children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),Li.styling&&J.jsx("div",{className:"px-[15px] pb-[15px] border-t border-[#070F1A]/10",children:J.jsxs("div",{className:"pt-4 space-y-5",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Цветовая тема виджета"}),J.jsxs("div",{className:"flex gap-[15px]",children:[J.jsx("div",{className:"w-[141px] h-[120px] rounded-[12px] border cursor-pointer transition-all "+("white"===no?"bg-[#DBE9FF] border-[#0084FF]":"bg-[#F3F5F7] border-[#070F1A]/10"),onClick:()=>ro("white"),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsx("div",{className:"w-full h-[80px] bg-white rounded-t-[12px] flex items-center justify-center border border-gray-200",children:J.jsx("img",{src:"/Group 161.png",alt:"Белая тема",className:"w-full h-full object-contain rounded-t-[12px]"})}),J.jsxs("div",{className:"flex items-center gap-2 pl-[10px] pt-2",children:[J.jsx("img",{src:"white"===no?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Белая",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Белая"})]})]})}),J.jsx("div",{className:"w-[141px] h-[120px] rounded-[12px] border cursor-pointer transition-all "+("dark"===no?"bg-[#DBE9FF] border-[#0084FF]":"bg-[#F3F5F7] border-[#070F1A]/10"),onClick:()=>ro("dark"),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsx("div",{className:"w-full h-[80px] bg-gray-800 rounded-t-[12px] flex items-center justify-center border border-gray-200",children:J.jsx("img",{src:"/Group 160.png",alt:"Темная тема",className:"w-full h-full object-contain rounded-t-[12px]"})}),J.jsxs("div",{className:"flex items-center gap-2 pl-[10px] pt-2",children:[J.jsx("img",{src:"dark"===no?"/Checkbox.svg":"/Checkbox-1.svg",alt:"Темная",className:"w-4 h-4"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"Темная"})]})]})})]})]}),J.jsxs("div",{className:"flex gap-[15px]",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Цвет фона"}),J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",value:yo>0?`Gradient №${yo}`:ao,onChange:e=>{0===yo&&io(e.target.value)},className:"w-full h-[34px] px-3 pr-12 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] bg-white"}),J.jsx("div",{className:"color-picker-button absolute right-2 top-1/2 transform -translate-y-1/2 w-[28px] h-[28px] cursor-pointer",onClick:()=>xc("background"),children:J.jsx("div",{className:"color-picker-preview w-[28px] h-[28px] rounded-[90px]",style:{background:"conic-gradient(from 0deg, #0C28FF 0%, #03FFFF 14%, #24D627 23%, #FDFF22 41%, #FF2227 58%, #FE2DF6 77%, #7122FF 89%, #0C28FF 100%)",border:"1.5px solid transparent",backgroundClip:"padding-box"},children:J.jsx("div",{className:"w-[16px] h-[16px] rounded-[90px] absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",style:{backgroundColor:ao.includes("gradient")?"#FFFFFF":ao}})})}),fc("background")]}),J.jsx("div",{className:"flex gap-[10px] mt-3",children:[1,2,3,4,5,6,7,8,9,10].map(e=>J.jsx("div",{className:"w-[20px] h-[20px] rounded-[90px] border cursor-pointer relative "+(yo===e?"border-[#0084FF]":"border-[#C8C7CB]"),onClick:()=>{return wo(t=e),void io(["#FFFFFF","linear-gradient(30deg, #52AEFF 0%, #096EFD 100%)","linear-gradient(30deg, #39E978 0%, #2A7344 100%)","linear-gradient(30deg, #4C4C4C 0%, #282828 100%)","linear-gradient(30deg, #D12020 0%, #8A2626 100%)","linear-gradient(30deg, #D15820 0%, #8A4B26 100%)","linear-gradient(30deg, #FDAB54 0%, #FA7F89 100%)","linear-gradient(30deg, #A41AE8 0%, #60268A 100%)","linear-gradient(30deg, #DAC887 0%, #EDAA24 100%)","linear-gradient(30deg, #5675FF 0%, #1749BD 100%)","linear-gradient(30deg, #28BCEE 0%, #27B0C2 100%)"][t]||"#FFFFFF");var t},children:J.jsx("div",{className:"w-[14px] h-[14px] rounded-[90px] absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",style:{background:1===e?"linear-gradient(30deg, #52AEFF 0%, #096EFD 100%)":2===e?"linear-gradient(30deg, #39E978 0%, #2A7344 100%)":3===e?"linear-gradient(30deg, #4C4C4C 0%, #282828 100%)":4===e?"linear-gradient(30deg, #D12020 0%, #8A2626 100%)":5===e?"linear-gradient(30deg, #D15820 0%, #8A4B26 100%)":6===e?"linear-gradient(30deg, #FDAB54 0%, #FA7F89 100%)":7===e?"linear-gradient(30deg, #A41AE8 0%, #60268A 100%)":8===e?"linear-gradient(30deg, #DAC887 0%, #EDAA24 100%)":9===e?"linear-gradient(30deg, #5675FF 0%, #1749BD 100%)":"linear-gradient(30deg, #28BCEE 0%, #27B0C2 100%)"}})},e))})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Акцентный цвет"}),J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",value:lo,onChange:e=>oo(e.target.value),className:"w-full h-[34px] px-3 pr-12 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] bg-white"}),J.jsx("div",{className:"color-picker-button absolute right-2 top-1/2 transform -translate-y-1/2 w-[28px] h-[28px] cursor-pointer",onClick:()=>xc("accent"),children:J.jsx("div",{className:"color-picker-preview w-[28px] h-[28px] rounded-[90px]",style:{background:"conic-gradient(from 0deg, #0C28FF 0%, #03FFFF 14%, #24D627 23%, #FDFF22 41%, #FF2227 58%, #FE2DF6 77%, #7122FF 89%, #0C28FF 100%)",border:"1.5px solid transparent",backgroundClip:"padding-box"},children:J.jsx("div",{className:"w-[16px] h-[16px] rounded-[90px] absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",style:{backgroundColor:lo}})})}),fc("accent")]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Цвет кнопки открытия виджета"}),J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",value:co,onChange:e=>uo(e.target.value),className:"w-full h-[34px] px-3 pr-12 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] bg-white"}),J.jsx("div",{className:"color-picker-button absolute right-2 top-1/2 transform -translate-y-1/2 w-[28px] h-[28px] cursor-pointer",onClick:()=>xc("button"),children:J.jsx("div",{className:"w-[28px] h-[28px] rounded-[90px]",style:{background:"conic-gradient(from 0deg, #0C28FF 0%, #03FFFF 14%, #24D627 23%, #FDFF22 41%, #FF2227 58%, #FE2DF6 77%, #7122FF 89%, #0C28FF 100%)",border:"1.5px solid transparent",backgroundClip:"padding-box"},children:J.jsx("div",{className:"w-[16px] h-[16px] rounded-[90px] absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",style:{backgroundColor:co}})})}),fc("button")]})]}),J.jsxs("div",{className:"flex gap-[15px]",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Позиция на компьютере"}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("label",{className:"text-[12px] text-[#8E8E93] mb-1 block",children:"Отступ снизу"}),J.jsx("input",{type:"text",value:`${Ao}px`,onChange:e=>{const t=e.target.value.replace("px","");To(Number(t)||0)},className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("label",{className:"text-[12px] text-[#8E8E93] mb-1 block",children:"Отступ справа"}),J.jsx("input",{type:"text",value:`${Do}px`,onChange:e=>{const t=e.target.value.replace("px","");Io(Number(t)||0)},className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Позиция на телефоне и планшете"}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("label",{className:"text-[12px] text-[#8E8E93] mb-1 block",children:"Отступ снизу"}),J.jsx("input",{type:"text",value:`${Mo}px`,onChange:e=>{const t=e.target.value.replace("px","");Lo(Number(t)||0)},className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]}),J.jsxs("div",{className:"flex-1",children:[J.jsx("label",{className:"text-[12px] text-[#8E8E93] mb-1 block",children:"Отступ справа"}),J.jsx("input",{type:"text",value:`${Ro}px`,onChange:e=>{const t=e.target.value.replace("px","");Oo(Number(t)||0)},className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]})]})]})]})]})})]}),J.jsxs("div",{className:"bg-white rounded-[16px] overflow-hidden",children:[J.jsxs("div",{className:"p-[20px] h-[76px] flex items-center gap-4 cursor-pointer",onClick:()=>Ri(e=>({...e,triggers:!e.triggers})),children:[J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:J.jsx("img",{src:"/1231236.png",alt:"Триггеры",className:"w-full h-full object-contain"})}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:"Быстрые ответы и триггеры"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Добавьте кнопки ответа, триггерные и догоняющие смс"})]}),J.jsx("div",{className:"transition-transform duration-300 "+(Li.triggers?"-rotate-90":"rotate-90"),children:J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[11px] h-[11px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),Li.triggers&&J.jsx("div",{className:"px-[15px] pb-[15px] border-t border-[#070F1A]/10",children:J.jsxs("div",{className:"pt-4 space-y-6",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Триггерное сообщение"}),J.jsxs("div",{className:"grid grid-cols-2 gap-[15px] mb-4",children:[J.jsx("button",{onClick:()=>Jl(!0),className:"h-[34px] px-4 rounded-[10px] text-[14px] font-[500] transition-all "+(Gl?"bg-[#0084FF] text-white":"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]"),children:"Есть"}),J.jsx("button",{onClick:()=>Jl(!1),className:"h-[34px] px-4 rounded-[10px] text-[14px] font-[500] transition-all "+(Gl?"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]":"bg-[#0084FF] text-white"),children:"Нет"})]}),Gl&&J.jsxs("div",{className:"space-y-4",children:[Yl.map((e,t)=>J.jsxs("div",{className:"bg-[#F3F5F7] rounded-[10px] p-[15px] h-[235px] relative",children:[J.jsxs("div",{className:"flex justify-between items-center mb-[13px]",children:[J.jsxs("h5",{className:"text-[14px] font-[500] text-[#070F1A]",children:["Триггерное сообщение №",t+1]}),J.jsx("button",{onClick:()=>{return t=e.id,void Xl(Yl.filter(e=>e.id!==t));var t},className:"w-[15px] h-[15px] flex items-center justify-center",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-[16px] h-[16px]",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"}})})]}),J.jsxs("div",{className:"bg-white rounded-[7px] px-[15px] py-[15px] space-y-4",children:[J.jsxs("div",{className:"flex gap-4",children:[J.jsxs("div",{className:"w-[155px]",children:[J.jsx("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:"Время показа через:"}),J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("input",{type:"number",value:e.timeDelay,onChange:t=>Ho(e.id,"timeDelay",Number(t.target.value)),className:"w-[50px] h-[40px] px-2 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"}),J.jsx("span",{className:"text-[12px] text-[#070F1A] opacity-50",children:"сек"})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsxs("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:["Сообщение",J.jsxs("span",{className:"text-[10px] text-[#8E8E93]/70 ml-1",children:["(",e.message.trim().split(/\s+/).filter(e=>e.length>0).length,"/15 слов)"]})]}),J.jsx("input",{type:"text",value:e.message,onChange:t=>Ho(e.id,"message",t.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20",placeholder:"Введите сообщение (максимум 15 слов)"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:"Кнопка ответа"}),J.jsx("input",{type:"text",value:e.buttonText,onChange:t=>Ho(e.id,"buttonText",t.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]})]})]},e.id)),J.jsxs("button",{onClick:Wo,className:"mt-3 h-[34px] px-4 bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[90px] font-[500] text-[14px] transition-colors flex items-center justify-center gap-[2px]",children:[J.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Добавить триггер"]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Догоняющее сообщение"}),J.jsxs("div",{className:"grid grid-cols-2 gap-[15px] mb-4",children:[J.jsx("button",{onClick:()=>eo(!0),className:"h-[34px] px-4 rounded-[10px] text-[14px] font-[500] transition-all "+(Zl?"bg-[#0084FF] text-white":"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]"),children:"Есть"}),J.jsx("button",{onClick:()=>eo(!1),className:"h-[34px] px-4 rounded-[10px] text-[14px] font-[500] transition-all "+(Zl?"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]":"bg-[#0084FF] text-white"),children:"Нет"})]}),Zl&&J.jsxs("div",{className:"space-y-4",children:[to.map((e,t)=>J.jsxs("div",{className:"bg-[#F3F5F7] rounded-[10px] p-[15px] h-[235px] relative",children:[J.jsxs("div",{className:"flex justify-between items-center mb-[13px]",children:[J.jsxs("h5",{className:"text-[14px] font-[500] text-[#070F1A]",children:["Догоняющее сообщение №",t+1]}),J.jsx("button",{onClick:()=>{return t=e.id,void so(to.filter(e=>e.id!==t));var t},className:"w-[15px] h-[15px] flex items-center justify-center",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-[16px] h-[16px]",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)"}})})]}),J.jsxs("div",{className:"bg-white rounded-[7px] px-[15px] py-[15px] space-y-4",children:[J.jsxs("div",{className:"flex gap-4",children:[J.jsxs("div",{className:"w-[155px]",children:[J.jsx("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:"Время показа через:"}),J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("input",{type:"number",value:e.timeDelay,onChange:t=>Vo(e.id,"timeDelay",Number(t.target.value)),className:"w-[50px] h-[40px] px-2 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"}),J.jsx("span",{className:"text-[12px] text-[#070F1A] opacity-50",children:"сек"})]})]}),J.jsxs("div",{className:"flex-1",children:[J.jsxs("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:["Сообщение",J.jsxs("span",{className:"text-[10px] text-[#8E8E93]/70 ml-1",children:["(",e.message.trim().split(/\s+/).filter(e=>e.length>0).length,"/15 слов)"]})]}),J.jsx("input",{type:"text",value:e.message,onChange:t=>Vo(e.id,"message",t.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20",placeholder:"Введите сообщение (максимум 15 слов)"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"text-[14px] text-[#8E8E93] mb-1 block",children:"Кнопка ответа"}),J.jsx("input",{type:"text",value:e.buttonText,onChange:t=>Vo(e.id,"buttonText",t.target.value),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20"})]})]})]},e.id)),J.jsxs("button",{onClick:Qo,className:"mt-3 h-[34px] px-4 bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[90px] font-[500] text-[14px] transition-colors flex items-center justify-center gap-[2px]",children:[J.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Добавить догоняющее"]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Текст кнопки разрешения вопроса и завершения диалога"}),J.jsx("div",{className:"flex gap-[10px] flex-wrap",children:["👍 Это помогло","Спасибо","Спасибо за ответ","👍"].map(e=>J.jsx("button",{onClick:()=>zo(e),className:"h-[34px] px-[14px] rounded-[90px] text-[13px] font-[500] transition-all "+(Bo===e?"bg-[#0084FF] text-white":"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]"),children:e},e))})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#8E8E93] mb-[10px]",children:"Текст кнопки для перенаправления на человека"}),J.jsx("div",{className:"flex gap-[10px] flex-wrap",children:["Получить доп. помощь","Поговорить с человеком 👤","Нет"].map(e=>J.jsx("button",{onClick:()=>qo(e),className:"h-[34px] px-[14px] rounded-[90px] text-[13px] font-[500] transition-all "+(Uo===e?"bg-[#0084FF] text-white":"bg-transparent border border-[#070F1A]/10 text-[#8E8E93]"),children:e},e))})]})]})})]})]}),J.jsx("div",{className:"sticky bottom-0 z-10 mt-6",children:J.jsx("div",{className:"w-full shadow-[0_12px_30px_rgba(7,15,26,0.12)]/50",children:J.jsx(og,{onClick:cc,className:"w-full h-[34px] bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[10px] font-[500] text-[13px] shadow-[0_12px_30px_rgba(7,15,26,0.12)]",style:jm.blueButton,children:"Сохранить изменения"})})})]}),J.jsx("div",{className:"w-px bg-[#E5E6E7] self-stretch",style:{marginLeft:"16px",marginRight:"16px",marginTop:"0px"}}),J.jsx("div",{className:"flex-1 bg-[#F8F8FA] py-6 sticky top-0 self-start h-fit max-h-screen overflow-y-auto",style:{marginTop:"20px"},children:J.jsxs("div",{className:"relative h-[680px]",children:[J.jsx("div",{className:"absolute transition-all duration-300",style:{bottom:`${Mc.desktopBottomOffset||20}px`,right:`${(Mc.desktopRightOffset||20)+40}px`,zIndex:Mc.zIndex||9999},children:J.jsx("button",{onClick:()=>Tl?Xc():Jc(),className:"w-[50px] h-[50px] shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center",style:{backgroundColor:co||"#0084FF",borderRadius:"990px 990px 0px 990px"},children:Tl?J.jsx("img",{src:"/Icon2.svg",alt:"Close",className:"w-4 h-4",style:{filter:"brightness(0) invert(1)"}}):J.jsx("img",{src:"/Vectorlogovidget.svg",alt:"Widget",className:"w-6 h-6",style:{filter:"brightness(0) invert(1)"}})})}),Tl&&J.jsx("div",{className:"absolute transition-all duration-300",style:{bottom:`${(Mc.desktopBottomOffset||20)+60}px`,right:`${(Mc.desktopRightOffset||20)+40}px`,zIndex:Mc.zIndex||9999},children:J.jsxs("div",{className:"rounded-[20px] shadow-lg border w-[371px] h-[601px] flex flex-col overflow-hidden relative "+("dark"===no?"bg-[#171717] border-white/10":"bg-white border-gray-200"),children:[J.jsx("button",{onClick:Xc,className:"absolute top-[15px] right-[15px] z-10 w-[18px] h-[18px] flex items-center justify-center hover:bg-white/10 rounded-[5px] transition-colors",children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-[18px] h-[18px]",style:{marginTop:"10px"}})}),"home"===Il&&J.jsxs("div",{className:"h-[238px] relative",style:{background:ao},children:[J.jsx("div",{className:"absolute top-[21px] left-[20px]",children:J.jsx("div",{className:"w-[40px] h-[40px] bg-white rounded-[10px] flex items-center justify-center overflow-hidden",children:"custom"===zi&&qi?J.jsx("img",{src:qi,alt:"Logo",className:"w-full h-full object-contain"}):J.jsx("img",{src:"/Group 1234.svg",alt:"Logo",className:"w-full h-full object-contain"})})}),J.jsxs("div",{className:"absolute top-[80px] left-[20px] text-white",children:[J.jsx("h2",{className:"text-[22px] font-medium leading-tight mb-2",children:Po||"Здравствуйте! 👋 Чем мы можем помочь?"}),J.jsx("p",{className:"text-[14px] opacity-60",children:Ko||"Выберите вопрос или задайте в чате свой"})]}),J.jsx("div",{className:"absolute bottom-[-34px] left-[20px] z-50",children:J.jsxs("button",{onClick:()=>{console.log('Кнопка "Отправить сообщение" нажата'),Ml("chat")},className:"w-[332px] h-[69px] rounded-[12px] border flex items-center justify-start px-4 transition-colors cursor-pointer "+("dark"===no?"bg-[#212121] border-white/10 hover:bg-[#3A3A3A]":"bg-white border-[#070F1A]/10 hover:bg-gray-50"),children:[J.jsxs("div",{className:"flex-1 text-left",children:[J.jsx("h3",{className:"text-[14px] font-medium mb-1 "+("dark"===no?"text-white":"text-[#070F1A]"),children:Jo||"Отправить сообщение"}),J.jsx("p",{className:"text-[13px] font-normal "+("dark"===no?"text-white/70":"text-[#8E8E93]"),children:Xo||"Задавайте вопросы, мы всегда поможем"})]}),J.jsx("div",{className:"w-[20px] h-[20px]",style:{backgroundColor:lo,mask:"url(/send.svg) no-repeat center",maskSize:"contain",WebkitMask:"url(/send.svg) no-repeat center",WebkitMaskSize:"contain"}})]})})]}),J.jsxs("div",{className:"flex-1 relative "+("dark"===no?"bg-[#171717]":"bg-white"),children:["home"===Il&&J.jsx("div",{className:"p-5 pt-[50px]",children:J.jsx("div",{className:"w-[332px] rounded-[12px] border mt-0 overflow-hidden "+("dark"===no?"bg-[#171717] border-white/10":"bg-white border-[#070F1A]/10"),children:ec.filter(e=>e.enabled).slice(0,4).map((e,t)=>J.jsxs("div",{children:[J.jsxs("button",{onClick:()=>{Ml("chat")},className:"w-full h-[47px] flex items-center justify-between px-4 transition-colors "+("dark"===no?"hover:bg-white/5":"hover:bg-gray-50"),children:[J.jsx("span",{className:"text-[13px] font-normal "+("dark"===no?"text-white/70":"text-[#070F1A]"),children:e.text}),J.jsx("img",{src:"/Bounds 2.svg",alt:"Arrow",className:"w-3 h-3"})]}),t<ec.filter(e=>e.enabled).slice(0,4).length-1&&J.jsx("div",{className:"mx-[15px] border-b "+("dark"===no?"border-white/10":"border-[#070F1A]/10")})]},e.id))})}),"chat"===Il&&J.jsxs("div",{className:"flex flex-col h-full",children:[J.jsxs("div",{className:"h-[58px] border-b flex items-center px-4 relative "+("dark"===no?"border-white/10":"border-[#070F1A]/10"),children:[J.jsx("img",{src:"/Frame 195.svg",alt:"Назад",className:"w-3 h-3 cursor-pointer",onClick:()=>Ml("home")}),J.jsx("div",{className:"ml-[10px] w-[35px] h-[35px] rounded-[10px] overflow-hidden",children:"custom"===zi&&qi?J.jsx("img",{src:qi,alt:"Logo",className:"w-full h-full object-contain"}):J.jsx("img",{src:"/Group 1234.svg",alt:"Logo",className:"w-full h-full object-contain"})}),J.jsxs("div",{className:"ml-[10px] flex flex-col",children:[J.jsx("span",{className:"text-[16px] font-normal "+("dark"===no?"text-white":"text-[#070F1A]"),children:Vi}),tl&&J.jsx("span",{className:"text-[11px] "+("dark"===no?"text-white/50":"text-[#8E8E93]"),children:Zi})]}),"add"===Gi&&Yi.length>0&&J.jsx("div",{className:"ml-auto mr-[10px] flex gap-[10px]",children:Yi.slice(0,2).map((e,t)=>J.jsx("div",{className:"w-[35px] h-[35px] rounded-[90px] overflow-hidden",children:J.jsx("img",{src:e,alt:"Менеджер",className:"w-full h-full object-cover"})},t))}),J.jsx("button",{onClick:()=>Dl(!1),className:"absolute top-[15px] right-[15px] z-10 w-[18px] h-[18px] flex items-center justify-center hover:bg-white/10 rounded-[5px] transition-colors",children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-[18px] h-[18px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",marginTop:"10px"}})})]}),J.jsx("div",{className:"flex-1 p-4 overflow-y-auto relative widget-chat-container",style:{flexBasis:0},children:al.map((e,t)=>{const s=!e.isUser&&t===al.length-1;return J.jsx("div",{className:"mb-4 "+(e.isUser?"flex justify-end":"flex justify-start"),children:J.jsxs("div",{className:"max-w-[80%] "+(e.isUser?"order-2":"order-1"),children:[J.jsx("div",{className:"px-3 py-2 rounded-[16px] "+(e.isUser?"dark"===no?"text-[#171717]":"text-white":"dark"===no?"text-white/70":"text-[#070F1A]"),style:{backgroundColor:e.isUser?"dark"===no?"#FFFFFF":"#0084FF":"dark"===no?"#212121":"#EFEFEF"},children:J.jsx("p",{className:"text-sm",children:e.text})}),!e.isUser&&J.jsx("div",{className:"mt-[5px] ml-3",children:J.jsxs("p",{className:"text-[9px] text-[#8E8E93]",children:[Vi," • ",e.time]})}),s&&Ol&&J.jsx("div",{className:"mt-3 ml-3 space-y-2",children:J.jsx("button",{onClick:()=>{Pl(!1),Rl(!1),Yc("Это помогло")},className:"h-[34px] px-[14px] rounded-[90px] text-[13px] font-[500] transition-all bg-transparent border border-[#070F1A]/10 text-[#8E8E93] hover:bg-[#F3F5F7]",children:Bo})}),s&&Ll&&"Нет"!==Uo&&J.jsx("div",{className:"mt-3 ml-3",children:J.jsx("button",{onClick:async()=>{Rl(!1),await Yc("Нужна помощь менеджера")},className:"h-[34px] px-[14px] rounded-[90px] text-[13px] font-[500] transition-all text-white",style:{backgroundColor:lo},children:Uo})})]})},e.id)})}),J.jsxs("div",{className:"p-4 flex-shrink-0",children:[$i&&J.jsx("div",{className:"mb-2 text-center overflow-hidden",children:J.jsx("span",{className:"text-[9px] font-medium animate-flash",children:"Нейросеть AdaptoGPT"})}),J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",value:Ar,onChange:e=>Tr(e.target.value),onKeyPress:e=>{"Enter"===e.key&&Gc()},placeholder:"Введите сообщение...",className:"w-full h-[40px] px-4 py-2 pr-[100px] rounded-[20px] border focus:outline-none focus:ring-0 text-[14px] "+("dark"===no?"border-white/10 text-white bg-transparent":"border-[#E5E7EB] text-[#070F1A]")}),J.jsxs("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[J.jsx("button",{className:"w-[22px] h-[32px] flex items-center justify-center transition-colors",title:"Добавить вложение",children:J.jsx("img",{src:"/paperclip.svg",alt:"Вложение",className:"w-[18px] h-[18px] text-[#8E8E93] hover:text-[#070F1A] transition-colors"})}),J.jsx("button",{onClick:Gc,className:"w-[32px] h-[32px] rounded-[90px] flex items-center justify-center cursor-pointer transition-colors",style:{backgroundColor:lo},title:"Отправить сообщение",children:J.jsx("img",{src:"/Frame 118.svg",alt:"Отправить",className:"w-[12px] h-[12px]",style:{filter:"brightness(0) saturate(100%) invert(100%)"}})})]})]})]})]})]}),"home"===Il&&J.jsxs("div",{className:"h-[70px] border-t flex items-center justify-center relative "+("dark"===no?"bg-[#171717] border-white/10":"bg-white border-gray-200"),children:[J.jsxs("div",{className:"flex items-center gap-20",children:[J.jsxs("button",{onClick:()=>Ml("home"),className:"flex flex-col items-center gap-1 text-[#8E8E93]",style:{color:"home"===Il?lo:"#8E8E93"},children:[J.jsx("div",{className:"w-[17px] h-[17px]",style:{backgroundColor:"home"===Il?lo:"#8E8E93",mask:"url(/house.svg) no-repeat center",maskSize:"contain",WebkitMask:"url(/house.svg) no-repeat center",WebkitMaskSize:"contain"}}),J.jsx("span",{className:"text-[14px] font-medium",children:"Главная"})]}),J.jsxs("button",{onClick:()=>Ml("chat"),className:"flex flex-col items-center gap-1 text-[#8E8E93]",style:{color:"chat"===Il?lo:"#8E8E93"},children:[J.jsx("img",{src:"/Frame 147.svg",alt:"Chat",className:"w-[17px] h-[17px]",style:{filter:"chat"===Il?`brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(1456%) hue-rotate(${gc(lo)}deg) brightness(101%) contrast(101%)`:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}}),J.jsx("span",{className:"text-[14px] font-medium",children:"Чат"})]})]}),"home"===Il&&J.jsx("div",{className:"absolute top-[-29px] left-1/2 transform -translate-x-1/2",children:J.jsx("span",{className:"text-[9px] font-medium animate-flash",children:"Виджет на сайт Adapto"})})]}),wl&&J.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-end justify-center p-[10px] z-50",onClick:()=>{kl({}),Al(!1),jl(!1)},children:J.jsxs("div",{className:"w-[351px] rounded-[15px] p-4 flex flex-col "+("dark"===no?"bg-[#212121]":"bg-white"),style:{minHeight:"212px",maxHeight:"400px",height:"auto",alignSelf:"flex-end"},onClick:e=>e.stopPropagation(),children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h3",{className:"text-[16px] font-medium "+("dark"===no?"text-white":"text-[#070F1A]"),children:fl}),J.jsx("button",{onClick:()=>{kl({}),Al(!1),jl(!1)},className:"w-[24px] h-[24px] flex items-center justify-center hover:bg-gray-100 rounded-[90px] transition-colors",children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-[14px] h-[14px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),J.jsx("div",{className:"space-y-[10px] overflow-y-auto max-h-[200px]",children:ul.map(e=>{const t=xl.find(t=>t.type===e);return t?J.jsx("div",{children:J.jsx("input",{type:"email"===t.type?"email":"phone"===t.type?"tel":"text",placeholder:t.placeholder,value:Nl[e]||"",onChange:t=>kl({...Nl,[e]:t.target.value}),className:"w-[319px] h-[34px] px-3 border rounded-[10px] text-[14px] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 "+("dark"===no?"border-white/10 text-white bg-transparent":"border-[#070F1A]/10 text-[#070F1A]")})},t.id):null})}),J.jsx("div",{className:"mt-[10px] mb-4",children:J.jsxs("div",{className:"flex items-start gap-2",children:[J.jsx("input",{type:"checkbox",id:"policy-checkbox",checked:Sl,onChange:e=>Al(e.target.checked),className:"mt-0.5 w-4 h-4 text-[#0084FF] bg-gray-100 border-gray-300 rounded focus:ring-[#0084FF] focus:ring-2"}),J.jsxs("label",{htmlFor:"policy-checkbox",className:"text-[12px] cursor-pointer "+("dark"===no?"text-white":"text-[#070F1A]"),children:['Нажимая на кнопку "Отправить" вы соглашаетесь с'," ",J.jsx("span",{className:"underline",style:{color:lo},children:"политикой обработки данных"})]})]})}),J.jsx("button",{onClick:async()=>{if(El)return;if(ul.filter(e=>{const t=xl.find(t=>t.type===e);return null==t?void 0:t.required}).every(e=>{var t;return null==(t=Nl[e])?void 0:t.trim()})&&Sl){Cl(!0);try{const s={timestamp:(new Date).toISOString(),formData:Nl,formFields:ul.map(e=>{const t=xl.find(t=>t.type===e);return{id:null==t?void 0:t.id,type:e,label:null==t?void 0:t.label,value:Nl[e]}})};try{Nl.name||Nl.fullname,Nl.email,Nl.phone,Nl.comment||Nl.message}catch(e){console.error("CRM save error:",e)}kl({}),Al(!1),jl(!1);try{const e={id:_n(),text:"Отлично, ваши данные успешно отправлены. Менеджер свяжется с вами в ближайшее время.",isUser:!1,time:"Только что",timestamp:_n()};il(t=>[...t,e]),await Am.saveMessage(r.id,"assistant",e.text,"widget")}catch(t){}console.log("Форма успешно отправлена:",s)}catch(s){console.error("Ошибка при отправке формы:",s)}finally{Cl(!1)}}},disabled:El,className:"w-full h-[40px] rounded-[10px] text-white font-medium text-[14px] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:lo},children:El?"Отправка...":"Отправить"})]})})]})}),$l&&Zl&&to.length>0&&!Tl&&J.jsxs("div",{className:"absolute transition-all duration-300",style:{bottom:`${(Mc.desktopBottomOffset||20)+62}px`,right:`${(Mc.desktopRightOffset||20)+40}px`,zIndex:(Mc.zIndex||9999)+1},children:[J.jsxs("div",{className:"rounded-[12px] shadow-lg border p-4 max-w-[300px] relative "+("dark"===no?"bg-[#171717] border-white/10":"bg-white border-gray-200"),children:[J.jsx("button",{onClick:()=>Bl(!1),className:"absolute top-2 right-2 w-4 h-4 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:J.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:J.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),J.jsx("p",{className:"text-[12px] mb-0 pr-6 "+("dark"===no?"text-white":"text-[#070F1A]"),children:to[0].message||"Продолжим диалог?"})]}),J.jsx("div",{className:"mt-[10px] flex justify-end",children:J.jsx("button",{onClick:()=>{Bl(!1),Jc(),Tr(to[0].message||"Продолжим диалог?"),setTimeout(()=>{Gc()},100)},className:"h-[34px] px-[14px] rounded-[90px] text-[12px] font-[400] transition-all text-white",style:{backgroundColor:lo},children:to[0].buttonText||"Продолжить"})})]}),zl&&Gl&&Yl.length>0&&!Tl&&J.jsx("div",{className:"absolute transition-all duration-300",style:{bottom:`${(Mc.desktopBottomOffset||20)+62}px`,right:`${(Mc.desktopRightOffset||20)+40}px`,zIndex:(Mc.zIndex||9999)+1},children:J.jsxs("div",{className:"relative max-w-[300px]",children:[J.jsx("button",{onClick:()=>Ul(!1),className:"absolute -top-3 right-2 w-4 h-4 flex items-center justify-center rounded-full bg-black/10 hover:bg-black/20 transition-colors z-10",style:{color:"#8E8E93"},children:J.jsx("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",children:J.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),J.jsx("div",{className:"h-10 px-[13px] flex items-center rounded-[10px_10px_0px_10px] w-fit max-w-[300px] mr-[23px] "+("dark"===no?"bg-[#171717]":"bg-white"),children:J.jsx("p",{className:"text-[14px] font-[500] mb-0 w-fit "+("dark"===no?"text-white":"text-[#070F1A]"),style:{letterSpacing:"-0.02em"},children:Yl[0].message||"У нас есть отличная акция"})}),J.jsx("div",{className:"pt-2 px-[13px] pb-[13px] flex justify-end mr-[23px]",children:J.jsx("button",{onClick:()=>{Ul(!1),Jc(),Tr(Yl[0].buttonText||"Расскажи подробнее"),setTimeout(()=>{Gc()},100)},className:"h-[34px] px-4 rounded-[90px] text-[12px] font-[500] transition-all text-white",style:{backgroundColor:lo,letterSpacing:"-0.02em"},children:Yl[0].buttonText||"Узнать больше"})})]})})]})})]}),rc&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:J.jsxs("div",{className:"rounded-[20px] p-6 max-w-md w-full mx-4 "+("dark"===me?"bg-[#070F1A]":"bg-white"),children:[J.jsx("h3",{className:"text-[18px] font-[500] mb-2 "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Вы уверены, что хотите удалить вопрос?"}),J.jsx("p",{className:"text-[14px] mb-6 "+("dark"===me?"text-white/70":"text-[#8E8E93]"),children:"После удаления его невозможно восстановить."}),J.jsxs("div",{className:"flex gap-3 justify-end",children:[J.jsx("button",{onClick:()=>{ac(!1),lc(null)},className:"px-4 py-2 text-[14px] font-[500] transition-colors "+("dark"===me?"text-white/70 hover:text-white":"text-[#8E8E93] hover:text-[#070F1A]"),children:"Отмена"}),J.jsx("button",{onClick:()=>{return e=ic,tc(t=>t.filter(t=>t.id!==e)),ac(!1),void lc(null);var e},className:"px-4 py-2 bg-[#FF0D0D] text-white text-[14px] font-[500] rounded-[10px] hover:bg-[#E00D0D] transition-colors",children:"Удалить"})]})]})})]});case"available-dialogs":const o=bc.filter(e=>("active"===e.status||"waiting"===e.status)&&(e.canTakeover||e.need_handover));return J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("h1",{className:"text-[20px] font-[500]",children:"Доступные диалоги"}),o.length>0&&J.jsx("div",{className:"bg-[#FF3B30] text-white text-[12px] font-[500] px-2 py-1 rounded-full",children:o.length})]}),0===o.length?J.jsx("div",{className:"bg-white rounded-[15px] p-8 border border-gray-200",children:J.jsxs("div",{className:"text-center",children:[J.jsx("svg",{className:"w-8 h-8 mx-auto mb-4",fill:"#0084FF",viewBox:"0 0 24 24",children:J.jsx("path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"})}),J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] mb-2",children:"Нет доступных диалогов"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] max-w-md mx-auto",children:"В этом разделе будут отображаться диалоги, в которых ИИ-агент запросил помощь оператора. Как только такие диалоги появятся, вы сможете их взять в работу."})]})}):J.jsx("div",{className:"space-y-4",children:o.map(e=>{var t;return J.jsx("div",{className:"bg-white rounded-[15px] p-6 border border-gray-200",children:J.jsxs("div",{className:"flex items-start justify-between",children:[J.jsxs("div",{className:"flex-1",children:[J.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A]",children:e.title}),e.need_handover&&J.jsx("div",{className:"bg-[#FF3B30] text-white text-[10px] font-[500] px-2 py-1 rounded-full",children:"Ждёт оператора"}),J.jsx("div",{className:"text-[10px] font-[500] px-2 py-1 rounded-full "+("active"===e.status?"bg-[#36C76A]/10 text-[#36C76A]":"bg-[#FF9500]/10 text-[#FF9500]"),children:"active"===e.status?"Активный":"Ожидает"})]}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-4",children:e.lastMessage}),J.jsxs("div",{className:"flex items-center gap-4 text-[12px] text-[#8E8E93]",children:[J.jsxs("span",{children:["Создан: ",new Date(e.createdAt).toLocaleString("ru-RU")]}),(null==(t=e.client)?void 0:t.name)&&J.jsxs("span",{children:["Клиент: ",e.client.name]})]})]}),e.assignedTo&&e.assignedTo!==(null==r?void 0:r.id)?J.jsx("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 h-[34px] rounded-[10px] cursor-not-allowed",children:"Занят оператором"}):e.assignedTo===(null==r?void 0:r.id)?J.jsx("button",{disabled:!0,className:"bg-[#0084FF] text-white px-4 h-[34px] rounded-[10px] cursor-default",children:"Ваш диалог"}):J.jsx("button",{onClick:()=>er(e.id),className:"bg-[#0084FF] text-white px-4 h-[34px] rounded-[10px] hover:bg-[#0070E6] transition-colors",style:jm.blueButton,children:"Взять диалог"})]})},e.id)})})]});case"operator-statistics":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500]",children:"Моя статистика"})}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",style:{paddingTop:"12px"},children:[J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"13px"},children:[J.jsx("div",{className:"flex items-center gap-2",style:{height:"21px"},children:J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Мои диалоги"})}),J.jsx("div",{className:"flex items-end",children:J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:bc.filter(e=>e.assignedTo===((null==r?void 0:r.id)||"current_operator")).length})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"13px"},children:[J.jsx("div",{className:"flex items-center gap-2",style:{height:"21px"},children:J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Решенные сегодня"})}),J.jsx("div",{className:"flex items-end",children:J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:bc.filter(e=>"closed"===e.status&&e.assignedTo===((null==r?void 0:r.id)||"current_operator")).length})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"13px"},children:[J.jsx("div",{className:"flex items-center gap-2",style:{height:"21px"},children:J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Среднее время"})}),J.jsx("div",{className:"flex items-end",children:J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:"0 мин"})})]})}),J.jsx(ug,{className:"shadow-none",children:J.jsxs(xg,{className:"p-[15px] h-[130px] flex flex-col justify-between",style:{paddingTop:"13px"},children:[J.jsx("div",{className:"flex items-center gap-2",style:{height:"21px"},children:J.jsx("p",{className:"text-[14px] font-[500] text-[#8E8E93]",children:"Рейтинг"})}),J.jsx("div",{className:"flex items-end",children:J.jsx("p",{className:"text-[1.8rem] font-[500] text-[#070F1A]",style:{height:"33px"},children:"4.8"})})]})})]})]});case"team":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Команда"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px",marginTop:"16px"}}),J.jsx("div",{children:J.jsx("div",{className:"flex items-center gap-3",children:J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[14px] font-medium text-[#070F1A] mb-3",children:"Добавить участника"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("input",{type:"email",placeholder:"Введите email участника",value:bt,onChange:e=>vt(e.target.value),className:"flex-1 h-[34px] px-3 bg-white rounded-[10px] focus:outline-none",style:Nm.inputField}),J.jsx("button",{className:"h-[34px] px-4 rounded-[10px] transition-colors "+(""===bt.trim()?"cursor-not-allowed":"hover:bg-[#0073E6] cursor-pointer"),style:""===bt.trim()?jm.disabledButton:{...jm.blueButton,backgroundColor:"#0084FF",color:"white"},disabled:""===bt.trim(),onClick:()=>{""!==bt.trim()&&(async e=>{try{const t=iu.randomBytes(32).toString("hex"),s={email:e,projectId:null==r?void 0:r.id,invitedBy:null==r?void 0:r.id,role:"operator",inviteToken:t,inviteExpiresAt:new Date(Date.now()+6048e5)};console.log("Отправка приглашения:",s),window.location.origin,null==r||r.id,C(`Приглашение отправлено на ${e}`),_(!0),vt(""),setTimeout(()=>{_(!1)},3e3)}catch(t){console.error("Ошибка отправки приглашения:",t),C("Ошибка при отправке приглашения"),_(!0),setTimeout(()=>{_(!1)},3e3)}})(bt.trim())},children:"Пригласить"})]})]})})}),J.jsxs("div",{className:"overflow-hidden -mx-6",children:[J.jsxs("div",{className:"grid grid-cols-3 gap-4 px-[26px] py-4 border-b border-[#070F1A]/10",children:[J.jsx("div",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Пользователь"}),J.jsx("div",{className:"text-[14px] font-[500] text-[#070F1A]"}),J.jsx("div",{className:"text-[14px] font-[500] text-[#070F1A] text-right",children:"Роль"})]}),J.jsx("div",{className:"divide-y divide-[#070F1A]/10",children:J.jsxs("div",{className:"grid grid-cols-3 gap-4 px-[26px] py-4 transition-colors",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-[24px] h-[24px] bg-[#0084FF] rounded-[90px] flex items-center justify-center flex-shrink-0",children:J.jsx("span",{className:"text-white font-semibold text-xs",children:Nr(null==r?void 0:r.name).letter})}),J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:(null==r?void 0:r.name)||"Администратор"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:(null==r?void 0:r.email)||"admin@example.com"})]})]}),J.jsx("div",{}),J.jsx("div",{className:"flex items-center justify-end",children:J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("div",{className:"w-[16px] h-[16px] bg-[#0084FF] rounded-[90px] flex items-center justify-center",children:J.jsx("div",{className:"w-[10px] h-[10px]",style:{maskImage:"url(/profile-circle.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",backgroundColor:"white"}})}),J.jsx("span",{className:"text-[12px] font-[500] text-[#070F1A]",children:"Админ"})]}),J.jsx("div",{className:"relative",children:J.jsx("button",{className:"w-[14px] h-[14px] text-[#8E8E93] hover:text-[#070F1A] transition-colors opacity-50 cursor-not-allowed",disabled:!0,children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",children:J.jsx("path",{d:"M 1.5 5.5 C 2.328 5.5 3 6.172 3 7 C 3 7.828 2.328 8.5 1.5 8.5 C 0.672 8.5 0 7.828 0 7 C 0 6.172 0.672 5.5 1.5 5.5 Z M 12.5 5.5 C 13.328 5.5 14 6.172 14 7 C 14 7.828 13.328 8.5 12.5 8.5 C 11.672 8.5 11 7.828 11 7 C 11 6.172 11.672 5.5 12.5 5.5 Z M 7 5.5 C 7.828 5.5 8.5 6.172 8.5 7 C 8.5 7.828 7.828 8.5 7 8.5 C 6.172 8.5 5.5 7.828 5.5 7 C 5.5 6.172 6.172 5.5 7 5.5 Z",fill:"currentColor"})})})})]})})]})})]})]});case"operator-stats":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Статистика оператора"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-4",style:{marginLeft:"-32px",marginRight:"-32px",marginTop:"16px"}}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[J.jsxs("div",{className:"bg-white rounded-[16px] p-6 border border-[#E5E7EB]",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Обработано диалогов"}),J.jsx("div",{className:"w-8 h-8 bg-[#0084FF]/10 rounded-[8px] flex items-center justify-center",children:J.jsx("img",{src:"/chat.svg",alt:"Диалоги",className:"w-4 h-4"})})]}),J.jsx("div",{className:"text-[24px] font-[600] text-[#070F1A] mb-1",children:"24"}),J.jsx("div",{className:"text-[12px] text-[#8E8E93]",children:"+3 за сегодня"})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 border border-[#E5E7EB]",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Завершено диалогов"}),J.jsx("div",{className:"w-8 h-8 bg-[#36C76A]/10 rounded-[8px] flex items-center justify-center",children:J.jsx("img",{src:"/check.svg",alt:"Завершено",className:"w-4 h-4"})})]}),J.jsx("div",{className:"text-[24px] font-[600] text-[#070F1A] mb-1",children:"18"}),J.jsx("div",{className:"text-[12px] text-[#8E8E93]",children:"75% успешность"})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 border border-[#E5E7EB]",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Среднее время ответа"}),J.jsx("div",{className:"w-8 h-8 bg-[#FF9500]/10 rounded-[8px] flex items-center justify-center",children:J.jsx("img",{src:"/clock.svg",alt:"Время",className:"w-4 h-4"})})]}),J.jsx("div",{className:"text-[24px] font-[600] text-[#070F1A] mb-1",children:"2:34"}),J.jsx("div",{className:"text-[12px] text-[#8E8E93]",children:"минуты"})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 border border-[#E5E7EB]",children:[J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Удовлетворенность"}),J.jsx("div",{className:"w-8 h-8 bg-[#A684FF]/10 rounded-[8px] flex items-center justify-center",children:J.jsx("img",{src:"/star.svg",alt:"Оценка",className:"w-4 h-4"})})]}),J.jsx("div",{className:"text-[24px] font-[600] text-[#070F1A] mb-1",children:"4.8"}),J.jsx("div",{className:"text-[12px] text-[#8E8E93]",children:"из 5.0"})]})]}),J.jsxs("div",{className:"bg-white rounded-[16px] p-6 border border-[#E5E7EB]",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-4",children:"Активность по дням"}),J.jsx("div",{className:"h-64 flex items-end justify-between gap-2",children:[12,8,15,22,18,25,20].map((e,t)=>J.jsxs("div",{className:"flex flex-col items-center gap-2",children:[J.jsx("div",{className:"w-8 bg-[#0084FF] rounded-t-[4px]",style:{height:e/25*200+"px"}}),J.jsx("span",{className:"text-[10px] text-[#8E8E93]",children:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"][t]})]},t))})]})]});case"crm":return J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"flex justify-between items-center mb-[16px]",children:[J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"CRM"}),J.jsxs("div",{className:"flex gap-3",children:[J.jsxs("button",{onClick:()=>Dt(!0),className:"h-[34px] bg-[#0084FF] text-white rounded-[10px] px-4 flex items-center gap-2 hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:[J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M12 5V19M5 12H19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Создать сделку"]}),J.jsxs("div",{className:"relative group",children:[J.jsxs("button",{className:"h-[34px] bg-white border border-[#E5E7EB] text-[#070F1A] font-[500] rounded-[10px] text-[13px] px-4 flex items-center gap-2 hover:bg-gray-50 transition-colors",children:[J.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[J.jsx("path",{d:"M12 15.75L8.25 12L9.66 10.59L11.25 12.18V3H12.75V12.18L14.34 10.59L15.75 12L12 15.75Z",fill:"currentColor"}),J.jsx("path",{d:"M20.25 15.75V18.75C20.25 19.1642 19.9142 19.5 19.5 19.5H4.5C4.08579 19.5 3.75 19.1642 3.75 18.75V15.75H2.25V18.75C2.25 19.9926 3.25736 21 4.5 21H19.5C20.7426 21 21.75 19.9926 21.75 18.75V15.75H20.25Z",fill:"currentColor"})]}),"Скачать"]}),J.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-[10px] shadow-lg py-1 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200",children:[J.jsx("button",{onClick:Qc,className:"w-full px-4 py-2 text-[12px] text-[#070F1A] hover:bg-gray-50 text-left",children:"Скачать в Excel"}),J.jsx("button",{onClick:Hc,className:"w-full px-4 py-2 text-[12px] text-[#070F1A] hover:bg-gray-50 text-left",children:"Скачать CSV"})]})]})]})]}),J.jsx("div",{className:"border-b border-gray-200 mb-0",style:{borderColor:"#E5E6E7",marginTop:"16px",marginLeft:"-32px",marginRight:"-32px"}}),J.jsxs("div",{className:"flex items-center gap-0 bg-[#F2F3F4] rounded-[10px] w-full max-w-[400px]",style:{height:"40px",padding:"3px"},children:[J.jsx("button",{className:"flex-1 px-5 rounded-[9px] text-[13px] font-medium transition-colors "+("deals"===Xe?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),style:{height:"34px"},onClick:()=>Ze("deals"),children:"Сделки"}),J.jsx("button",{className:"flex-1 px-5 rounded-[9px] text-[13px] font-medium transition-colors "+("tasks"===Xe?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),style:{height:"34px"},onClick:()=>Ze("tasks"),children:"Задачи"}),J.jsx("button",{className:"flex-1 px-5 rounded-[9px] text-[13px] font-medium transition-colors "+("clients"===Xe?"bg-white text-[#0084FF]":"text-[#8E8E93] hover:text-[#0084FF]"),style:{height:"34px"},onClick:()=>Ze("clients"),children:"Клиенты"})]}),J.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-[10px]",children:[J.jsx("div",{className:"flex gap-[10px] flex-wrap order-1",children:"tasks"!==Xe&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{className:"relative crm-dropdown",children:[J.jsxs("button",{onClick:()=>Ms("leadQuality"),className:"h-[34px] pl-3 pr-3 bg-white rounded-[10px] text-[13px] flex items-center gap-[8px] hover:bg-white transition-colors group",children:[J.jsx("span",{className:"text-[#8E8E93] group-hover:text-[#070F1A] transition-colors",children:"Лиды"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-2 h-2 transition-transform duration-300",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",transform:As.leadQuality?"rotate(-90deg)":"rotate(90deg)"}})]}),As.leadQuality&&J.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-[12px] shadow-lg z-50 min-w-[160px]",children:J.jsx("div",{className:"p-[2px]",children:J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Wt([]),Ts(e=>({...e,leadQuality:!1}))},children:[0===qt.length&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded-[4px]"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Все лиды"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Wt(e=>e.includes("hot")?e.filter(e=>"hot"!==e):[...e,"hot"])},children:[qt.includes("hot")&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 rounded-[4px]",style:{backgroundColor:"#FE6A51"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Горячие"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Wt(e=>e.includes("warm")?e.filter(e=>"warm"!==e):[...e,"warm"])},children:[qt.includes("warm")&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 rounded-[4px]",style:{backgroundColor:"#FFC340"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Теплые"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Wt(e=>e.includes("cold")?e.filter(e=>"cold"!==e):[...e,"cold"])},children:[qt.includes("cold")&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 rounded-[4px]",style:{backgroundColor:"#0099FF"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Холодные"})]})]})})})]}),J.jsxs("div",{className:"relative crm-dropdown",children:[J.jsxs("button",{onClick:()=>Ms("contact"),className:"h-[34px] pl-3 pr-3 bg-white rounded-[10px] text-[13px] flex items-center gap-[8px] hover:bg-white transition-colors group",children:[J.jsx("span",{className:"text-[#8E8E93] group-hover:text-[#070F1A] transition-colors",children:"Контакты"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-2 h-2 transition-transform duration-300",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",transform:As.contact?"rotate(-90deg)":"rotate(90deg)"}})]}),As.contact&&J.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-[12px] shadow-lg z-50 min-w-[160px]",children:J.jsx("div",{className:"p-[2px]",children:J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Qt("all"),Ts(e=>({...e,contact:!1}))},children:["all"===Ht&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded-[4px]"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Все контакты"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Qt("with_contacts"),Ts(e=>({...e,contact:!1}))},children:["with_contacts"===Ht&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("img",{src:"/Icon phone.svg",alt:"Телефон",className:"w-[13px] h-[13px]",style:ym}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Есть контакты"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Qt("without_contacts"),Ts(e=>({...e,contact:!1}))},children:["without_contacts"===Ht&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("img",{src:"/Icon nophone.svg",alt:"Нет телефона",className:"w-[13px] h-[13px]"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Нет контактов"})]})]})})})]}),J.jsxs("div",{className:"relative crm-dropdown",children:[J.jsxs("button",{onClick:()=>Ms("owner"),className:"h-[34px] pl-3 pr-3 bg-white rounded-[10px] text-[13px] flex items-center gap-[8px] hover:bg-white transition-colors group",children:[J.jsx("span",{className:"text-[#8E8E93] group-hover:text-[#070F1A] transition-colors",children:"Исполнители"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-2 h-2 transition-transform duration-300",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",transform:As.owner?"rotate(-90deg)":"rotate(90deg)"}})]}),As.owner&&J.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-[12px] shadow-lg z-50 min-w-[180px]",children:J.jsx("div",{className:"p-[2px]",children:J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Kt([]),Ts(e=>({...e,owner:!1}))},children:[0===Vt.length&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded-[4px]"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Все исполнители"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Kt(e=>e.includes("ai")?e.filter(e=>"ai"!==e):[...e,"ai"])},children:[Vt.includes("ai")&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("img",{src:"/aiii.svg",alt:"ИИ",className:"w-[13px] h-[13px] align-middle"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"ИИ-агент"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Kt(e=>e.includes("operator-1")?e.filter(e=>"operator-1"!==e):[...e,"operator-1"])},children:[Vt.includes("operator-1")&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[13px] h-[13px]",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Анна Петрова"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Kt(e=>e.includes("operator-2")?e.filter(e=>"operator-2"!==e):[...e,"operator-2"])},children:[J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[13px] h-[13px]",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Михаил Иванов"})]})]})})})]})]})}),"tasks"!==Xe&&J.jsxs("div",{className:"flex flex-wrap gap-2 mt-[10px] order-3 w-full",children:[qt.map(e=>J.jsxs("div",{className:"flex items-center gap-2 bg-[#F2F3F4] rounded-[10px] px-2 py-2 h-[32px]",children:[J.jsx("div",{className:"w-[13px] h-[13px] rounded-[4px]",style:{backgroundColor:"hot"===e?"#FE6A51":"warm"===e?"#FFC340":"#0099FF"}}),J.jsx("p",{className:"text-[13px] text-[#070F1A]",children:"hot"===e?"Горячие":"warm"===e?"Теплые":"Холодные"}),J.jsx("button",{onClick:()=>Wt(t=>t.filter(t=>t!==e)),className:"w-4 h-4 flex items-center justify-center transition-colors",children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",children:J.jsx("path",{d:"M 9.828 3.111 C 10.121 2.818 10.596 2.818 10.889 3.111 C 11.182 3.404 11.182 3.879 10.889 4.172 L 8.061 7 L 10.889 9.828 C 11.182 10.121 11.182 10.596 10.889 10.889 C 10.596 11.182 10.121 11.182 9.828 10.889 L 7 8.061 L 4.172 10.889 C 3.879 11.182 3.404 11.182 3.111 10.889 C 2.818 10.596 2.818 10.121 3.111 9.828 L 5.939 7 L 3.111 4.172 C 2.818 3.879 2.818 3.404 3.111 3.111 C 3.404 2.818 3.879 2.818 4.172 3.111 L 7 5.939 Z",fill:"#8E8E93",className:"hover:fill-[#070F1A] transition-colors"})})})]},e)),"all"!==Ht&&J.jsxs("div",{className:"flex items-center gap-2 bg-[#F2F3F4] rounded-[10px] px-2 py-2 h-[32px]",children:["with_contacts"===Ht?J.jsx("img",{src:"/Icon phone.svg",alt:"Телефон",className:"w-[13px] h-[13px]",style:ym}):J.jsx("img",{src:"/Icon nophone.svg",alt:"Нет телефона",className:"w-[13px] h-[13px]",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}}),J.jsx("p",{className:"text-[13px] text-[#070F1A]",children:"with_contacts"===Ht?"Есть контакты":"Нет контактов"}),J.jsx("button",{onClick:()=>Qt("all"),className:"w-4 h-4 flex items-center justify-center transition-colors",children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",children:J.jsx("path",{d:"M 9.828 3.111 C 10.121 2.818 10.596 2.818 10.889 3.111 C 11.182 3.404 11.182 3.879 10.889 4.172 L 8.061 7 L 10.889 9.828 C 11.182 10.121 11.182 10.596 10.889 10.889 C 10.596 11.182 10.121 11.182 9.828 10.889 L 7 8.061 L 4.172 10.889 C 3.879 11.182 3.404 11.182 3.111 10.889 C 2.818 10.596 2.818 10.121 3.111 9.828 L 5.939 7 L 3.111 4.172 C 2.818 3.879 2.818 3.404 3.111 3.111 C 3.404 2.818 3.879 2.818 4.172 3.111 L 7 5.939 Z",fill:"#8E8E93",className:"hover:fill-[#070F1A] transition-colors"})})})]}),Vt.map(e=>J.jsxs("div",{className:"flex items-center gap-2 bg-[#F2F3F4] rounded-[10px] px-2 py-2 h-[32px]",children:["ai"===e?J.jsx("img",{src:"/aiii.svg",alt:"ИИ",className:"w-[13px] h-[13px]"}):J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[13px] h-[13px]",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("p",{className:"text-[13px] text-[#070F1A]",children:"ai"===e?"ИИ-агент":"operator-1"===e?"Анна Петрова":"operator-2"===e?"Михаил Иванов":"Исполнитель"}),J.jsx("button",{onClick:()=>Kt(t=>t.filter(t=>t!==e)),className:"w-4 h-4 flex items-center justify-center transition-colors",children:J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",children:J.jsx("path",{d:"M 9.828 3.111 C 10.121 2.818 10.596 2.818 10.889 3.111 C 11.182 3.404 11.182 3.879 10.889 4.172 L 8.061 7 L 10.889 9.828 C 11.182 10.121 11.182 10.596 10.889 10.889 C 10.596 11.182 10.121 11.182 9.828 10.889 L 7 8.061 L 4.172 10.889 C 3.879 11.182 3.404 11.182 3.111 10.889 C 2.818 10.596 2.818 10.121 3.111 9.828 L 5.939 7 L 3.111 4.172 C 2.818 3.879 2.818 3.404 3.111 3.111 C 3.404 2.818 3.879 2.818 4.172 3.111 L 7 5.939 Z",fill:"#8E8E93",className:"hover:fill-[#070F1A] transition-colors"})})})]},e))]}),J.jsxs("div",{className:"flex gap-[10px] items-center order-2 ml-auto",children:[J.jsxs("div",{className:"relative crm-dropdown",children:[J.jsxs("button",{onClick:()=>Ms("sortOrder"),className:"h-[34px] px-3 bg-white rounded-[10px] text-[13px] flex items-center gap-[8px] hover:bg-[#F2F3F4] transition-colors group",onMouseEnter:e=>{const t=e.currentTarget.querySelector("img");t&&(t.style.filter="brightness(0) saturate(100%)",t.style.opacity="1")},onMouseLeave:e=>{const t=e.currentTarget.querySelector("img");t&&(t.style.filter="brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",t.style.opacity="0.8")},children:[J.jsx("img",{src:"/Frame 2089.svg",alt:"Сортировать",className:"w-4 h-4 transition-colors",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)",opacity:.8}}),J.jsx("span",{className:"text-[#8E8E93] group-hover:text-[#070F1A] transition-colors",children:"Сортировать"})]}),As.sortOrder&&J.jsx("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-[12px] shadow-lg z-50 min-w-[160px]",children:J.jsx("div",{className:"p-[2px]",children:J.jsxs("div",{className:"space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{nt("newest"),Ts(e=>({...e,sortOrder:!1}))},children:[J.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded-[4px] flex items-center justify-center",children:"newest"===st&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})})}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Сначала новые"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{nt("oldest"),Ts(e=>({...e,sortOrder:!1}))},children:[J.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded-[4px] flex items-center justify-center",children:"oldest"===st&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})})}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Сначала старые"})]})]})})})]}),J.jsxs("div",{className:"flex bg-[#F2F3F4] rounded-[10px] p-[2px]",style:{height:"34px"},children:[J.jsx("button",{className:"px-2 py-[2px] rounded-[8px] transition-colors "+("kanban"===et?"bg-white":"text-[#8E8E93] hover:text-[#070F1A]"),style:{height:"30px"},onClick:()=>tt("kanban"),children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M3 6H21V8H3V6ZM3 11H21V13H3V11ZM3 16H21V18H3V16Z",fill:"currentColor"})})}),J.jsx("button",{className:"px-2 py-[2px] rounded-[8px] transition-colors "+("list"===et?"bg-white":"text-[#8E8E93] hover:text-[#070F1A]"),style:{height:"30px"},onClick:()=>tt("list"),children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M8 6H21V8H8V6ZM8 11H21V13H8V11ZM8 16H21V18H8V16ZM3 6H5V8H3V6ZM3 11H5V13H3V11ZM3 16H5V18H3V16Z",fill:"currentColor"})})})]})]})]}),"deals"===Xe&&J.jsx("div",{className:"space-y-4",children:"kanban"===et?J.jsx("div",{className:"grid grid-cols-4 gap-4",children:["Новые","В работе","Согласование","Закрытые"].map((e,t)=>J.jsxs("div",{className:"bg-[#F2F3F4] rounded-[15px] p-[5px] transition-colors "+(zt===e?"bg-[#E3F2FD] border-2 border-[#0084FF]":""),onDragOver:t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",Ut(e)},onDragLeave:()=>{Ut(null)},onDrop:t=>{var s,n;t.preventDefault(),$t&&$t.stage!==e&&(s=$t.id,n=e,tn(e=>e.map(e=>e.id===s?{...e,stage:n}:e)),console.log(`Перемещение сделки ${$t.title} в ${e}`)),Bt(null),Ut(null)},children:[J.jsxs("div",{className:"flex items-center justify-between mb-4 mx-4",style:{paddingTop:"9px",marginLeft:"10px",marginRight:"10px"},children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:e}),J.jsx("span",{className:"text-[12px] text-[#8E8E93] bg-white px-2 py-1 rounded-[6px]",children:Zs().filter(t=>t.stage===e).length})]}),J.jsx("div",{className:"space-y-3",children:Zs().filter(t=>t.stage===e).map(e=>J.jsxs("div",{className:"bg-white rounded-[15px] p-3 border border-[#E5E7EB] cursor-pointer hover:shadow-md transition-all "+((null==$t?void 0:$t.id)===e.id?"opacity-50 scale-95":""),draggable:!0,onDragStart:t=>{Bt(e),t.dataTransfer.effectAllowed="move"},onDragEnd:()=>{Bt(null),Ut(null)},onClick:()=>{at(e),lt(!0)},children:[J.jsxs("div",{className:"flex items-center justify-between mb-1",children:[J.jsx("h4",{className:"text-[13px] font-[500] text-[#070F1A]",children:e.client.phone||`Обращение #${e.id.slice(-4)}`}),J.jsx("span",{className:"text-[10px] px-2 py-1 rounded-[90px] "+("hot"===e.leadQuality?"bg-red-100 text-red-600":"warm"===e.leadQuality?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"),children:"hot"===e.leadQuality?"Горячий":"warm"===e.leadQuality?"Теплый":"Холодный"})]}),J.jsx("p",{className:"text-[12px] text-[#8E8E93] mb-2",children:e.company}),J.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[J.jsxs("span",{className:"text-[10px] px-2 py-1 rounded-[15px] flex items-center gap-1 "+(e.hasContacts?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"),children:[e.hasContacts?J.jsx("img",{src:"/call-calling.svg",alt:"Телефон",className:"w-[10px] h-[10px]",style:ym}):J.jsxs("div",{className:"relative w-[10px] h-[10px]",children:[J.jsx("img",{src:"/call-calling.svg",alt:"Телефон",className:"w-[10px] h-[10px]",style:ym}),J.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-[1px] bg-gray-400 transform -translate-y-1/2"})]}),e.hasContacts?"Есть":"Нет"]}),J.jsxs("span",{className:"text-[10px] text-[#8E8E93] flex items-center gap-1",children:["ai"===e.owner?J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-[10px] h-[10px] align-middle"}):J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[10px] h-[10px] align-middle",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),e.ownerName]})]}),J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("span",{className:"text-[12px] text-[#0084FF] font-[500]",children:e.amount?`${e.amount.toLocaleString()}₽`:"Без суммы"}),J.jsxs("span",{className:"text-[11px] text-[#8E8E93]",children:[e.days,"д"]})]})]},e.id))})]},e))}):J.jsx("div",{className:"space-y-3",children:0===Zs().length?J.jsx("div",{className:"bg-white border border-[#E5E7EB] rounded-[15px] p-6 text-center text-[#8E8E93]",children:"Сделок пока нет"}):Zs().map(e=>{var t;return J.jsx("div",{className:"bg-white border border-[#E5E7EB] rounded-[15px] p-4 cursor-pointer hover:shadow-md transition-all",onClick:()=>{at(e),lt(!0)},children:J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-10 h-10 bg-[#0084FF]/10 rounded-[90px] flex items-center justify-center",children:J.jsxs("span",{className:"text-[#0084FF] font-[500] text-[14px]",children:["#",(null==(t=e.id)?void 0:t.toString().slice(-4))||""]})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:e.title||"Сделка"}),J.jsxs("p",{className:"text-[12px] text-[#8E8E93]",children:["Создана ",e.createdDate||""]})]})]}),J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsxs("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:[e.amount||0,"₽"]}),J.jsx("span",{className:"px-3 py-1 bg-[#36C76A]/10 text-[#36C76A] text-[12px] font-[500] rounded-[6px]",children:e.stage})]})]})},e.id)})})}),"tasks"===Xe&&J.jsx("div",{className:"space-y-4",children:"list"===et?J.jsx("div",{className:"space-y-3",children:bs.map(e=>J.jsx("div",{className:"bg-white border border-[#E5E7EB] rounded-[15px] p-4 cursor-pointer hover:shadow-md transition-all",onClick:()=>Bs(e),children:J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-3 h-3 rounded-[90px] "+("completed"===e.status?"bg-[#36C76A]":"bg-[#E5E7EB]")}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:e.title||`Задача #${e.id.slice(-4)}`}),J.jsxs("p",{className:"text-[12px] text-[#8E8E93]",children:["Исполнитель: ",e.assigneeName," • Создана ",new Date(e.createdDate).toLocaleDateString()]})]})]}),J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[6px] "+("high"===e.priority?"bg-red-100 text-red-600":"medium"===e.priority?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"),children:"high"===e.priority?"Высокий":"medium"===e.priority?"Средний":"Низкий"}),J.jsx("span",{className:"text-[11px] text-[#8E8E93]",children:e.dueDate?new Date(e.dueDate).toLocaleDateString():"Без дедлайна"})]})]})},e.id))}):J.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{key:"pending",label:"К выполнению",color:"bg-yellow-50 border-yellow-200"},{key:"in_progress",label:"В работе",color:"bg-blue-50 border-blue-200"},{key:"completed",label:"Выполнено",color:"bg-green-50 border-green-200"}].map(e=>J.jsxs("div",{className:"bg-[#F2F3F4] rounded-[15px] p-[5px] transition-colors "+(_s===e.key?"bg-[#E3F2FD] border-2 border-[#0084FF]":""),onDragOver:t=>((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",Es(t),console.log("Drag over column:",t)})(t,e.key),onDragLeave:Ys,onDrop:t=>((e,t)=>{e.preventDefault(),console.log("Drop event triggered:",{draggedTask:ks,newStatus:t}),ks&&ks.status!==t&&(console.log(`Перемещение задачи "${ks.title}" из ${ks.status} в ${t}`),$s(ks.id,{status:t})),Fs(null),Es(null),Ss(!1)})(t,e.key),children:[J.jsxs("div",{className:"flex items-center justify-between mb-4 mx-4",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:e.label}),J.jsx("span",{className:"text-[12px] text-[#8E8E93] bg-white px-2 py-1 rounded-[6px]",children:Js(e.key).length})]}),J.jsxs("div",{className:"space-y-3",children:[Js(e.key).map(e=>J.jsxs("div",{className:"bg-white rounded-[15px] p-3 border border-[#E5E7EB] cursor-grab hover:shadow-md transition-all "+((null==ks?void 0:ks.id)===e.id?"opacity-50 scale-95 cursor-grabbing":""),draggable:!0,onDragStart:t=>((e,t)=>{console.log("Drag start:",t),Fs(t),Ss(!0),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.id)})(t,e),onDragEnd:Xs,onClick:t=>{Cs||Bs(e)},children:[J.jsx("h4",{className:"text-[13px] font-[500] text-[#070F1A] mb-1",children:e.title||`Задача #${e.id.slice(-4)}`}),J.jsx("p",{className:"text-[12px] text-[#8E8E93] mb-2",children:e.assigneeName}),J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("span",{className:"px-2 py-1 text-[11px] font-[500] rounded-[4px] "+("high"===e.priority?"bg-red-100 text-red-600":"medium"===e.priority?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"),children:"high"===e.priority?"Высокий":"medium"===e.priority?"Средний":"Низкий"}),J.jsx("span",{className:"text-[11px] text-[#8E8E93]",children:e.dueDate?new Date(e.dueDate).toLocaleDateString():"Без дедлайна"})]})]},e.id)),"pending"===e.key&&J.jsx("div",{className:"mt-3",children:J.jsxs("button",{onClick:()=>Mt(!0),className:"w-full h-[34px] text-[#8E8E93] rounded-[8px] text-[13px] hover:border-[#0084FF] hover:text-[#0084FF] transition-colors flex items-center justify-center gap-2",style:jm.whiteButton,children:[J.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:J.jsx("path",{d:"M12 5V19M5 12H19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Добавить задачу"]})})]})]},e.key))})}),"clients"===Xe&&J.jsxs("div",{className:"space-y-4",children:[console.log("Rendering clients tab, clients count:",sn.length,"clients:",sn),console.log("crmActiveTab:",Xe),0===sn.length?J.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[J.jsx("div",{className:"w-20 h-20 bg-[#F3F4F6] rounded-full flex items-center justify-center mb-4",children:J.jsx("svg",{className:"w-8 h-8 text-[#8E8E93]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Клиентов пока нет"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] text-center max-w-md",children:"Клиенты появятся здесь автоматически, когда начнут поступать заявки через виджет или другие каналы связи"})]}):J.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:sn.map(e=>J.jsxs("div",{className:"bg-white rounded-[12px] p-4 border border-[#E5E7EB] hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{on(e),an(!0)},children:[J.jsxs("div",{className:"flex items-start justify-between mb-3",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-1",children:e.name}),e.company&&J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-2",children:e.company})]}),J.jsx("span",{className:"px-2 py-1 rounded-[6px] text-[12px] font-[500] "+("active"===e.status?"bg-[#DCFCE7] text-[#166534]":"bg-[#FEF3C7] text-[#92400E]"),children:"active"===e.status?"Активный":"Неактивный"})]}),J.jsxs("div",{className:"space-y-2",children:[e.email&&J.jsxs("div",{className:"flex items-center text-[14px] text-[#6B7280]",children:[J.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.email]}),e.phone&&J.jsxs("div",{className:"flex items-center text-[14px] text-[#6B7280]",children:[J.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.phone]}),e.website&&J.jsxs("div",{className:"flex items-center text-[14px] text-[#6B7280]",children:[J.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"})}),J.jsx("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-[#3B82F6] hover:underline",children:e.website})]})]}),e.notes&&J.jsx("div",{className:"mt-3 pt-3 border-t border-[#F3F4F6]",children:J.jsx("p",{className:"text-[12px] text-[#8E8E93] line-clamp-2",children:e.notes})}),J.jsxs("div",{className:"mt-3 pt-3 border-t border-[#F3F4F6] flex items-center justify-between",children:[J.jsx("span",{className:"text-[12px] text-[#8E8E93]",children:"widget_form"===e.source?"Из виджета":e.source}),J.jsx("span",{className:"text-[12px] text-[#8E8E93]",children:new Date(e.created_at).toLocaleDateString("ru-RU")})]})]},e.id))})]}),it&&J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9998]",style:{marginTop:0},onClick:()=>lt(!1)}),J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px",marginTop:0},children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Детали сделки"}),J.jsx("button",{onClick:()=>lt(!1),className:"w-8 h-8 rounded-[90px] bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:rt&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:rt.title}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Стадия:"}),J.jsx("span",{className:"px-3 py-1 bg-[#0084FF]/10 text-[#0084FF] text-[12px] font-[500] rounded-[6px]",children:rt.stage})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Качество лида:"}),J.jsx("div",{className:"flex items-center gap-2",children:J.jsxs("div",{className:"relative lead-quality-dropdown",children:[J.jsxs("button",{onClick:()=>xt(!ht),className:"px-3 py-1 text-[12px] font-[500] rounded-[90px] flex items-center gap-2 hover:opacity-80 transition-opacity "+("hot"===rt.leadQuality?"bg-red-100 text-red-600":"warm"===rt.leadQuality?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"),children:["hot"===rt.leadQuality?"Горячий":"warm"===rt.leadQuality?"Теплый":"Холодный",J.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ht&&J.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-[#E5E7EB] rounded-[10px] shadow-lg z-50 min-w-[120px]",children:J.jsxs("div",{className:"p-2 space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>hs("hot"),children:[J.jsx("div",{className:"w-3 h-3 bg-red-100 rounded-full"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Горячий"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>hs("warm"),children:[J.jsx("div",{className:"w-3 h-3 bg-orange-100 rounded-full"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Теплый"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>hs("cold"),children:[J.jsx("div",{className:"w-3 h-3 bg-blue-100 rounded-full"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Холодный"})]})]})})]})})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Контакты:"}),J.jsxs("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[15px] flex items-center gap-2 "+(rt.hasContacts?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"),children:[rt.hasContacts?J.jsx("img",{src:"/call-calling.svg",alt:"Телефон",className:"w-[10px] h-[10px]",style:ym}):J.jsxs("div",{className:"relative w-[10px] h-[10px]",children:[J.jsx("img",{src:"/call-calling.svg",alt:"Телефон",className:"w-[10px] h-[10px]",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-[1px] bg-gray-400 transform -translate-y-1/2"})]}),rt.hasContacts?"Есть":"Нет"]})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Исполнитель:"}),J.jsx("div",{className:"flex items-center gap-2",children:J.jsxs("div",{className:"relative executor-dropdown",children:[J.jsxs("button",{onClick:()=>"ai"!==rt.owner&&Ls("deal"),className:"text-[12px] text-[#070F1A] flex items-center gap-2 "+("ai"===rt.owner?"cursor-default":"hover:opacity-80 transition-opacity"),children:["ai"===rt.owner?J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-[12px] h-[12px] align-middle"}):J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[12px] h-[12px] align-middle",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),rt.ownerName,"ai"!==rt.owner&&J.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Ds.deal&&J.jsx("div",{className:"absolute top-full right-0 mt-1 bg-white border border-[#E5E7EB] rounded-[10px] shadow-lg z-50 min-w-[160px]",children:J.jsxs("div",{className:"p-2 space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{tn(e=>e.map(e=>e.id===rt.id?{...e,owner:"ai",ownerName:"ИИ-агент"}:e)),at(e=>({...e,owner:"ai",ownerName:"ИИ-агент"})),Is(e=>({...e,deal:!1}))},children:[J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-4 h-4"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"ИИ-агент"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{tn(e=>e.map(e=>e.id===rt.id?{...e,owner:"operator-1",ownerName:"Анна Петрова"}:e)),at(e=>({...e,owner:"operator-1",ownerName:"Анна Петрова"})),Is(e=>({...e,deal:!1}))},children:[J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Анна Петрова"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{tn(e=>e.map(e=>e.id===rt.id?{...e,owner:"operator-2",ownerName:"Михаил Сидоров"}:e)),at(e=>({...e,owner:"operator-2",ownerName:"Михаил Сидоров"})),Is(e=>({...e,deal:!1}))},children:[J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Михаил Сидоров"})]})]})})]})})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Статус решения:"}),J.jsx("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[90px] "+(rt.isResolved?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600"),children:rt.isResolved?"Решен":"В работе"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Создана:"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.createdDate})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Последний контакт:"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.lastContact})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:"Клиент"}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Имя:"}),J.jsx("div",{className:"flex items-center gap-2",children:"name"===ot?J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"text",value:dt.name||"",onChange:e=>ut(t=>({...t,name:e.target.value})),className:"text-[12px] text-[#070F1A] border border-gray-300 rounded px-2 py-1 w-32",autoFocus:!0}),J.jsx("button",{onClick:()=>ds("name"),className:"w-4 h-4 text-green-600 hover:text-green-700",children:J.jsx("img",{src:"/Frame 2069.svg",alt:"Сохранить",className:"w-4 h-4",style:{filter:"brightness(0) saturate(50%) invert(35%) sepia(43%) saturate(1352%) hue-rotate(87deg) brightness(119%) contrast(119%)"}})}),J.jsx("button",{onClick:us,className:"w-4 h-4 text-red-600 hover:text-red-700",children:J.jsx("img",{src:"/x-02.svg",alt:"Отмена",className:"w-4 h-4",style:wm})})]}):J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.client.name||"Не указано"}),J.jsx("button",{onClick:()=>cs("name",rt.client.name||""),className:"w-[11px] h-[11px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[11px] h-[11px]"})})]})})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Email:"}),J.jsx("div",{className:"flex items-center gap-2",children:"email"===ot?J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"email",value:dt.email||"",onChange:e=>ut(t=>({...t,email:e.target.value})),className:"text-[12px] text-[#070F1A] border border-gray-300 rounded px-2 py-1 w-32",autoFocus:!0}),J.jsx("button",{onClick:()=>ds("email"),className:"w-4 h-4 text-green-600 hover:text-green-700",children:J.jsx("img",{src:"/Frame 2069.svg",alt:"Сохранить",className:"w-4 h-4",style:{filter:"brightness(0) saturate(50%) invert(35%) sepia(43%) saturate(1352%) hue-rotate(87deg) brightness(119%) contrast(119%)"}})}),J.jsx("button",{onClick:us,className:"w-4 h-4 text-red-600 hover:text-red-700",children:J.jsx("img",{src:"/x-02.svg",alt:"Отмена",className:"w-4 h-4",style:wm})})]}):J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[12px] text-[#0084FF]",children:rt.client.email||"Не указан"}),J.jsx("button",{onClick:()=>cs("email",rt.client.email||""),className:"w-[11px] h-[11px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[11px] h-[11px]"})})]})})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Телефон:"}),J.jsx("div",{className:"flex items-center gap-2",children:"phone"===ot?J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"tel",value:dt.phone||"",onChange:e=>ut(t=>({...t,phone:e.target.value})),className:"text-[12px] text-[#070F1A] border border-gray-300 rounded px-2 py-1 w-32",autoFocus:!0}),J.jsx("button",{onClick:()=>ds("phone"),className:"w-4 h-4 text-green-600 hover:text-green-700",children:J.jsx("img",{src:"/Frame 2069.svg",alt:"Сохранить",className:"w-4 h-4",style:{filter:"brightness(0) saturate(50%) invert(35%) sepia(43%) saturate(1352%) hue-rotate(87deg) brightness(119%) contrast(119%)"}})}),J.jsx("button",{onClick:us,className:"w-4 h-4 text-red-600 hover:text-red-700",children:J.jsx("img",{src:"/x-02.svg",alt:"Отмена",className:"w-4 h-4",style:wm})})]}):J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.client.phone||"Не указан"}),J.jsx("button",{onClick:()=>cs("phone",rt.client.phone||""),className:"w-[11px] h-[11px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[11px] h-[11px]"})})]})})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Компания:"}),J.jsx("div",{className:"flex items-center gap-2",children:"company"===ot?J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"text",value:dt.company||"",onChange:e=>ut(t=>({...t,company:e.target.value})),className:"text-[12px] text-[#070F1A] border border-gray-300 rounded px-2 py-1 w-32",autoFocus:!0}),J.jsx("button",{onClick:()=>ds("company"),className:"w-4 h-4 text-green-600 hover:text-green-700",children:J.jsx("img",{src:"/Frame 2069.svg",alt:"Сохранить",className:"w-4 h-4",style:{filter:"brightness(0) saturate(50%) invert(35%) sepia(43%) saturate(1352%) hue-rotate(87deg) brightness(119%) contrast(119%)"}})}),J.jsx("button",{onClick:us,className:"w-4 h-4 text-red-600 hover:text-red-700",children:J.jsx("img",{src:"/x-02.svg",alt:"Отмена",className:"w-4 h-4",style:wm})})]}):J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.client.company||"Не указана"}),J.jsx("button",{onClick:()=>cs("company",rt.client.company||""),className:"w-[11px] h-[11px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[11px] h-[11px]"})})]})})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Сумма:"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:rt.amount?`${rt.amount.toLocaleString()}₽`:"Не указана"}),J.jsx("button",{className:"w-[11px] h-[11px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:J.jsx("img",{src:"/pencil.svg",alt:"Редактировать",className:"w-[11px] h-[11px]"})})]})]})]})]}),J.jsxs("div",{children:[J.jsxs("div",{className:"flex items-center justify-between mb-3",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A]",children:"Заметки"}),!Gt&&J.jsx("button",{onClick:Os,className:"text-[12px] text-[#0084FF] hover:underline",children:"Редактировать"})]}),Gt?J.jsxs("div",{className:"space-y-3",children:[J.jsx("textarea",{value:Yt,onChange:e=>Xt(e.target.value),className:"w-full h-24 px-3 py-2 border border-[#E5E7EB] rounded-[8px] text-[14px] focus:outline-none focus:border-[#0084FF] resize-none",placeholder:"Добавьте заметки о сделке..."}),J.jsxs("div",{className:"flex gap-2",children:[J.jsx("button",{onClick:Rs,className:"px-3 py-1 bg-[#0084FF] text-white text-[12px] rounded-[90px] hover:bg-[#0073E6] transition-colors h-[34px]",children:"Сохранить"}),J.jsx("button",{onClick:Ps,className:"px-3 py-1 bg-gray-200 text-gray-700 text-[12px] rounded-[90px] hover:bg-gray-300 transition-colors h-[34px]",children:"Отмена"})]})]}):J.jsx("div",{className:"bg-[#F2F3F4] rounded-[15px] p-4",children:J.jsx("p",{className:"text-[12px] text-[#070F1A] leading-relaxed",children:rt.notes||"Заметки не добавлены"})})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:"Действия"}),J.jsxs("div",{className:"space-y-2",children:[rt.client.email?J.jsx("a",{href:`mailto:${rt.client.email}?subject=По поводу сделки: ${rt.title}`,className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[10px] text-[14px] font-[500] hover:bg-[#0073E6] transition-colors flex items-center justify-center",children:"Отправить email"}):J.jsx("button",{disabled:!0,className:"w-full h-10 bg-gray-200 text-gray-500 rounded-[10px] text-[14px] font-[500] cursor-not-allowed",children:"Email не указан"}),rt.client.phone?J.jsx("a",{href:`tel:${rt.client.phone}`,className:"w-full h-[34px] bg-white border border-[#E5E7EB] text-[#070F1A] rounded-[10px] text-[14px] font-[500] hover:bg-gray-50 transition-colors flex items-center justify-center",children:"Позвонить"}):J.jsx("button",{disabled:!0,className:"w-full h-[34px] bg-gray-100 border border-gray-200 text-gray-500 rounded-[10px] text-[14px] font-[500] cursor-not-allowed",children:"Телефон не указан"}),rt.dialogId?J.jsx("button",{onClick:()=>{lt(!1),Ze("deals"),console.log(`Переход к диалогу: ${rt.dialogId}`)},className:"w-full h-[34px] bg-white border border-[#E5E7EB] text-[#070F1A] rounded-[10px] text-[14px] font-[500] hover:bg-gray-50 transition-colors flex items-center justify-center",children:"Перейти в диалог"}):J.jsx("button",{disabled:!0,className:"w-full h-[34px] bg-gray-100 border border-gray-200 text-gray-500 rounded-[10px] text-[14px] font-[500] cursor-not-allowed",children:"Диалог не найден"}),J.jsx("button",{onClick:()=>{return e=rt.id,void(window.confirm("Вы уверены, что хотите удалить эту сделку?")&&(tn(t=>t.filter(t=>t.id!==e)),rt&&rt.id===e&&(lt(!1),at(null))));var e},className:"w-full h-[34px] bg-red-50/50 border border-red-100/50 text-red-500/70 rounded-[10px] text-[14px] font-[500] hover:bg-red-100/50 hover:text-red-500 transition-colors flex items-center justify-center",children:"Удалить сделку"})]})]})]})})]})})]}),rn&&ln&&J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9998]",style:{marginTop:0},onClick:()=>an(!1)}),J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px",marginTop:0},children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Детали клиента"}),J.jsx("button",{onClick:()=>an(!1),className:"w-8 h-8 rounded-[90px] bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:ln.name}),J.jsxs("div",{className:"space-y-3",children:[ln.company&&J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Компания:"}),J.jsx("span",{className:"text-[14px] text-[#070F1A] font-[500]",children:ln.company})]}),ln.email&&J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Email:"}),J.jsx("a",{href:`mailto:${ln.email}`,className:"text-[14px] text-[#0084FF] hover:underline",children:ln.email})]}),ln.phone&&J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Телефон:"}),J.jsx("a",{href:`tel:${ln.phone}`,className:"text-[14px] text-[#0084FF] hover:underline",children:ln.phone})]}),ln.website&&J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Сайт:"}),J.jsx("a",{href:ln.website,target:"_blank",rel:"noopener noreferrer",className:"text-[14px] text-[#0084FF] hover:underline",children:ln.website})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Статус:"}),J.jsx("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[6px] "+("active"===ln.status?"bg-[#DCFCE7] text-[#166534]":"bg-[#FEF3C7] text-[#92400E]"),children:"active"===ln.status?"Активный":"Неактивный"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Источник:"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:"widget_form"===ln.source?"Из виджета":ln.source})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Дата создания:"}),J.jsx("span",{className:"text-[14px] text-[#070F1A]",children:new Date(ln.created_at).toLocaleDateString("ru-RU")})]})]})]}),ln.notes&&J.jsxs("div",{children:[J.jsx("h4",{className:"text-[14px] font-[500] text-[#070F1A] mb-3",children:"Заметки"}),J.jsx("div",{className:"bg-[#F9FAFB] rounded-[8px] p-4",children:J.jsx("p",{className:"text-[14px] text-[#6B7280] whitespace-pre-wrap",children:ln.notes})})]}),J.jsx("div",{className:"space-y-3 pt-4 border-t border-[#E5E7EB]",children:J.jsx("button",{onClick:async()=>{try{const e={title:`Сделка с ${ln.name}`,stage:"Новые",lead_quality:"warm",amount:0,owner:"ai",owner_name:"ИИ-агент",is_resolved:!1,description:`Сделка создана из карточки клиента ${ln.name}`,client_id:ln.id,dialog_id:null};console.log("Deal created in Supabase:",createdDeal);createdDeal.id,e.title,ln.company,e.amount,e.stage,e.lead_quality,!ln.email&&ln.phone,e.owner,e.owner_name,e.is_resolved,ln.name,ln.email,ln.phone,ln.company,e.description,(new Date).toISOString().split("T")[0],(new Date).toISOString().split("T")[0],e.dialog_id;await(async()=>{if(null==r?void 0:r.id)try{console.log("Reloading CRM data for user:",r.id),console.log("Reloaded clients:",sn),console.log("Reloaded deals:",en),console.log("Reloaded tasks:",bs);const e=en.map(e=>{var t,s,n,r,a,i,l;return{id:e.id,title:e.title,company:(null==(t=e.crm_clients)?void 0:t.company)||"",amount:e.amount||0,days:0,stage:e.stage||"Новые",leadQuality:e.lead_quality||"medium",hasContacts:!(!(null==(s=e.crm_clients)?void 0:s.email)&&!(null==(n=e.crm_clients)?void 0:n.phone)),owner:e.owner||"ai",ownerName:e.owner_name||"ИИ-агент",isResolved:e.is_resolved||!1,client:{name:(null==(r=e.crm_clients)?void 0:r.name)||"",email:(null==(a=e.crm_clients)?void 0:a.email)||"",phone:(null==(i=e.crm_clients)?void 0:i.phone)||"",company:(null==(l=e.crm_clients)?void 0:l.company)||""},notes:e.description||"",createdDate:e.created_at?e.created_at.split("T")[0]:(new Date).toISOString().split("T")[0],lastContact:e.created_at?e.created_at.split("T")[0]:(new Date).toISOString().split("T")[0],dialogId:e.dialog_id}}),t=bs.map(e=>({id:e.id,title:e.title,description:e.description||"",assignee:e.assignee||"operator-1",assigneeName:e.assignee_name||"Анна Петрова",priority:e.priority||"medium",status:e.status||"pending",dueDate:e.due_date||"",dealId:e.deal_id||"",notes:e.result||"",createdBy:e.created_by||"ИИ-агент",createdDate:e.created_at?e.created_at.split("T")[0]:(new Date).toLocaleDateString("ru-RU")}));tn(e),vs(t),nn(sn),console.log("CRM data reloaded successfully")}catch(e){console.error("Error reloading CRM data:",e)}})(),an(!1),Ze("deals")}catch(e){console.error("Error creating deal:",e),alert("Ошибка создания сделки: "+e.message)}},className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0070E6] transition-colors flex items-center justify-center",style:jm.blueButton,children:"Создать сделку"})})]})]})})]}),js&&ys&&J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9998]",style:{marginTop:0},onClick:()=>Ns(!1)}),J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px",marginTop:0},children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Детали задачи"}),J.jsx("button",{onClick:()=>Ns(!1),className:"w-8 h-8 rounded-[90px] bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:ys.title}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Статус:"}),J.jsx("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[6px] "+("completed"===ys.status?"bg-green-100 text-green-600":"in_progress"===ys.status?"bg-blue-100 text-blue-600":"bg-yellow-100 text-yellow-600"),children:"completed"===ys.status?"Выполнено":"in_progress"===ys.status?"В работе":"К выполнению"})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Приоритет:"}),J.jsx("span",{className:"px-3 py-1 text-[12px] font-[500] rounded-[6px] "+("high"===ys.priority?"bg-red-100 text-red-600":"medium"===ys.priority?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"),children:"high"===ys.priority?"Высокий":"medium"===ys.priority?"Средний":"Низкий"})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Исполнитель:"}),J.jsx("div",{className:"flex items-center gap-2",children:J.jsxs("div",{className:"relative executor-dropdown",children:[J.jsxs("button",{onClick:()=>"ai"!==ys.assignee&&Ls("task"),className:"text-[12px] text-[#070F1A] flex items-center gap-2 "+("ai"===ys.assignee?"cursor-default":"hover:opacity-80 transition-opacity"),children:["ai"===ys.assignee?J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-[12px] h-[12px] align-middle"}):J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-[12px] h-[12px] align-middle",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),ys.assigneeName,"ai"!==ys.assignee&&J.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Ds.task&&J.jsx("div",{className:"absolute top-full right-0 mt-1 bg-white border border-[#E5E7EB] rounded-[10px] shadow-lg z-50 min-w-[160px]",children:J.jsxs("div",{className:"p-2 space-y-1",children:[J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{vs(e=>e.map(e=>e.id===ys.id?{...e,assignee:"ai",assigneeName:"ИИ-агент"}:e)),ws(e=>({...e,assignee:"ai",assigneeName:"ИИ-агент"})),Is(e=>({...e,task:!1}))},children:[J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(7500%) hue-rotate(212deg) brightness(102%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"ИИ-агент"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{vs(e=>e.map(e=>e.id===ys.id?{...e,assignee:"operator-1",assigneeName:"Анна Петрова"}:e)),ws(e=>({...e,assignee:"operator-1",assigneeName:"Анна Петрова"})),Is(e=>({...e,task:!1}))},children:[J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Анна Петрова"})]}),J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{vs(e=>e.map(e=>e.id===ys.id?{...e,assignee:"operator-2",assigneeName:"Михаил Сидоров"}:e)),ws(e=>({...e,assignee:"operator-2",assigneeName:"Михаил Сидоров"})),Is(e=>({...e,task:!1}))},children:[J.jsx("img",{src:"/headphone.svg",alt:"Оператор",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(66%) sepia(21%) saturate(828%) hue-rotate(230deg) brightness(95%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"Михаил Сидоров"})]})]})})]})})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Дедлайн:"}),J.jsx("div",{className:"flex items-center gap-2",children:ts?J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"date",value:ns,onChange:e=>rs(e.target.value),className:"text-[12px] border border-[#E5E7EB] rounded-[6px] px-2 py-1 focus:outline-none focus:border-[#0084FF]"}),J.jsx("button",{onClick:Qs,className:"text-[12px] text-[#0084FF] hover:text-[#0066CC] transition-colors",children:"✓"}),J.jsx("button",{onClick:Hs,className:"text-[12px] text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:"✕"})]}):J.jsxs(J.Fragment,{children:[J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:ys.dueDate?new Date(ys.dueDate).toLocaleDateString():"Не установлен"}),J.jsx("button",{onClick:Ws,className:"text-[12px] text-[#0084FF] hover:text-[#0066CC] transition-colors",children:"Изменить"})]})})]}),J.jsxs("div",{className:"flex justify-between",children:[J.jsx("span",{className:"text-[14px] text-[#8E8E93]",children:"Создана:"}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:new Date(ys.createdDate).toLocaleDateString()})]})]})]}),J.jsxs("div",{children:[J.jsxs("div",{className:"flex items-center justify-between mb-3",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A]",children:"Описание"}),!as&&J.jsx("button",{onClick:Vs,className:"text-[12px] text-[#0084FF] hover:text-[#0066CC] transition-colors",children:"Редактировать"})]}),as?J.jsxs("div",{children:[J.jsx("textarea",{value:ls,onChange:e=>os(e.target.value),className:"w-full h-24 p-3 border border-[#E5E7EB] rounded-[10px] text-[12px] resize-none focus:outline-none focus:border-[#0084FF]",placeholder:"Добавьте описание задачи..."}),J.jsxs("div",{className:"flex gap-2 mt-2",children:[J.jsx("button",{onClick:Gs,className:"px-3 py-1 bg-[#0084FF] text-white text-[12px] rounded-[90px] hover:bg-[#0073E6] transition-colors h-[34px]",children:"Сохранить"}),J.jsx("button",{onClick:Ks,className:"px-3 py-1 bg-gray-200 text-gray-700 text-[12px] rounded-[90px] hover:bg-gray-300 transition-colors h-[34px]",children:"Отмена"})]})]}):J.jsx("div",{className:"bg-[#F8F9FA] rounded-[15px] p-4",children:J.jsx("p",{className:"text-[12px] text-[#070F1A] leading-relaxed",children:ys.description||"Описание не добавлено"})})]}),J.jsxs("div",{children:[J.jsxs("div",{className:"flex items-center justify-between mb-3",children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A]",children:"Заметки"}),!Zt&&J.jsx("button",{onClick:zs,className:"text-[12px] text-[#0084FF] hover:text-[#0066CC] transition-colors",children:"Редактировать"})]}),Zt?J.jsxs("div",{children:[J.jsx("textarea",{value:gs,onChange:e=>fs(e.target.value),className:"w-full h-24 p-3 border border-[#E5E7EB] rounded-[10px] text-[12px] resize-none focus:outline-none focus:border-[#0084FF]",placeholder:"Добавьте заметки к задаче..."}),J.jsxs("div",{className:"flex gap-2 mt-2",children:[J.jsx("button",{onClick:qs,className:"px-3 py-1 bg-[#0084FF] text-white text-[12px] rounded-[90px] hover:bg-[#0073E6] transition-colors h-[34px]",children:"Сохранить"}),J.jsx("button",{onClick:Us,className:"px-3 py-1 bg-gray-200 text-gray-700 text-[12px] rounded-[90px] hover:bg-gray-300 transition-colors h-[34px]",children:"Отмена"})]})]}):J.jsx("div",{className:"bg-[#F8F9FA] rounded-[15px] p-4",children:J.jsx("p",{className:"text-[12px] text-[#070F1A] leading-relaxed",children:ys.notes||"Заметки не добавлены"})})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:"Действия"}),J.jsxs("div",{className:"space-y-2",children:[J.jsx("button",{onClick:()=>{$s(ys.id,{status:"completed"===ys.status?"pending":"completed"}),ws({...ys,status:"completed"===ys.status?"pending":"completed"})},className:"w-full h-[34px] rounded-[10px] text-[14px] font-[500] transition-colors "+("completed"===ys.status?"bg-yellow-100 text-yellow-600 hover:bg-yellow-200":"bg-green-100 text-green-600 hover:bg-green-200"),children:"completed"===ys.status?"Вернуть в работу":"Отметить выполненной"}),J.jsx("button",{onClick:()=>{var e;confirm("Вы уверены, что хотите удалить эту задачу?")&&(e=ys.id,vs(t=>t.filter(t=>t.id!==e)),Ns(!1),ws(null))},className:"w-full h-[34px] bg-red-100 text-red-600 rounded-[10px] text-[14px] font-[500] hover:bg-red-200 transition-colors flex items-center justify-center",children:"Удалить задачу"})]})]})]})]})})]})]});case"notifications":return J.jsxs("div",{className:"space-y-6",children:[J.jsx("div",{className:"flex justify-between items-center",children:J.jsx("h1",{className:"text-[20px] font-[500]",children:"Уведомления"})}),J.jsxs("div",{className:"border border-[#070F1A]/10 rounded-[16px] p-5",children:[J.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A]",children:"Уведомления в"}),J.jsxs("div",{className:"flex items-center gap-1",children:[J.jsx("span",{className:"text-[18px] font-medium text-[#070F1A]",children:"Telegram"}),J.jsx("img",{src:"/Vector 712783.svg",alt:"Telegram",className:"w-[15px] h-[13px]"})]})]}),J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-6",children:"Получайте информацию о новых сообщениях, уведомлениях о переключения чата на оператора и тд. Это поможет вам быть на связи с клиентами круглосуточно и быть в курсе о перехватах диалогов человеком!"}),J.jsxs("div",{className:"mt-[30px]",children:[J.jsxs("p",{className:"text-[14px] font-[500] text-[#070F1A] mb-4",children:["Перейдите в ",J.jsx("a",{href:"https://t.me/Adapto_notifications_bot",target:"_blank",rel:"noopener noreferrer",className:"text-[#0084FF] hover:underline",children:"наш Telegram-бот"})," и отправьте команду ",J.jsx("span",{className:"text-[#0084FF]",children:"/start"}),".",J.jsx("br",{}),"После чего бот вышлет API ключ, который необходимо вставить в поле ниже"]}),J.jsxs("div",{className:"flex gap-[10px]",children:[J.jsx("input",{type:"text",placeholder:"Введите API ключ из Telegram бота",value:cn,onChange:e=>dn(e.target.value),className:"flex-1 h-10 px-4 border border-[#E5E7EB] rounded-[10px] text-[13px] font-[400] focus:outline-none focus:border-[#0084FF]",style:Nm.inputField}),J.jsx("button",{onClick:xr,disabled:un,className:"h-10 px-6 bg-[#0084FF] text-white rounded-[10px] text-[13px] font-[500] hover:bg-[#0073E6] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:jm.blueButton,children:un?"Подключение...":"Подключить"})]})]})]}),J.jsxs("div",{className:"border border-[#070F1A]/10 rounded-[16px] p-5",children:[J.jsx("h3",{className:"text-[18px] font-medium text-[#070F1A] mb-4",children:"Типы уведомлений"}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Новые сообщения в чатах"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Уведомления о входящих сообщениях от клиентов"})]}),J.jsx("img",{src:(null==(v=null==mn?void 0:mn.notification_types)?void 0:v.includes("new_messages"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("new_messages")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Перехваты оператором"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Уведомления когда диалог перехватывает человек"})]}),J.jsx("img",{src:(null==(y=null==mn?void 0:mn.notification_types)?void 0:y.includes("operator_takeover"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("operator_takeover")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-[12px]",children:[J.jsxs("div",{children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Критические уведомления"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Система недоступна, превышены лимиты токенов"})]}),J.jsx("img",{src:(null==(w=null==mn?void 0:mn.notification_types)?void 0:w.includes("system_alerts"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("system_alerts")})]}),J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-[12px]",children:[J.jsxs("div",{className:"flex-1",children:[J.jsx("p",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Ежедневные отчеты"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93]",children:"Ежедневная статистика и аналитика"}),J.jsx("button",{onClick:br,className:"mt-2 px-3 py-1 text-[12px] font-[500] text-white rounded-[6px] transition-colors",style:{backgroundColor:"#0084FF"},children:"Отправить отчет"})]}),J.jsx("img",{src:(null==(k=null==mn?void 0:mn.notification_types)?void 0:k.includes("daily_reports"))?"/iOS/Switch.svg":"/iOS/Switch-1.svg",alt:"Включить",className:"w-[34px] h-[34px] cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>gr("daily_reports")})]})]})]})]});case"stories-management":return J.jsxs("div",{className:"p-0",children:[J.jsx("div",{className:"text-left mb-[16px]",children:J.jsx("h1",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Управление сторис"})}),J.jsx("div",{className:"h-px bg-[#E5E7EB] mb-[30px]",style:{marginLeft:"-32px",marginRight:"-32px"}}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("h2",{className:"text-[16px] font-[500] text-[#070F1A]",children:"Текущие сторис"}),J.jsx("button",{onClick:()=>P(!0),className:"bg-[#0084FF] text-white px-4 py-2 rounded-[10px] text-[14px] font-[500] hover:bg-[#0070E6] transition-colors",children:"Добавить сторис"})]}),J.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(e=>J.jsxs("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4",children:[J.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[J.jsx("div",{className:"w-[50px] h-[50px] border border-[#0084FF] rounded-[50px] flex items-center justify-center",children:J.jsx("div",{className:"w-[46px] h-[46px] bg-white rounded-[50px] relative overflow-hidden",children:J.jsx("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-cover"})})}),J.jsxs("div",{className:"flex-1",children:[J.jsx("h3",{className:"text-[14px] font-[500] text-[#070F1A]",children:e.title}),J.jsxs("p",{className:"text-[12px] text-[#8E8E93]",children:["Порядок: ",e.order_index]})]})]}),J.jsxs("div",{className:"flex gap-2",children:[J.jsx("button",{onClick:()=>q(e),className:"flex-1 bg-[#F3F4F6] text-[#070F1A] px-3 py-2 rounded-[8px] text-[12px] font-[500] hover:bg-[#E5E7EB] transition-colors",children:"Редактировать"}),J.jsx("button",{onClick:()=>hr(e.id),className:"flex-1 bg-[#FEF2F2] text-[#DC2626] px-3 py-2 rounded-[8px] text-[12px] font-[500] hover:bg-[#FEE2E2] transition-colors",children:"Удалить"})]})]},e.id))})]})]});default:return J.jsx("div",{className:"text-center py-8 text-gray-500",children:"Раздел в разработке"})}})()})})]}),le&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>oe(!1)}),J.jsxs("div",{className:"relative w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden flex flex-col "+("dark"===me?"bg-[#070F1A] rounded-[20px]":"bg-white rounded-[20px]"),children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b "+("dark"===me?"border-white/10":"border-gray-200"),children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("button",{onClick:()=>oe(!1),className:"transition-colors "+("dark"===me?"text-white/70 hover:text-white":"text-gray-400 hover:text-gray-600"),children:J.jsx("img",{src:"/Frame 195.svg",alt:"Назад",className:"w-4 h-4"})}),J.jsx("h3",{className:"text-[20px] font-[500] "+("dark"===me?"text-white":"text-[#070F1A]"),children:"Интеграции / Виджет"})]}),J.jsxs("button",{onClick:async()=>{try{const e=qc();await navigator.clipboard.writeText(e),Oc("Скрипт скопирован в буфер обмена!"),Rn(e=>e.map(e=>"widget"===e.id?{...e,installed:!0}:e)),oe(!1)}catch(e){console.error("Ошибка при копировании:",e),Oc("Ошибка при копировании скрипта")}},className:"h-[40px] px-4 bg-[#0084FF] text-white hover:bg-[#0073E6] rounded-[10px] font-[500] text-[14px] flex items-center gap-2 transition-colors",children:[J.jsx("img",{src:"/document-copy.svg",alt:"Копировать",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(1)"}}),"Скопировать скрипт"]})]}),J.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:J.jsxs("div",{className:"space-y-8",children:[J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Акцентный цвет"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("input",{type:"text",value:Mc.accentColor,onChange:e=>Lc({...Mc,accentColor:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"HEX"}),J.jsx("input",{type:"color",value:Mc.accentColor,onChange:e=>Lc({...Mc,accentColor:e.target.value}),className:"w-10 h-10 rounded-lg border-2 border-gray-300 cursor-pointer"}),J.jsx("button",{onClick:()=>Lc({...Mc,accentColor:"#1354FC"}),className:"text-gray-400 hover:text-gray-600",children:"×"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Цвет кнопки"}),J.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{id:"light",label:"Светлый фон",bg:"bg-white",border:"border-blue-500",text:"text-blue-500"},{id:"dark",label:"Темный фон",bg:"bg-gray-900",border:"border-white",text:"text-white"},{id:"custom",label:"Задать свой цвет",bg:"bg-gradient-to-r from-yellow-400 via-pink-500 to-blue-500",border:"border-blue-500",text:"text-white"}].map(e=>J.jsxs("button",{onClick:()=>Lc({...Mc,buttonColor:e.id}),className:"p-3 rounded-lg border-2 transition-all "+(Mc.buttonColor===e.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsxs("div",{className:"w-[140px] h-[42px] rounded-xl flex items-center justify-center gap-2 mb-2 mx-auto "+("light"===e.id?"bg-white border-2 border-gray-300":"dark"===e.id?"bg-gray-900":"bg-gradient-to-r from-yellow-400 via-pink-500 to-blue-500"),style:{borderColor:"light"===e.id?Mc.accentColor:"transparent",color:"light"===e.id?Mc.accentColor:"white"},children:[J.jsx("div",{className:"w-4 h-4 rounded-[90px] opacity-80",style:{backgroundColor:"light"===e.id?Mc.accentColor:"currentColor"}}),J.jsx("span",{className:"text-sm font-medium",style:{maxWidth:"90px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:"Написать нам"})]}),J.jsx("span",{className:"text-xs "+(Mc.buttonColor===e.id?"text-blue-600":"text-gray-600"),children:e.label})]},e.id))})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Название кнопки"}),J.jsx("input",{type:"text",value:Mc.buttonText,onChange:e=>Lc({...Mc,buttonText:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Написать нам"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Аватар Adapto"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[J.jsxs("button",{onClick:()=>Lc({...Mc,avatar:"default"}),className:"p-3 rounded-lg border-2 transition-all "+("default"===Mc.avatar?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-[90px] mx-auto mb-2 flex items-center justify-center",children:J.jsxs("div",{className:"flex items-center justify-center w-6 h-6",children:[J.jsx("div",{className:"w-3 h-3 bg-white rounded-[90px] mr-1"}),J.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-[90px]"})]})}),J.jsx("span",{className:"text-xs text-center block",children:"По умолчанию"})]}),J.jsxs("button",{onClick:()=>{var e;return null==(e=document.getElementById("avatar-input"))?void 0:e.click()},className:"p-3 rounded-lg border-2 transition-all "+("custom"===Mc.avatar?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[J.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-[90px] mx-auto mb-2 flex items-center justify-center",children:J.jsx("span",{className:"text-gray-500",children:"+"})}),J.jsx("span",{className:"text-xs text-center block",children:"Загрузить"}),J.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;(null==(t=e.target.files)?void 0:t[0])&&(Lc({...Mc,avatar:"custom"}),Oc("Аватар загружен!"))}})]})]})]})]}),"custom"===Mc.buttonColor&&J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Введите цвет для фона"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("input",{type:"text",value:Mc.customButtonColor,onChange:e=>Lc({...Mc,customButtonColor:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"HEX"}),J.jsx("input",{type:"color",value:Mc.customButtonColor,onChange:e=>Lc({...Mc,customButtonColor:e.target.value}),className:"w-10 h-10 rounded-lg border-2 border-gray-300 cursor-pointer"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Расположение виджета"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[J.jsx("button",{onClick:()=>Lc({...Mc,widgetLocation:"default"}),className:"p-4 rounded-lg border-2 transition-all "+("default"===Mc.widgetLocation?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"По умолчанию"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Правый нижний угол"})]})}),J.jsx("button",{onClick:()=>Lc({...Mc,widgetLocation:"custom"}),className:"p-4 rounded-lg border-2 transition-all "+("custom"===Mc.widgetLocation?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"Настроить"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Выбрать позицию"})]})})]}),"custom"===Mc.widgetLocation&&J.jsxs("div",{className:"mt-4 space-y-6 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-sm font-medium mb-3",children:"Для компьютеров"}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ снизу"}),J.jsx("input",{type:"number",value:Mc.desktopBottomOffset,onChange:e=>Lc({...Mc,desktopBottomOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ справа"}),J.jsx("input",{type:"number",value:Mc.desktopRightOffset,onChange:e=>Lc({...Mc,desktopRightOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]})]})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-sm font-medium mb-3",children:"Для телефонов"}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ снизу"}),J.jsx("input",{type:"number",value:Mc.mobileBottomOffset,onChange:e=>Lc({...Mc,mobileBottomOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Отступ справа"}),J.jsx("input",{type:"number",value:Mc.mobileRightOffset,onChange:e=>Lc({...Mc,mobileRightOffset:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"0"})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Z-index"}),J.jsx("input",{type:"number",value:Mc.zIndex,onChange:e=>Lc({...Mc,zIndex:parseInt(e.target.value)}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",min:"1"})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Приветственное сообщение"}),J.jsxs("div",{className:"space-y-3",children:[Mc.welcomeMessages.map((e,t)=>J.jsxs("div",{className:"flex gap-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.welcomeMessages];s[t]=e.target.value,Lc({...Mc,welcomeMessages:s})},className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Приветственное сообщение"}),J.jsx("button",{onClick:()=>{const e=Mc.welcomeMessages.filter((e,s)=>s!==t);Lc({...Mc,welcomeMessages:e})},className:"px-3 py-2 text-red-500 hover:text-red-700",children:"×"})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.welcomeMessages,""];Lc({...Mc,welcomeMessages:e})},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить сообщение"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Триггерный вопрос"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[J.jsx("button",{onClick:()=>Lc({...Mc,triggerQuestionEnabled:"no"}),className:"p-4 rounded-lg border-2 transition-all "+("no"===Mc.triggerQuestionEnabled?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Нет"})})}),J.jsx("button",{onClick:()=>Lc({...Mc,triggerQuestionEnabled:"yes"}),className:"p-4 rounded-lg border-2 transition-all "+("yes"===Mc.triggerQuestionEnabled?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Есть"})})})]}),"yes"===Mc.triggerQuestionEnabled&&J.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Через какое время показать:"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"number",value:Mc.triggerQuestionDelay,onChange:e=>Lc({...Mc,triggerQuestionDelay:parseInt(e.target.value)}),className:"w-20 p-2 border border-gray-300 rounded-lg text-sm",min:"1"}),J.jsx("span",{className:"text-sm text-gray-600",children:"сек"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Вопрос:"}),J.jsx("textarea",{value:Mc.triggerQuestionText,onChange:e=>Lc({...Mc,triggerQuestionText:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",rows:"3",placeholder:"Введите вопрос"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Быстрые ответы:"}),J.jsxs("div",{className:"space-y-2",children:[Mc.quickReplies.map((e,t)=>J.jsxs("div",{className:"flex gap-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.quickReplies];s[t]=e.target.value,Lc({...Mc,quickReplies:s})},className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Быстрый ответ"}),J.jsx("button",{onClick:()=>{const e=Mc.quickReplies.filter((e,s)=>s!==t);Lc({...Mc,quickReplies:e})},className:"px-3 py-2 text-red-500 hover:text-red-700",children:"×"})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.quickReplies,""];Lc({...Mc,quickReplies:e})},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить быстрый ответ"})]})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Follow up сообщение"}),J.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Сообщение, которое увидит пользователь, если выйдет из диалога"}),J.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[J.jsx("button",{onClick:()=>Lc({...Mc,followUpMessage:"no"}),className:"p-4 rounded-lg border-2 transition-all "+("no"===Mc.followUpMessage?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Нет"})})}),J.jsx("button",{onClick:()=>Lc({...Mc,followUpMessage:"yes"}),className:"p-4 rounded-lg border-2 transition-all "+("yes"===Mc.followUpMessage?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:"Есть"})})})]}),"yes"===Mc.followUpMessage&&J.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Через какое время показать:"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"number",value:Mc.followUpDelay,onChange:e=>Lc({...Mc,followUpDelay:parseInt(e.target.value)}),className:"w-20 p-2 border border-gray-300 rounded-lg text-sm",min:"1"}),J.jsx("span",{className:"text-sm text-gray-600",children:"сек"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Вопрос:"}),J.jsx("textarea",{value:Mc.followUpQuestion,onChange:e=>Lc({...Mc,followUpQuestion:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",rows:"3",placeholder:"Введите вопрос"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Быстрые ответы:"}),J.jsx("div",{className:"space-y-2",children:Mc.followUpQuickReply&&J.jsx("div",{className:"flex gap-2",children:J.jsx("input",{type:"text",value:Mc.followUpQuickReply,onChange:e=>Lc({...Mc,followUpQuickReply:e.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Быстрый ответ"})})})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ссылка на политику обработки персональных данных"}),J.jsx("input",{type:"url",value:Mc.privacyPolicyUrl,onChange:e=>Lc({...Mc,privacyPolicyUrl:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"https://example.com/privacy"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-3",children:"Какие метки собирать"}),J.jsx("div",{className:"grid grid-cols-2 gap-2",children:["utm_source","utm_medium","utm_campaign","utm_term","utm_content","roistat_visit","gclid","fbclid"].map(e=>J.jsx("button",{onClick:()=>{const t=Mc.dataTags||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Lc({...Mc,dataTags:s})},className:"p-2 rounded-lg border-2 transition-all text-sm "+((Mc.dataTags||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e))}),J.jsx("div",{className:"mt-3",children:J.jsx("button",{onClick:()=>{const e=prompt("Введите название метки:");if(e&&!Mc.dataTags.includes(e)){const t=[...Mc.dataTags,e];Lc({...Mc,dataTags:t})}},className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Добавить метку"})})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Режим работы виджета"}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[J.jsxs("button",{onClick:()=>Lc({...Mc,widgetMode:"chat"}),className:"p-4 rounded-lg border-2 transition-all "+("chat"===Mc.widgetMode?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[J.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[J.jsx(pm,{className:"w-5 h-5 text-blue-600"}),J.jsx("span",{className:"font-medium",children:"Чат"})]}),J.jsx("p",{className:"text-sm text-gray-600",children:"Обычный режим чата с ИИ-ассистентом"})]}),J.jsxs("button",{onClick:()=>Lc({...Mc,widgetMode:"questions"}),className:"p-4 rounded-lg border-2 transition-all "+("questions"===Mc.widgetMode?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[J.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[J.jsx(cm,{className:"w-5 h-5 text-blue-600"}),J.jsx("span",{className:"font-medium",children:"Быстрые вопросы"})]}),J.jsx("p",{className:"text-sm text-gray-600",children:"Предустановленные вопросы с готовыми ответами"})]})]})]}),"questions"===Mc.widgetMode&&J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Быстрые вопросы"}),J.jsxs("div",{className:"space-y-4",children:[Mc.quickQuestions.map((e,t)=>J.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[J.jsxs("div",{className:"flex items-start justify-between mb-3",children:[J.jsxs("h5",{className:"font-medium",children:["Вопрос ",t+1]}),J.jsx("button",{onClick:()=>{const e=Mc.quickQuestions.filter((e,s)=>s!==t);Lc({...Mc,quickQuestions:e})},className:"text-red-500 hover:text-red-700",children:J.jsx(vm,{className:"w-4 h-4"})})]}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-1",children:"Вопрос"}),J.jsx("input",{type:"text",value:e.question,onChange:e=>{const s=[...Mc.quickQuestions];s[t].question=e.target.value,Lc({...Mc,quickQuestions:s})},className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Введите вопрос"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ответ"}),J.jsx("textarea",{value:e.answer,onChange:e=>{const s=[...Mc.quickQuestions];s[t].answer=e.target.value,Lc({...Mc,quickQuestions:s})},className:"w-full p-2 border border-gray-300 rounded-lg text-sm h-20 resize-none",placeholder:"Введите ответ"})]})]})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.quickQuestions,{question:"",answer:""}];Lc({...Mc,quickQuestions:e})},className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-gray-400 hover:text-gray-600 transition-colors",children:"+ Добавить вопрос"})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Форма заявки"}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx("button",{onClick:()=>Lc({...Mc,leadFormEnabled:"yes"}),className:"px-4 py-2 rounded-lg border-2 transition-all "+("yes"===Mc.leadFormEnabled?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:"Включить"}),J.jsx("button",{onClick:()=>Lc({...Mc,leadFormEnabled:"no"}),className:"px-4 py-2 rounded-lg border-2 transition-all "+("no"===Mc.leadFormEnabled?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:"Отключить"})]}),"yes"===Mc.leadFormEnabled&&J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Заголовок формы"}),J.jsx("input",{type:"text",value:Mc.leadFormTitle,onChange:e=>Lc({...Mc,leadFormTitle:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Оставьте заявку"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Описание формы"}),J.jsx("input",{type:"text",value:Mc.leadFormDescription,onChange:e=>Lc({...Mc,leadFormDescription:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Мы свяжемся с вами в ближайшее время"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"Поля формы"}),J.jsxs("div",{className:"space-y-3",children:[Mc.leadFormFields.map((e,t)=>J.jsxs("div",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg",children:[J.jsx("div",{className:"flex-1",children:J.jsx("input",{type:"text",value:e.label,onChange:e=>{const s=[...Mc.leadFormFields];s[t].label=e.target.value,Lc({...Mc,leadFormFields:s})},className:"w-full p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Название поля"})}),J.jsxs("select",{value:e.type,onChange:e=>{const s=[...Mc.leadFormFields];s[t].type=e.target.value,Lc({...Mc,leadFormFields:s})},className:"p-2 border border-gray-300 rounded-lg text-sm",children:[J.jsx("option",{value:"text",children:"Текст"}),J.jsx("option",{value:"email",children:"Email"}),J.jsx("option",{value:"tel",children:"Телефон"})]}),J.jsxs("label",{className:"flex items-center gap-2",children:[J.jsx("input",{type:"checkbox",checked:e.required,onChange:e=>{const s=[...Mc.leadFormFields];s[t].required=e.target.checked,Lc({...Mc,leadFormFields:s})},className:"w-4 h-4"}),J.jsx("span",{className:"text-sm",children:"Обязательное"})]}),J.jsx("button",{onClick:()=>{const e=Mc.leadFormFields.filter((e,s)=>s!==t);Lc({...Mc,leadFormFields:e})},className:"text-red-500 hover:text-red-700",children:J.jsx(vm,{className:"w-4 h-4"})})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.leadFormFields,{name:"",label:"",type:"text",required:!1}];Lc({...Mc,leadFormFields:e})},className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-gray-400 hover:text-gray-600 transition-colors",children:"+ Добавить поле"})]})]})]})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Предложения"}),J.jsxs("div",{className:"space-y-4",children:[Mc.quickReplies.map((e,t)=>J.jsxs("div",{className:"flex items-center border rounded-md p-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.quickReplies];s[t]=e.target.value,Lc({...Mc,quickReplies:s})},className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",placeholder:`Сообщение ${t+1}`}),J.jsx("button",{onClick:()=>{const e=Mc.quickReplies.filter((e,s)=>s!==t);Lc({...Mc,quickReplies:e})},className:"ml-2 text-red-400 hover:text-red-600",children:J.jsx(vm,{className:"w-4 h-4"})})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.quickReplies,""];Lc({...Mc,quickReplies:e})},className:"text-blue-400 hover:text-blue-600 font-medium",children:"+ Добавить сообщение"}),J.jsx("p",{className:"text-sm text-gray-500",children:"Укажите сообщения, которые будут автоматически видны в виджете и предложены пользователю для отправки"})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Приветственные сообщения"}),J.jsxs("div",{className:"space-y-4",children:[Mc.welcomeMessages.map((e,t)=>J.jsxs("div",{className:"flex items-center border rounded-md p-2",children:[J.jsx("input",{type:"text",value:e,onChange:e=>{const s=[...Mc.welcomeMessages];s[t]=e.target.value,Lc({...Mc,welcomeMessages:s})},className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",placeholder:`Сообщение ${t+1}`}),J.jsx("button",{onClick:()=>{const e=Mc.welcomeMessages.filter((e,s)=>s!==t);Lc({...Mc,welcomeMessages:e})},className:"ml-2 text-red-400 hover:text-red-600",children:J.jsx(vm,{className:"w-4 h-4"})})]},t)),J.jsx("button",{onClick:()=>{const e=[...Mc.welcomeMessages,""];Lc({...Mc,welcomeMessages:e})},className:"text-blue-400 hover:text-blue-600 font-medium",children:"+ Добавить сообщение"}),J.jsx("p",{className:"text-sm text-gray-500",children:"Укажите приветственные сообщения от ассистента, которые будут автоматически видны в начале каждого диалога"})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Логотип и брендинг"}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[J.jsx("div",{className:"space-y-4",children:J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Название рядом с логотипом"}),J.jsx("input",{type:"text",value:Mc.buttonText,onChange:e=>Lc({...Mc,buttonText:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md text-sm",placeholder:"Введите название"}),J.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Текст, отображаемый рядом с логотипом в виджете."})]})}),J.jsx("div",{className:"space-y-4",children:J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ссылка на логотип"}),J.jsx("input",{type:"url",value:Mc.logoUrl||"",onChange:e=>Lc({...Mc,logoUrl:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-md text-sm",placeholder:"Введите ссылку на логотип"}),J.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Вставьте URL логотипа вашей компании, который будет отображаться в виджете."})]})})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Код для вставки"}),J.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:J.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:["Вставьте этот фрагмент кода внутри тега ",J.jsx("span",{className:"font-semibold text-blue-700",children:"<body>"})," на каждой странице, где вы хотите, чтобы отображался виджет."]})}),J.jsxs("div",{className:"bg-gray-900 rounded-lg overflow-hidden",children:[J.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800",children:[J.jsx("span",{className:"text-gray-200 font-mono text-sm",children:"HTML"}),J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("button",{onClick:()=>{navigator.clipboard.writeText(qc()),Oc("Код скопирован!")},className:"text-gray-200 hover:text-white transition-colors text-sm",children:"Копировать"}),J.jsx("button",{onClick:Wc,className:"text-gray-200 hover:text-white transition-colors text-sm underline",children:"Открыть в новой вкладке"})]})]}),J.jsx("pre",{className:"p-4 text-gray-200 text-sm overflow-x-auto",children:J.jsx("code",{children:qc()})})]})]}),J.jsxs("div",{className:"border-t pt-6",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Превью виджета"}),J.jsxs("div",{className:"flex items-center justify-between mb-3",children:[J.jsx("p",{className:"text-sm text-gray-600",children:"Предпросмотр открывается с тем же скриптом, что вставляется на сайт."}),J.jsx("button",{onClick:Wc,className:"px-3 py-1.5 rounded-md text-sm bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"Открыть в новой вкладке"})]}),J.jsx("div",{className:"border rounded-lg shadow-inner h-96 overflow-hidden relative",children:J.jsx("iframe",{src:(()=>{Mc.accentColor,Mc.buttonText,Mc.buttonColor,Mc.buttonColor,Mc.customButtonColor,Mc.widgetMode,Mc.quickQuestions,Mc.leadFormEnabled,Mc.leadFormTitle,Mc.leadFormDescription,Mc.leadFormFields,Mc.welcomeMessages,Mc.quickReplies,Mc.logoUrl,Mc.logoName,Mc.suggestions,Mc.triggerQuestionEnabled,Mc.triggerQuestionDelay,Mc.triggerQuestionText,Mc.followUpMessage,Mc.followUpDelay,Mc.followUpQuestion,Mc.followUpQuickReply,Mc.privacyPolicyUrl,Mc.dataTags,Mc.widgetLocation,Mc.desktopBottomOffset,Mc.desktopRightOffset,Mc.mobileBottomOffset,Mc.mobileRightOffset,Mc.zIndex,Mc.avatar;const e=(null==r?void 0:r.id)?`adapto_${r.id}`:"adapto_demo";return`${$m}/widget-preview.html?key=${e}&noCache=1&ts=${Date.now()}`})(),title:"Widget Preview",className:"w-full h-full",style:{border:"none"}})})]}),J.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[J.jsx(og,{variant:"outline",onClick:()=>{const e=`https://adaptoai.ru/preview.html?settings=${encodeURIComponent(JSON.stringify(Mc))}`;window.open(e,"_blank")},children:"Предосмотр"}),J.jsx(og,{onClick:()=>{localStorage.setItem("widgetDevelopmentSettings",JSON.stringify(Mc)),Oc("Настройки виджета сохранены!"),de(!1)},children:"Сохранить"})]})]})})]})]}),ne&&ae&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>re(!1)}),J.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[J.jsx("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("button",{onClick:()=>re(!1),className:"text-gray-400 hover:text-gray-600",children:"←"}),J.jsxs("h3",{className:"text-xl font-semibold",children:["Установка ",ae.name]})]})}),J.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx("img",{src:`/${ae.icon}`,alt:ae.name,className:"w-12 h-12"}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-lg font-medium",children:ae.name}),J.jsx("p",{className:"text-gray-600",children:ae.description})]})]}),J.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[J.jsx("h5",{className:"font-medium mb-3",children:"Инструкция по установке:"}),J.jsxs("div",{className:"space-y-3 text-sm",children:[J.jsxs("p",{children:["1. Перейдите в настройки вашего ",ae.name]}),J.jsx("p",{children:'2. Найдите раздел "Интеграции" или "API"'}),J.jsx("p",{children:"3. Скопируйте ваш API ключ"}),J.jsx("p",{children:"4. Вставьте ключ в поле ниже"}),J.jsx("p",{children:'5. Нажмите "Подключить"'})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"API Ключ"}),J.jsx(cg,{placeholder:"Введите ваш API ключ",className:"w-full"})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx(og,{onClick:()=>{return e=ae.id,Rn(t=>t.map(t=>t.id===e?{...t,installed:!0}:t)),re(!1),ie(null),void Oc("Интеграция успешно установлена!");var e},className:"flex-1",children:"Подключить"}),J.jsx(og,{variant:"outline",onClick:()=>re(!1),children:"Отмена"})]})]})})]})]}),On&&$n&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Pn(!1)}),J.jsx("div",{className:"relative bg-white rounded-xl w-full max-w-md mx-4 p-6",children:J.jsxs("div",{className:"text-center",children:[J.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Удалить интеграцию?"}),J.jsxs("p",{className:"text-gray-600 mb-6",children:["Вы действительно хотите удалить интеграцию с ",$n.name,"? Это действие нельзя отменить."]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx(og,{onClick:()=>{$n&&(Rn(e=>e.map(e=>e.id===$n.id?{...e,installed:!1}:e)),Pn(!1),Bn(null),Oc("Интеграция удалена"))},variant:"destructive",className:"flex-1",children:"Да, удалить"}),J.jsx(og,{variant:"outline",onClick:()=>Pn(!1),className:"flex-1",children:"Нет, отмена"})]})]})})]}),I&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:J.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[J.jsxs("div",{className:"flex items-center justify-between mb-6",children:[J.jsx("h2",{className:"text-[20px] font-[500]",children:"Настройка вашего ИИ-агента"}),J.jsx(og,{variant:"ghost",onClick:()=>M(!1),children:J.jsx(vm,{className:"w-4 h-4"})})]}),J.jsxs("div",{className:"mb-8",children:[J.jsxs("div",{className:"flex items-center justify-between mb-2",children:[J.jsxs("span",{className:"text-sm font-medium",children:["Шаг ",K," из 4"]}),J.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(K/4*100),"%"]})]}),J.jsx("div",{className:"w-full bg-gray-200 rounded-[90px] h-2",children:J.jsx("div",{className:"bg-blue-600 h-2 rounded-[90px] transition-all duration-300",style:{width:K/4*100+"%"}})})]}),1===K&&J.jsxs("div",{className:"space-y-6",children:[J.jsx("h3",{className:"text-xl font-semibold",children:"Шаг 1: Уточните цели Adapto"}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"1. Какую задачу должен выполнять Адапто?"}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[J.jsx("button",{onClick:()=>Fr({...kr,task:"Продавать"}),className:"p-4 rounded-lg border-2 transition-all "+("Продавать"===kr.task?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"Продавать"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Помогать в продажах"})]})}),J.jsx("button",{onClick:()=>Fr({...kr,task:"Консультировать"}),className:"p-4 rounded-lg border-2 transition-all "+("Консультировать"===kr.task?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium mb-1",children:"Консультировать"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Давать консультации"})]})})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"2. Какая главная цель ии-агента?"}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[["Записать на консультацию","Продать продукт","Решить проблему клиента"].map(e=>J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:e}),className:"p-4 rounded-lg border-2 transition-all "+(kr.mainGoal===e?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsx("div",{className:"text-center",children:J.jsx("div",{className:"text-lg font-medium",children:e})})},e)),J.jsx("button",{onClick:()=>Fr({...kr,mainGoal:"custom"}),className:"p-4 rounded-lg border-2 transition-all "+("custom"===kr.mainGoal?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-lg font-medium",children:"Другое"}),J.jsx("div",{className:"text-sm text-gray-600",children:"Указать свою цель"})]})})]}),"custom"===kr.mainGoal&&J.jsx("div",{className:"mt-3",children:J.jsx(cg,{value:kr.customGoal||"",onChange:e=>Fr({...kr,customGoal:e.target.value}),placeholder:"Укажите вашу главную цель",className:"w-full"})})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-2 font-medium",children:"3. Какой цикл сделки у вас в компании?"}),J.jsx(dg,{value:kr.dealCycle||"",onChange:e=>Fr({...kr,dealCycle:e.target.value}),placeholder:"Опишите цикл сделки в вашей компании...",className:"min-h-[100px]"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-2 font-medium",children:"4. Целевая аудитория"}),J.jsx(dg,{value:kr.targetAudience||"",onChange:e=>Fr({...kr,targetAudience:e.target.value}),placeholder:"Опишите вашу целевую аудиторию...",className:"min-h-[100px]"})]})]}),2===K&&J.jsxs("div",{className:"space-y-6",children:[J.jsx("h3",{className:"text-xl font-semibold",children:"Шаг 2: Правила общения"}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"Обращение к пользователю"}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>Fr({...kr,addressing:"Ты"}),className:"flex-1 border rounded-[90px] h-12 transition-colors "+("Ты"===kr.addressing?"bg-[#0084FF] text-white border-[#0084FF]":"bg-white hover:bg-gray-50 border-gray-200"),children:'На "Ты"'}),J.jsx("button",{onClick:()=>Fr({...kr,addressing:"Вы"}),className:"flex-1 border rounded-[90px] h-12 transition-colors "+("Вы"===kr.addressing?"bg-[#0084FF] text-white border-[#0084FF]":"bg-white hover:bg-gray-50 border-gray-200"),children:'На "Вы"'})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"2. Стиль общения"}),J.jsx("div",{className:"flex flex-wrap gap-3",children:[{text:"Дружелюбный",emoji:"😊"},{text:"Нейтральный",emoji:"😐"},{text:"Профессиональный",emoji:"💼"},{text:"Юмористический",emoji:"😄"}].map(e=>J.jsxs("button",{onClick:()=>Fr({...kr,communicationStyle:e.text}),className:"px-6 py-3 rounded-[90px] border flex items-center gap-2 "+(kr.communicationStyle===e.text?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50"),children:[J.jsx("span",{children:e.emoji}),J.jsx("span",{children:e.text})]},e.text))})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"3. Ограничения Адапто"}),J.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Не обсуждай цены","Не давай финансовых советов","Не консультируй по юридическим вопросам","Не разъясняй условия договоров","Не создавай обязательств от лица компании","Не подтверждай наличие товара или услуги"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.restrictions||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,restrictions:s})},className:"px-4 py-2 rounded-[90px] border-2 transition-all text-sm "+((kr.restrictions||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e)),J.jsx("button",{onClick:()=>Fr({...kr,showCustomRestriction:!0}),className:"px-4 py-2 rounded-[90px] border-2 border-gray-200 bg-white text-gray-700 hover:border-gray-300 text-sm",children:"Другое"})]}),kr.showCustomRestriction&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customRestriction||"",onChange:e=>Fr({...kr,customRestriction:e.target.value}),placeholder:"Введите ваше ограничение",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customRestriction){const e=kr.restrictions||[];Fr({...kr,restrictions:[...e,kr.customRestriction],customRestriction:"",showCustomRestriction:!1})}},disabled:!kr.customRestriction,children:"Добавить"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"4. Дополнительные настройки стиля общения под вашу компанию"}),J.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:["Не гарантировать результат","Пояснять ссылки перед отправкой","Проверять понимание ответа","Избегать длинных сообщений","Уточнять задачу в начале общения","Не оказывать давление на клиента","Предупреждать об ожидании ответа","Избегать споров","Отвечать от первого лица"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.communicationSettings||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,communicationSettings:s})},className:"p-3 rounded-lg border-2 transition-all text-left "+((kr.communicationSettings||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e))}),J.jsx("div",{className:"mt-3",children:J.jsx(cg,{value:kr.customCommunicationSetting||"",onChange:e=>Fr({...kr,customCommunicationSetting:e.target.value}),placeholder:"Добавить свое правило общения",className:"w-full"})})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"5. Сбор данных"}),J.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:["Имя","Номер телефона","Почта","Адрес доставки","Город","Возраст"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.dataCollection||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,dataCollection:s})},className:"p-2 rounded-lg border-2 transition-all text-sm "+((kr.dataCollection||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e))}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>Fr({...kr,dataCollection:[]}),className:"px-4 py-2 rounded-lg border-2 transition-all "+(0===(kr.dataCollection||[]).length?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:"Не собирать данные"}),J.jsx("button",{onClick:()=>Fr({...kr,showCustomData:!0}),className:"px-4 py-2 rounded-lg border-2 border-gray-200 bg-white text-gray-700 hover:border-gray-300",children:"Добавить данные"})]}),kr.showCustomData&&J.jsxs("div",{className:"mt-3 flex gap-2",children:[J.jsx(cg,{value:kr.customData||"",onChange:e=>Fr({...kr,customData:e.target.value}),placeholder:"Введите тип данных для сбора",className:"flex-1"}),J.jsx(og,{onClick:()=>{if(kr.customData){const e=kr.dataCollection||[];Fr({...kr,dataCollection:[...e,kr.customData],customData:"",showCustomData:!1})}},disabled:!kr.customData,children:"Добавить"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"6. Уточнение и вопросы"}),J.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["Если запрос неполный","Если клиент сомневается","Если есть риск ошибки","При выборе продукта или услуги","Если ответ зависит от тонкостей","Если клиент проявляет интерес к нескольким вариантам","Если клиент не понимает предложенное","Если требуется индивидуальный подбор","Если клиент задаёт вопросы вне своей компетенции","Если клиент спрашивает о вещах, которые требует специальных знаний","При оформлении заявки или заказа","Перед тем как оформить что-то важное","Если клиент долго молчит"].map(e=>J.jsx("button",{onClick:()=>{const t=kr.clarificationQuestions||[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];Fr({...kr,clarificationQuestions:s})},className:"p-3 rounded-lg border-2 transition-all text-left text-sm "+((kr.clarificationQuestions||[]).includes(e)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:e},e))})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block mb-3 font-medium",children:"7. Отправка смайликов"}),J.jsx("div",{className:"flex gap-3",children:[{text:"Никогда",emoji:"😐"},{text:"Редко",emoji:"😊"},{text:"Часто",emoji:"😄"}].map(e=>J.jsx("button",{onClick:()=>Fr({...kr,emojiUsage:e.text}),className:"flex-1 p-4 rounded-lg border-2 transition-all "+(kr.emojiUsage===e.text?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"text-2xl mb-2",children:e.emoji}),J.jsx("div",{className:"font-medium",children:e.text})]})},e.text))})]})]}),3===K&&J.jsxs("div",{className:"space-y-6",children:[J.jsx("h3",{className:"text-xl font-semibold",children:"Шаг 3: Этапы диалога"}),J.jsx("p",{className:"text-gray-600",children:"Опишите идеальный скрипт"}),J.jsx("p",{className:"text-gray-600",children:"Чем лучше вы опишите ваш скрипт, тем лучше ии-агент сможет выполнять задачи."}),J.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:J.jsxs("div",{className:"flex items-start gap-3",children:[J.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-[90px] flex items-center justify-center flex-shrink-0 mt-0.5",children:J.jsx("span",{className:"text-white text-sm",children:"!"})}),J.jsxs("div",{children:[J.jsx("div",{className:"font-medium text-blue-800 mb-1",children:"Уделите время детальному описанию идеального скрипта"}),J.jsx("div",{className:"text-sm text-blue-700",children:"Это очень важно для хорошей работы вашего ИИ-продажника. Вы сможете скорректировать поведение позже, но правильная настройка сейчас даст лучшие результаты сразу. Ниже представлен шаблон, который вам нужно адаптировать."})]})]})}),J.jsxs("div",{className:"space-y-4",children:[(kr.dialogStages||["🎯 УСТАНОВЛЕНИЕ КОНТАКТА: Поздоровайся тепло, представься как ИИ-помощник. Спроси имя клиента и как дела. Создай дружелюбную атмосферу.","🔍 ВЫЯСНЕНИЕ ПОТРЕБНОСТЕЙ: Задавай открытые вопросы о проблемах клиента, целях и ситуации. Уточни детали: бюджет, сроки, приоритеты.","💡 ПРЕЗЕНТАЦИЯ И ЗАКРЫТИЕ: Предложи решение на основе потребностей. Расскажи о преимуществах и выгодах. При возражениях - выясни причину и предложи альтернативы. Когда готов - подведи итоги и предложи оформить заказ."]).map((e,t)=>J.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:J.jsxs("div",{className:"flex items-start gap-3",children:[J.jsx("div",{className:"w-6 h-6 bg-gray-500 rounded-[90px] flex items-center justify-center flex-shrink-0 mt-0.5",children:J.jsx("span",{className:"text-white text-sm",children:t+1})}),J.jsx("div",{className:"flex-1",children:J.jsx(dg,{value:e,onChange:e=>{const s=[...kr.dialogStages||[]];s[t]=e.target.value,Fr({...kr,dialogStages:s,dialogStagesModified:!0})},className:"w-full resize-none",rows:2})}),J.jsx(og,{variant:"ghost",size:"sm",onClick:()=>{const e=[...kr.dialogStages||[]];e.splice(t,1),Fr({...kr,dialogStages:e,dialogStagesModified:!0})},children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4"})})]})},t)),J.jsxs(og,{variant:"outline",onClick:()=>{const e=[...kr.dialogStages||[],"Новый этап диалога"];Fr({...kr,dialogStages:e,dialogStagesModified:!0})},className:"w-full",children:[J.jsx(mm,{className:"w-4 h-4 mr-2"}),"Добавить этап"]})]}),!1===kr.dialogStagesModified&&J.jsx("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:J.jsxs("div",{className:"flex items-start gap-3",children:[J.jsx("div",{className:"w-6 h-6 bg-yellow-500 rounded-[90px] flex items-center justify-center flex-shrink-0 mt-0.5",children:J.jsx("span",{className:"text-white text-sm",children:"⚠"})}),J.jsxs("div",{children:[J.jsx("div",{className:"font-medium text-yellow-800 mb-1",children:"Вы не внесли никаких изменений"}),J.jsx("div",{className:"text-sm text-yellow-700 mb-3",children:"Он не адаптирован под ваш бизнес это может сказаться на эффективности ии-агента."}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx(og,{variant:"outline",onClick:()=>Fr({...kr,dialogStagesModified:!0}),children:"Внести изменения"}),J.jsx(og,{onClick:()=>Fr({...kr,dialogStagesModified:!0}),children:"Продолжить без изменений"})]})]})]})})]}),4===K&&J.jsxs("div",{className:"space-y-6",children:[J.jsx("h3",{className:"text-xl font-semibold",children:"Шаг 4: Обучение Адапто"}),J.jsx("p",{className:"text-gray-600",children:"Загрузите минимум 1 ресурс с информацией о компании, чтобы Адапто смог обучиться на ней"}),J.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"site",name:"Сайт",description:"Добавить URL вашего сайта",icon:hm},{id:"feed",name:"Товарный фид",description:"CSV/XML фид или ссылка на каталог",icon:um},{id:"text",name:"Написать самому",description:"Ввести информацию вручную",icon:fm},{id:"file",name:"Файл",description:"PDF, Word, Excel, TXT, CSV, XML",icon:bm}].map(e=>J.jsx("button",{onClick:()=>Fr({...kr,selectedKnowledgeType:e.id}),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors text-left",children:J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:J.jsx(e.icon,{className:"w-5 h-5 text-blue-600"})}),J.jsxs("div",{children:[J.jsx("div",{className:"font-medium",children:e.name}),J.jsx("div",{className:"text-sm text-gray-600",children:e.description})]})]})},e.id))}),kr.selectedKnowledgeType&&J.jsxs("div",{className:"mt-6 p-4 border border-blue-200 rounded-lg bg-blue-50",children:[J.jsxs("h4",{className:"font-medium mb-3",children:["site"===kr.selectedKnowledgeType&&"Добавить URL сайта","feed"===kr.selectedKnowledgeType&&"Загрузить CSV/XML фид","text"===kr.selectedKnowledgeType&&"Ввести информацию вручную","file"===kr.selectedKnowledgeType&&"Загрузить файл (PDF, Word, Excel, TXT, CSV, XML)"]}),"site"===kr.selectedKnowledgeType&&J.jsxs("div",{className:"space-y-3",children:[J.jsx(cg,{value:kr.knowledgeInput||"",onChange:e=>Fr({...kr,knowledgeInput:e.target.value}),placeholder:"https://example.com",className:"w-full"}),J.jsx(og,{onClick:async()=>{if(kr.knowledgeInput){const e={type:"site",content:kr.knowledgeInput,nicheId:ia};await dd(e),Fr({...kr,knowledgeInput:"",selectedKnowledgeType:null})}},disabled:!kr.knowledgeInput,children:"Добавить сайт"})]}),"text"===kr.selectedKnowledgeType&&J.jsxs("div",{className:"space-y-3",children:[J.jsx(dg,{value:kr.knowledgeInput||"",onChange:e=>Fr({...kr,knowledgeInput:e.target.value}),placeholder:"Введите информацию о вашей компании, продуктах, услугах...",className:"w-full min-h-[120px]"}),J.jsx(og,{onClick:async()=>{if(kr.knowledgeInput){const e={type:"text",content:kr.knowledgeInput,nicheId:ia};await dd(e),Fr({...kr,knowledgeInput:"",selectedKnowledgeType:null})}},disabled:!kr.knowledgeInput,children:"Добавить текст"})]}),"file"===kr.selectedKnowledgeType&&J.jsxs("div",{className:"space-y-3",children:[J.jsx(cg,{type:"file",onChange:e=>{var t,s;return Fr({...kr,knowledgeInput:(null==(s=null==(t=e.target.files)?void 0:t[0])?void 0:s.name)||""})},className:"w-full"}),J.jsx(og,{onClick:async()=>{if(kr.knowledgeInput){const e={type:"file",content:kr.knowledgeInput,nicheId:ia};await dd(e),Fr({...kr,knowledgeInput:"",selectedKnowledgeType:null})}},disabled:!kr.knowledgeInput,children:"Загрузить файл"})]}),"feed"===kr.selectedKnowledgeType&&J.jsxs("div",{className:"space-y-3",children:[J.jsx(cg,{type:"file",accept:".csv,.xml",onChange:e=>{var t,s;return Fr({...kr,knowledgeInput:(null==(s=null==(t=e.target.files)?void 0:t[0])?void 0:s.name)||""})},className:"w-full"}),J.jsx(og,{onClick:async()=>{if(kr.knowledgeInput){const e={type:"feed",content:kr.knowledgeInput,nicheId:ia};await dd(e),Fr({...kr,knowledgeInput:"",selectedKnowledgeType:null})}},disabled:!kr.knowledgeInput,children:"Загрузить CSV/XML фид"})]})]}),kr.knowledgeItems&&kr.knowledgeItems.length>0&&J.jsxs("div",{className:"mt-4",children:[J.jsx("h4",{className:"font-medium mb-2",children:"Добавленные ресурсы:"}),J.jsx("div",{className:"space-y-2",children:kr.knowledgeItems.map((e,t)=>J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsxs("div",{className:"w-8 h-8 bg-blue-100 rounded-[90px] flex items-center justify-center",children:[("site"===e.type||"website"===e.type)&&J.jsx(hm,{className:"w-4 h-4 text-blue-600"}),"text"===e.type&&J.jsx(fm,{className:"w-4 h-4 text-blue-600"}),"file"===e.type&&J.jsx(um,{className:"w-4 h-4 text-blue-600"}),"feed"===e.type&&J.jsx(um,{className:"w-4 h-4 text-blue-600"})]}),J.jsx("span",{className:"text-sm",children:e.content})]}),J.jsx("div",{className:"text-xs text-green-600",children:"✓ Добавлено"})]},t))})]})]}),J.jsxs("div",{className:"flex justify-between mt-8",children:[J.jsx(og,{variant:"outline",onClick:()=>G(Math.max(1,K-1)),disabled:1===K,children:"Назад"}),K<4?J.jsx(og,{onClick:()=>{if(3===K){const e=["Поздоровайся и спроси имя клиента. Уточни его проблему и пойми текущую ситуацию пользователя","Опиши коротко как решишь его задачу/назови наши преимущества, предложи товары по запросу","Веди клиента к оформлению заказа/заявки","Когда клиент готов оформить заказ, сделай итог заказа и пришли ссылку на оплату из базы знаний.","Переведи клиента на менеджера для проверки оплаты и дальнейшей работы"],t=kr.dialogStages||[];t.length!==e.length||t.some((t,s)=>t!==e[s])?(Fr({...kr,dialogStagesModified:!0}),G(K+1)):Fr({...kr,dialogStagesModified:!1})}else G(K+1)},disabled:1===K&&!kr.task||2===K&&(!kr.addressing||!kr.communicationStyle)||3===K&&(!kr.dialogStages||0===kr.dialogStages.length),children:"Далее"}):J.jsx(og,{onClick:()=>{localStorage.setItem("hasShownSetupWizard","true"),M(!1),Wn(!0)},disabled:!kr.knowledgeItems||0===kr.knowledgeItems.length,children:"Завершить настройку"})]})]})}),qn&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white",children:J.jsxs("div",{className:"text-center max-w-md mx-4",children:[J.jsxs("div",{className:"mb-8",children:[J.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-[90px] animate-spin mx-auto mb-4"}),J.jsx("h2",{className:"text-[20px] font-[500] text-gray-800 mb-2",children:"Настраиваем модель"}),J.jsx("p",{className:"text-gray-600 mb-4",children:"Пожалуйста, подождите. Мы настраиваем вашу модель под ваши требования."}),J.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-4",children:[Math.floor(Hn/60),":",(Hn%60).toString().padStart(2,"0")]}),J.jsxs("div",{className:"space-y-3",children:[J.jsxs("div",{className:"flex items-center justify-between text-sm",children:[J.jsx("span",{children:"Анализ целей и задач"}),J.jsx("span",{className:"text-green-600",children:"✓"})]}),J.jsxs("div",{className:"flex items-center justify-between text-sm",children:[J.jsx("span",{children:"Настройка стиля общения"}),J.jsx("span",{className:"text-green-600",children:"✓"})]}),J.jsxs("div",{className:"flex items-center justify-between text-sm",children:[J.jsx("span",{children:"Создание диалоговых сценариев"}),J.jsx("span",{className:"text-green-600",children:"✓"})]}),J.jsxs("div",{className:"flex items-center justify-between text-sm",children:[J.jsx("span",{children:"Обучение на базе знаний"}),J.jsx("span",{className:"text-blue-600",children:"⏳"})]}),J.jsxs("div",{className:"flex items-center justify-between text-sm",children:[J.jsx("span",{children:"Финальная настройка модели"}),J.jsx("span",{className:"text-gray-400",children:"○"})]})]})]}),J.jsx("div",{className:"w-full bg-gray-200 rounded-[90px] h-2",children:J.jsx("div",{className:"bg-blue-600 h-2 rounded-[90px] transition-all duration-1000",style:{width:(300-Hn)/300*100+"%"}})})]})}),ba&&J.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(7, 15, 26, 0.2)"},onClick:md,children:J.jsx("div",{className:"bg-white rounded-[20px] w-[700px] max-h-[90vh] overflow-y-auto relative",onClick:e=>e.stopPropagation(),children:J.jsxs("div",{className:"p-[20px]",children:[J.jsxs("div",{className:"flex items-center justify-between mb-[12px]",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Как импортировать знания?"}),J.jsx("button",{onClick:md,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx(vm,{className:"w-5 h-5 text-gray-500"})})]}),J.jsx("p",{className:"text-[#8E8E93] text-[14px] mb-[30px]",children:"Выберите, как вы хотите поделиться знаниями. Это научит ИИ, как отвечать на вопросы, связанные с вашим бизнесом"}),J.jsxs("div",{className:"flex gap-[20px] mb-[30px]",children:[J.jsx("div",{className:"w-[315px] h-[84px] border rounded-[15px] cursor-pointer transition-all "+("full"===Da?"border-[#0084FF]/60 bg-[#FFFFFF]":"border-[#070F1A]/10 bg-white"),onClick:()=>Ia("full"),children:J.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-2 "+("full"===Da?"text-[#070F1A]":"text-[#8E8E93]/70"),children:"Сканировать весь сайт"}),J.jsx("p",{className:"text-[12px] font-[400] text-center px-4 "+("full"===Da?"text-[#8E8E93]":"text-[#8E8E93]/70"),children:"ИИ будет брать знания со всех страниц сайта"})]})}),J.jsx("div",{className:"w-[315px] h-[84px] border rounded-[15px] cursor-pointer transition-all "+("selective"===Da?"border-[#0084FF]/60 bg-[#FFFFFF]":"border-[#070F1A]/10 bg-white"),onClick:()=>Ia("selective"),children:J.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[J.jsx("h3",{className:"text-[16px] font-[500] mb-2 "+("selective"===Da?"text-[#070F1A]":"text-[#8E8E93]/70"),children:"Сканировать страницы"}),J.jsx("p",{className:"text-[12px] font-[400] text-center px-4 "+("selective"===Da?"text-[#8E8E93]":"text-[#8E8E93]/70"),children:"Выберите определенные страницы сайта"})]})})]}),"full"===Da?J.jsx("div",{className:"space-y-[30px]",children:J.jsxs("div",{children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] mb-[20px]",children:"Предоставить URL-адрес"}),J.jsx("div",{className:"w-[650px] h-[34px] bg-white border rounded-[10px] flex items-center px-3 "+(Pa?"border-red-500":"border-[#070F1A]/10"),style:Nm.inputField,children:J.jsx("input",{type:"url",value:Ma,onChange:e=>(e=>{La(e);const t=hc(e);$a(t)})(e.target.value),placeholder:"https://mypage.com",className:"flex-1 bg-transparent text-[13px] font-[500] text-[#070F1A] placeholder-[#070F1A]/30 outline-none"})}),Pa&&J.jsx("p",{className:"text-red-500 text-[12px] mt-1",children:Pa})]})}):J.jsx("div",{className:"space-y-[30px]",children:J.jsxs("div",{children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A] mb-[20px]",children:"Предоставить URL-адреса страниц"}),Ra.map((e,t)=>J.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[J.jsx("div",{className:"w-[650px] h-[40px] bg-white border rounded-[10px] flex items-center px-3 "+(Ba[t]?"border-red-500":"border-[#070F1A]/10"),style:Nm.inputField,children:J.jsx("input",{type:"url",value:e,onChange:e=>((e,t)=>{Oa(s=>s.map((s,n)=>n===e?t:s));const s=hc(t);za(t=>t.map((t,n)=>n===e?s:t))})(t,e.target.value),placeholder:"https://mypage.com",className:"flex-1 bg-transparent text-[13px] font-[500] text-[#070F1A] placeholder-[#070F1A]/30 outline-none"})}),Ra.length>1&&J.jsx("button",{onClick:()=>(e=>{Oa(t=>t.filter((t,s)=>s!==e)),za(t=>t.filter((t,s)=>s!==e))})(t),className:"w-8 h-8 flex items-center justify-center text-red-500 hover:bg-red-50 rounded-[8px] transition-colors",children:J.jsx("img",{src:"/traash.svg",alt:"Удалить",className:"w-4 h-4"})}),Ba[t]&&J.jsx("p",{className:"text-red-500 text-[12px] mt-1",children:Ba[t]})]},t)),J.jsx("button",{onClick:()=>{Oa(e=>[...e,""]),za(e=>[...e,""])},className:"h-[34px] px-4 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0084FF]/80 transition-colors text-[13px] font-[500]",style:jm.blueButton,children:"Добавить страницу"})]})}),J.jsxs("div",{className:"mt-[10px]",children:[J.jsx("p",{className:"text-[10px] text-[#8E8E93] mb-[30px]",children:"Этот процесс может занять несколько минут и будет продолжаться в фоновом режиме."}),J.jsx("div",{className:"flex justify-center",children:J.jsx("button",{onClick:async()=>{if(console.log("handleSiteImport called"),console.log("sitePopupTab:",Da),console.log("siteUrl:",Ma),console.log("selectedPages:",Ra),md(),"full"===Da){const e=hc(Ma);if(e)return $a(e),void Oc("Неверный URL сайта");const t={type:"site",content:Ma,status:"Обработка"};console.log("Adding full site item:",t),await dd(t)}else{const e=Ra.map(e=>hc(e));if(za(e),e.some(e=>e))return void Oc("Неверные URL страниц");const t=Ra.filter(e=>e.trim());if(0===t.length)return;for(const s of t){const e={type:"site",content:s,status:"Обработка"};console.log("Adding page item:",e),await dd(e)}}},disabled:"full"===Da&&(Pa||!Ma.trim())||"selective"===Da&&(Ba.some(e=>e)||0===Ra.filter(e=>e.trim()).length),className:"w-[650px] h-[34px] bg-[#0084FF] text-white font-[500] text-[13px] rounded-[10px] hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:jm.blueButton,children:"Начать импорт"})})]})]})})}),ya&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50",onClick:fd,children:J.jsxs("div",{className:"bg-white rounded-[20px] w-[700px] p-[20px]",onClick:e=>e.stopPropagation(),children:[J.jsxs("div",{className:"flex justify-between items-start mb-[12px]",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Загрузите товарный фид"}),J.jsx("button",{onClick:fd,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx(vm,{className:"w-5 h-5 text-gray-500"})})]}),J.jsx("p",{className:"text-[#8E8E93] text-[14px] mb-[30px]",children:"Вставьте ссылку на товарный фид (CSV/XML) или загрузите файл каталога"}),J.jsx("div",{className:"space-y-[30px]",children:J.jsxs("div",{children:[J.jsx("div",{className:"w-[650px] h-[34px] bg-white border rounded-[10px] flex items-center px-3 "+(Wa?"border-red-500":"border-[#070F1A]/10"),style:Nm.inputField,children:J.jsx("input",{type:"url",value:Ua,onChange:e=>(e=>{qa(e);const t=hc(e);Ha(t)})(e.target.value),placeholder:"https://example.com/feed.xml или https://example.com/products.csv",className:"flex-1 bg-transparent text-[13px] font-[500] text-[#070F1A] placeholder-[#070F1A]/30 outline-none"})}),Wa&&J.jsx("p",{className:"text-red-500 text-[12px] mt-1",children:Wa})]})}),J.jsxs("div",{className:"mt-[10px]",children:[J.jsx("p",{className:"text-[10px] text-[#8E8E93] mb-[30px]",children:"Этот процесс может занять несколько минут и будет продолжаться в фоновом режиме."}),J.jsx("div",{className:"flex justify-center",children:J.jsx("button",{onClick:async()=>{const e=hc(Ua);if(e)return void Ha(e);const t={type:"feed",content:Ua,status:"Обработка"};await dd(t),fd()},disabled:Wa||!Ua.trim(),className:"w-[650px] h-[34px] bg-[#0084FF] text-white font-[500] text-[13px] rounded-[10px] hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:jm.blueButton,children:"Начать импорт"})})]})]})}),ja&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50",onClick:vd,children:J.jsxs("div",{className:"bg-white rounded-[20px] w-[700px] p-[20px]",onClick:e=>e.stopPropagation(),children:[J.jsxs("div",{className:"flex justify-between items-start mb-[12px]",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Прикрепите файлы для импорта"}),J.jsx("button",{onClick:vd,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx(vm,{className:"w-5 h-5 text-gray-500"})})]}),J.jsx("p",{className:"text-[#8E8E93] text-[14px] mb-[30px]",children:"Поддерживается загрузка файлов формата: .docx, .doc, .pdf, .txt, .xls, .xlsx, .csv, .xml"}),J.jsxs("div",{className:"space-y-[30px]",children:[J.jsxs("div",{className:"border-2 border-dashed border-[#070F1A]/10 rounded-[10px] p-8 text-center",children:[J.jsx("input",{type:"file",multiple:!0,accept:".docx,.doc,.pdf,.txt,.xls,.xlsx,.csv,.xml",onChange:e=>{const t=Array.from(e.target.files);Va(t)},className:"hidden",id:"file-upload"}),J.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:J.jsxs("div",{className:"space-y-4",children:[J.jsx("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-[90px] flex items-center justify-center",children:J.jsx(bm,{className:"w-6 h-6 text-gray-400"})}),J.jsxs("div",{children:[J.jsx("p",{className:"text-[16px] font-[500] text-[#070F1A]",children:"Прикрепить файл"}),J.jsx("p",{className:"text-[12px] text-[#8E8E93] mt-1",children:"Максимум: 3 файла, 100 мегабайт за одну отправку."})]})]})})]}),Qa.length>0&&J.jsxs("div",{className:"space-y-4",children:[J.jsx("div",{className:"space-y-2",children:Qa.map((e,t)=>J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-[10px]",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx(um,{className:"w-5 h-5 text-blue-500"}),J.jsx("span",{className:"text-sm text-gray-700",children:e.name})]}),J.jsx("button",{onClick:()=>(e=>{Va(t=>t.filter((t,s)=>s!==e))})(t),className:"text-red-500 hover:text-red-700",children:J.jsx(vm,{className:"w-4 h-4"})})]},t))}),J.jsx("div",{className:"flex justify-end",children:J.jsxs("button",{onClick:async()=>{var e;if(0!==Qa.length)if(null==r?void 0:r.id){for(const s of Qa)try{Oc(`Начинаем обработку файла: ${s.name}`);const t=new FormData;t.append("file",s),t.append("userId",r.id),t.append("contentType","file");const n=await fetch(`${$m}/api/upload-file`,{method:"POST",body:t}),a=await n.json();if(a.success){const t={id:(null==(e=a.knowledge_item)?void 0:e.id)||pg(),type:"file",content:s.name,status:a.status||"Загружено",processed_content:a.analysis,created_at:(new Date).toISOString()};ta(e=>[...e,t]),Zr(!0),Oc(`✅ Файл ${s.name} успешно обработан!`)}else Oc(`❌ Ошибка обработки файла ${s.name}: ${a.message}`)}catch(t){console.error("File upload error:",t),Oc(`❌ Ошибка загрузки файла ${s.name}`)}vd()}else Oc("Необходимо войти в систему")},className:"px-6 py-2 bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors font-[500] text-[13px] flex items-center gap-2",style:jm.blueButton,children:[J.jsx(bm,{className:"w-4 h-4"}),"Загрузить в базу знаний"]})})]})]})]})}),ka&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50",onClick:wd,children:J.jsxs("div",{className:"bg-white rounded-[20px] w-[700px] p-[20px]",onClick:e=>e.stopPropagation(),children:[J.jsxs("div",{className:"flex justify-between items-start mb-[12px]",children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A]",children:"Добавить текст в базу знаний"}),J.jsx("button",{onClick:wd,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsx("p",{className:"text-[#8E8E93] text-[14px] mb-[30px]",children:"Введите текстовую информацию, которую должен знать ИИ-агент при общении с клиентами"}),J.jsx("div",{className:"space-y-[20px]",children:J.jsxs("div",{children:[J.jsx("textarea",{value:Ja,onChange:e=>{return t=e.target.value,Ya(t),void(t.trim()?Za(""):Za("Поле обязательно для заполнения"));var t},placeholder:"Введите информацию о вашей компании, услугах, ценах, условиях работы и т.д.",className:"w-full h-[200px] p-4 border rounded-[10px] text-[13px] resize-none "+(Xa?"border-red-500":"border-[#070F1A]/10 focus:outline-none"),style:Nm.inputField}),Xa&&J.jsx("p",{className:"text-red-500 text-[12px] mt-2",children:Xa})]})}),J.jsx("div",{className:"mt-[20px]",children:J.jsx("button",{onClick:async()=>{if(!Ja.trim())return void Za("Поле обязательно для заполнения");const e={type:"text",content:Ja.trim(),status:"Загружено"};await dd(e),wd()},disabled:(Ja||"").trim().length<50,className:"w-full h-[34px] text-[13px] font-[500] text-white bg-[#0084FF] rounded-[10px] hover:bg-[#0073E6] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:jm.blueButton,children:"Добавить в базу знаний"})})]})}),_a&&Ca&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50",onClick:()=>Ea(!1),children:J.jsxs("div",{className:"bg-white rounded-[20px] w-[800px] max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[J.jsxs("div",{className:"flex justify-between items-start mb-[20px] p-[20px] border-b border-[#070F1A]/10",children:[J.jsxs("div",{children:[J.jsx("h2",{className:"text-[20px] font-[500] text-[#070F1A] mb-2",children:"Подробности источника"}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("div",{className:"h-[24px] px-2 rounded-[7px] bg-gray-100 flex items-center gap-[2px]",children:[J.jsx("img",{src:"site"===(Ca.source_type||Ca.type)?"/global2.svg":"feed"===(Ca.source_type||Ca.type)?"/document-code.svg":"text"===(Ca.source_type||Ca.type)?"/edit-2.svg":"/document-copy.svg",alt:Ca.type,className:"w-[10px] h-[10px]"}),J.jsxs("span",{className:"text-[12px] font-[400] text-[#070F1A]",children:["site"===(Ca.source_type||Ca.type)&&"Сайт","feed"===(Ca.source_type||Ca.type)&&"Товарный фид","text"===(Ca.source_type||Ca.type)&&"Текст","file"===(Ca.source_type||Ca.type)&&"Файл","website"===(Ca.source_type||Ca.type)&&"Сайт"]})]}),J.jsx("div",{className:"h-[24px] px-3 rounded-[50px] flex items-center gap-2 "+("Загружено"===Ca.status?"bg-[#36C76A]/15 text-[#36C76A]":"Обработка"===Ca.status?"bg-[#0084FF]/15 text-[#0084FF]":"Ошибка"===Ca.status?"bg-[#FF3B30]/15 text-[#FF3B30]":"bg-[#0084FF]/15 text-[#0084FF]"),children:J.jsx("span",{className:"text-[12px] font-[400]",children:Ca.status||"Обработка..."})})]})]}),J.jsx("button",{onClick:()=>Ea(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx(vm,{className:"w-5 h-5 text-gray-500"})})]}),J.jsxs("div",{className:"p-[20px] space-y-6",children:[Ca.title&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Название"}),J.jsx("p",{className:"text-[14px] text-[#070F1A] bg-gray-50 p-3 rounded-[10px]",children:Ca.title})]}),Ca.source_url&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"URL"}),J.jsx("p",{className:"text-[14px] text-[#0084FF] bg-gray-50 p-3 rounded-[10px] break-all",children:J.jsx("a",{href:Ca.source_url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:Ca.source_url})})]}),Ca.original_content&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Исходный контент"}),J.jsx("div",{className:"bg-gray-50 p-4 rounded-[10px] max-h-[300px] overflow-y-auto",children:J.jsx("pre",{className:"text-[13px] text-[#070F1A] whitespace-pre-wrap font-sans",children:Ca.original_content})})]}),Ca.processed_content&&Ca.processed_content!==Ca.original_content&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Обработанный контент"}),J.jsx("div",{className:"bg-blue-50 p-4 rounded-[10px] max-h-[300px] overflow-y-auto",children:J.jsx("pre",{className:"text-[13px] text-[#070F1A] whitespace-pre-wrap font-sans",children:Ca.processed_content})})]}),Ca.structured_data&&Object.keys(Ca.structured_data).length>0&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Структурированные данные"}),J.jsx("div",{className:"bg-green-50 p-4 rounded-[10px] max-h-[300px] overflow-y-auto",children:J.jsx("pre",{className:"text-[13px] text-[#070F1A] whitespace-pre-wrap",children:JSON.stringify(Ca.structured_data,null,2)})})]}),Ca.chunks&&Ca.chunks.length>0&&J.jsxs("div",{children:[J.jsxs("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:["Созданные чанки (",Ca.chunks.length,")"]}),J.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:Ca.chunks.map((e,t)=>{var s,n;return J.jsxs("div",{className:"bg-yellow-50 p-3 rounded-[10px] border border-yellow-200",children:[J.jsxs("div",{className:"flex justify-between items-start mb-2",children:[J.jsxs("span",{className:"text-[12px] font-[500] text-[#070F1A]",children:["Чанк ",t+1]}),e.tokens_estimate&&J.jsxs("span",{className:"text-[12px] text-[#8E8E93]",children:[e.tokens_estimate," токенов"]})]}),J.jsxs("p",{className:"text-[13px] text-[#070F1A] mb-2",children:[null==(s=e.chunk_text)?void 0:s.substring(0,200),(null==(n=e.chunk_text)?void 0:n.length)>200&&"..."]}),e.chunk_summary&&J.jsxs("p",{className:"text-[12px] text-[#8E8E93] italic",children:["Резюме: ",e.chunk_summary]})]},t)})})]}),J.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ca.created_at&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Дата создания"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93]",children:new Date(Ca.created_at).toLocaleString("ru-RU")})]}),Ca.updated_at&&J.jsxs("div",{children:[J.jsx("h3",{className:"text-[16px] font-[500] text-[#070F1A] mb-2",children:"Последнее обновление"}),J.jsx("p",{className:"text-[14px] text-[#8E8E93]",children:new Date(Ca.updated_at).toLocaleString("ru-RU")})]})]})]}),J.jsx("div",{className:"p-[20px] border-t border-[#070F1A]/10",children:J.jsx("div",{className:"flex justify-end",children:J.jsx("button",{onClick:()=>Ea(!1),className:"h-[34px] px-6 text-[13px] font-[500] text-[#070F1A] bg-gray-100 rounded-[10px] hover:bg-gray-200 transition-colors",children:"Закрыть"})})})]})}),St&&Et&&J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9998]",style:{marginTop:0},onClick:()=>At(!1)}),J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px",marginTop:0},children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Детали клиента"}),J.jsx("button",{onClick:()=>At(!1),className:"w-8 h-8 rounded-[90px] bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[J.jsxs("div",{children:[J.jsx("h4",{className:"text-[16px] font-[500] text-[#070F1A] mb-3",children:"Контактная информация"}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Телефон:"}),J.jsx("span",{className:"text-[12px] text-[#070F1A]",children:Et.phone})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Email:"}),J.jsx("span",{className:"text-[12px] text-[#0084FF]",children:Et.email})]}),J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsx("span",{className:"text-[14px] font-[500] text-[#070F1A]",children:"Компания:"}),J.jsx("span",{className:"text-[12px] text-[#070F1A]",children:Et.company})]})]})]}),J.jsxs("div",{className:"space-y-3",children:[J.jsx("button",{onClick:()=>Mt(!0),className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors flex items-center justify-center",style:jm.blueButton,children:"Создать задачу"}),J.jsx("button",{className:"w-full h-[34px] text-[#070F1A] rounded-[10px] hover:bg-gray-50 transition-colors flex items-center justify-center",style:jm.whiteButton,children:"Перейти в диалог"}),J.jsx("button",{onClick:()=>{return e=Et.phone,void(window.confirm("Вы уверены, что хотите удалить этого клиента?")&&(console.log("Удаление клиента:",e),At(!1),Ct(null)));var e},className:"w-full h-[34px] bg-red-50 border border-red-100 text-red-500 rounded-[10px] text-[14px] font-[500] hover:bg-red-100 transition-colors flex items-center justify-center",children:"Удалить клиента"})]})]})]})})]}),Tt&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-10 z-[9998]",style:{marginTop:0},onClick:()=>Dt(!1),children:J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"16px",borderBottomLeftRadius:"16px",marginTop:0},onClick:e=>e.stopPropagation(),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Создать сделку"}),J.jsx("button",{onClick:()=>Dt(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-[500] text-[#070F1A] mb-2",children:"Название сделки"}),J.jsx("input",{type:"text",value:Lt.title,onChange:e=>Rt(t=>({...t,title:e.target.value})),placeholder:"Введите название сделки",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"})]}),J.jsxs("div",{className:"relative",children:[J.jsx("label",{className:"block text-[13px] font-[500] text-[#070F1A] mb-2",children:"Стадия"}),J.jsxs("button",{onClick:()=>Ts(e=>({...e,dealStage:!e.dealStage})),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 flex items-center justify-between",children:[J.jsx("span",{children:Lt.stage||"Выберите стадию"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[9px] h-[9px] transition-transform duration-300",style:{transform:(null==As?void 0:As.dealStage)?"rotate(-90deg)":"rotate(90deg)",filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})]}),(null==As?void 0:As.dealStage)&&J.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-[#070F1A]/10 rounded-[10px] shadow-lg z-50",children:J.jsx("div",{className:"p-[2px]",children:["Новые","В работе","Согласование","Закрытые"].map(e=>{const t=Lt.stage===e;return J.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-[10px] cursor-pointer h-[32px] "+(t?"bg-[#F2F3F4]":"hover:bg-[#F2F3F4]"),onMouseDown:t=>{t.preventDefault(),t.stopPropagation(),Rt(t=>({...t,stage:e})),Ts(e=>({...e,dealStage:!1}))},children:[t&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:e})]},e)})})})]}),J.jsxs("div",{className:"relative",children:[J.jsx("label",{className:"block text-[13px] font-[500] text-[#070F1A] mb-2",children:"Качество лида"}),J.jsxs("button",{onClick:()=>Ts(e=>({...e,leadQualityDeal:!e.leadQualityDeal})),className:"w-full h-[34px] px-3 border border-[#070F1A]/10 rounded-[10px] text-[14px] text-[#070F1A] focus:outline-none focus:ring-2 focus:ring-[#0084FF]/20 flex items-center justify-between",children:[J.jsx("span",{children:"hot"===Lt.leadQuality?"Горячий":"warm"===Lt.leadQuality?"Теплый":"cold"===Lt.leadQuality?"Холодный":"Выберите качество"}),J.jsx("img",{src:"/Bounds.svg",alt:"Раскрыть",className:"w-[9px] h-[9px] transition-transform duration-300",style:{transform:(null==As?void 0:As.leadQualityDeal)?"rotate(-90deg)":"rotate(90deg)",filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})]}),(null==As?void 0:As.leadQualityDeal)&&J.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-[#070F1A]/10 rounded-[10px] shadow-lg z-50",children:J.jsx("div",{className:"p-[2px]",children:[{key:"hot",label:"Горячий"},{key:"warm",label:"Теплый"},{key:"cold",label:"Холодный"}].map(e=>{const t=Lt.leadQuality===e.key;return J.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-[10px] cursor-pointer h-[32px] "+(t?"bg-[#F2F3F4]":"hover:bg-[#F2F3F4]"),onMouseDown:t=>{t.preventDefault(),t.stopPropagation(),Rt(t=>({...t,leadQuality:e.key})),Ts(e=>({...e,leadQualityDeal:!1}))},children:[t&&J.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",className:"w-3 h-3",children:J.jsx("path",{d:"M 1.5 6 L 4.5 9 L 10.5 3",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeDasharray:""})}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:e.label})]},e.key)})})})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-[500] text-[#070F1A] mb-2",children:"Сумма (₽)"}),J.jsx("input",{type:"number",value:Lt.amount,onChange:e=>Rt(t=>({...t,amount:e.target.value})),placeholder:"Введите сумму",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"})]}),J.jsxs("div",{children:[J.jsx("h4",{className:"text-[13px] font-[500] text-[#070F1A] mb-3",children:"Информация о клиенте"}),J.jsxs("div",{className:"space-y-3",children:[J.jsx("input",{type:"text",value:Lt.client.name,onChange:e=>Rt(t=>({...t,client:{...t.client,name:e.target.value}})),placeholder:"Имя клиента",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"}),J.jsx("input",{type:"email",value:Lt.client.email,onChange:e=>Rt(t=>({...t,client:{...t.client,email:e.target.value}})),placeholder:"Email клиента",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"}),J.jsx("input",{type:"tel",value:Lt.client.phone,onChange:e=>{let t=e.target.value.replace(/\D/g,"");t.length>0&&(t=t.length<=1?"+7 ("+t:t.length<=4?"+7 ("+t.slice(1):t.length<=7?"+7 ("+t.slice(1,4)+") "+t.slice(4):t.length<=9?"+7 ("+t.slice(1,4)+") "+t.slice(4,7)+"-"+t.slice(7):t.length<=11?"+7 ("+t.slice(1,4)+") "+t.slice(4,7)+"-"+t.slice(7,9)+"-"+t.slice(9):"+7 ("+t.slice(1,4)+") "+t.slice(4,7)+"-"+t.slice(7,9)+"-"+t.slice(9,11)),Rt(e=>({...e,client:{...e.client,phone:t}}))},placeholder:"+7 (___) ___-__-__",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"}),J.jsx("input",{type:"text",value:Lt.client.address||"",onChange:e=>Rt(t=>({...t,client:{...t.client,address:e.target.value}})),placeholder:"Адрес клиента",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"}),J.jsx("input",{type:"text",value:Lt.client.company,onChange:e=>Rt(t=>({...t,client:{...t.client,company:e.target.value}})),placeholder:"Компания клиента",className:"w-full h-[34px] px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none placeholder-[#8E8E93]"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Заметки"}),J.jsx("textarea",{value:Lt.notes,onChange:e=>Rt(t=>({...t,notes:e.target.value})),placeholder:"Дополнительная информация о сделке",rows:3,className:"w-full px-3 py-2 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none focus:border-[#0084FF] resize-none"})]})]}),J.jsxs("div",{className:"p-5 border-t border-[#E5E7EB] flex flex-col gap-2",children:[J.jsx("button",{onClick:()=>{var e,t;const s=((null==(e=null==Lt?void 0:Lt.client)?void 0:e.email)||"").trim(),n=((null==(t=null==Lt?void 0:Lt.client)?void 0:t.phone)||"").trim(),a=""===s||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),i=n.replace(/[^\d+]/g,""),l=""===n||/^\+?\d{10,15}$/.test(i);a?l?(async()=>{try{const e={title:Lt.title||`Сделка #${Date.now().toString().slice(-4)}`,stage:Lt.stage,lead_quality:Lt.leadQuality,amount:parseFloat(Lt.amount)||0,days:0,owner:p?"operator-1":"ai",owner_name:p?"Анна Петрова":"ИИ-агент",is_resolved:!1,description:Lt.notes,client_id:null,dialog_id:null};if(r){const t={id:Date.now().toString()};console.log("Deal created in Supabase:",t);const s={id:t.id,title:e.title,company:Lt.client.company||"",amount:e.amount,days:e.days,stage:e.stage,leadQuality:e.lead_quality,hasContacts:!(!Lt.client.email&&!Lt.client.phone),owner:e.owner,ownerName:e.owner_name,isResolved:e.is_resolved,client:Lt.client,notes:e.description,createdDate:(new Date).toISOString().split("T")[0],lastContact:(new Date).toISOString().split("T")[0],dialogId:e.dialog_id||""};tn(e=>[s,...e])}Rt({title:"",stage:"Новые",leadQuality:"medium",amount:"",client:{name:"",email:"",phone:"",company:""},notes:"",dialogId:null}),Dt(!1)}catch(e){console.error("Error creating deal:",e);const t={id:`deal-${Date.now()}`,title:Lt.title||`Сделка #${Date.now().toString().slice(-4)}`,stage:Lt.stage,leadQuality:Lt.leadQuality,amount:parseFloat(Lt.amount)||0,days:0,owner:p?"operator-1":"ai",ownerName:p?"Анна Петрова":"ИИ-агент",isResolved:!1,client:Lt.client,notes:Lt.notes,createdDate:(new Date).toISOString().split("T")[0],lastContact:(new Date).toISOString().split("T")[0],dialogId:null};tn(e=>[t,...e]),Rt({title:"",stage:"Новые",leadQuality:"medium",amount:"",client:{name:"",email:"",phone:"",company:""},notes:"",dialogId:null}),Dt(!1)}})():alert("Введите корректный телефон (10-15 цифр, допускается +)"):alert("Введите корректный email")},className:"w-full h-[34px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Создать сделку"}),J.jsx("button",{onClick:()=>Dt(!1),className:"w-full h-[34px] text-gray-600 rounded-[10px] hover:bg-gray-200 transition-colors",style:jm.whiteButton,children:"Отмена"})]})]})})}),It&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9998]",style:{marginTop:0},onClick:()=>Mt(!1),children:J.jsx("div",{className:"fixed right-0 top-0 h-full w-[500px] bg-white shadow-2xl z-[9999] transform transition-transform duration-300 ease-in-out",style:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px",marginTop:0},onClick:e=>e.stopPropagation(),children:J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#E5E7EB]",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Создать задачу"}),J.jsx("button",{onClick:()=>Mt(!1),className:"w-8 h-8 rounded-[90px] bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:J.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{color:"#8E8E93"},children:J.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),J.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Название задачи"}),J.jsx("input",{type:"text",value:Ot.title,onChange:e=>Pt(t=>({...t,title:e.target.value})),placeholder:"Введите название задачи",className:"w-full h-10 px-3 rounded-[10px] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Описание"}),J.jsx("textarea",{value:Ot.description,onChange:e=>Pt(t=>({...t,description:e.target.value})),placeholder:"Опишите детали задачи",rows:3,className:"w-full px-3 py-2 rounded-[10px] focus:outline-none resize-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Исполнитель"}),J.jsxs("div",{className:"relative executor-dropdown",children:[J.jsxs("button",{onClick:()=>Ls("task"),className:"w-full h-10 px-3 rounded-[10px] flex items-center justify-between hover:border-[#0084FF] transition-colors",style:Nm.inputField,children:[J.jsx("span",{className:"text-[#8E8E93] hover:text-[#070F1A] transition-colors",children:Ot.assigneeName}),J.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:J.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Ds.task&&J.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-[#E5E7EB] rounded-[10px] shadow-lg z-50",children:J.jsx("div",{className:"px-5 py-2 space-y-1",children:J.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-[#F2F3F4] rounded-[10px] cursor-pointer h-[32px]",onClick:()=>{Pt(e=>({...e,assignee:"ai",assigneeName:"ИИ-агент"})),Is(e=>({...e,task:!1}))},children:[J.jsx("img",{src:"/Frame 205.svg",alt:"ИИ",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(96%) saturate(7500%) hue-rotate(212deg) brightness(102%) contrast(101%)"}}),J.jsx("span",{className:"text-[13px] text-[#070F1A]",children:"ИИ-агент"})]})})})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Приоритет"}),J.jsxs("select",{value:Ot.priority,onChange:e=>Pt(t=>({...t,priority:e.target.value})),className:"w-full h-10 px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none focus:border-[#0084FF]",children:[J.jsx("option",{value:"low",children:"Низкий"}),J.jsx("option",{value:"medium",children:"Средний"}),J.jsx("option",{value:"high",children:"Высокий"}),J.jsx("option",{value:"urgent",children:"Срочный"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Дата дедлайна"}),J.jsx("input",{type:"date",value:Ot.dueDate,onChange:e=>Pt(t=>({...t,dueDate:e.target.value})),className:"w-full h-10 px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none focus:border-[#0084FF]"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"ID сделки"}),J.jsx("input",{type:"text",value:Ot.dealId,onChange:e=>Pt(t=>({...t,dealId:e.target.value})),placeholder:"Введите ID связанной сделки",className:"w-full h-10 px-3 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none focus:border-[#0084FF]"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[14px] font-[500] text-[#070F1A] mb-2",children:"Заметки"}),J.jsx("textarea",{value:Ot.notes,onChange:e=>Pt(t=>({...t,notes:e.target.value})),placeholder:"Дополнительная информация о задаче",rows:3,className:"w-full px-3 py-2 border border-[#E5E7EB] rounded-[10px] text-[14px] focus:outline-none focus:border-[#0084FF] resize-none"})]})]}),J.jsxs("div",{className:"p-6 border-t border-[#E5E7EB] flex gap-3",children:[J.jsx("button",{onClick:()=>Mt(!1),className:"flex-1 h-[34px] text-gray-600 rounded-[10px] hover:bg-gray-200 transition-colors",style:jm.whiteButton,children:"Отмена"}),J.jsx("button",{onClick:async()=>{try{const e={title:Ot.title||`Задача #${Date.now().toString().slice(-4)}`,description:Ot.description,assignee:Ot.assignee,assignee_name:Ot.assigneeName,priority:Ot.priority,status:"Новые",due_date:Ot.dueDate,deal_id:Ot.dealId,result:Ot.notes,created_by:p?"Анна Петрова":"ИИ-агент"};if(r){const t={id:Date.now().toString()};console.log("Task created in Supabase:",t);const s={...e,id:t.id,assigneeName:e.assignee_name,dueDate:e.due_date,dealId:e.deal_id,notes:e.result,createdBy:e.created_by,createdDate:(new Date).toLocaleDateString("ru-RU")};vs(e=>[s,...e])}Pt({title:"",description:"",assignee:"ai",assigneeName:"ИИ-агент",priority:"medium",dueDate:"",dealId:"",notes:""}),Mt(!1)}catch(e){console.error("Error creating task:",e);const t={id:`task-${Date.now()}`,title:Ot.title||`Задача #${Date.now().toString().slice(-4)}`,description:Ot.description,assignee:Ot.assignee,assigneeName:Ot.assigneeName,priority:Ot.priority,status:"Новые",dueDate:Ot.dueDate,dealId:Ot.dealId,notes:Ot.notes,createdBy:p?"Анна Петрова":"ИИ-агент",createdDate:(new Date).toLocaleDateString("ru-RU")};vs(e=>[t,...e]),Pt({title:"",description:"",assignee:"ai",assigneeName:"ИИ-агент",priority:"medium",dueDate:"",dealId:"",notes:""}),Mt(!1)}},className:"flex-1 h-[34px] bg-[#0084FF] text-white rounded-[10px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Создать задачу"})]})]})})}),Me&&J.jsxs("div",{className:"fixed z-50 bg-white text-gray-900 text-sm px-4 py-3 rounded-[15px] shadow-lg border border-gray-200 pointer-events-none max-w-[300px]",style:{left:Re.x,top:Re.y,transform:"translateX(-50%)"},children:[J.jsx("div",{className:"text-[12px] text-gray-600 mb-2 font-[500]",children:(null==(e=$c[Me])?void 0:e.description)||"Информация о метрике"}),J.jsx("div",{className:"bg-gray-100 px-3 py-2 rounded text-[12px] font-mono",children:(null==(t=$c[Me])?void 0:t.formula)||"Формула расчета"})]}),_c&&J.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-[16px] p-5 w-[400px]",children:[J.jsxs("div",{className:"flex justify-between items-center mb-4",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Завершить диалог"}),J.jsx("button",{onClick:()=>Ec(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 text-gray-500",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]}),J.jsx("div",{className:"mb-6",children:J.jsxs("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:["Вы уверены, что хотите завершить диалог?",J.jsx("br",{}),"Диалог будет помечен как разрешенный."]})}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>Ec(!1),className:"flex-1 h-[34px] text-[#070F1A] rounded-[12px] transition-colors hover:border-[#070F1A]/20",style:jm.whiteButton,children:"Отмена"}),J.jsx("button",{onClick:()=>{Cc&&((async e=>{vc(t=>t.map(t=>t.id===e?{...t,status:"resolved",assignedTo:t.assignedTo,canTakeover:!1,priority:null}:t));try{console.log("CRM: Сделка обновлена при закрытии диалога")}catch(t){console.error("Ошибка обновления сделки при закрытии диалога:",t)}try{Om.updateDialog(e,{status:"resolved_by_operator",need_handover:!1})}catch(s){console.warn("Failed to sync close to DB:",s)}})(Cc),Ec(!1),Sc(null))},className:"flex-1 h-[34px] bg-[#0084FF] text-white rounded-[12px] transition-colors hover:bg-[#0066CC]",style:jm.blueButton,children:"Завершить"})]})]})}),Ac&&J.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-[16px] p-5 w-[400px]",children:[J.jsxs("div",{className:"flex justify-between items-center mb-4",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Удалить диалог"}),J.jsx("button",{onClick:()=>Tc(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 text-gray-500",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]}),J.jsx("div",{className:"mb-6",children:J.jsxs("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:["Вы уверены, что хотите удалить диалог?",J.jsx("br",{}),"Это действие нельзя отменить."]})}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>Tc(!1),className:"flex-1 h-[34px] border border-[#070F1A]/10 text-[#070F1A] rounded-[12px] transition-colors hover:border-[#070F1A]/20 text-[14px] font-[500]",children:"Отмена"}),J.jsx("button",{onClick:()=>{if(Dc){vc(e=>e.filter(e=>e.id!==Dc)),vi&&vi.id===Dc&&yi(null);try{Om.deleteDialog(Dc)}catch(e){console.warn("Failed to sync delete to DB:",e)}Tc(!1),Ic(null)}},className:"flex-1 h-[34px] bg-[#EF4444] text-white rounded-[12px] transition-colors hover:bg-[#DC2626] text-[14px] font-[500]",children:"Удалить"})]})]})}),Kr&&J.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-[16px] p-5 w-[400px]",children:[J.jsxs("div",{className:"flex justify-between items-center mb-4",children:[J.jsx("h2",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Удалить корректировки"}),J.jsx("button",{onClick:()=>Gr(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-[7px] transition-colors",children:J.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 text-gray-500",children:[J.jsx("path",{d:"M18 6 6 18"}),J.jsx("path",{d:"m6 6 12 12"})]})})]}),J.jsx("div",{className:"mb-6",children:J.jsxs("p",{className:"text-[14px] text-[#8E8E93] leading-relaxed",children:["Вы действительно хотите удалить выбранные корректировки?",J.jsx("br",{}),"Это действие нельзя отменить."]})}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>Gr(!1),className:"flex-1 h-[34px] border border-[#070F1A]/10 text-[#070F1A] rounded-[12px] transition-colors hover:border-[#070F1A]/20 text-[14px] font-[500]",children:"Отмена"}),J.jsx("button",{onClick:async()=>{if(!(null==r?void 0:r.id))return Oc("Ошибка: пользователь не авторизован"),void Gr(!1);const e=Array.from(Rr);if(0!==e.length)try{for(const s of e){const e=Mr[s];if(e&&"string"==typeof e.id&&e.id)try{await Cm(e.id)}catch(t){console.error("deleteCorrection failed for id:",e.id,t)}}Lr(t=>t.filter((t,s)=>!e.includes(s))),Or(new Set),Gr(!1),Oc("Корректировки удалены")}catch(s){console.error("Error deleting corrections:",s),Oc("Ошибка при удалении корректировок")}else Gr(!1)},className:"flex-1 h-[34px] bg-[#EF4444] text-white rounded-[12px] transition-colors hover:bg-[#DC2626] text-[14px] font-[500]",children:"Удалить"})]})]})}),Jr&&J.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-[16px] p-6 w-[600px] max-h-[80vh] overflow-y-auto",children:[J.jsxs("div",{className:"flex justify-between items-center mb-[10px]",children:[J.jsx("h3",{className:"text-[18px] font-[500] text-[#070F1A]",children:"Скрипт вашего виджета"}),J.jsx("button",{onClick:()=>Yr(!1),className:"w-[32px] h-[32px] flex items-center justify-center hover:bg-[#F2F3F4] rounded-[8px] transition-colors",children:J.jsx("img",{src:"/x-02.svg",alt:"Закрыть",className:"w-4 h-4",style:{filter:"brightness(0) saturate(100%) invert(56%) sepia(6%) saturate(14%) hue-rotate(200deg) brightness(95%) contrast(89%)"}})})]}),J.jsxs("div",{className:"mb-[20px]",children:[J.jsx("p",{className:"text-[14px] text-[#8E8E93] mb-[20px]",children:"Скопируйте этот код и вставьте на ваш сайт:"}),J.jsx("div",{className:"bg-[#F8F8FA] rounded-[10px] p-4 border border-[#E5E6E7]",children:J.jsx("pre",{className:"text-[12px] text-[#070F1A] whitespace-pre-wrap font-mono",children:qc()})})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(qc()),Oc("Скрипт скопирован в буфер обмена!")}catch(e){console.error("Ошибка при копировании:",e)}},className:"flex-1 h-[34px] bg-[#0084FF] text-white rounded-[10px] font-[500] text-[13px] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Скопировать"}),J.jsx("button",{onClick:()=>{const e=sc||((null==r?void 0:r.id)?`adapto_${r.id}`:"adapto_demo"),t=`${$m}/widget-preview.html?key=${e}&noCache=1&ts=${Date.now()}`;window.open(t,"_blank","noopener,noreferrer")},className:"flex-1 h-[34px] bg-white text-[#070F1A] border border-[#E5E6E7] rounded-[10px] font-[500] text-[13px] hover:bg-[#F2F3F4] transition-colors",style:jm.whiteButton,children:"Предпросмотр в новой вкладке"})]})]})}),Pe&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>$e(!1)}),J.jsxs("div",{className:"relative bg-white rounded-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("img",{src:"/tg.png",alt:"Telegram",className:"w-8 h-8"}),J.jsx("h3",{className:"text-xl font-semibold",children:"Подключение Telegram бота"})]}),J.jsx("button",{onClick:()=>$e(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),J.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[J.jsx("h5",{className:"font-medium mb-3 text-blue-900",children:"Инструкция по получению API токена:"}),J.jsxs("div",{className:"space-y-3 text-sm text-blue-800",children:[J.jsx("p",{children:"1. Откройте Telegram и найдите BotFather"}),J.jsx("p",{children:"2. Отправьте команду /newbot и следуйте инструкциям для создания нового бота"}),J.jsx("p",{children:"3. После создания бота, BotFather даст вам уникальный API токен"}),J.jsx("p",{children:"4. Сохраните этот токен в безопасном месте - он нужен для управления вашим ботом"}),J.jsx("p",{children:"5. Вставьте скопированный API токен в поле ниже"})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2",children:"API Токен бота"}),J.jsx("input",{type:"text",placeholder:"Введите API токен вашего бота",value:Be,onChange:e=>ze(e.target.value),className:"w-full h-12 px-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:async()=>{if(!Be.trim())return C("Введите API токен бота"),_(!0),void setTimeout(()=>_(!1),3e3);if(!(null==r?void 0:r.id))return C("Ошибка аутентификации"),_(!0),void setTimeout(()=>_(!1),3e3);qe(!0);try{const e=await fetch(`${$m}/api/messenger/telegram/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({botToken:Be,userId:r.id})}),t=await e.json();t.success?(He(!0),$e(!1),C("Telegram бот успешно подключен!"),_(!0),setTimeout(()=>_(!1),3e3),await cr()):(C(t.error||"Ошибка подключения бота"),_(!0),setTimeout(()=>_(!1),3e3))}catch(e){console.error("Ошибка подключения Telegram бота:",e),C("Ошибка подключения бота"),_(!0),setTimeout(()=>_(!1),3e3)}finally{qe(!1)}},disabled:Ue,className:"flex-1 h-12 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:Ue?"Подключение...":"Подключить Telegram"}),J.jsx("button",{onClick:()=>$e(!1),className:"px-6 h-12 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})})]})]}),O&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>P(!1)}),J.jsx("div",{className:"relative bg-white rounded-xl w-full max-w-md mx-4 p-6",children:J.jsxs("div",{className:"text-center",children:[J.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Добавить сторис"}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2 text-left",children:"Название"}),J.jsx("input",{type:"text",value:W,onChange:e=>H(e.target.value),placeholder:"Введите название сторис",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2 text-left",children:"URL изображения"}),J.jsx("input",{type:"text",value:Q,onChange:e=>V(e.target.value),placeholder:"/path/to/image.png",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:async()=>{if(W.trim()&&Q.trim())try{const e={title:W,image_url:Q,order_index:L.length+1,is_active:!0};await(async e=>{try{return console.log("Story added:",e),{success:!0,data:e}}catch(t){return console.error("Error adding story:",t),{success:!1,error:t.message}}})(e),await dr(),H(""),V(""),P(!1),Oc("Сторис добавлена успешно")}catch(e){console.error("Ошибка при добавлении сторис:",e),Oc("Ошибка при добавлении сторис")}else Oc("Заполните все поля")},className:"flex-1 bg-[#0084FF] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#0070E6] transition-colors",children:"Добавить"}),J.jsx("button",{onClick:()=>P(!1),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Отмена"})]})]})]})})]}),B&&J.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[J.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>q(null)}),J.jsx("div",{className:"relative bg-white rounded-xl w-full max-w-md mx-4 p-6",children:J.jsxs("div",{className:"text-center",children:[J.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Редактировать сторис"}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2 text-left",children:"Название"}),J.jsx("input",{type:"text",value:B.title,onChange:e=>q({...B,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2 text-left",children:"URL изображения"}),J.jsx("input",{type:"text",value:B.image_url,onChange:e=>q({...B,image_url:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-sm font-medium mb-2 text-left",children:"Порядок"}),J.jsx("input",{type:"number",value:B.order_index,onChange:e=>q({...B,order_index:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsx("button",{onClick:()=>ur(B.id,{title:B.title,image_url:B.image_url,order_index:B.order_index}),className:"flex-1 bg-[#0084FF] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#0070E6] transition-colors",children:"Сохранить"}),J.jsx("button",{onClick:()=>q(null),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Отмена"})]})]})]})})]})]}):"login"===m?J.jsxs("div",{className:"h-screen flex bg-white",children:[J.jsxs("div",{className:"w-1/2 bg-white flex flex-col",children:[J.jsx("div",{className:"pt-10 flex justify-center",children:J.jsx("img",{src:"/Логотип-блэк.svg",alt:"Adapto",className:"h-8"})}),J.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:J.jsxs("div",{className:"w-full max-w-md space-y-8",children:[J.jsx("div",{className:"text-center",children:J.jsx("h2",{className:"text-[24px] font-[500] text-[#070F1A]",children:"Вход в Adapto"})}),J.jsx("div",{className:"space-y-[15px]",children:J.jsxs("form",{onSubmit:nd,className:"space-y-[15px]",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Email"}),J.jsx(cg,{type:"email",value:Vn.email,onChange:e=>Kn({...Vn,email:e.target.value}),placeholder:"your@email.com",required:!0,autoComplete:"email",className:"h-[34px] rounded-[10px] bg-white text-[#070F1A] placeholder-[#8E8E93] focus:outline-none",style:Nm.inputField})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Пароль"}),J.jsx(cg,{type:"password",value:Vn.password,onChange:e=>Kn({...Vn,password:e.target.value}),placeholder:"Введите пароль",required:!0,autoComplete:"current-password",className:"h-[34px] rounded-[10px] bg-white text-[#070F1A] placeholder-[#8E8E93] focus:outline-none",style:Nm.inputField})]}),Gn.general&&J.jsx("div",{className:"text-red-400 text-sm",children:Gn.general}),J.jsx(og,{type:"submit",className:"w-full h-[34px] rounded-[10px] text-white bg-[#0084FF] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:"Войти в аккаунт"}),J.jsx("div",{className:"text-center",children:J.jsx("button",{type:"button",className:"text-[#8E8E93] hover:text-[#070F1A] text-sm",children:"Забыл пароль?"})}),J.jsxs("div",{className:"text-center",children:[J.jsx("span",{className:"text-[#8E8E93] text-sm",children:"Нет аккаунта? "}),J.jsx("button",{type:"button",onClick:()=>g("register"),className:"text-[#0084FF] hover:text-[#0073E6] text-sm font-[500]",children:"Зарегистрироваться"})]})]})})]})})]}),J.jsx("div",{className:"w-1/2 relative p-[15px]",children:J.jsxs("div",{className:"w-full h-[calc(100vh-30px)] rounded-[20px] overflow-hidden transition-all duration-1000",children:[J.jsx("img",{src:Ta[f],alt:`Slide ${f+1}`,className:"w-full h-full object-cover object-center transition-all duration-1000 ease-in-out "+(v?"opacity-50":"opacity-100"),onError:e=>{console.log("Ошибка загрузки изображения:",Ta[f]),e.target.style.display="none"}}),J.jsx("div",{className:"absolute bottom-[35px] left-1/2 transform -translate-x-1/2",children:J.jsx("div",{className:"bg-white bg-opacity-20 w-[96px] h-[24px] rounded-[90px] flex items-center justify-center gap-2 px-2",children:[0,1,2,3,4].map(e=>J.jsx("div",{className:"w-2 h-2 rounded-[90px] transition-all duration-300 "+(e===f?"bg-white bg-opacity-100":"bg-white bg-opacity-30")},e))})})]})})]}):J.jsxs("div",{className:"h-screen flex bg-white",children:[J.jsxs("div",{className:"w-1/2 bg-white flex flex-col",children:[J.jsx("div",{className:"pt-10 flex justify-center",children:J.jsx("img",{src:"/Логотип-блэк.svg",alt:"Adapto",className:"h-8"})}),J.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:J.jsxs("div",{className:"w-full max-w-md space-y-8",children:[J.jsxs("div",{className:"text-center",children:[J.jsx("h2",{className:"text-[24px] font-[500] text-[#070F1A]",children:yt?"Регистрация оператора":"Регистрация"}),yt&&J.jsx("p",{className:"text-[14px] text-[#8E8E93] mt-2",children:"Вас пригласили в команду как оператора"})]}),J.jsx("div",{className:"space-y-[15px]",children:J.jsxs("form",{onSubmit:yt?ad:rd,className:"space-y-[15px]",children:[J.jsxs("div",{className:yt?"grid grid-cols-1 gap-5":"grid grid-cols-2 gap-5",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Имя"}),J.jsx(cg,{type:"text",value:Vn.name,onChange:e=>Kn({...Vn,name:e.target.value}),placeholder:"Ваше имя",required:!0,autoComplete:"name",className:"h-[34px] rounded-[10px] border border-[#070F1A] border-opacity-10 bg-white text-[#070F1A] placeholder-[#8E8E93] focus:border-[#070F1A] focus:border-opacity-20 font-[400]"})]}),!yt&&J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Компания"}),J.jsx(cg,{type:"text",value:Vn.company,onChange:e=>Kn({...Vn,company:e.target.value}),placeholder:"Название компании",required:!0,autoComplete:"organization",className:"h-[34px] rounded-[10px] border border-[#070F1A] border-opacity-10 bg-white text-[#070F1A] placeholder-[#8E8E93] focus:border-[#070F1A] focus:border-opacity-20 font-[400]"})]})]}),J.jsxs("div",{className:yt?"grid grid-cols-1 gap-5":"grid grid-cols-2 gap-5",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Email"}),J.jsx(cg,{type:"email",value:Vn.email,onChange:e=>Kn({...Vn,email:e.target.value}),placeholder:"your@email.com",required:!0,autoComplete:"email",className:"h-[34px] rounded-[10px] bg-white text-[#070F1A] placeholder-[#8E8E93] focus:outline-none",style:Nm.inputField})]}),!yt&&J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Номер телефона"}),J.jsx(cg,{type:"tel",value:Vn.phone,onChange:e=>{const t=(e=>{const t=e.replace(/\D/g,"");if(0===t.length)return"";let s=t;return t.startsWith("7")&&t.length>1&&(s=t.slice(1)),s.length<=3?`+7 (${s}`:s.length<=6?`+7 (${s.slice(0,3)}) ${s.slice(3)}`:s.length<=8?`+7 (${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6)}`:`+7 (${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6,8)}-${s.slice(8,10)}`})(e.target.value);Kn({...Vn,phone:t});const s=jr(t);Xn({...Yn,phone:s})},placeholder:"+7 (999) 123-45-67",required:!0,autoComplete:"tel",className:"h-[34px] rounded-[10px] bg-white text-[#070F1A] placeholder-[#8E8E93] focus:outline-none",style:Nm.inputField})]})]}),Yn.phone&&J.jsx("div",{className:"text-red-400 text-sm mt-1",children:Yn.phone}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-[13px] font-medium mb-2 text-[#070F1A]",children:"Пароль"}),J.jsx(cg,{type:"password",value:Vn.password,onChange:e=>Kn({...Vn,password:e.target.value}),placeholder:"Создайте пароль",required:!0,autoComplete:"new-password",className:"h-[34px] rounded-[10px] bg-white text-[#070F1A] placeholder-[#8E8E93] focus:outline-none",style:Nm.inputField})]}),J.jsx(og,{type:"submit",className:"w-full h-[34px] rounded-[10px] text-white bg-[#0084FF] hover:bg-[#0073E6] transition-colors",style:jm.blueButton,children:yt?"Зарегистрироваться как оператор":"Создать аккаунт"}),J.jsxs("div",{className:"text-center space-y-4",children:[J.jsx("p",{className:"text-xs text-[#8E8E93] leading-relaxed",children:'Нажимая "Создать аккаунт", вы соглашаетесь с условиями Оферты и даете согласие на обработку персональных данных в соответствии с Политикой Конфиденциальности'}),J.jsx("span",{className:"text-[#8E8E93] text-sm",children:"Уже есть аккаунт? "}),J.jsx("button",{type:"button",onClick:()=>g("login"),className:"text-[#0084FF] hover:text-[#0073E6] text-sm font-[500]",children:"Войти"})]})]})})]})})]}),J.jsx("div",{className:"w-1/2 relative p-[15px]",children:J.jsxs("div",{className:"w-full h-[calc(100vh-30px)] rounded-[20px] overflow-hidden transition-all duration-1000",children:[J.jsx("img",{src:Ta[f],alt:`Slide ${f+1}`,className:"w-full h-full object-cover object-center transition-all duration-1000 ease-in-out "+(v?"opacity-50":"opacity-100"),onError:e=>{console.log("Ошибка загрузки изображения:",Ta[f]),e.target.style.display="none"}}),J.jsx("div",{className:"absolute bottom-[35px] left-1/2 transform -translate-x-1/2",children:J.jsx("div",{className:"bg-white bg-opacity-20 w-[96px] h-[24px] rounded-[90px] flex items-center justify-center gap-2 px-2",children:[0,1,2,3,4].map(e=>J.jsx("div",{className:"w-2 h-2 rounded-[90px] transition-all duration-300 "+(e===f?"bg-white bg-opacity-100":"bg-white bg-opacity-30")},e))})})]})})]})}Y.createRoot(document.getElementById("root")).render(J.jsx(U.StrictMode,{children:J.jsx(mg,{})}));
