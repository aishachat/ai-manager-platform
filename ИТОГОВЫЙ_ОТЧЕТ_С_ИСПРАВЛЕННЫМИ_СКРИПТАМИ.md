# üìã –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢ –° –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ú–ò –°–ö–†–ò–ü–¢–ê–ú–ò

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–®–ê–ì 1-4):
1. **users** - ‚úÖ `id = auth.uid()`
2. **projects** - ‚úÖ `owner_id = auth.uid()`
3. **project_members** - ‚úÖ `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())`
4. **assistants** - ‚úÖ `owner_id = auth.uid()`

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–®–ê–ì 6-19):
5. **autoswitch_settings** - ‚úÖ `user_id = auth.uid()` (–ª–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
6. **conversations** - ‚úÖ `owner_id = auth.uid()` (—Ä–∞–∑–≥–æ–≤–æ—Ä—ã –≤–ª–∞–¥–µ–ª—å—Ü–∞)
7. **user_niches** - ‚úÖ `user_id = auth.uid() AND project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())` (–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
8. **niche_synonyms** - ‚úÖ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫: —á—Ç–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö, –∑–∞–ø–∏—Å—å –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
9. **ai_agent_settings** - ‚úÖ `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())` (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
10. **dialogs** - ‚úÖ `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())` (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
11. **chat_messages** - ‚úÖ `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())` (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
12. **widget_development_settings** - ‚úÖ `project_id IN (SELECT id FROM projects WHERE owner_id = auth.uid())` (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞)

## üéØ –ì–û–¢–û–í–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –°–ö–†–ò–ü–¢–´

### –ù–ï–ú–ï–î–õ–ï–ù–ù–û –í–´–ü–û–õ–ù–ò–¢–¨:
1. **`–®–ê–ì_16_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_TELEGRAM_SETTINGS_–ü–†–û–ï–ö–¢.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `telegram_settings`
2. **`–®–ê–ì_18_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_SOURCES_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `knowledge_sources` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
3. **`–®–ê–ì_19_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_CHUNKS_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `knowledge_chunks` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)

### –ü–û–°–õ–ï –£–°–ü–ï–•–ê –°–û–ó–î–ê–¢–¨:
4. **`–®–ê–ì_20_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_CRM_CLIENTS_–ü–†–û–ï–ö–¢.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `crm_clients`
5. **`–®–ê–ì_21_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_CRM_DEALS_–ü–†–û–ï–ö–¢.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `crm_deals`
6. **`–®–ê–ì_22_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_CRM_OPERATORS_–ü–†–û–ï–ö–¢.sql`** - –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `crm_operators`

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
- **`widget_development_settings`** - `user_id` –∏–º–µ–µ—Ç —Ç–∏–ø `text` ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–æ `u.id::text = wds.user_id`
- **`knowledge_sources`** - `user_id` –∏–º–µ–µ—Ç —Ç–∏–ø `uuid` ‚Üí —É–±—Ä–∞–Ω–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤
- **`knowledge_chunks`** - `user_id` –∏–º–µ–µ—Ç —Ç–∏–ø `uuid` ‚Üí —É–±—Ä–∞–Ω–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

### 2. –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
- `–®–ê–ì_15_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_WIDGET_DEVELOPMENT_SETTINGS_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`
- `–®–ê–ì_18_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_SOURCES_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`
- `–®–ê–ì_19_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_CHUNKS_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`

## üéØ –õ–û–ì–ò–ö–ê RLS

### 1. PROJECT_ID –ª–æ–≥–∏–∫–∞ (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞):
- `telegram_settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –ø—Ä–æ–µ–∫—Ç–∞
- `knowledge_sources` - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–Ω–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞
- `knowledge_chunks` - —á–∞–Ω–∫–∏ –∑–Ω–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞
- `crm_clients` - –∫–ª–∏–µ–Ω—Ç—ã CRM –ø—Ä–æ–µ–∫—Ç–∞
- `crm_deals` - —Å–¥–µ–ª–∫–∏ CRM –ø—Ä–æ–µ–∫—Ç–∞
- `crm_operators` - –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã CRM –ø—Ä–æ–µ–∫—Ç–∞

### 2. –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ):
- `niches` - –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–∂–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
- `chunk_synonyms` - –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–∂–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –°–ï–ô–ß–ê–°:
1. –í—ã–ø–æ–ª–Ω–∏—Ç—å `–®–ê–ì_16_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_TELEGRAM_SETTINGS_–ü–†–û–ï–ö–¢.sql`
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å `–®–ê–ì_18_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_SOURCES_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å `–®–ê–ì_19_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_KNOWLEDGE_CHUNKS_–ë–ï–ó_–û–®–ò–ë–û–ö.sql`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–û–°–õ–ï –£–°–ü–ï–•–ê:
–°–æ–∑–¥–∞–º —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

## üí° –í–ê–ñ–ù–û

**–í—Å–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!** 

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

## üìû –¢–†–ï–ë–£–ï–¢–°–Ø –î–ï–ô–°–¢–í–ò–ï

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å–æ–æ–±—â–∏—Ç–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
