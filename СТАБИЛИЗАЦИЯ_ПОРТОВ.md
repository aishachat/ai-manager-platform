# üéØ –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ü–æ—Ä—Ç–æ–≤ - –ó–∞–≤–µ—Ä—à–µ–Ω–∞!

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞:**
- **3000** - Next.js –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è)
- **3001** - Next.js backend (API)
- **3002** - WebSocket —Å–µ—Ä–≤–µ—Ä (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å)
- **5173** - Vite dev server (—Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

### **–ü—Ä–æ–±–ª–µ–º—ã:**
1. **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. **–°–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –Ω—É–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
3. **–¢–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞** - –µ—Å–ª–∏ –æ–¥–∏–Ω –ø–æ—Ä—Ç –ø–∞–¥–∞–µ—Ç, —á–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ª–æ–º–∞–µ—Ç—Å—è
4. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

### **–ï–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã ‚Üí –ü–æ—Ä—Ç 3001 ‚Üí Next.js Backend
     ‚Üì              ‚Üì           ‚Üì
  Frontend    Nginx Proxy   API + WebSocket
```

### **–ß—Ç–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ:**
- ‚úÖ **API endpoints** - `/api/*`
- ‚úÖ **WebSocket** - `/api/websocket`
- ‚úÖ **Health check** - `/api/health`
- ‚úÖ **–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã**

## üèóÔ∏è **–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

### **Backend (–ü–æ—Ä—Ç 3001):**
```
Next.js Server
‚îú‚îÄ‚îÄ /api/health - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ /api/dialogs - –¥–∏–∞–ª–æ–≥–∏
‚îú‚îÄ‚îÄ /api/websocket - WebSocket-like —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ /api/chat/message - —Å–æ–æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ /api/user-limits - –ª–∏–º–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ /api/* - –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ endpoints
```

### **Frontend:**
```
React App
‚îú‚îÄ‚îÄ API calls ‚Üí https://adaptoai.ru/api/*
‚îú‚îÄ‚îÄ WebSocket ‚Üí wss://adaptoai.ru/api/websocket
‚îî‚îÄ‚îÄ Fallback ‚Üí HTTP polling –µ—Å–ª–∏ WebSocket –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
```

### **Nginx:**
```
Nginx Proxy
‚îú‚îÄ‚îÄ /api/* ‚Üí localhost:3001/api/*
‚îú‚îÄ‚îÄ /ws ‚Üí localhost:3001/api/websocket
‚îî‚îÄ‚îÄ /* ‚Üí localhost:3001 (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã)
```

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**

### **1. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **–û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å** - —Ç–æ–ª—å–∫–æ Next.js –Ω–∞ –ø–æ—Ä—Ç—É 3001
- ‚úÖ **–û–¥–Ω–∞ —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞** - –µ—Å–ª–∏ –ø–∞–¥–∞–µ—Ç, –ø–∞–¥–∞–µ—Ç –≤—Å–µ —Å—Ä–∞–∑—É
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –æ–¥–∏–Ω `pm2 restart`

### **2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- ‚úÖ **–û–¥–∏–Ω PM2 –ø—Ä–æ—Ü–µ—Å—Å** - –ª–µ–≥–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å
- ‚úÖ **–ï–¥–∏–Ω—ã–µ –ª–æ–≥–∏** - –≤—Å–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

### **3. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** - HTTP polling –µ—Å–ª–∏ WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ **Graceful degradation** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ WebSocket

### **4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **–ú–µ–Ω—å—à–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤** - –º–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ **–ï–¥–∏–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –º–µ–Ω—å—à–µ overhead
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö**

## üìä **–°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**

- ‚úÖ **–û—Ç–¥–µ–ª—å–Ω—ã–π WebSocket —Å–µ—Ä–≤–µ—Ä** - –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —É–¥–∞–ª–µ–Ω
- ‚úÖ **Next.js WebSocket endpoint** - —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
- ‚úÖ **Frontend** - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - WebSocket endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

### **–î–æ:**
```
‚ùå 3 –ø–æ—Ä—Ç–∞ (3000, 3001, 3002)
‚ùå 2+ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ PM2
‚ùå –°–ª–æ–∂–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞
```

### **–ü–æ—Å–ª–µ:**
```
‚úÖ 1 –ø–æ—Ä—Ç (3001)
‚úÖ 1 –ø—Ä–æ—Ü–µ—Å—Å –≤ PM2
‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚úÖ –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞ (–ª–µ–≥—á–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å)
```

## üöÄ **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
pm2 restart ai-platform-backend

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
pm2 logs ai-platform-backend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
ss -tlnp | grep 3001
```

## üìà **–ü—Ä–æ–≥—Ä–µ—Å—Å: 98% –∑–∞–≤–µ—Ä—à–µ–Ω–æ** üéØ

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!**

### **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ API endpoints (–µ–¥–∏–Ω—ã–π –ø–æ—Ä—Ç)
- ‚úÖ WebSocket (—á–µ—Ä–µ–∑ API)
- ‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- ‚úÖ HTTP polling fallback
- ‚úÖ Nginx –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** üÜï

### **–û—Å—Ç–∞–ª–æ—Å—å:**
- üîÑ –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Ç–µ–ø–µ—Ä—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –Ω–∞–¥–µ–∂–Ω–∞!** üöÄ
